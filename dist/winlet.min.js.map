{"version":3,"file":"winlet.min.js","names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","module","d","this","v","k","__esModule","Array","isArray","arrayLikeToArray","ReferenceError","asyncGeneratorStep","value","done","Promise","resolve","then","arguments","apply","_next","_throw","TypeError","isNativeReflectConstruct","setPrototypeOf","Reflect","construct","push","bind","prototype","toPropertyKey","_defineProperties","enumerable","configurable","writable","Object","defineProperty","key","_getPrototypeOf","getPrototypeOf","__proto__","create","constructor","default","Function","toString","indexOf","_isNativeReflectConstruct","Boolean","valueOf","Symbol","iterator","from","l","next","_typeof","assertThisInitialized","regeneratorDefine","_regenerator","toStringTag","Generator","y","G","GeneratorFunction","GeneratorFunctionPrototype","displayName","w","m","regeneratorAsyncGen","regenerator","regeneratorAsyncIterator","OverloadYield","AsyncIterator","asyncIterator","_regeneratorDefine","_invoke","unshift","pop","regeneratorAsync","regeneratorKeys","regeneratorValues","_regeneratorRuntime","name","throw","return","break","continue","stop","catch","abrupt","delegateYield","resultName","finish","_t","prev","sent","wrap","reverse","isGeneratorFunction","mark","awrap","async","keys","values","isNaN","_setPrototypeOf","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arrayWithoutHoles","iterableToArray","nonIterableSpread","toPrimitive","String","Number","slice","test","isNativeFunction","_wrapNativeSuper","Map","has","get","set","Wrapper","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","defaultConfig","id","ifExists","title","icon","x","width","height","minWidth","minHeight","virtualizable","windowOptions","resizableX","resizableY","movable","closable","minimizable","maximizable","maximizableOnDblClick","focus","alwaysOnTop","useGhostWindow","opacity","modal","content","html","iframe","src","srcdoc","allow","referrerPolicy","loading","sandbox","loadWinLet","template","menu","menuStyle","tabs","tabStyle","tabOptions","reorderable","addable","detachable","mergeable","allowIncomingMerge","onAdd","undefined","onMergeAttempt","taskbarOptions","showIconOnly","contextMenu","customControls","enableShortcuts","controlsPosition","showLoadingIndicator","onOpen","onClose","onFocus","onBlur","onResize","onMove","onReload","_isPopup","_parent","_taskbarItem","WinLetBaseError","_Error","message","_this","_classCallCheck2","_callSuper","BuiltInError","captureStackTrace","_inherits2","_createClass2","_wrapNativeSuper2","SimpleError","_WinLetBaseError","WinLetError","_SimpleError","LIBRARY_NAME","TIMEOUT_RESULT","CLOSE_BUTTON_RESULT","_config","_errors","_types","_baseclass","_interopRequireDefault","_utils","_window_manager","ownKeys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","_objectSpread","forEach","_defineProperty2","getOwnPropertyDescriptors","defineProperties","_WinLetBaseClass","WinLetWindow","options","manager","_getPrototypeOf2","_possibleConstructorReturn2","generateId","concat","existingEl","document","getElementById","classList","contains","deepMerge","deepCopy","parentWindow","el","createDOM","add","setAttribute","titleBarEl","querySelector","iconEl","titleEl","mainContentEl","contentEl","loaderEl","debugOverlayEl","applyOptions","setupEventListeners","updateDebugOverlay","_this$options$customC","windowEl","createElement","className","state","handles","resizableHandlesHTML","join","hasMenu","hasTabs","isMergedMenu","isMergedTabs","customControlsHTML","map","controlsHTML","titleBarContentHTML","loaderHTML","debugHTML","innerHTML","setTitle","setIcon","setSize","style","createTabs","renderContent","createMenu","display","container","_this2","hideLoader","virtualizationLevel","tagName","appendChild","cloneNode","console","warn","isNonEmptyObject","showLoader","iframeConfig","finalSrcDoc","globalConfig","getGlobalConfig","libraryPath","scriptTag","addEventListener","querySelectorAll","dd","isMenuOpen","_this3","menuBar","menuItemData","_menuItemData$name","menuItemEl","textContent","items","dropdownEl","createDropdownMenu","stopPropagation","isVisible","closeAllMenus","_this4","itemData","itemEl","separator","_itemData$name","text","shortcut","_itemData$action","action","subMenuEl","_this$options$tabOpti","_this5","tabBar","tabOpts","tabData","index","createTabElement","addTabBtn","_tabOpts$onAdd","newTabItem","addTab","setupTabBarDropZone","activateTab","_this6","_e$dataTransfer","dataTransfer","types","includes","preventDefault","dropEffect","remove","_e$dataTransfer2","_e$dataTransfer3","_e$dataTransfer4","_this6$manager$contai","tabDataJSON","getData","sourceWindowId","sourceTabId","draggingEl","sourceWindow","getWindow","_sourceOpts$mergeable","_targetOpts$allowInco","sourceOpts","targetOpts","isMergeable","allowsIncoming","customFilterPassed","JSON","parse","closeTab","parseInt","updateTabOrderFromDOM","_this$options$tabOpti2","_this7","tabEl","dataset","tabId","insertBefore","closeBtn","indexToClose","findIndex","tabContentEl","splice","makeTabReorderable","_this8","draggable","setData","tabIndex","stringify","onTabDragStart","onTabDragEnd","_this8$manager$draggi","draggingTabInfo","rect","getBoundingClientRect","isAfter","clientX","left","parent","parentNode","nextSibling","passive","_this$tabs$index","wasActive","tab","newActiveIndex","Math","max","close","toggle","tabItem","setActive","newIndex","tabElements","newTabs","newOptionsTabs","oldTabs","_toConsumableArray2","oldOptionsTabs","oldIndex","_this9","boundGlobalClickHandler","controlsEl","button","target","closest","_this9$popupCloseCall","popupCloseCallback","toggleMaximize","minimize","control","find","makeMovable","makeResizable","showContextMenu","clientY","pointerType","contextMenuTimer","window","setTimeout","MOBILE_CONTEXT_MENU_TIMEOUT","clearContextMenuTimer","clearTimeout","_this0","initialLeft","initialTop","_this0$manager$contai","startX","startY","isDragging","ghostEl","offsetLeft","top","offsetTop","offsetWidth","offsetHeight","onPointerMove","moveE","_this0$el","isConnected","deltaX","abs","deltaY","DRAG_THRESHOLD","setPointerCapture","pointerId","pointerEvents","restoredWidth","lastState","clickRatio","titleBarRect","offsetY","posX","posY","restore","setPosition","newLeft","newTop","_onPointerUp","removeEventListener","releasePointerCapture","updateVirtualization","_this1","handle","_this1$manager$contai","direction","replace","_this1$el","startWidth","startHeight","startLeft","startTop","_this1$options","newWidth","newHeight","_onPointerUp2","classStr","classes","trim","split","hasPrefix","some","hasIcon","pos","getPosition","size","getSize","round","focused","zIndex","level","getUnsafeContentLevel","currentIndex","virtualizationHierarchy","targetIndex","cleanupVirtualizationStyles","updateTaskbarItem","_this10","previousLevel","destroyWindow","_this11","doMinimize","blur","_globalConfig$virtual","enableVirtualization","minimizeVirtualizeTimer","virtualize","virtualizationDelay","enableAnimations","once","maximize","_this12","doMaximize","maxBtn","_this13","unvirtualize","wasMinimized","removeAttribute","doRestore","focusWindow","_this14","_this15","reloadContent","_iframe$contentWindow","contentWindow","location","reload","activeTabIndex","activeTab","tabContentOptions","contentContainer","childManager","applyGlobalConfig","init","type","postMessage","getChildManager","createWindow","winOptions","popup","assign","popupOptionsWithParent","popupAsync","_capture","_asyncToGenerator2","_callee","canvas","_e","_this16","_context","html2canvas","reject","allowTaint","useCORS","logging","onclone","clonedDoc","_clonedDoc$querySelec","toDataURL","stack","error","_printFrame$contentWi","_printFrame$contentWi4","contentSource","getContent","printFrame","position","border","transform","body","frameDoc","removeChild","open","write","getTitle","outerHTML","_ref","_printFrame$contentWi5","doPrint","_callee2","_printFrame$contentWi2","_printFrame$contentWi3","_context2","print","readyState","_iframe$contentWindow2","_iframe$contentWindow3","sanitizeHTML","isFontAwesome","img","alt","finalX","finalY","parentRect","winWidth","winHeight","min","clampedOpacity","setOpacity","_styles","_dark","_default","_highContrast","_window2","_createForOfIteratorHelper","_arrayLikeToArray","_unsupportedIterableToArray","_n","F","s","WindowManager","initialConfig","registerTheme","defaultTheme","darkTheme","highContrastTheme","_isInitialized","enableDebugMode","enableTaskbar","taskbarEl","createTaskbar","updateTaskbarLayout","flexDirection","autoDetectBootstrapTheme","startBootstrapThemeObserver","stopBootstrapThemeObserver","parentEl","HTMLElement","styleTag","getStyleData","head","containerEl","workspaceEl","getComputedStyle","theme","setTheme","requestAnimationFrame","activeEl","activeElement","winEl","win","windows","activeWindow","clickedWindow","clickedContextMenu","clickedTaskbar","active","hideContextMenu","event","data","_typeof2","_step","isSourceValid","_iterator","source","err","origin","setupShortcutListeners","newTab","mergedWindowOptions","_targetWindow$options","_targetWindow$options2","windowSwitchShortcut","parseShortcut","toLowerCase","ctrlKey","ctrl","altKey","shiftKey","shift","targetWindow","startsWith","keyNum","numTabs","getTabs","_findAndExecShortcut","menuItems","_step2","_iterator2","item","_item$action","_shortcut","toUpperCase","replaceStringVariable","str","_options$ifExists","ensureInitialized","existingWindow","creationOptions","nextX","nextY","containerRect","lastAutoPosition","CASCADE_OFFSET","allWindows","createTaskbarItem","zIndexCounterOnTop","zIndexCounter","_options$modal","_options$alwaysOnTop","_options$focus","buttons","buttonPresets","Ok","OkCancel","Yes","YesNo","YesNoCancel","Retry","RetryCancel","AbortRetryIgnore","timeoutId","closeCallback","result","_options$onClose","messageHTML","buttonsHTML","btn","contentHTML","autoWidth","_this$workspaceEl","_this$workspaceEl2","temp","visibility","whiteSpace","winPosition","lastPopupPosition","timeout","opt","tmpOnClose","deactivateFocusTrap","nextWin","_this$activeWindow","_win$options$_taskbar","enableFocusTrapping","activateFocusTrap","_w$options$_taskbarIt","element","_this$workspaceEl3","_this$workspaceEl4","contextWindow","contextMenuEl","_this$contextMenuEl","menuWidth","menuHeight","_window","screenWidth","innerWidth","screenHeight","innerHeight","_this$contextMenuEl2","themes","themeObj","activeTheme","_i","_Object$entries","entries","variables","_Object$entries$_i","_slicedToArray2","removeProperty","_i2","_Object$entries2","_Object$entries2$_i","_key","_value","setProperty","taskbar","order","paddingTop","paddingBottom","paddingLeft","paddingRight","computedStyle","taskbarHeight","taskbarWidth","windowId","updateTaskbarItemContent","_win$options","indicateVirtualizationInTaskbar","boundTabPressHandler","focusableElements","hasAttribute","nextIndex","_this$globalConfig$vi","threshold","virtualizationThreshold","_step3","_iterator3","sort","b","viewportRect","targetWin","targetRect","_i3","_samplePoints","right","bottom","point","pointIsOccluded","j","_occluderWin$getOpaci","occluderWin","getOpacity","occluderRect","bootstrapThemeObserver","highContrastMatcher","matchMedia","highContrastListener","matches","stopAutoThemeListener","applyBootstrapTheme","documentElement","getAttribute","targetNode","MutationObserver","mutationsList","_this8$highContrastMa","_step4","_iterator4","mutation","attributeName","themeValue","observe","attributes","attributeFilter","disconnect","startAutoThemeListener","prefersColorSchemeListener","prefersDarkMatcher","_document","_version","currentScript","api","setGlobalConfig","createPopup","createAsyncPopup","getWindowFromElement","getActiveWindow","setDefaultConfig","isInitialized","getRegisteredThemes","getTheme","version","LIB_VERSION","POPUP_TIMEOUT_RESULT","POPUP_CLOSE_BUTTON_RESULT","WinLet","WinLetBaseClass","Utils","random","substring","seen","WeakMap","Date","getTime","copiedMap","Set","copiedSet","arrCopy","copiedObj","hasOwnProperty","output","sourceValue","targetValue","obj","_"],"sources":["node_modules/browser-pack/_prelude.js","node_modules/@babel/runtime/helpers/OverloadYield.js","node_modules/@babel/runtime/helpers/arrayLikeToArray.js","node_modules/@babel/runtime/helpers/arrayWithHoles.js","node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","node_modules/@babel/runtime/helpers/assertThisInitialized.js","node_modules/@babel/runtime/helpers/asyncToGenerator.js","node_modules/@babel/runtime/helpers/classCallCheck.js","node_modules/@babel/runtime/helpers/construct.js","node_modules/@babel/runtime/helpers/createClass.js","node_modules/@babel/runtime/helpers/defineProperty.js","node_modules/@babel/runtime/helpers/getPrototypeOf.js","node_modules/@babel/runtime/helpers/inherits.js","node_modules/@babel/runtime/helpers/interopRequireDefault.js","node_modules/@babel/runtime/helpers/isNativeFunction.js","node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js","node_modules/@babel/runtime/helpers/iterableToArray.js","node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","node_modules/@babel/runtime/helpers/nonIterableRest.js","node_modules/@babel/runtime/helpers/nonIterableSpread.js","node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","node_modules/@babel/runtime/helpers/regenerator.js","node_modules/@babel/runtime/helpers/regeneratorAsync.js","node_modules/@babel/runtime/helpers/regeneratorAsyncGen.js","node_modules/@babel/runtime/helpers/regeneratorAsyncIterator.js","node_modules/@babel/runtime/helpers/regeneratorDefine.js","node_modules/@babel/runtime/helpers/regeneratorKeys.js","node_modules/@babel/runtime/helpers/regeneratorRuntime.js","node_modules/@babel/runtime/helpers/regeneratorValues.js","node_modules/@babel/runtime/helpers/setPrototypeOf.js","node_modules/@babel/runtime/helpers/slicedToArray.js","node_modules/@babel/runtime/helpers/toConsumableArray.js","node_modules/@babel/runtime/helpers/toPrimitive.js","node_modules/@babel/runtime/helpers/toPropertyKey.js","node_modules/@babel/runtime/helpers/typeof.js","node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","node_modules/@babel/runtime/helpers/wrapNativeSuper.js","node_modules/@babel/runtime/regenerator/index.js","src/const/config.ts","src/const/errors.ts","src/const/types.ts","src/function/window.ts","src/function/window_manager.ts","src/index.ts","src/libs/baseclass.ts","src/libs/utils.ts","src/style/styles.ts","src/style/themes/dark.ts","src/style/themes/default.ts","src/style/themes/high-contrast.ts","src/version.ts"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","function _OverloadYield(e, d) {\n  this.v = e, this.k = d;\n}\nmodule.exports = _OverloadYield, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nmodule.exports = _arrayWithHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return arrayLikeToArray(r);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nmodule.exports = _asyncToGenerator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var isNativeReflectConstruct = require(\"./isNativeReflectConstruct.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _construct(t, e, r) {\n  if (isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments);\n  var o = [null];\n  o.push.apply(o, e);\n  var p = new (t.bind.apply(t, o))();\n  return r && setPrototypeOf(p, r.prototype), p;\n}\nmodule.exports = _construct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _getPrototypeOf(t) {\n  return module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _getPrototypeOf(t);\n}\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _interopRequireDefault(e) {\n  return e && e.__esModule ? e : {\n    \"default\": e\n  };\n}\nmodule.exports = _interopRequireDefault, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _isNativeFunction(t) {\n  try {\n    return -1 !== Function.toString.call(t).indexOf(\"[native code]\");\n  } catch (n) {\n    return \"function\" == typeof t;\n  }\n}\nmodule.exports = _isNativeFunction, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (module.exports = _isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _isNativeReflectConstruct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nmodule.exports = _iterableToArrayLimit, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableRest, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var regeneratorDefine = require(\"./regeneratorDefine.js\");\nfunction _regenerator() {\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */\n  var e,\n    t,\n    r = \"function\" == typeof Symbol ? Symbol : {},\n    n = r.iterator || \"@@iterator\",\n    o = r.toStringTag || \"@@toStringTag\";\n  function i(r, n, o, i) {\n    var c = n && n.prototype instanceof Generator ? n : Generator,\n      u = Object.create(c.prototype);\n    return regeneratorDefine(u, \"_invoke\", function (r, n, o) {\n      var i,\n        c,\n        u,\n        f = 0,\n        p = o || [],\n        y = !1,\n        G = {\n          p: 0,\n          n: 0,\n          v: e,\n          a: d,\n          f: d.bind(e, 4),\n          d: function d(t, r) {\n            return i = t, c = 0, u = e, G.n = r, a;\n          }\n        };\n      function d(r, n) {\n        for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) {\n          var o,\n            i = p[t],\n            d = G.p,\n            l = i[2];\n          r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0));\n        }\n        if (o || r > 1) return a;\n        throw y = !0, n;\n      }\n      return function (o, p, l) {\n        if (f > 1) throw TypeError(\"Generator is already running\");\n        for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) {\n          i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u);\n          try {\n            if (f = 2, i) {\n              if (c || (o = \"next\"), t = i[o]) {\n                if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\");\n                if (!t.done) return t;\n                u = t.value, c < 2 && (c = 0);\n              } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1);\n              i = e;\n            } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break;\n          } catch (t) {\n            i = e, c = 1, u = t;\n          } finally {\n            f = 1;\n          }\n        }\n        return {\n          value: t,\n          done: y\n        };\n      };\n    }(r, o, i), !0), u;\n  }\n  var a = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  t = Object.getPrototypeOf;\n  var c = [][n] ? t(t([][n]())) : (regeneratorDefine(t = {}, n, function () {\n      return this;\n    }), t),\n    u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c);\n  function f(e) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, regeneratorDefine(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e;\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, regeneratorDefine(u, \"constructor\", GeneratorFunctionPrototype), regeneratorDefine(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", regeneratorDefine(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), regeneratorDefine(u), regeneratorDefine(u, o, \"Generator\"), regeneratorDefine(u, n, function () {\n    return this;\n  }), regeneratorDefine(u, \"toString\", function () {\n    return \"[object Generator]\";\n  }), (module.exports = _regenerator = function _regenerator() {\n    return {\n      w: i,\n      m: f\n    };\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _regenerator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var regeneratorAsyncGen = require(\"./regeneratorAsyncGen.js\");\nfunction _regeneratorAsync(n, e, r, t, o) {\n  var a = regeneratorAsyncGen(n, e, r, t, o);\n  return a.next().then(function (n) {\n    return n.done ? n.value : a.next();\n  });\n}\nmodule.exports = _regeneratorAsync, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var regenerator = require(\"./regenerator.js\");\nvar regeneratorAsyncIterator = require(\"./regeneratorAsyncIterator.js\");\nfunction _regeneratorAsyncGen(r, e, t, o, n) {\n  return new regeneratorAsyncIterator(regenerator().w(r, e, t, o), n || Promise);\n}\nmodule.exports = _regeneratorAsyncGen, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var OverloadYield = require(\"./OverloadYield.js\");\nvar regeneratorDefine = require(\"./regeneratorDefine.js\");\nfunction AsyncIterator(t, e) {\n  function n(r, o, i, f) {\n    try {\n      var c = t[r](o),\n        u = c.value;\n      return u instanceof OverloadYield ? e.resolve(u.v).then(function (t) {\n        n(\"next\", t, i, f);\n      }, function (t) {\n        n(\"throw\", t, i, f);\n      }) : e.resolve(u).then(function (t) {\n        c.value = t, i(c);\n      }, function (t) {\n        return n(\"throw\", t, i, f);\n      });\n    } catch (t) {\n      f(t);\n    }\n  }\n  var r;\n  this.next || (regeneratorDefine(AsyncIterator.prototype), regeneratorDefine(AsyncIterator.prototype, \"function\" == typeof Symbol && Symbol.asyncIterator || \"@asyncIterator\", function () {\n    return this;\n  })), regeneratorDefine(this, \"_invoke\", function (t, o, i) {\n    function f() {\n      return new e(function (e, r) {\n        n(t, i, e, r);\n      });\n    }\n    return r = r ? r.then(f, f) : f();\n  }, !0);\n}\nmodule.exports = AsyncIterator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _regeneratorDefine(e, r, n, t) {\n  var i = Object.defineProperty;\n  try {\n    i({}, \"\", {});\n  } catch (e) {\n    i = 0;\n  }\n  module.exports = _regeneratorDefine = function regeneratorDefine(e, r, n, t) {\n    if (r) i ? i(e, r, {\n      value: n,\n      enumerable: !t,\n      configurable: !t,\n      writable: !t\n    }) : e[r] = n;else {\n      var o = function o(r, n) {\n        _regeneratorDefine(e, r, function (e) {\n          return this._invoke(r, n, e);\n        });\n      };\n      o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2);\n    }\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _regeneratorDefine(e, r, n, t);\n}\nmodule.exports = _regeneratorDefine, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _regeneratorKeys(e) {\n  var n = Object(e),\n    r = [];\n  for (var t in n) r.unshift(t);\n  return function e() {\n    for (; r.length;) if ((t = r.pop()) in n) return e.value = t, e.done = !1, e;\n    return e.done = !0, e;\n  };\n}\nmodule.exports = _regeneratorKeys, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var OverloadYield = require(\"./OverloadYield.js\");\nvar regenerator = require(\"./regenerator.js\");\nvar regeneratorAsync = require(\"./regeneratorAsync.js\");\nvar regeneratorAsyncGen = require(\"./regeneratorAsyncGen.js\");\nvar regeneratorAsyncIterator = require(\"./regeneratorAsyncIterator.js\");\nvar regeneratorKeys = require(\"./regeneratorKeys.js\");\nvar regeneratorValues = require(\"./regeneratorValues.js\");\nfunction _regeneratorRuntime() {\n  \"use strict\";\n\n  var r = regenerator(),\n    e = r.m(_regeneratorRuntime),\n    t = (Object.getPrototypeOf ? Object.getPrototypeOf(e) : e.__proto__).constructor;\n  function n(r) {\n    var e = \"function\" == typeof r && r.constructor;\n    return !!e && (e === t || \"GeneratorFunction\" === (e.displayName || e.name));\n  }\n  var o = {\n    \"throw\": 1,\n    \"return\": 2,\n    \"break\": 3,\n    \"continue\": 3\n  };\n  function a(r) {\n    var e, t;\n    return function (n) {\n      e || (e = {\n        stop: function stop() {\n          return t(n.a, 2);\n        },\n        \"catch\": function _catch() {\n          return n.v;\n        },\n        abrupt: function abrupt(r, e) {\n          return t(n.a, o[r], e);\n        },\n        delegateYield: function delegateYield(r, o, a) {\n          return e.resultName = o, t(n.d, regeneratorValues(r), a);\n        },\n        finish: function finish(r) {\n          return t(n.f, r);\n        }\n      }, t = function t(r, _t, o) {\n        n.p = e.prev, n.n = e.next;\n        try {\n          return r(_t, o);\n        } finally {\n          e.next = n.n;\n        }\n      }), e.resultName && (e[e.resultName] = n.v, e.resultName = void 0), e.sent = n.v, e.next = n.n;\n      try {\n        return r.call(this, e);\n      } finally {\n        n.p = e.prev, n.n = e.next;\n      }\n    };\n  }\n  return (module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return {\n      wrap: function wrap(e, t, n, o) {\n        return r.w(a(e), t, n, o && o.reverse());\n      },\n      isGeneratorFunction: n,\n      mark: r.m,\n      awrap: function awrap(r, e) {\n        return new OverloadYield(r, e);\n      },\n      AsyncIterator: regeneratorAsyncIterator,\n      async: function async(r, e, t, o, u) {\n        return (n(e) ? regeneratorAsyncGen : regeneratorAsync)(a(r), e, t, o, u);\n      },\n      keys: regeneratorKeys,\n      values: regeneratorValues\n    };\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorValues(e) {\n  if (null != e) {\n    var t = e[\"function\" == typeof Symbol && Symbol.iterator || \"@@iterator\"],\n      r = 0;\n    if (t) return t.call(e);\n    if (\"function\" == typeof e.next) return e;\n    if (!isNaN(e.length)) return {\n      next: function next() {\n        return e && r >= e.length && (e = void 0), {\n          value: e && e[r++],\n          done: !e\n        };\n      }\n    };\n  }\n  throw new TypeError(_typeof(e) + \" is not iterable\");\n}\nmodule.exports = _regeneratorValues, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _setPrototypeOf(t, e) {\n  return module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _setPrototypeOf(t, e);\n}\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableRest = require(\"./nonIterableRest.js\");\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nmodule.exports = _slicedToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(r) {\n  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var getPrototypeOf = require(\"./getPrototypeOf.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nvar isNativeFunction = require(\"./isNativeFunction.js\");\nvar construct = require(\"./construct.js\");\nfunction _wrapNativeSuper(t) {\n  var r = \"function\" == typeof Map ? new Map() : void 0;\n  return module.exports = _wrapNativeSuper = function _wrapNativeSuper(t) {\n    if (null === t || !isNativeFunction(t)) return t;\n    if (\"function\" != typeof t) throw new TypeError(\"Super expression must either be null or a function\");\n    if (void 0 !== r) {\n      if (r.has(t)) return r.get(t);\n      r.set(t, Wrapper);\n    }\n    function Wrapper() {\n      return construct(t, arguments, getPrototypeOf(this).constructor);\n    }\n    return Wrapper.prototype = Object.create(t.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    }), setPrototypeOf(Wrapper, t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _wrapNativeSuper(t);\n}\nmodule.exports = _wrapNativeSuper, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","import { WindowOptions } from \"./types\";\n\n// Partial<WindowOptions>ではなく、全てのキーを定義して型安全にする\nexport const defaultConfig: Required<WindowOptions> = {\n\tid: null,\n\tifExists: \"focus\",\n\ttitle: \"New Window\",\n\ticon: null,\n\tx: \"auto\",\n\ty: \"auto\",\n\twidth: 500,\n\theight: 400,\n\tminWidth: 200,\n\tminHeight: 150,\n\tvirtualizable: true,\n\twindowOptions: {\n\t\tresizableX: true,\n\t\tresizableY: true,\n\t\tmovable: true,\n\t\tclosable: true,\n\t\tminimizable: true,\n\t\tmaximizable: true,\n\t\tmaximizableOnDblClick: true,\n\t\tfocus: true,\n\t\talwaysOnTop: false,\n\t\tuseGhostWindow: false,\n\t\topacity: 1.0,\n\t\tmodal: false,\n\t},\n\tcontent: {\n\t\thtml: \"\",\n\t\tiframe: {\n\t\t\tsrc: \"\",\n\t\t\tsrcdoc: \"\",\n\t\t\tallow: \"\",\n\t\t\treferrerPolicy: \"\",\n\t\t\tloading: \"lazy\",\n\t\t\tsandbox: \"\",\n\t\t\tloadWinLet: false,\n\t\t},\n\t\ttemplate: \"\",\n\t},\n\tmenu: [],\n\tmenuStyle: \"default\",\n\ttabs: [],\n\ttabStyle: \"default\",\n\ttabOptions: {\n\t\treorderable: false,\n\t\tclosable: false,\n\t\taddable: false,\n\t\tdetachable: false,\n\t\tmergeable: false,\n\t\tallowIncomingMerge: false,\n\t\tonAdd: undefined,\n\t\tonMergeAttempt: undefined,\n\t},\n\ttaskbarOptions: {\n\t\tshowIconOnly: true,\n\t},\n\tcontextMenu: [],\n\tcustomControls: [],\n\tenableShortcuts: true,\n\tcontrolsPosition: \"right\",\n\tshowLoadingIndicator: true,\n\tonOpen: () => {},\n\tonClose: () => {},\n\tonFocus: () => {},\n\tonBlur: () => {},\n\tonResize: () => {},\n\tonMove: () => {},\n\tonReload: () => {},\n\n\t_isPopup: false,\n\t_parent: null,\n\t_taskbarItem: null,\n};\n","interface ErrorConstructor {\n\tcaptureStackTrace?(targetObject: object, constructorOpt?: Function): void;\n}\n\n/**\n * すべてのカスタムエラーの基底クラス\n */\nexport class WinLetBaseError extends Error {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t\tthis.name = this.constructor.name;\n\n\t\tconst BuiltInError: ErrorConstructor = Error as ErrorConstructor;\n\t\tif (BuiltInError.captureStackTrace) {\n\t\t\tBuiltInError.captureStackTrace(this, this.constructor);\n\t\t}\n\t}\n}\n\n/**\n * 単純なメッセージのみのエラー\n */\nexport class SimpleError extends WinLetBaseError {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t}\n}\n\nexport class WinLetError extends SimpleError {}\n","export const LIBRARY_NAME = \"winlet\";\n\nexport type WindowState = \"normal\" | \"minimized\" | \"maximized\";\n/**\n * ウィンドウの仮想化レベル\n * - `none`: 仮想化されていない状態\n * - `frozen`: ウィンドウのコンテンツは保持されるが、インタラクションは停止\n * - `suspended`: ウィンドウのコンテンツはDOMから非表示にされ、描画負荷を削減\n * - `unloaded`: ウィンドウのコンテンツはメモリから解放され、リソースを最大限制御\n */\nexport type VirtualizationLevel = \"none\" | \"frozen\" | \"suspended\" | \"unloaded\";\n\nexport interface WindowContentOptions {\n\t/**\n\t * 直接埋め込むHTML\n\t */\n\thtml?: string;\n\t/**\n\t * iframe設定\n\t */\n\tiframe?: {\n\t\tsrc?: HTMLIFrameElement[\"src\"];\n\t\tsrcdoc?: HTMLIFrameElement[\"srcdoc\"];\n\t\tallow?: HTMLIFrameElement[\"allow\"];\n\t\treferrerPolicy?: HTMLIFrameElement[\"referrerPolicy\"];\n\t\tloading?: HTMLIFrameElement[\"loading\"];\n\t\tsandbox?: string[] | string;\n\t\t/**\n\t\t * srcdocで生成されるiframe内にWinLetライブラリ自身を読み込むかどうか。\n\t\t * trueにする場合、GlobalConfigOptionsでlibraryPathを指定する必要があります。\n\t\t */\n\t\tloadWinLet?: boolean;\n\t};\n\t/**\n\t * HTMLテンプレートのselector\n\t */\n\ttemplate?: string;\n}\n\n// IWindowインターフェースを先に定義することで循環参照を回避\nexport interface IWindow {\n\treadonly id: string;\n\toptions: Required<WindowOptions>;\n\tel: HTMLElement;\n\tstate: WindowState;\n\n\t// --- Public API ---\n\t/**\n\t * ウィンドウを閉じます。\n\t */\n\tclose(): void;\n\t/**\n\t * ウィンドウを最小化します。\n\t */\n\tminimize(): void;\n\t/**\n\t * ウィンドウを最大化/元に戻します。\n\t */\n\ttoggleMaximize(): void;\n\t/**\n\t * ウィンドウを最大化します。\n\t */\n\tmaximize(): void;\n\t/**\n\t * ウィンドウを元に戻します。\n\t */\n\trestore(): void;\n\t/**\n\t * ウィンドウをフォーカスします。\n\t */\n\tfocus(): void;\n\t/**\n\t * ウィンドウからフォーカスを外します。\n\t */\n\tblur(): void;\n\t/**\n\t * 注意を引くためにウィンドウを揺らします。\n\t */\n\tshake(): void;\n\t/**\n\t * ウィンドウの内容をキャプチャして、画像データとして取得します。\n\t * @returns PNG形式のデータURLを含むPromise\n\t * @see https://github.com/niklasvh/html2canvas\n\t */\n\tcapture(): Promise<string>;\n\t/**\n\t * ウィンドウのコンテンツを印刷します。\n\t */\n\tprint(): void;\n\tgetTitle(): string;\n\tsetTitle(title: string): void;\n\tsetIcon(icon: string | null): void;\n\tgetPosition(): { x: number; y: number };\n\tsetPosition(x: number | \"center\" | \"left\" | \"right\" | \"auto\", y: number | \"center\" | \"top\" | \"bottom\" | \"auto\"): void;\n\tgetSize(): { width: number; height: number };\n\tsetSize(width: number | string, height: number | string): void;\n\t/**\n\t * ウィンドウの不透明度を設定します。\n\t * @param opacity 0.0 (透明) から 1.0 (不透明) の間の値\n\t */\n\tsetOpacity(opacity: number): void;\n\t/**\n\t * ウィンドウをリロードします。\n\t */\n\treload(): void;\n\n\t/**\n\t * ウィンドウのコンテンツ要素（またはiframe要素）を取得します。\n\t * @returns コンテンツを内包するHTMLElement、またはiframeウィンドウの場合はHTMLIFrameElement\n\t */\n\tgetContent(): HTMLElement | HTMLIFrameElement;\n\n\t/**\n\t * このウィンドウの内部に新しいウィンドウを作成します。\n\t * @param options - 新しいウィンドウのオプション\n\t * @returns 作成されたIWindowインスタンス\n\t */\n\tcreateWindow(options?: WindowOptions): IWindow;\n\n\t/**\n\t * このウィンドウの内部に新しいポップアップを作成します。\n\t * @param options - 新しいポップアップのオプション\n\t * @returns 作成されたIWindowインスタンス\n\t */\n\tcreatePopup(options: PopupOptions): IWindow;\n\t/**\n\t * このウィンドウの内部に新しいポップアップを作成します。\n\t * @param options - 新しいポップアップのオプション\n\t * @returns Promiseオブジェクト\n\t */\n\tcreateAsyncPopup(options: PopupOptions): Promise<PopupResult>;\n\n\t/**\n\t * ウィンドウのオプションを動的に変更します。\n\t *\n\t * (初期化時に使用されるオプションは変更されず、警告なども出力されません。)\n\t *\n\t * @param options - 変更したいオプション\n\t */\n\tsetOptions(options: Partial<WindowOptions>): void;\n}\n\nexport interface MenuItem {\n\tname?: string;\n\taction?: (win: IWindow) => void;\n\titems?: MenuItem[];\n\tseparator?: boolean;\n\tshortcut?: string;\n}\n\nexport interface TabItem {\n\ttitle: string;\n\tcontent: WindowContentOptions;\n}\n\nexport interface ContextMenuItem {\n\tname?: string;\n\taction?: (win: IWindow) => void;\n\tseparator?: boolean;\n}\n\nexport interface CustomControlButton {\n\t/**\n\t * ボタンを識別するための一意の名前\n\t */\n\tname: string;\n\t/**\n\t * ボタンのHTMLコンテンツ (例: '<i class=\"fa fa-question\"></i>')\n\t */\n\thtml: string;\n\t/**\n\t * ボタンのツールチップテキスト\n\t */\n\ttitle?: string;\n\t/**\n\t * ボタンクリック時のアクション\n\t */\n\taction: (win: IWindow) => void;\n}\n\nexport interface WindowOptions {\n\t/**\n\t * ウィンドウのID\n\t */\n\tid?: string | null;\n\t/**\n\t * 既に同名のウィンドウが存在する場合の動作\n\t *\n\t * focus (デフォルト): 既存のウィンドウを復元し、フォーカスします。\n\t * prevent: 新しいウィンドウを作成せず、処理を中断します。\n\t * create: IDの重複を無視して、常に新しいウィンドウを作成します。\n\t */\n\tifExists?: \"focus\" | \"prevent\" | \"create\";\n\t/**\n\t * ウィンドウのタイトル\n\t */\n\ttitle?: string;\n\t/**\n\t * ウィンドウのアイコン\n\t *\n\t * url / font-awesomeのクラス名の指定可能\n\t */\n\ticon?: string | null;\n\t/**\n\t * ウィンドウのX座標\n\t */\n\tx?: number | \"center\" | \"left\" | \"right\" | \"auto\";\n\t/**\n\t * ウィンドウのY座標\n\t */\n\ty?: number | \"center\" | \"top\" | \"bottom\" | \"auto\";\n\t/**\n\t * ウィンドウのサイズX\n\t */\n\twidth?: number;\n\t/**\n\t * ウィンドウのサイズY\n\t */\n\theight?: number;\n\t/**\n\t * ウィンドウの最小サイズX\n\t */\n\tminWidth?: number;\n\t/**\n\t * ウィンドウの最小サイズY\n\t */\n\tminHeight?: number;\n\t/**\n\t * ウィンドウが仮想化の対象となるかどうか。\n\t * `enableVirtualization` がtrueの場合にのみ有効です。\n\t * @default true\n\t */\n\tvirtualizable?: boolean;\n\t/**\n\t * ウィンドウのオプション\n\t */\n\twindowOptions?: {\n\t\t/**\n\t\t * 水平方向のリサイズ\n\t\t */\n\t\tresizableX?: boolean;\n\t\t/**\n\t\t * 垂直方向のリサイズ\n\t\t */\n\t\tresizableY?: boolean;\n\t\t/**\n\t\t * ウィンドウの移動\n\t\t */\n\t\tmovable?: boolean;\n\t\t/**\n\t\t * ウィンドウを閉じるボタンの表示\n\t\t */\n\t\tclosable?: boolean;\n\t\t/**\n\t\t * ウィンドウを最小化するボタンの表示\n\t\t */\n\t\tminimizable?: boolean;\n\t\t/**\n\t\t * ウィンドウを最大化するボタンの表示\n\t\t */\n\t\tmaximizable?: boolean;\n\t\t/**\n\t\t * タイトルバーのダブルクリックで最大化\n\t\t */\n\t\tmaximizableOnDblClick?: boolean;\n\t\t/**\n\t\t * ウィンドウを常に最前面に表示するかどうか\n\t\t */\n\t\talwaysOnTop?: boolean;\n\t\t/**\n\t\t * ドラッグ・リサイズ時にゴーストウィンドウ（輪郭）を表示するか\n\t\t */\n\t\tuseGhostWindow?: boolean;\n\t\t/**\n\t\t * 作成時にウィンドウにフォーカスを当てるか\n\t\t */\n\t\tfocus?: boolean;\n\t\t/**\n\t\t * ウィンドウの不透明度 (0.0 - 1.0)\n\t\t */\n\t\topacity?: number;\n\t\t/**\n\t\t * ウィンドウをモーダルとして扱うか\n\t\t * trueの場合、このウィンドウ以外は操作できなくなります。\n\t\t */\n\t\tmodal?: boolean;\n\t};\n\t/**\n\t * ウィンドウのコンテンツ\n\t */\n\tcontent?: WindowContentOptions;\n\t/**\n\t * メニュー\n\t */\n\tmenu?: MenuItem[];\n\t/**\n\t * メニューの表示形式\n\t * - default: 通常のメニューバー\n\t * - merged: タイトルバーに統合\n\t */\n\tmenuStyle?: \"default\" | \"merged\";\n\t/**\n\t * タブ\n\t */\n\ttabs?: TabItem[];\n\t/**\n\t * タブの表示形式\n\t * - default: 通常のタブバー\n\t * - merged: タイトルバーに統合されたChrome風タブ\n\t */\n\ttabStyle?: \"default\" | \"merged\";\n\ttabOptions?: {\n\t\t/**\n\t\t * タブの入れ替え\n\t\t */\n\t\treorderable?: boolean;\n\t\t/**\n\t\t * タブを閉じるボタン\n\t\t */\n\t\tclosable?: boolean;\n\t\t/**\n\t\t * タブ追加ボタン\n\t\t */\n\t\taddable?: boolean;\n\t\t/**\n\t\t * タブをドラッグして新しいウィンドウとして分離できるようにするか\n\t\t */\n\t\tdetachable?: boolean;\n\t\t/**\n\t\t * タブを別の既存のウィンドウにマージすることができます。\n\t\t */\n\t\tmergeable?: boolean;\n\t\t/**\n\t\t * このウィンドウが他のウィンドウからマージされたタブを受け入れることができます。\n\t\t */\n\t\tallowIncomingMerge?: boolean;\n\t\t/**\n\t\t * 追加ボタン押下時の処理\n\t\t */\n\t\tonAdd?: (win: IWindow) => TabItem;\n\t\t/**\n\t\t * マージが許可されているかどうかを動的に決定するコールバック関数。\n\t\t * @param sourceWindow タブの元ウィンドウ\n\t\t * @param targetWindow ドロップされたタブのウィンドウ\n\t\t * @returns true:マージ許可 false:マージ禁止\n\t\t */\n\t\tonMergeAttempt?: (sourceWindow: IWindow, targetWindow: IWindow) => boolean;\n\t};\n\t/**\n\t * タスクバーアイテムの表示設定\n\t */\n\ttaskbarOptions?: {\n\t\t/**\n\t\t * trueにすると、タスクバーにタイトルではなくアイコンを表示します。\n\t\t * アイコンが設定されている必要があります。\n\t\t */\n\t\tshowIconOnly?: boolean;\n\t};\n\t/**\n\t * 右クリックメニュー\n\t */\n\tcontextMenu?: ContextMenuItem[];\n\t/**\n\t * タイトルバーに追加するカスタムコントロールボタン\n\t */\n\tcustomControls?: CustomControlButton[];\n\t/**\n\t * ショートカットキーを有効化\n\t */\n\tenableShortcuts?: boolean;\n\t/**\n\t * コントロールの位置\n\t */\n\tcontrolsPosition?: \"left\" | \"right\";\n\t/**\n\t * iframeや非同期コンテンツの読み込み中にローディングインジケーターを表示するか\n\t */\n\tshowLoadingIndicator?: boolean;\n\t/**\n\t * ウィンドウオープン時\n\t */\n\tonOpen?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウクローズ時\n\t */\n\tonClose?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウフォーカス時\n\t */\n\tonFocus?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウブラー時\n\t */\n\tonBlur?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウリサイズ時\n\t */\n\tonResize?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウ移動時\n\t */\n\tonMove?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウリロード時\n\t *\n\t * デフォルトのリロード動作（iframeの再読み込みやhtmlの再描画）をキャンセルする場合は `false` を返します。\n\t */\n\tonReload?: (win: IWindow) => boolean | void;\n\n\t// 内部利用フラグ\n\t_isPopup?: boolean;\n\t/**\n\t * 親ウィンドウのインスタンス (内部利用)\n\t */\n\t_parent?: IWindow | null;\n\t/**\n\t * タスクバーのアイテム要素 (内部利用)\n\t */\n\t_taskbarItem?: HTMLElement | null;\n}\n\n// --- Popup ---\nexport const TIMEOUT_RESULT = Symbol(\"timeout\");\nexport const CLOSE_BUTTON_RESULT = Symbol(\"close\");\n\nexport type PopupResult = string | number | symbol | null;\n\nexport interface PopupButton {\n\ttext: string;\n\tvalue: PopupResult;\n}\n\nexport type PopupButtonPreset = \"Ok\" | \"OkCancel\" | \"Yes\" | \"YesNo\" | \"YesNoCancel\" | \"Retry\" | \"RetryCancel\" | \"AbortRetryIgnore\";\n\nexport interface PopupOptions {\n\tmessage: string;\n\ttitle?: string;\n\ticon?: string | null;\n\tbuttons?: PopupButton[] | PopupButtonPreset;\n\ttimeout?: number;\n\tautoWidth?: boolean;\n\tfocus?: boolean;\n\talwaysOnTop?: boolean;\n\tmodal?: boolean;\n\n\t/**\n\t * ウィンドウクローズ時\n\t */\n\tonClose?: (result: PopupResult) => void;\n\t/**\n\t * ウィンドウフォーカス時\n\t */\n\tonFocus?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウブラー時\n\t */\n\tonBlur?: (win: IWindow) => void;\n}\n\nexport interface TaskbarOptions {\n\t/**\n\t * タスクバーの表示位置\n\t * @default 'bottom'\n\t */\n\tposition?: \"top\" | \"bottom\" | \"left\" | \"right\";\n}\n\nexport interface GlobalConfigOptions {\n\twindowSwitchShortcut?: string | null; // 例: \"Ctrl+`\"\n\t/**\n\t * ウィンドウマネージャを内包する親要素。\n\t * セレクタ文字列またはHTMLElementを指定します。\n\t * 未指定の場合はbody直下に配置されます。\n\t */\n\tcontainer?: string | HTMLElement;\n\t/**\n\t * `srcdoc` iframeでWinLetを自己読込する場合のライブラリのパス。\n\t */\n\tlibraryPath?: string;\n\t/**\n\t * ウィンドウ操作時のアニメーションを有効にするか\n\t * @default true\n\t */\n\tenableAnimations?: boolean;\n\t/**\n\t * タスクバーを表示するか\n\t * @default false\n\t */\n\tenableTaskbar?: boolean;\n\t/**\n\t * タスクバーの設定\n\t */\n\ttaskbar?: TaskbarOptions;\n\t/**\n\t * モーダルウィンドウのフォーカストラップを有効にするか\n\t * @default true\n\t */\n\tenableFocusTrapping?: boolean;\n\t/**\n\t * ウィンドウ仮想化を有効にするか。\n\t * 大量のウィンドウを扱う際のパフォーマンスを向上させます。\n\t * @default true\n\t */\n\tenableVirtualization?: boolean;\n\t/**\n\t * 仮想化されたウィンドウをタスクバーで視覚的に示すか\n\t * @default true\n\t */\n\tindicateVirtualizationInTaskbar?: boolean;\n\t/**\n\t * 仮想化がアクティブになる最小ウィンドウ数。\n\t * この数を超えると、非表示のウィンドウの仮想化が開始されます。\n\t * @default 5\n\t */\n\tvirtualizationThreshold?: number;\n\t/**\n\t * 最小化されたウィンドウを仮想化するまでの遅延時間（ミリ秒）。\n\t * `enableVirtualization` がtrueの場合にのみ有効です。\n\t * @default 10000\n\t */\n\tvirtualizationDelay?: number;\n\t/**\n\t * 初期テーマ\n\t * 'dark'などの登録済みテーマ名、またはThemeオブジェクトを指定\n\t * @default 'default'\n\t */\n\ttheme?: string | Theme;\n\t/**\n\t * Bootstrapのカラースキームを自動検出し、テーマを同期させるか\n\t * @default true\n\t */\n\tautoDetectBootstrapTheme?: boolean;\n\t/**\n\t * デバッグモードを有効にするか。\n\t * ウィンドウにID、座標、状態などのデバッグ情報をオーバーレイ表示します。\n\t * @default false\n\t */\n\tenableDebugMode?: boolean;\n}\n\n/**\n * テーマの定義\n */\nexport interface Theme {\n\tname: string;\n\tvariables: Record<string, string>;\n}\n\n// WinLetの公開APIの型\nexport interface WinLetApi {\n\tinit: (options?: GlobalConfigOptions) => void;\n\t/**\n\t * ウィンドウを作成します。\n\t * @param options - 新しいウィンドウのオプション\n\t * @returns 作成されたIWindowインスタンス\n\t */\n\tcreateWindow: (options?: WindowOptions) => IWindow;\n\t/**\n\t * ポップアップウィンドウを作成します。\n\t * @param options - 新しいポップアップのオプション\n\t * @returns 作成されたIWindowインスタンス\n\t */\n\tcreatePopup: (options: PopupOptions) => IWindow;\n\t/**\n\t * ポップアップウィンドウを作成します。\n\t * @param options - 新しいポップアップのオプション\n\t * @returns Promiseオブジェクト\n\t */\n\tcreateAsyncPopup(options: PopupOptions): Promise<PopupResult>;\n\t/**\n\t * 指定されたIDのウィンドウインスタンスを取得します。\n\t * @param id - 取得するウィンドウのID\n\t */\n\tgetWindow: (id: string) => IWindow | undefined;\n\t/**\n\t * 指定されたDOM要素を内包するウィンドウインスタンスを取得します。\n\t * 入れ子ウィンドウの場合、最も内側にある子ウィンドウを返します。\n\t * @param element - 検索の起点となるDOM要素\n\t * @returns 発見されたIWindowインスタンス、またはundefined\n\t */\n\tgetWindowFromElement: (element: HTMLElement) => IWindow | undefined;\n\t/**\n\t * 現在アクティブなウィンドウを取得します。\n\t */\n\tgetActiveWindow: () => IWindow | null;\n\t/**\n\t * タスクバーのアイテムを更新します。\n\t * @param win - 更新するウィンドウ\n\t * @param state - 更新する状態\n\t */\n\tupdateTaskbarItem: (win: IWindow, state: \"minimized\" | \"restored\" | \"titleChanged\" | \"iconChanged\" | \"virtualized\" | \"unvirtualized\") => void;\n\t/**\n\t * ウィンドウのデフォルトの設定を変更します。\n\t * @param options - 新しいウィンドウのオプション\n\t */\n\tsetDefaultConfig: (options: WindowOptions) => void;\n\t/**\n\t * グローバル設定を変更します。\n\t * @param options - 新しいウィンドウのオプション\n\t */\n\tsetGlobalConfig: (options: GlobalConfigOptions) => void;\n\t/**\n\t * 表示テーマを登録します。\n\t * @param theme - 登録するテーマ\n\t */\n\tregisterTheme: (theme: Theme) => void;\n\t/**\n\t * 登録済みのテーマ名の配列を取得します。\n\t * @returns 登録済みのテーマ名の配列\n\t */\n\tgetRegisteredThemes: () => string[];\n\t/**\n\t * 表示テーマを変更します。\n\t * @param theme - 登録済みのテーマ名（'default', 'dark'など）またはThemeオブジェクト\n\t */\n\tsetTheme: (theme: string | Theme) => void;\n\t/**\n\t * 現在の表示テーマを取得します。\n\t * @returns 現在の表示テーマ\n\t */\n\tgetTheme: () => Theme | null;\n\t/**\n\t * WinLetのバージョンを取得します。\n\t */\n\tget version(): string;\n\tPOPUP_TIMEOUT_RESULT: typeof TIMEOUT_RESULT;\n\tPOPUP_CLOSE_BUTTON_RESULT: typeof CLOSE_BUTTON_RESULT;\n}\n\n// グローバルスコープのWindowにWinLetプロパティを追加\ndeclare global {\n\tinterface Window {\n\t\tWinLet: WinLetApi;\n\n\t\t// 外部ライブラリを追加\n\t\thtml2canvas?: (element: HTMLElement, options?: any) => Promise<HTMLCanvasElement>;\n\t}\n}\n","import { defaultConfig } from \"../const/config\";\nimport { WinLetError } from \"../const/errors\";\nimport { CLOSE_BUTTON_RESULT, IWindow, LIBRARY_NAME, MenuItem, PopupOptions, PopupResult, TabItem, VirtualizationLevel, WindowContentOptions, WindowOptions, WindowState } from \"../const/types\";\nimport WinLetBaseClass from \"../libs/baseclass\";\nimport Utils from \"../libs/utils\";\nimport WindowManager from \"./window_manager\";\n\nexport default class WinLetWindow extends WinLetBaseClass implements IWindow {\n\tpublic readonly id: string;\n\tpublic options: Required<WindowOptions>;\n\tpublic el: HTMLElement;\n\tpublic state: WindowState = \"normal\";\n\n\tprivate manager: WindowManager;\n\tprivate lastState = { x: 0, y: 0, width: 0, height: 0 };\n\tprivate focused: boolean = false;\n\tprivate readonly DRAG_THRESHOLD = 5;\n\n\tprivate titleBarEl: HTMLElement;\n\tprivate iconEl: HTMLElement;\n\tprivate titleEl: HTMLElement;\n\tprivate mainContentEl: HTMLElement;\n\tprivate contentEl: HTMLElement;\n\tprivate loaderEl: HTMLElement;\n\tprivate tabs: { tabEl: HTMLElement; contentEl: HTMLElement }[] = [];\n\tprivate addTabBtn: HTMLElement | null = null;\n\tprivate isMenuOpen = false;\n\tprivate boundGlobalClickHandler: ((event: MouseEvent) => void) | null = null;\n\n\t// モバイル対応\n\tprivate readonly MOBILE_CONTEXT_MENU_TIMEOUT = 700;\n\tprivate contextMenuTimer: number | null = null;\n\n\t// Popup用\n\tpublic popupCloseCallback: ((result: PopupResult) => void) | null = null;\n\n\tprivate childManager: WindowManager | null = null;\n\tprivate parentWindow: IWindow | null;\n\n\tprivate debugOverlayEl: HTMLElement | null = null;\n\tpublic virtualizationLevel: VirtualizationLevel = \"none\";\n\tprivate minimizeVirtualizeTimer: number | null = null;\n\tprivate readonly virtualizationHierarchy: readonly VirtualizationLevel[] = [\"none\", \"frozen\", \"suspended\", \"unloaded\"];\n\n\tconstructor(options: WindowOptions, manager: WindowManager) {\n\t\tsuper();\n\t\tthis.id = options.id || Utils.generateId(`${LIBRARY_NAME}-window`);\n\t\tif (options.id) {\n\t\t\tconst existingEl = document.getElementById(options.id);\n\t\t\tif (existingEl && existingEl.classList.contains(`${LIBRARY_NAME}-window`)) {\n\t\t\t\tthrow new WinLetError(`WinLet: Window with ID \"${options.id}\" already exists. New window will not be created.`);\n\t\t\t}\n\t\t}\n\t\tthis.manager = manager;\n\t\tthis.options = Utils.deepMerge(Utils.deepCopy(defaultConfig), options) as Required<WindowOptions>;\n\t\tthis.parentWindow = options._parent || null;\n\n\t\tthis.el = this.createDOM();\n\n\t\t// _isPopupによってクラスを追加\n\t\tif (this.options._isPopup) {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-popup-window`);\n\t\t}\n\t\t// tabStyleとmenuStyleによってクラスを追加\n\t\tif (this.options.tabStyle === \"merged\") {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-tab-style-merged`);\n\t\t}\n\t\tif (this.options.menuStyle === \"merged\") {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-menu-style-merged`);\n\t\t}\n\t\t// 最前面/モーダル指定によりクラスを追加\n\t\tif (this.options.windowOptions.alwaysOnTop) {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-always-on-top`);\n\t\t}\n\t\tif (this.options.windowOptions.modal) {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-modal`);\n\t\t\tthis.el.setAttribute(\"aria-modal\", \"true\");\n\t\t}\n\n\t\tthis.titleBarEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title-bar`)!;\n\t\tthis.iconEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-icon`)!;\n\t\tthis.titleEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title`)!;\n\t\tthis.mainContentEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-main-content`)!;\n\t\tthis.contentEl = this.mainContentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-content`)!;\n\t\tthis.loaderEl = this.mainContentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-loader-overlay`)!;\n\t\tthis.debugOverlayEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-debug-overlay`);\n\n\t\tthis.applyOptions();\n\t\tthis.setupEventListeners();\n\t\tthis.updateDebugOverlay();\n\n\t\tthis.options.onOpen(this);\n\t}\n\n\tprivate createDOM(): HTMLElement {\n\t\tconst windowEl = document.createElement(\"div\");\n\t\twindowEl.className = `${LIBRARY_NAME}-window`;\n\t\twindowEl.id = this.id;\n\n\t\t// ARIA属性\n\t\twindowEl.setAttribute(\"role\", \"application\");\n\t\twindowEl.setAttribute(\"aria-labelledby\", `${this.id}-title`);\n\t\tif (this.state === \"minimized\") {\n\t\t\twindowEl.setAttribute(\"inert\", \"\");\n\t\t\twindowEl.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\n\t\tconst handles: string[] = [];\n\t\tif (this.options.windowOptions.resizableY) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-n\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-s\"></div>`);\n\t\t}\n\t\tif (this.options.windowOptions.resizableX) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-w\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-e\"></div>`);\n\t\t}\n\t\tif (this.options.windowOptions.resizableX && this.options.windowOptions.resizableY) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-nw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-ne\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-sw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-se\"></div>`);\n\t\t}\n\t\tconst resizableHandlesHTML = handles.join(\"\");\n\n\t\tconst hasMenu = this.options.menu.length > 0;\n\t\tconst hasTabs = this.options.tabs.length > 0;\n\t\tconst isMergedMenu = this.options.menuStyle === \"merged\" && hasMenu;\n\t\tconst isMergedTabs = this.options.tabStyle === \"merged\" && hasTabs;\n\n\t\tconst customControlsHTML = (this.options.customControls ?? []).map((c) => `<button class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-custom-control-btn\" data-name=\"${c.name}\" title=\"${c.title || \"\"}\" aria-label=\"${c.title || c.name}\">${c.html}</button>`).join(\"\");\n\n\t\tconst controlsHTML = `\n            <div class=\"${LIBRARY_NAME}-controls\">\n\t\t\t\t${customControlsHTML}\n                ${this.options.windowOptions.minimizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-minimize-btn\" type=\"button\" value=\"\\uff3f\" title=\"Minimize\" aria-label=\"Minimize\"/>` : \"\"}\n                ${this.options.windowOptions.maximizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-maximize-btn\" type=\"button\" value=\"\\u25a1\" title=\"Maximize\" aria-label=\"Maximize\"/>` : \"\"}\n                ${this.options.windowOptions.closable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-close-btn\" type=\"button\" value=\"\\u2573\" title=\"Close\" aria-label=\"Close\"/>` : \"\"}\n            </div>`;\n\n\t\tconst titleBarContentHTML = `\n            <div class=\"${LIBRARY_NAME}-icon\"></div>\n            ${isMergedMenu ? `<div class=\"${LIBRARY_NAME}-menu-bar\"></div>` : \"\"}\n            <div id=\"${this.id}-title\" class=\"${LIBRARY_NAME}-title\"></div>\n            ${isMergedTabs ? `<div class=\"${LIBRARY_NAME}-tab-bar\"></div>` : \"\"}\n            ${controlsHTML}\n        `;\n\n\t\tconst loaderHTML = `\n            <div class=\"${LIBRARY_NAME}-loader-overlay\" style=\"display: none;\">\n                <div class=\"${LIBRARY_NAME}-loader-spinner\"></div>\n            </div>\n        `;\n\n\t\tconst debugHTML = `<div class=\"${LIBRARY_NAME}-debug-overlay\"></div>`;\n\n\t\twindowEl.innerHTML = `\n\t\t\t${debugHTML}\n            <div class=\"${LIBRARY_NAME}-title-bar ${LIBRARY_NAME}-us-none\">\n                ${titleBarContentHTML}\n            </div>\n            <div class=\"${LIBRARY_NAME}-main-content\">\n                ${!isMergedMenu && hasMenu ? `<div class=\"${LIBRARY_NAME}-menu-bar\" role=\"menubar\"></div>` : \"\"}\n                ${!isMergedTabs && hasTabs ? `<div class=\"${LIBRARY_NAME}-tab-bar\" role=\"tablist\"></div>` : \"\"}\n                <div class=\"${LIBRARY_NAME}-content\"></div>\n\t\t\t\t${loaderHTML}\n            </div>\n            ${resizableHandlesHTML}\n        `;\n\t\treturn windowEl;\n\t}\n\n\tprivate applyOptions(): void {\n\t\tthis.setTitle(this.options.title);\n\t\tthis.setIcon(this.options.icon);\n\t\tthis.setSize(this.options.width, this.options.height);\n\t\tthis.el.style.minWidth = `${this.options.minWidth}px`;\n\t\tthis.el.style.minHeight = `${this.options.minHeight}px`;\n\n\t\tif (this.options.controlsPosition === \"left\") {\n\t\t\tthis.titleBarEl.classList.add(`${LIBRARY_NAME}-controls-left`);\n\t\t}\n\n\t\tif (this.options.tabs.length > 0) {\n\t\t\tthis.createTabs();\n\t\t} else {\n\t\t\tthis.renderContent(this.contentEl, this.options.content);\n\t\t}\n\n\t\tif (this.options.menu.length > 0) {\n\t\t\tthis.createMenu();\n\t\t}\n\t}\n\n\tprivate showLoader(): void {\n\t\tif (this.options.showLoadingIndicator) {\n\t\t\tthis.loaderEl.style.display = \"flex\";\n\t\t}\n\t}\n\n\tprivate hideLoader(): void {\n\t\tthis.loaderEl.style.display = \"none\";\n\t}\n\n\tprivate renderContent(container: HTMLElement, content: WindowContentOptions): void {\n\t\tcontainer.innerHTML = \"\";\n\t\tthis.hideLoader();\n\n\t\tif (this.virtualizationLevel === \"unloaded\") {\n\t\t\treturn; // 仮想化された場合、コンテンツをレンダリングしない\n\t\t}\n\n\t\tif (content.template) {\n\t\t\tconst template = document.querySelector<HTMLTemplateElement>(content.template);\n\t\t\tif (template?.tagName === \"TEMPLATE\") {\n\t\t\t\tcontainer.appendChild(template.content.cloneNode(true));\n\t\t\t} else {\n\t\t\t\tcontainer.innerHTML = \"Error: Template not found or invalid.\";\n\t\t\t\tconsole.warn(\"WinLet Warning: Template not found or invalid.\");\n\t\t\t}\n\t\t} else if (content.html) {\n\t\t\tcontainer.innerHTML = content.html;\n\t\t} else if (Utils.isNonEmptyObject(content.iframe) && (content.iframe.src || content.iframe.srcdoc)) {\n\t\t\tthis.showLoader();\n\t\t\tconst iframe = document.createElement(\"iframe\");\n\t\t\tconst iframeConfig = content.iframe;\n\t\t\tif (iframeConfig.src) {\n\t\t\t\tiframe.src = iframeConfig.src;\n\t\t\t}\n\t\t\tif (iframeConfig.srcdoc) {\n\t\t\t\tlet finalSrcDoc = iframeConfig.srcdoc;\n\t\t\t\tif (iframeConfig.loadWinLet) {\n\t\t\t\t\tconst globalConfig = this.manager.getGlobalConfig();\n\t\t\t\t\tif (globalConfig.libraryPath) {\n\t\t\t\t\t\tconst scriptTag = `<script src=\"${globalConfig.libraryPath}\"><\\/script>`;\n\t\t\t\t\t\tconst initScript = `<script>document.addEventListener('DOMContentLoaded', () => window.WinLet.init({ container: document.body }));<\\/script>`;\n\t\t\t\t\t\tfinalSrcDoc = `<!DOCTYPE html><html><head><meta charset=\"UTF-8\">${scriptTag}${initScript}</head><body>${iframeConfig.srcdoc}</body></html>`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"WinLet Warning: `loadWinLet` is true, but `libraryPath` is not set in global config.\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tiframe.srcdoc = finalSrcDoc;\n\t\t\t}\n\t\t\tif (iframeConfig.allow) {\n\t\t\t\tiframe.allow = iframeConfig.allow;\n\t\t\t}\n\t\t\tif (iframeConfig.referrerPolicy) {\n\t\t\t\tiframe.referrerPolicy = iframeConfig.referrerPolicy;\n\t\t\t}\n\t\t\tif (iframeConfig.loading) {\n\t\t\t\tiframe.loading = iframeConfig.loading;\n\t\t\t}\n\t\t\tif (iframeConfig.sandbox) {\n\t\t\t\tif (!Array.isArray(iframeConfig.sandbox)) {\n\t\t\t\t\tiframeConfig.sandbox = [iframeConfig.sandbox];\n\t\t\t\t}\n\t\t\t\tif (iframeConfig.sandbox.length > 0) {\n\t\t\t\t\tiframe.setAttribute(\"sandbox\", iframeConfig.sandbox.join(\" \"));\n\t\t\t\t}\n\t\t\t}\n\t\t\tiframe.addEventListener(\"load\", () => this.hideLoader());\n\t\t\tiframe.addEventListener(\"error\", () => this.hideLoader());\n\t\t\tcontainer.appendChild(iframe);\n\t\t} else {\n\t\t\tcontainer.innerHTML = \"\";\n\t\t}\n\t}\n\n\tprivate closeAllMenus(): void {\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-menu-item > .${LIBRARY_NAME}-menu-dropdown`).forEach((dd) => {\n\t\t\tdd.style.display = \"none\";\n\t\t});\n\t\tthis.isMenuOpen = false;\n\t}\n\n\tprivate createMenu(): void {\n\t\tconst menuBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-menu-bar`)!;\n\t\tmenuBar.innerHTML = \"\";\n\n\t\tthis.options.menu.forEach((menuItemData) => {\n\t\t\tconst menuItemEl = document.createElement(\"div\");\n\t\t\tmenuItemEl.className = `${LIBRARY_NAME}-menu-item ${LIBRARY_NAME}-us-none`;\n\t\t\tmenuItemEl.textContent = menuItemData.name ?? \"\";\n\t\t\tmenuItemEl.setAttribute(\"role\", \"menu\");\n\n\t\t\tif (menuItemData.items) {\n\t\t\t\tconst dropdownEl = this.createDropdownMenu(menuItemData.items);\n\n\t\t\t\tmenuItemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tconst isVisible = dropdownEl.style.display === \"block\";\n\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\tif (!isVisible) {\n\t\t\t\t\t\tdropdownEl.style.display = \"block\";\n\t\t\t\t\t\tthis.isMenuOpen = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuItemEl.addEventListener(\"mouseenter\", () => {\n\t\t\t\t\tif (this.isMenuOpen) {\n\t\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\t\tdropdownEl.style.display = \"block\";\n\t\t\t\t\t\tthis.isMenuOpen = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuItemEl.appendChild(dropdownEl);\n\t\t\t}\n\t\t\tmenuBar.appendChild(menuItemEl);\n\t\t});\n\t}\n\n\tprivate createDropdownMenu(items: MenuItem[]): HTMLUListElement {\n\t\tconst dropdownEl = document.createElement(\"ul\");\n\t\tdropdownEl.className = `${LIBRARY_NAME}-menu-dropdown`;\n\n\t\titems.forEach((itemData) => {\n\t\t\tconst itemEl = document.createElement(\"li\");\n\t\t\tif (itemData.separator) {\n\t\t\t\titemEl.className = `${LIBRARY_NAME}-separator`;\n\t\t\t} else {\n\t\t\t\tlet text = itemData.name ?? \"\";\n\t\t\t\ttext = `<span>${text}</span>`;\n\t\t\t\tif (this.options.enableShortcuts && itemData.shortcut) {\n\t\t\t\t\ttext += `<span class=\"${LIBRARY_NAME}-shortcut-text\">(${itemData.shortcut})</span>`;\n\t\t\t\t}\n\t\t\t\titemEl.innerHTML = `<div class=\"${LIBRARY_NAME}-menu-dropdown-item\" role=\"menuitem\">${text}</div>`;\n\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\titemData.action?.(this);\n\t\t\t\t});\n\t\t\t\tif (itemData.items) {\n\t\t\t\t\titemEl.classList.add(`${LIBRARY_NAME}-has-submenu`); // スタイル付けのためのクラス\n\t\t\t\t\tconst subMenuEl = this.createDropdownMenu(itemData.items);\n\t\t\t\t\titemEl.appendChild(subMenuEl);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdropdownEl.appendChild(itemEl);\n\t\t});\n\t\treturn dropdownEl;\n\t}\n\n\tprivate createTabs(): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\ttabBar.innerHTML = \"\";\n\t\tthis.tabs = [];\n\t\tconst tabOpts = this.options.tabOptions ?? {};\n\n\t\tthis.options.tabs.forEach((tabData, index) => {\n\t\t\tthis.createTabElement(tabData, index);\n\t\t});\n\n\t\tif (tabOpts.addable) {\n\t\t\tthis.addTabBtn = document.createElement(\"div\");\n\t\t\tthis.addTabBtn.className = `${LIBRARY_NAME}-tab-add-btn`;\n\t\t\tthis.addTabBtn.textContent = \"+\";\n\t\t\tthis.addTabBtn.addEventListener(\"click\", (e) => {\n\t\t\t\tconst newTabItem = tabOpts.onAdd?.(this);\n\t\t\t\tif (newTabItem) {\n\t\t\t\t\tthis.addTab(newTabItem);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttabBar.appendChild(this.addTabBtn);\n\t\t}\n\t\t// タブの並び替えと統合のためのドロップゾーンを設定\n\t\tthis.setupTabBarDropZone();\n\n\t\tif (this.tabs.length > 0) this.activateTab(0);\n\t}\n\n\tprivate setupTabBarDropZone(): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\tif (!tabBar || !this.options.tabOptions.reorderable) return;\n\n\t\ttabBar.addEventListener(\"dragover\", (e) => {\n\t\t\tif (e.dataTransfer?.types.includes(\"application/winlet-tab\")) {\n\t\t\t\te.preventDefault();\n\t\t\t\tif (e.dataTransfer) e.dataTransfer.dropEffect = \"move\";\n\t\t\t\ttabBar.classList.add(`${LIBRARY_NAME}-drag-over`);\n\t\t\t}\n\t\t});\n\t\ttabBar.addEventListener(\"dragleave\", () => {\n\t\t\ttabBar.classList.remove(`${LIBRARY_NAME}-drag-over`);\n\t\t});\n\t\ttabBar.addEventListener(\"drop\", (e) => {\n\t\t\te.preventDefault();\n\t\t\ttabBar.classList.remove(`${LIBRARY_NAME}-drag-over`);\n\n\t\t\tconst tabDataJSON = e.dataTransfer?.getData(\"application/winlet-tab\");\n\t\t\tconst sourceWindowId = e.dataTransfer?.getData(\"application/winlet-source-window-id\");\n\t\t\tconst sourceTabId = e.dataTransfer?.getData(\"text/plain\");\n\t\t\tif (!tabDataJSON || !sourceWindowId || !sourceTabId) return;\n\n\t\t\tconst draggingEl = this.manager.container?.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.${LIBRARY_NAME}-dragging`);\n\n\t\t\t// 自分自身のウィンドウ内での並び替え\n\t\t\tif (sourceWindowId === this.id) {\n\t\t\t\tif (draggingEl) {\n\t\t\t\t\t// ドロップされた位置に挿入\n\t\t\t\t\tthis.updateTabOrderFromDOM();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// 外部ウィンドウからのタブ統合\n\t\t\tconst sourceWindow = this.manager.getWindow(sourceWindowId);\n\t\t\tif (sourceWindow) {\n\t\t\t\tconst sourceOpts = sourceWindow.options.tabOptions;\n\t\t\t\tconst targetOpts = this.options.tabOptions;\n\n\t\t\t\tconst isMergeable = sourceOpts.mergeable ?? sourceOpts.detachable; // ソースをマージできるかどうかを確認\n\t\t\t\tconst allowsIncoming = targetOpts.allowIncomingMerge ?? true; // ターゲットが受け入れるかどうかを確認\n\t\t\t\tconst customFilterPassed = !targetOpts.onMergeAttempt || targetOpts.onMergeAttempt(sourceWindow, this);\n\n\t\t\t\tif (!isMergeable || !allowsIncoming || !customFilterPassed) {\n\t\t\t\t\treturn; // 条件が満たされていない場合は、マージを中止\n\t\t\t\t}\n\n\t\t\t\tconst tabData: TabItem = JSON.parse(tabDataJSON);\n\t\t\t\tthis.addTab(tabData, true);\n\n\t\t\t\tsourceWindow.closeTab(parseInt(sourceTabId, 10));\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate createTabElement(tabData: TabItem, index: number): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\tconst tabOpts = this.options.tabOptions ?? {};\n\n\t\tconst tabEl = document.createElement(\"div\");\n\t\ttabEl.className = `${LIBRARY_NAME}-tab`;\n\t\ttabEl.setAttribute(\"role\", \"tab\");\n\t\ttabEl.dataset.tabId = index.toString(); // IDを紐付け\n\n\t\tconst titleEl = document.createElement(\"span\");\n\t\ttitleEl.textContent = tabData.title;\n\t\ttabEl.appendChild(titleEl);\n\n\t\t// +ボタンが存在すればその前に、なければ末尾に追加\n\t\ttabBar.insertBefore(tabEl, this.addTabBtn);\n\n\t\tif (tabOpts.closable) {\n\t\t\tconst closeBtn = document.createElement(\"span\");\n\t\t\tcloseBtn.className = `${LIBRARY_NAME}-tab-close-btn`;\n\t\t\tcloseBtn.innerHTML = \"&times;\";\n\t\t\tcloseBtn.addEventListener(\"click\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\t// クロージャのindexに依存せず、クリックされた時点の最新のインデックスを探す\n\t\t\t\tconst indexToClose = this.tabs.findIndex((t) => t.tabEl === tabEl);\n\t\t\t\tif (indexToClose !== -1) {\n\t\t\t\t\tthis.closeTab(indexToClose);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttabEl.appendChild(closeBtn);\n\t\t}\n\n\t\t// タブコンテント生成ロジック\n\t\tconst tabContentEl = document.createElement(\"div\");\n\t\ttabContentEl.className = `${LIBRARY_NAME}-tab-content`;\n\t\ttabContentEl.setAttribute(\"role\", \"tabpanel\");\n\t\tthis.contentEl.appendChild(tabContentEl);\n\t\tthis.renderContent(tabContentEl, tabData.content);\n\n\t\ttabEl.addEventListener(\"click\", (e) => {\n\t\t\tthis.activateTab(+tabEl.dataset.tabId!);\n\t\t});\n\t\tthis.tabs.splice(index, 0, { tabEl, contentEl: tabContentEl }); // 指定位置に挿入\n\n\t\tif (tabOpts.reorderable) {\n\t\t\tthis.makeTabReorderable(tabEl);\n\t\t}\n\t}\n\n\tprivate makeTabReorderable(tabEl: HTMLElement) {\n\t\ttabEl.draggable = true;\n\t\ttabEl.addEventListener(\"dragstart\", (e) => {\n\t\t\te.dataTransfer!.setData(\"text/plain\", tabEl.dataset.tabId!);\n\t\t\ttabEl.classList.add(`${LIBRARY_NAME}-dragging`);\n\n\t\t\t// 分離機能が有効な場合、追加情報をセット\n\t\t\tif (this.options.tabOptions.detachable) {\n\t\t\t\tconst tabIndex = parseInt(tabEl.dataset.tabId!, 10);\n\t\t\t\tif (!isNaN(tabIndex) && this.options.tabs[tabIndex]) {\n\t\t\t\t\tconst tabData = this.options.tabs[tabIndex];\n\t\t\t\t\te.dataTransfer!.setData(\"application/winlet-tab\", JSON.stringify(tabData));\n\t\t\t\t\te.dataTransfer!.setData(\"application/winlet-source-window-id\", this.id);\n\n\t\t\t\t\tthis.manager.onTabDragStart(this.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\ttabEl.addEventListener(\"dragend\", () => {\n\t\t\ttabEl.classList.remove(`${LIBRARY_NAME}-dragging`);\n\t\t\tthis.manager.onTabDragEnd();\n\t\t});\n\n\t\ttabEl.addEventListener(\n\t\t\t\"dragover\",\n\t\t\t(e) => {\n\t\t\t\tif (this.manager.draggingTabInfo?.sourceWindowId !== this.id) {\n\t\t\t\t\treturn; //タブが別のウィンドウからである場合、何もしない\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t\tconst draggingEl = document.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.${LIBRARY_NAME}-dragging`);\n\t\t\t\tif (draggingEl && draggingEl !== tabEl) {\n\t\t\t\t\tconst rect = tabEl.getBoundingClientRect();\n\t\t\t\t\t// カーソルの位置によって挿入位置を左右に決める\n\t\t\t\t\tconst isAfter = e.clientX > rect.left + rect.width / 2;\n\t\t\t\t\tconst parent = tabEl.parentNode!;\n\t\t\t\t\tif (isAfter) {\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl.nextSibling);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\n\t\ttabEl.addEventListener(\n\t\t\t\"drop\",\n\t\t\t(e) => {\n\t\t\t\te.preventDefault();\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\t}\n\n\t// タブを閉じるロジック\n\tpublic closeTab(index: number) {\n\t\t// アクティブなタブが閉じられるかチェック\n\t\tconst wasActive = this.tabs[index]?.tabEl.classList.contains(`${LIBRARY_NAME}-active`);\n\n\t\t// DOMから要素を削除\n\t\tthis.tabs[index].tabEl.remove();\n\t\tthis.tabs[index].contentEl.remove();\n\t\t// 配列から削除\n\t\tthis.tabs.splice(index, 1);\n\t\tthis.options.tabs.splice(index, 1);\n\n\t\t// IDの再割り当て\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\n\n\t\t// アクティブなタブを再設定\n\t\tif (this.tabs.length > 0) {\n\t\t\tif (wasActive) {\n\t\t\t\tconst newActiveIndex = Math.max(0, index - 1);\n\t\t\t\tthis.activateTab(newActiveIndex);\n\t\t\t}\n\t\t} else {\n\t\t\t// タブが0になったらウィンドウを閉じる\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tpublic activateTab(index: number): void {\n\t\tthis.tabs.forEach((tab, i) => {\n\t\t\ttab.tabEl.classList.toggle(`${LIBRARY_NAME}-active`, i === index);\n\t\t\ttab.contentEl.classList.toggle(`${LIBRARY_NAME}-active`, i === index);\n\t\t});\n\t}\n\n\tpublic addTab(tabItem: TabItem, setActive: boolean = true): void {\n\t\tthis.options.tabs.push(tabItem);\n\t\tconst newIndex = this.options.tabs.length - 1;\n\t\tthis.createTabElement(tabItem, newIndex);\n\t\tif (setActive) {\n\t\t\tthis.activateTab(newIndex);\n\t\t\t// タブが追加されアクティブになったウィンドウにフォーカスを当てる\n\t\t\tthis.focus();\n\t\t}\n\t}\n\n\tpublic getTabs(): { tabEl: HTMLElement; contentEl: HTMLElement }[] {\n\t\treturn this.tabs;\n\t}\n\n\tprivate updateTabOrderFromDOM(): void {\n\t\tconst tabElements = Array.from(this.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-tab-bar > .${LIBRARY_NAME}-tab`));\n\n\t\tconst newTabs: typeof this.tabs = [];\n\t\tconst newOptionsTabs: TabItem[] = [];\n\n\t\tconst oldTabs = [...this.tabs];\n\t\tconst oldOptionsTabs = [...this.options.tabs];\n\n\t\ttabElements.forEach((tabEl) => {\n\t\t\t// dataset.tabIdはもはや信頼できない可能性があるため、DOM要素で直接比較する\n\t\t\tconst oldIndex = oldTabs.findIndex((t) => t.tabEl === tabEl);\n\t\t\tif (oldIndex !== -1) {\n\t\t\t\tnewTabs.push(oldTabs[oldIndex]);\n\t\t\t\tnewOptionsTabs.push(oldOptionsTabs[oldIndex]);\n\t\t\t}\n\t\t});\n\n\t\tthis.tabs = newTabs;\n\t\tthis.options.tabs = newOptionsTabs;\n\n\t\t// 新しい順序でdataset.tabIdを再設定\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\n\t}\n\n\tprivate setupEventListeners(): void {\n\t\tthis.el.addEventListener(\"click\", () => this.focus(), true);\n\n\t\t// iframeなどにフォーカスが移った際にウィンドウ自体をアクティブにする\n\t\tthis.el.addEventListener(\"focusin\", () => this.focus());\n\n\t\t// グローバルクリックリスナーを追加して、外側をクリックするときにメニューを閉じる\n\t\tthis.boundGlobalClickHandler = () => {\n\t\t\tif (this.isMenuOpen) {\n\t\t\t\tthis.closeAllMenus();\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener(\"click\", this.boundGlobalClickHandler);\n\n\t\tconst controlsEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-controls`);\n\t\tcontrolsEl?.addEventListener(\"click\", (e) => {\n\t\t\tconst target = e.target as HTMLElement;\n\t\t\tconst button = target.closest<HTMLElement>(`.${LIBRARY_NAME}-control-btn`);\n\t\t\tif (!button) return;\n\n\t\t\t// 標準ボタン\n\t\t\tif (button.classList.contains(`${LIBRARY_NAME}-close-btn`)) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tif (this.options._isPopup) {\n\t\t\t\t\tthis.popupCloseCallback?.(CLOSE_BUTTON_RESULT);\n\t\t\t\t}\n\t\t\t\tthis.close();\n\t\t\t} else if (button.classList.contains(`${LIBRARY_NAME}-maximize-btn`)) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.toggleMaximize();\n\t\t\t} else if (button.classList.contains(`${LIBRARY_NAME}-minimize-btn`)) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.minimize();\n\t\t\t}\n\t\t\t// カスタムボタン\n\t\t\telse if (button.classList.contains(`${LIBRARY_NAME}-custom-control-btn`)) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tconst name = button.dataset.name;\n\t\t\t\tconst control = this.options.customControls.find((c) => c.name === name);\n\t\t\t\tcontrol?.action(this);\n\t\t\t}\n\t\t});\n\n\t\tif (this.options.windowOptions.movable) this.makeMovable();\n\t\tif (this.options.windowOptions.resizableX || this.options.windowOptions.resizableY) this.makeResizable();\n\t\tif (this.options.contextMenu.length > 0) {\n\t\t\t// PC用: 右クリック\n\t\t\tthis.el.addEventListener(\n\t\t\t\t\"contextmenu\",\n\t\t\t\t(e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\n\t\t\t\t},\n\t\t\t\t{ passive: false }\n\t\t\t);\n\t\t\t// モバイル用: 長押し\n\t\t\tthis.el.addEventListener(\"pointerdown\", (e) => {\n\t\t\t\tif (e.pointerType !== \"touch\") return;\n\t\t\t\tthis.contextMenuTimer = window.setTimeout(() => {\n\t\t\t\t\tthis.contextMenuTimer = null;\n\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\n\t\t\t\t}, this.MOBILE_CONTEXT_MENU_TIMEOUT);\n\t\t\t});\n\t\t\tconst clearContextMenuTimer = () => {\n\t\t\t\tif (this.contextMenuTimer) {\n\t\t\t\t\tclearTimeout(this.contextMenuTimer);\n\t\t\t\t\tthis.contextMenuTimer = null;\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.el.addEventListener(\"pointermove\", clearContextMenuTimer);\n\t\t\tthis.el.addEventListener(\"pointerup\", clearContextMenuTimer);\n\t\t\tthis.el.addEventListener(\"pointercancel\", clearContextMenuTimer);\n\t\t}\n\t}\n\n\tprivate makeMovable(): void {\n\t\tconst onPointerDown = (e: PointerEvent) => {\n\t\t\tconst target = e.target as HTMLElement;\n\t\t\t// 操作UI要素の上なら移動させない\n\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-resize-handle, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab, .${LIBRARY_NAME}-tab-add-btn`)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// メインボタン（マウスの左ボタン、タッチ）でのみ移動\n\t\t\tif (e.button !== 0) return;\n\n\t\t\te.preventDefault();\n\t\t\tthis.focus();\n\n\t\t\tconst { clientX: startX, clientY: startY } = e;\n\t\t\tlet isDragging = false;\n\n\t\t\t// ドラッグ開始時のウィンドウ座標。isDraggingがtrueになったときに設定される。\n\t\t\tlet initialLeft: number;\n\t\t\tlet initialTop: number;\n\n\t\t\t// --- ゴーストウィンドウ処理 ---\n\t\t\tlet ghostEl: HTMLElement | null = null;\n\t\t\tif (this.options.windowOptions.useGhostWindow) {\n\t\t\t\tghostEl = document.createElement(\"div\");\n\t\t\t\tghostEl.className = `${LIBRARY_NAME}-ghost-window`;\n\t\t\t\tthis.manager.container?.appendChild(ghostEl);\n\t\t\t\tghostEl.style.left = `${this.el.offsetLeft}px`;\n\t\t\t\tghostEl.style.top = `${this.el.offsetTop}px`;\n\t\t\t\tghostEl.style.width = `${this.el.offsetWidth}px`;\n\t\t\t\tghostEl.style.height = `${this.el.offsetHeight}px`;\n\t\t\t}\n\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-dragging`);\n\n\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\n\t\t\t\tif (!this.el?.isConnected) return;\n\t\t\t\tif (!isDragging) {\n\t\t\t\t\tconst deltaX = Math.abs(moveE.clientX - startX);\n\t\t\t\t\tconst deltaY = Math.abs(moveE.clientY - startY);\n\n\t\t\t\t\t// 閾値を超えたらドラッグモードを開始\n\t\t\t\t\tif (deltaX > this.DRAG_THRESHOLD || deltaY > this.DRAG_THRESHOLD) {\n\t\t\t\t\t\tisDragging = true;\n\t\t\t\t\t\tthis.el.setPointerCapture(e.pointerId);\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\n\n\t\t\t\t\t\t// 最大化状態からのドラッグ開始の場合、ウィンドウを復元\n\t\t\t\t\t\tif (this.state === \"maximized\") {\n\t\t\t\t\t\t\tconst restoredWidth = this.lastState.width;\n\t\t\t\t\t\t\tconst clickRatio = e.clientX / this.el.offsetWidth;\n\t\t\t\t\t\t\tconst titleBarRect = this.titleBarEl.getBoundingClientRect();\n\t\t\t\t\t\t\tconst offsetY = e.clientY - titleBarRect.top;\n\t\t\t\t\t\t\tconst posX = e.clientX - restoredWidth * clickRatio;\n\t\t\t\t\t\t\tconst posY = e.clientY - offsetY;\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.setPosition(posX, posY);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// ドラッグ開始時点の座標を記録\n\t\t\t\t\t\tinitialLeft = this.el.offsetLeft;\n\t\t\t\t\t\tinitialTop = this.el.offsetTop;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 閾値に達していなければ何もしない\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ドラッグ中の移動処理\n\t\t\t\tconst newLeft = initialLeft + moveE.clientX - startX;\n\t\t\t\tconst newTop = initialTop + moveE.clientY - startY;\n\t\t\t\tif (ghostEl) {\n\t\t\t\t\tghostEl.style.left = `${newLeft}px`;\n\t\t\t\t\tghostEl.style.top = `${newTop}px`;\n\t\t\t\t} else {\n\t\t\t\t\tthis.setPosition(newLeft, newTop);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst onPointerUp = () => {\n\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\n\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerUp);\n\n\t\t\t\tif (ghostEl) {\n\t\t\t\t\tthis.setPosition(ghostEl.offsetLeft, ghostEl.offsetTop);\n\t\t\t\t\tghostEl.remove();\n\t\t\t\t}\n\t\t\t\t// ドラッグが発生した場合のみ後処理とコールバック呼び出し\n\t\t\t\tif (isDragging) {\n\t\t\t\t\tthis.el.releasePointerCapture(e.pointerId);\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\n\t\t\t\t\tthis.options.onMove(this);\n\t\t\t\t\tthis.manager.updateVirtualization();\n\t\t\t\t}\n\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-dragging`);\n\t\t\t};\n\n\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove);\n\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp);\n\t\t};\n\n\t\tthis.titleBarEl.addEventListener(\"pointerdown\", onPointerDown, { passive: false });\n\n\t\tif (this.options.windowOptions.maximizable) {\n\t\t\tthis.titleBarEl.addEventListener(\"dblclick\", (e: MouseEvent) => {\n\t\t\t\tif (this.options.windowOptions.maximizableOnDblClick) {\n\t\t\t\t\tconst target = e.target as HTMLElement;\n\t\t\t\t\t// 操作UI（コントロールボタン、メニュー、タブ）の上では発火しないようにする\n\t\t\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab`)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.toggleMaximize();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate makeResizable(): void {\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-resize-handle`).forEach((handle) => {\n\t\t\thandle.addEventListener(\n\t\t\t\t\"pointerdown\",\n\t\t\t\t(e: PointerEvent) => {\n\t\t\t\t\tif (e.button !== 0 || !handle?.isConnected) return;\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\n\t\t\t\t\thandle.setPointerCapture(e.pointerId);\n\n\t\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-resizing`);\n\n\t\t\t\t\t// --- ゴーストウィンドウ処理 ---\n\t\t\t\t\tlet ghostEl: HTMLElement | null = null;\n\t\t\t\t\tif (this.options.windowOptions.useGhostWindow) {\n\t\t\t\t\t\tghostEl = document.createElement(\"div\");\n\t\t\t\t\t\tghostEl.className = `${LIBRARY_NAME}-ghost-window`;\n\t\t\t\t\t\tthis.manager.container?.appendChild(ghostEl);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst direction = handle.className.replace(`${LIBRARY_NAME}-resize-handle `, \"\");\n\t\t\t\t\tconst { clientX: startX, clientY: startY } = e;\n\t\t\t\t\tconst { offsetWidth: startWidth, offsetHeight: startHeight, offsetLeft: startLeft, offsetTop: startTop } = this.el;\n\t\t\t\t\tconst { minWidth, minHeight } = this.options;\n\n\t\t\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\n\t\t\t\t\t\tlet newWidth = startWidth,\n\t\t\t\t\t\t\tnewHeight = startHeight,\n\t\t\t\t\t\t\tnewLeft = startLeft,\n\t\t\t\t\t\t\tnewTop = startTop;\n\t\t\t\t\t\tconst deltaX = moveE.clientX - startX;\n\t\t\t\t\t\tconst deltaY = moveE.clientY - startY;\n\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-e`)) newWidth = Math.max(minWidth, startWidth + deltaX);\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-w`)) {\n\t\t\t\t\t\t\tnewWidth = Math.max(minWidth, startWidth - deltaX);\n\t\t\t\t\t\t\tnewLeft = startLeft + deltaX;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-s`)) newHeight = Math.max(minHeight, startHeight + deltaY);\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-n`)) {\n\t\t\t\t\t\t\tnewHeight = Math.max(minHeight, startHeight - deltaY);\n\t\t\t\t\t\t\tnewTop = startTop + deltaY;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ghostEl) {\n\t\t\t\t\t\t\tghostEl.style.left = `${newLeft}px`;\n\t\t\t\t\t\t\tghostEl.style.top = `${newTop}px`;\n\t\t\t\t\t\t\tghostEl.style.width = `${newWidth}px`;\n\t\t\t\t\t\t\tghostEl.style.height = `${newHeight}px`;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.setSize(newWidth, newHeight);\n\t\t\t\t\t\t\tthis.setPosition(newLeft, newTop);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tconst onPointerUp = () => {\n\t\t\t\t\t\thandle.releasePointerCapture(e.pointerId);\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\n\n\t\t\t\t\t\tif (ghostEl) {\n\t\t\t\t\t\t\tthis.setSize(ghostEl.offsetWidth, ghostEl.offsetHeight);\n\t\t\t\t\t\t\tthis.setPosition(ghostEl.offsetLeft, ghostEl.offsetTop);\n\t\t\t\t\t\t\tghostEl.remove();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\n\t\t\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerUp);\n\t\t\t\t\t\tthis.options.onResize(this);\n\t\t\t\t\t\tthis.updateDebugOverlay();\n\t\t\t\t\t\tthis.manager.updateVirtualization();\n\n\t\t\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-resizing`);\n\t\t\t\t\t};\n\t\t\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove);\n\t\t\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp);\n\t\t\t\t},\n\t\t\t\t{ passive: false }\n\t\t\t);\n\t\t});\n\t}\n\n\tpublic isFontAwesome(classStr: string): boolean {\n\t\tconst classes = classStr.trim().split(/\\s+/);\n\t\tconst hasPrefix = classes.some((c) => /^fa[bslr]?$/.test(c));\n\t\tconst hasIcon = classes.some((c) => /^fa-[a-z0-9-]+$/.test(c));\n\t\treturn hasPrefix && hasIcon;\n\t}\n\n\tpublic updateDebugOverlay(): void {\n\t\tif (this.debugOverlayEl) {\n\t\t\tconst pos = this.getPosition();\n\t\t\tconst size = this.getSize();\n\t\t\tthis.debugOverlayEl.textContent = `ID:    ${this.id}\nState: ${this.state}\nPos:   x:${Math.round(pos.x)}, y:${Math.round(pos.y)}\nSize:  w:${Math.round(size.width)}, h:${Math.round(size.height)}\nFocus: ${this.focused}\nz-idx: ${this.el.style.zIndex}\nVirt:  ${this.virtualizationLevel}`.trim();\n\t\t}\n\t}\n\n\t/**\n\t * ウィンドウ内に不安全なコンテンツがあるか判定する\n\t */\n\tpublic getUnsafeContentLevel(): VirtualizationLevel {\n\t\tif (this.mainContentEl.querySelector(\"iframe, frame, video, audio, applet, embed, object\")) {\n\t\t\treturn \"frozen\";\n\t\t}\n\t\tif (this.mainContentEl.querySelector(\"img, input, textarea, select, canvas, [contentEditable=true]\")) {\n\t\t\treturn \"suspended\";\n\t\t}\n\t\treturn \"unloaded\";\n\t}\n\n\t/**\n\t * ウィンドウを指定されたレベルまで仮想化する\n\t * @param level - 仮想化の目標レベル\n\t */\n\tpublic virtualize(level: \"none\" | \"frozen\" | \"suspended\" | \"unloaded\" | \"auto\"): void {\n\t\tif (level === \"auto\") {\n\t\t\tlevel = this.getUnsafeContentLevel();\n\t\t}\n\t\tif (level === \"none\") {\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentIndex = this.virtualizationHierarchy.indexOf(this.virtualizationLevel);\n\t\tconst targetIndex = this.virtualizationHierarchy.indexOf(level);\n\n\t\t// 下位レベルへの変更は、一度unvirtualize()を呼び出してリセットする必要がある\n\t\tif (targetIndex <= currentIndex) {\n\t\t\treturn;\n\t\t}\n\n\t\t// 現在の仮想化状態に関連するスタイルなどをクリーンアップ\n\t\tthis.cleanupVirtualizationStyles();\n\n\t\t// 新しいレベルを設定し、その効果を適用\n\t\tthis.virtualizationLevel = level;\n\n\t\t// 以前が非仮想化状態だった場合にのみ通知\n\t\tif (currentIndex === 0 && targetIndex > 0) {\n\t\t\tthis.manager.updateTaskbarItem(this, \"virtualized\");\n\t\t}\n\n\t\tswitch (level) {\n\t\t\tcase \"frozen\":\n\t\t\t\t// cssでvisibility: hiddenを適用\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-frozen`);\n\t\t\t\tbreak;\n\t\t\tcase \"suspended\":\n\t\t\t\t// cssでdisplay: noneを適用\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-suspended`);\n\t\t\t\tbreak;\n\t\t\tcase \"unloaded\":\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-virtualized`);\n\t\t\t\t// コンテンツをメモリから解放\n\t\t\t\tif (this.tabs.length > 0) {\n\t\t\t\t\tthis.tabs.forEach((tab) => {\n\t\t\t\t\t\ttab.contentEl.innerHTML = \"\";\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.contentEl.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.updateDebugOverlay();\n\t}\n\t/**\n\t * ウィンドウの仮想化を解除する\n\t */\n\tpublic unvirtualize(): void {\n\t\tif (this.virtualizationLevel === \"none\") return;\n\t\tthis.manager.updateTaskbarItem(this, \"unvirtualized\");\n\n\t\tconst previousLevel = this.virtualizationLevel;\n\t\tthis.virtualizationLevel = \"none\";\n\t\t// すべての仮想化関連クラスを削除\n\t\tthis.cleanupVirtualizationStyles();\n\n\t\t// 前のレベルに応じてコンテンツを復元\n\t\tif (previousLevel === \"unloaded\") {\n\t\t\t// コンテンツを再描画\n\t\t\tthis.loaderEl.style.display = \"flex\"; // ローディング表示\n\t\t\t// 非同期でコンテンツを再読み込み・再描画\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.options.tabs.length > 0) {\n\t\t\t\t\tthis.tabs.forEach((tab) => {\n\t\t\t\t\t\tconst tabIndex = parseInt(tab.tabEl.dataset.tabId!, 10);\n\t\t\t\t\t\tthis.renderContent(tab.contentEl, this.options.tabs[tabIndex].content);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.renderContent(this.contentEl, this.options.content);\n\t\t\t\t}\n\t\t\t\tthis.loaderEl.style.display = \"none\";\n\t\t\t}, 0);\n\t\t}\n\t\tthis.updateDebugOverlay();\n\t}\n\n\t/**\n\t * 仮想化に関連するスタイルと属性をリセットします。\n\t */\n\tprivate cleanupVirtualizationStyles(): void {\n\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-frozen`, `${LIBRARY_NAME}-is-suspended`, `${LIBRARY_NAME}-is-virtualized`);\n\t\tthis.contentEl.style.display = \"\";\n\t}\n\n\t// --- Public API ---\n\n\tpublic close(): void {\n\t\t// Clean up global event listeners\n\t\tif (this.boundGlobalClickHandler) {\n\t\t\tdocument.removeEventListener(\"click\", this.boundGlobalClickHandler);\n\t\t}\n\t\tthis.options.onClose(this);\n\t\tthis.manager.destroyWindow(this.id);\n\t}\n\n\tpublic minimize(): void {\n\t\tif (this.state !== \"minimized\") {\n\t\t\tif (this.state !== \"normal\") this.restore();\n\n\t\t\tconst doMinimize = () => {\n\t\t\t\tthis.state = \"minimized\";\n\t\t\t\tthis.el.setAttribute(\"aria-hidden\", \"true\");\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-minimized`);\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-minimizing`);\n\t\t\t\tthis.manager.updateTaskbarItem(this, \"minimized\");\n\t\t\t\tthis.blur();\n\n\t\t\t\t// 最小化時の仮想化タイマーを開始\n\t\t\t\tconst globalConfig = this.manager.getGlobalConfig();\n\t\t\t\tif (globalConfig.enableVirtualization && this.options.virtualizable) {\n\t\t\t\t\tif (this.minimizeVirtualizeTimer) {\n\t\t\t\t\t\tclearTimeout(this.minimizeVirtualizeTimer);\n\t\t\t\t\t}\n\t\t\t\t\tthis.minimizeVirtualizeTimer = window.setTimeout(() => {\n\t\t\t\t\t\tthis.virtualize(\"auto\");\n\t\t\t\t\t}, globalConfig.virtualizationDelay ?? 5000);\n\t\t\t\t}\n\t\t\t\tthis.updateDebugOverlay();\n\t\t\t\tthis.manager.updateVirtualization();\n\t\t\t};\n\n\t\t\tthis.el.setAttribute(\"inert\", \"\");\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations) {\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-minimizing`);\n\t\t\t\tthis.el.setAttribute(\"inert\", \"\");\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doMinimize, { once: true });\n\t\t\t} else {\n\t\t\t\tdoMinimize();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic toggleMaximize(): void {\n\t\tthis.state === \"maximized\" ? this.restore() : this.maximize();\n\t}\n\n\tpublic maximize(): void {\n\t\tif (this.state !== \"maximized\") {\n\t\t\tif (this.state !== \"normal\") this.restore();\n\t\t\tthis.lastState = { x: this.el.offsetLeft, y: this.el.offsetTop, width: this.el.offsetWidth, height: this.el.offsetHeight };\n\t\t\tthis.state = \"maximized\";\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-maximized`);\n\n\t\t\tconst doMaximize = () => {\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-maximizing`);\n\t\t\t\tthis.setPosition(0, 0);\n\t\t\t\tthis.setSize(\"100%\", \"100%\");\n\t\t\t\tthis.updateDebugOverlay();\n\t\t\t};\n\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations) {\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-maximizing`);\n\t\t\t\t// アニメーションのために先にサイズと位置を設定\n\t\t\t\tthis.el.style.top = \"0px\";\n\t\t\t\tthis.el.style.left = \"0px\";\n\t\t\t\tthis.el.style.width = \"100%\";\n\t\t\t\tthis.el.style.height = \"100%\";\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doMaximize, { once: true });\n\t\t\t} else {\n\t\t\t\tdoMaximize();\n\t\t\t}\n\n\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\t\tif (maxBtn) {\n\t\t\t\tmaxBtn.title = \"Restore\";\n\t\t\t\tmaxBtn.value = \"\\u274f\";\n\t\t\t\tmaxBtn.setAttribute(\"aria-label\", \"Restore\");\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic restore(): void {\n\t\t// 仮想化解除タイマーをクリア\n\t\tif (this.minimizeVirtualizeTimer) {\n\t\t\tclearTimeout(this.minimizeVirtualizeTimer);\n\t\t\tthis.minimizeVirtualizeTimer = null;\n\t\t}\n\t\t// もし仮想化されていたら、解除する\n\t\tif (this.virtualizationLevel !== \"none\") {\n\t\t\tthis.unvirtualize();\n\t\t}\n\n\t\tconst wasMinimized = this.state === \"minimized\";\n\t\tif (this.state === \"minimized\") {\n\t\t\tthis.state = \"normal\";\n\t\t\tthis.el.removeAttribute(\"aria-hidden\");\n\t\t\tthis.el.removeAttribute(\"inert\");\n\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-minimized`);\n\t\t\tthis.manager.updateTaskbarItem(this, \"restored\");\n\t\t\tthis.focus();\n\t\t} else if (this.state === \"maximized\") {\n\t\t\tconst doRestore = () => {\n\t\t\t\tthis.state = \"normal\";\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-maximized`, `${LIBRARY_NAME}-is-restoring`);\n\t\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\t\t\tif (maxBtn) {\n\t\t\t\t\tmaxBtn.title = \"Maximize\";\n\t\t\t\t\tmaxBtn.value = \"\\u25a1\";\n\t\t\t\t\tmaxBtn.setAttribute(\"aria-label\", \"Maximize\");\n\t\t\t\t}\n\t\t\t\tthis.updateDebugOverlay();\n\t\t\t};\n\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations && !wasMinimized) {\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-restoring`);\n\t\t\t\tthis.setSize(this.lastState.width, this.lastState.height);\n\t\t\t\tthis.setPosition(this.lastState.x, this.lastState.y);\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doRestore, { once: true });\n\t\t\t} else {\n\t\t\t\tthis.setSize(this.lastState.width, this.lastState.height);\n\t\t\t\tthis.setPosition(this.lastState.x, this.lastState.y);\n\t\t\t\tdoRestore();\n\t\t\t}\n\t\t}\n\t\tthis.updateDebugOverlay();\n\t\tthis.manager.updateVirtualization();\n\t}\n\n\tpublic focus(): void {\n\t\tif (this.focused) return;\n\n\t\t// 階層を遡ってすべての親ウィンドウをフォーカスする\n\t\tif (this.parentWindow) {\n\t\t\tthis.parentWindow.focus();\n\t\t}\n\n\t\tthis.manager.focusWindow(this);\n\t\tthis.focused = true;\n\t\tthis.el.classList.add(`${LIBRARY_NAME}-active`);\n\t\tthis.updateDebugOverlay();\n\t\tthis.options.onFocus(this);\n\t}\n\n\tpublic blur(): void {\n\t\tif (!this.focused) return;\n\t\tthis.focused = false;\n\t\tthis.el.classList.remove(`${LIBRARY_NAME}-active`);\n\t\tthis.updateDebugOverlay();\n\t\tthis.options.onBlur(this);\n\t}\n\n\tpublic shake(): void {\n\t\tconst className = `${LIBRARY_NAME}-is-shaking`;\n\t\tif (this.el.classList.contains(className)) {\n\t\t\treturn; // Already shaking\n\t\t}\n\t\tthis.el.classList.add(className);\n\t\tthis.el.addEventListener(\n\t\t\t\"animationend\",\n\t\t\t() => {\n\t\t\t\tthis.el.classList.remove(className);\n\t\t\t},\n\t\t\t{ once: true }\n\t\t);\n\t}\n\n\tpublic reload(): void {\n\t\t// onReloadがfalseを返した場合、デフォルトのリロード処理を中断\n\t\tif (this.options.onReload(this) === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst reloadContent = (container: HTMLElement, content: WindowContentOptions) => {\n\t\t\tif (Utils.isNonEmptyObject(content.iframe) && (content.iframe.src || content.iframe.srcdoc)) {\n\t\t\t\tconst iframe = container.querySelector(\"iframe\");\n\t\t\t\t// srcがあり、srcdocがない場合はiframeのreloadを試みる\n\t\t\t\tif (iframe && iframe.src && !content.iframe.srcdoc) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// クロスオリジンフレームへのアクセスはエラーになる可能性がある\n\t\t\t\t\t\tiframe.contentWindow?.location.reload();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// 失敗した場合はiframe要素を再生成する\n\t\t\t\t\t\tconsole.warn(\"WinLet: Cross-origin iframe could not be reloaded directly. Recreating iframe element.\", e);\n\t\t\t\t\t\tthis.renderContent(container, content);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// srcdocの場合やiframeが見つからない場合は要素を再生成\n\t\t\t\t\tthis.renderContent(container, content);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// htmlまたはtemplateの場合は常に再描画\n\t\t\t\tthis.renderContent(container, content);\n\t\t\t}\n\t\t};\n\n\t\tif (this.options.tabs.length > 0) {\n\t\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(`${LIBRARY_NAME}-active`));\n\t\t\tif (activeTabIndex > -1) {\n\t\t\t\tconst activeTab = this.tabs[activeTabIndex];\n\t\t\t\tconst tabContentOptions = this.options.tabs[activeTabIndex].content;\n\t\t\t\treloadContent(activeTab.contentEl, tabContentOptions);\n\t\t\t}\n\t\t} else {\n\t\t\treloadContent(this.contentEl, this.options.content);\n\t\t}\n\t}\n\n\tpublic getContent(): HTMLElement | HTMLIFrameElement {\n\t\tlet contentContainer: HTMLElement;\n\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(`${LIBRARY_NAME}-active`));\n\n\t\tif (activeTabIndex > -1) {\n\t\t\t// If there's an active tab, use its content element\n\t\t\tcontentContainer = this.tabs[activeTabIndex].contentEl;\n\t\t} else {\n\t\t\t// Otherwise, use the main content element\n\t\t\tcontentContainer = this.contentEl;\n\t\t}\n\n\t\tconst iframe = contentContainer.querySelector(\"iframe\");\n\t\treturn iframe || contentContainer;\n\t}\n\n\t/**\n\t * 子ウィンドウマネージャを初期化または取得します。\n\t */\n\tprivate getChildManager(): WindowManager {\n\t\tif (!this.childManager) {\n\t\t\t// WindowManagerのコンストラクタとGlobalConfigの整合性を取る必要がある\n\t\t\t// ここでは簡易的に空のconfigで生成\n\t\t\tconst childConfig = {};\n\t\t\tthis.childManager = new WindowManager(childConfig);\n\n\t\t\t// 子マネージャのコンテナとして、このウィンドウのcontentElを指定\n\t\t\tthis.childManager.applyGlobalConfig({ container: this.contentEl });\n\t\t\tthis.childManager.init();\n\t\t}\n\t\treturn this.childManager;\n\t}\n\n\t/**\n\t * このウィンドウ内に新しいウィンドウを作成します。\n\t */\n\tpublic createWindow(options: WindowOptions = {}): IWindow {\n\t\t// iframeコンテンツの場合は、直接DOM操作する代わりにpostMessageを使用\n\t\tconst iframe = this.contentEl.querySelector(\"iframe\");\n\t\tif (iframe && iframe.contentWindow) {\n\t\t\tconst message = {\n\t\t\t\ttype: \"winlet:createWindow\",\n\t\t\t\toptions: options,\n\t\t\t};\n\t\t\t// iframeのオリジンを尊重\n\t\t\tiframe.contentWindow.postMessage(message, \"*\");\n\t\t\t// postMessageでは直接インスタンスを返せないため、暫定的にnullを返すか、Promiseベースの設計にする必要がある\n\t\t\t// ここでは未対応とし、コンソールに警告を出す\n\t\t\tconsole.warn(\"WinLet: Window creation inside an iframe is asynchronous and does not return an instance directly.\");\n\t\t\t// ダミーのインスタンスを返すか、APIの戻り値をvoidにするなどの検討が必要\n\t\t\treturn null as any; // 暫定\n\t\t}\n\n\t\t// 通常のHTMLコンテンツの場合\n\t\tconst manager = this.getChildManager();\n\t\t// 新しいウィンドウに自身を親として設定\n\t\toptions._parent = this;\n\t\treturn manager.createWindow(options);\n\t}\n\n\t/**\n\t * このウィンドウ内に新しいポップアップを作成します。\n\t */\n\tpublic createPopup(options: PopupOptions): IWindow {\n\t\tconst manager = this.getChildManager();\n\t\t// ポップアップにも自身を親として設定\n\t\tconst winOptions: WindowOptions = { _parent: this };\n\t\treturn manager.popup(Object.assign(options, winOptions));\n\t}\n\n\tpublic createAsyncPopup(options: PopupOptions): Promise<PopupResult> {\n\t\tconst manager = this.getChildManager();\n\t\tconst popupOptionsWithParent = { ...options, _parent: this };\n\t\treturn manager.popupAsync(popupOptionsWithParent);\n\t}\n\n\tpublic async capture(): Promise<string> {\n\t\t// HTML2Canvasがロードされているかどうかを確認します（例：CDN経由）\n\t\tif (typeof window.html2canvas !== \"function\") {\n\t\t\tconst e = new WinLetError(\"The capture() feature requires the 'html2canvas' library. Please include it from a CDN to use this feature. https://html2canvas.hertzen.com/\");\n\t\t\tconsole.warn(e);\n\t\t\treturn Promise.reject(e);\n\t\t}\n\n\t\ttry {\n\t\t\tconst canvas = await window.html2canvas(this.el, {\n\t\t\t\tallowTaint: true,\n\t\t\t\tuseCORS: true,\n\t\t\t\tlogging: false,\n\t\t\t\tonclone: (clonedDoc: Document) => {\n\t\t\t\t\t// 一時的なUI要素のキャプチャを避けるため\n\t\t\t\t\tclonedDoc.querySelector(`#${this.id}`)?.classList.remove(`${LIBRARY_NAME}-is-resizing`, `${LIBRARY_NAME}-is-dragging`);\n\t\t\t\t},\n\t\t\t});\n\t\t\treturn canvas.toDataURL(\"image/png\");\n\t\t} catch (error: any) {\n\t\t\tconst e = new WinLetError(`html2canvas failed to capture the window. Error: ${error.message}`);\n\t\t\te.stack += \"\\n\\n--- Caused by ---\\n\" + error.stack;\n\t\t\tconsole.error(e);\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n\n\tpublic print(): void {\n\t\tconst contentSource = this.getContent();\n\n\t\t// コンテンツがiframeの場合は、直接印刷\n\t\tif (contentSource.tagName === \"IFRAME\") {\n\t\t\tconst iframe = contentSource as HTMLIFrameElement;\n\t\t\ttry {\n\t\t\t\t// 印刷する前にiframeが完全にロードされていることを確認\n\t\t\t\tif (document.readyState === \"complete\") {\n\t\t\t\t\tiframe.contentWindow?.print();\n\t\t\t\t} else {\n\t\t\t\t\twindow.addEventListener(\"load\", () => {\n\t\t\t\t\t\tiframe.contentWindow?.print();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(\"WinLet: Could not print iframe content, possibly due to cross-origin restrictions.\", e);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst size = this.getSize();\n\n\t\t// HTMLコンテンツの場合、印刷する一時的なiframeを作成します。\n\t\tconst printFrame = document.createElement(\"iframe\");\n\t\tprintFrame.style.position = \"absolute\";\n\t\tprintFrame.style.opacity = \"0.01\";\n\t\tprintFrame.style.border = \"0\";\n\t\tprintFrame.style.top = \"0\";\n\t\tprintFrame.style.left = \"0\";\n\t\tprintFrame.style.width = size.width + \"px\";\n\t\tprintFrame.style.height = size.height + \"px\";\n\t\tprintFrame.style.zIndex = \"1\";\n\t\tprintFrame.style.transform = \"scale(0.5)\";\n\t\tprintFrame.style.pointerEvents = \"none\";\n\t\tprintFrame.setAttribute(\"inert\", \"\");\n\t\tdocument.body.appendChild(printFrame);\n\n\t\tconst frameDoc = printFrame.contentWindow?.document;\n\t\tif (!frameDoc) {\n\t\t\tconsole.error(\"WinLet: Could not create a document for printing.\");\n\t\t\tdocument.body.removeChild(printFrame);\n\t\t\treturn;\n\t\t}\n\t\tframeDoc.open();\n\t\tframeDoc.write(\"<!DOCTYPE html><html><head>\");\n\t\tframeDoc.write(`<title>${this.getTitle()}</title>`);\n\n\t\t// メインドキュメントから印刷iframeにスタイルをコピーします\n\t\tconst styles = document.querySelectorAll('style, link[rel=\"stylesheet\"]');\n\t\tstyles.forEach((style) => {\n\t\t\tframeDoc.write(style.outerHTML);\n\t\t});\n\n\t\tframeDoc.write(\"</head><body>\");\n\t\tframeDoc.write(contentSource.innerHTML);\n\t\tframeDoc.write(\"</body></html>\");\n\t\tframeDoc.close();\n\n\t\tconst doPrint = async () => {\n\t\t\tawait new Promise((resolve) => setTimeout(resolve, 300));\n\t\t\ttry {\n\t\t\t\tprintFrame.contentWindow?.focus();\n\t\t\t\tprintFrame.contentWindow?.print();\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(\"WinLet: Printing failed.\", e);\n\t\t\t} finally {\n\t\t\t\t// 印刷ダイアログが閉じられた後にiframeが削除されます（またはキャンセルされます）\n\t\t\t\t// タイムアウトを使用すると、印刷ダイアログが適切に開くことができます\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tdocument.body.removeChild(printFrame);\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t};\n\n\t\tif (printFrame.contentWindow?.document.readyState === \"complete\") {\n\t\t\tdoPrint();\n\t\t} else {\n\t\t\tprintFrame.contentWindow?.addEventListener(\"load\", doPrint);\n\t\t}\n\t}\n\n\tpublic getTitle(): string {\n\t\treturn this.options.title;\n\t}\n\n\tpublic setTitle(title: string): void {\n\t\tthis.options.title = title;\n\t\tthis.titleEl.textContent = Utils.sanitizeHTML(title);\n\t\tthis.titleEl.setAttribute(\"aria-label\", Utils.sanitizeHTML(title));\n\t\tthis.manager.updateTaskbarItem(this, \"titleChanged\");\n\t}\n\n\tpublic setIcon(icon: string | null): void {\n\t\tthis.options.icon = icon;\n\t\tthis.iconEl.innerHTML = \"\";\n\t\tif (!icon) {\n\t\t\tthis.manager.updateTaskbarItem(this, \"iconChanged\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isFontAwesome(icon)) {\n\t\t\tconst i = document.createElement(\"i\");\n\t\t\ti.className = icon;\n\t\t\tthis.iconEl.appendChild(i);\n\t\t} else {\n\t\t\tconst img = document.createElement(\"img\");\n\t\t\timg.src = icon;\n\t\t\timg.alt = \"window icon\";\n\t\t\tthis.iconEl.appendChild(img);\n\t\t}\n\t\tthis.manager.updateTaskbarItem(this, \"iconChanged\");\n\t}\n\n\tpublic getPosition(): { x: number; y: number } {\n\t\tif (this.state === \"maximized\") {\n\t\t\treturn { x: this.lastState.x, y: this.lastState.y };\n\t\t}\n\t\treturn { x: this.el.offsetLeft, y: this.el.offsetTop };\n\t}\n\n\tpublic setPosition(x: number | \"center\" | \"left\" | \"right\", y: number | \"center\" | \"top\" | \"bottom\"): void {\n\t\t// containerが存在しない（初期化前）場合は処理を中断\n\t\tif (!this.manager.container) {\n\t\t\tconsole.warn(\"WinLet Warning: setPosition called before manager is initialized.\");\n\t\t\treturn;\n\t\t}\n\t\tconst parentRect = this.manager.container.getBoundingClientRect();\n\t\tconst winWidth = this.el.offsetWidth;\n\t\tconst winHeight = this.el.offsetHeight;\n\n\t\tlet finalX: number;\n\t\tlet finalY: number;\n\n\t\t// X座標の計算\n\t\tswitch (x) {\n\t\t\tcase \"left\":\n\t\t\t\tfinalX = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"center\":\n\t\t\t\tfinalX = (parentRect.width - winWidth) / 2;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tfinalX = parentRect.width - winWidth;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfinalX = x as number;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Y座標の計算\n\t\tswitch (y) {\n\t\t\tcase \"top\":\n\t\t\t\tfinalY = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"center\":\n\t\t\t\tfinalY = (parentRect.height - winHeight) / 2;\n\t\t\t\tbreak;\n\t\t\tcase \"bottom\":\n\t\t\t\tfinalY = parentRect.height - winHeight;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfinalY = y as number;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// 画面外にはみ出さないようにする既存のロジックを適用\n\t\tthis.el.style.left = `${Math.min(Math.max(150 - winWidth, finalX), parentRect.width - 150)}px`;\n\t\tthis.el.style.top = `${Math.min(Math.max(0, finalY), parentRect.height - 50)}px`;\n\t\tthis.updateDebugOverlay();\n\t}\n\n\tpublic getSize(): { width: number; height: number } {\n\t\tif (this.state === \"maximized\") {\n\t\t\treturn { width: this.lastState.width, height: this.lastState.height };\n\t\t}\n\t\treturn { width: this.el.offsetWidth, height: this.el.offsetHeight };\n\t}\n\n\tpublic setSize(width: number | string, height: number | string): void {\n\t\tthis.el.style.width = typeof width === \"number\" ? `${width}px` : width;\n\t\tthis.el.style.height = typeof height === \"number\" ? `${height}px` : height;\n\t\tthis.updateDebugOverlay();\n\t}\n\n\tpublic setOpacity(opacity: number): void {\n\t\tconst clampedOpacity = Math.max(0, Math.min(1, opacity));\n\t\tthis.options.windowOptions.opacity = clampedOpacity;\n\t\tthis.el.style.opacity = clampedOpacity.toString();\n\t}\n\n\tpublic getOpacity(): number {\n\t\treturn this.options.windowOptions.opacity!;\n\t}\n\n\tpublic setOptions(options: Partial<WindowOptions>): void {\n\t\t// ifExists\n\t\tif (typeof options.ifExists === \"boolean\") {\n\t\t\tthis.options.ifExists = options.ifExists;\n\t\t}\n\t\t// タイトル\n\t\tif (typeof options.title === \"string\") {\n\t\t\tthis.setTitle(options.title);\n\t\t}\n\t\t// アイコン\n\t\tif (typeof options.icon === \"string\" || options.icon === null) {\n\t\t\tthis.setIcon(options.icon);\n\t\t}\n\t\t// 位置\n\t\tlet x: number | \"center\" | \"left\" | \"right\" | null = null;\n\t\tif (typeof options.x === \"number\" || options.x === \"center\" || options.x === \"left\" || options.x === \"right\") {\n\t\t\tx = options.x;\n\t\t}\n\t\tlet y: number | \"center\" | \"top\" | \"bottom\" | null = null;\n\t\tif (typeof options.y === \"number\" || options.y === \"center\" || options.y === \"top\" || options.y === \"bottom\") {\n\t\t\ty = options.y;\n\t\t}\n\t\tif (x !== null || y !== null) {\n\t\t\tif (x === null) {\n\t\t\t\tx = this.getPosition().x;\n\t\t\t}\n\t\t\tif (y === null) {\n\t\t\t\ty = this.getPosition().y;\n\t\t\t}\n\t\t\tthis.setPosition(x, y);\n\t\t}\n\t\t// サイズ\n\t\tlet width: number | string | null = null;\n\t\tif (typeof options.width === \"number\" || typeof options.width === \"string\") {\n\t\t\twidth = options.width;\n\t\t}\n\t\tlet height: number | string | null = null;\n\t\tif (typeof options.height === \"number\" || typeof options.height === \"string\") {\n\t\t\theight = options.height;\n\t\t}\n\t\tif (width !== null || height !== null) {\n\t\t\tif (width === null) {\n\t\t\t\twidth = this.getSize().width;\n\t\t\t}\n\t\t\tif (height === null) {\n\t\t\t\theight = this.getSize().height;\n\t\t\t}\n\t\t\tthis.setSize(width, height);\n\t\t}\n\n\t\tconst windowOptions = options.windowOptions || {};\n\n\t\t// 不透明度\n\t\tif (typeof windowOptions.opacity === \"number\") {\n\t\t\tthis.setOpacity(windowOptions.opacity);\n\t\t}\n\t\t// 常に手前に表示\n\t\tif (typeof windowOptions.alwaysOnTop === \"boolean\") {\n\t\t\tthis.options.windowOptions.alwaysOnTop = windowOptions.alwaysOnTop;\n\t\t\tthis.el.classList.toggle(`${LIBRARY_NAME}-always-on-top`, windowOptions.alwaysOnTop);\n\t\t\t// z-indexを再評価するためにフォーカスする\n\t\t\tthis.focus();\n\t\t}\n\t\t// ゴーストウィンドウ\n\t\tif (typeof windowOptions.useGhostWindow === \"boolean\") {\n\t\t\tthis.options.windowOptions.useGhostWindow = windowOptions.useGhostWindow;\n\t\t}\n\t}\n}\n","// src/WindowManager.ts\n\nimport { defaultConfig } from \"../const/config\";\nimport { WinLetError } from \"../const/errors\";\nimport { ContextMenuItem, GlobalConfigOptions, IWindow, LIBRARY_NAME, MenuItem, PopupButton, PopupButtonPreset, PopupOptions, PopupResult, TabItem, Theme, TIMEOUT_RESULT, WindowOptions } from \"../const/types\";\nimport WinLetBaseClass from \"../libs/baseclass\";\nimport Utils from \"../libs/utils\";\nimport styleData from \"../style/styles\";\nimport { darkTheme } from \"../style/themes/dark\";\nimport { defaultTheme } from \"../style/themes/default\";\nimport { highContrastTheme } from \"../style/themes/high-contrast\";\nimport WinLetWindow from \"./window\";\n\nexport default class WindowManager extends WinLetBaseClass {\n\tpublic container: HTMLElement | null = null;\n\tprivate workspaceEl: HTMLElement | null = null;\n\tprivate static allWindows = new Map<string, WinLetWindow>();\n\tprivate windows = new Map<string, WinLetWindow>();\n\t// z-indexを通常と最前面で分離\n\tprivate zIndexCounter = 1000;\n\tprivate zIndexCounterOnTop = 50000;\n\tprivate activeWindow: WinLetWindow | null = null;\n\tprivate contextMenuEl: HTMLElement | null = null;\n\tprivate _isInitialized = false;\n\n\tprivate globalConfig: GlobalConfigOptions;\n\n\tprivate lastAutoPosition: { x: number; y: number } | null = null;\n\tprivate lastPopupPosition: { x: number; y: number } | null = null;\n\tprivate readonly CASCADE_OFFSET = 30;\n\n\tpublic draggingTabInfo: { sourceWindowId: string } | null = null;\n\n\tprivate taskbarEl: HTMLElement | null = null;\n\tprivate themes = new Map<string, Theme>();\n\tprivate activeTheme: Theme | null = null;\n\tprivate boundTabPressHandler: ((e: KeyboardEvent) => void) | null = null;\n\n\tprivate bootstrapThemeObserver: MutationObserver | null = null;\n\tprivate prefersDarkMatcher: MediaQueryList | null = null;\n\tprivate prefersColorSchemeListener: ((e: MediaQueryListEvent) => void) | null = null;\n\n\tprivate highContrastMatcher: MediaQueryList | null = null;\n\tprivate highContrastListener: ((e: MediaQueryListEvent) => void) | null = null;\n\n\tconstructor(initialConfig: GlobalConfigOptions) {\n\t\tsuper();\n\t\tthis.globalConfig = initialConfig;\n\t\tthis.registerTheme(defaultTheme);\n\t\tthis.registerTheme(darkTheme);\n\t\tthis.registerTheme(highContrastTheme);\n\t}\n\n\t/**\n\t * ライブラリが初期化済みかどうかを取得します。\n\t */\n\tpublic get isInitialized(): boolean {\n\t\treturn this._isInitialized;\n\t}\n\n\tpublic applyGlobalConfig(options: GlobalConfigOptions) {\n\t\tObject.assign(this.globalConfig, options);\n\t\t// アニメーション設定をコンテナクラスに反映\n\t\tif (this.container) {\n\t\t\tthis.container.classList.toggle(`${LIBRARY_NAME}-animations-disabled`, !this.globalConfig.enableAnimations);\n\t\t\tthis.container.classList.toggle(`${LIBRARY_NAME}-debug-mode-enabled`, !!this.globalConfig.enableDebugMode);\n\n\t\t\t// タスクバーの有効・無効切り替えとレイアウト更新\n\t\t\tif (this.globalConfig.enableTaskbar) {\n\t\t\t\tif (!this.taskbarEl) {\n\t\t\t\t\t// タスクバーがなければ作成\n\t\t\t\t\tthis.createTaskbar();\n\t\t\t\t}\n\t\t\t\tthis.updateTaskbarLayout();\n\t\t\t} else if (this.taskbarEl) {\n\t\t\t\t// 無効化された場合\n\t\t\t\tthis.taskbarEl.remove();\n\t\t\t\tthis.taskbarEl = null;\n\t\t\t\t// flex-directionをリセット\n\t\t\t\tthis.container.style.flexDirection = \"\";\n\t\t\t}\n\t\t}\n\n\t\t// Bootstrapテーマ監視の開始/停止\n\t\tif (this.globalConfig.autoDetectBootstrapTheme) {\n\t\t\tthis.startBootstrapThemeObserver();\n\t\t} else {\n\t\t\tthis.stopBootstrapThemeObserver();\n\t\t}\n\t}\n\n\tpublic getGlobalConfig(): GlobalConfigOptions {\n\t\treturn this.globalConfig;\n\t}\n\n\tpublic init(): void {\n\t\tif (this._isInitialized) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet parentEl: HTMLElement | null = null;\n\t\tif (typeof this.globalConfig.container === \"string\") {\n\t\t\tparentEl = document.querySelector<HTMLElement>(this.globalConfig.container);\n\t\t\tif (!parentEl) {\n\t\t\t\tthrow new WinLetError(`WinLet: The specified container \"${this.globalConfig.container}\" was not found.`);\n\t\t\t}\n\t\t} else if (this.globalConfig.container instanceof HTMLElement) {\n\t\t\tparentEl = this.globalConfig.container;\n\t\t}\n\n\t\t// 親が指定されていない場合は、デフォルトでbodyに設定\n\t\tif (!parentEl) {\n\t\t\tif (!document.body) {\n\t\t\t\tthrow new WinLetError(\"Cannot initialize before document.body is ready. Please call WinLet.init() after DOMContentLoaded.\");\n\t\t\t}\n\t\t\tparentEl = document.body;\n\t\t}\n\n\t\tif (!document.getElementById(`${LIBRARY_NAME}-styles`)) {\n\t\t\tconst styleTag = document.createElement(\"style\");\n\t\t\tstyleTag.id = `${LIBRARY_NAME}-styles`;\n\t\t\tstyleTag.innerHTML = this.getStyleData();\n\t\t\tdocument.head.appendChild(styleTag);\n\t\t}\n\t\tlet containerEl = parentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-container`);\n\t\tif (!containerEl) {\n\t\t\tcontainerEl = document.createElement(\"div\");\n\t\t\tcontainerEl.className = `${LIBRARY_NAME}-container`;\n\t\t\tparentEl.appendChild(containerEl);\n\t\t}\n\t\tthis.container = containerEl;\n\n\t\tthis.workspaceEl = document.createElement(\"div\");\n\t\tthis.workspaceEl.className = `${LIBRARY_NAME}-workspace`;\n\t\tthis.container.appendChild(this.workspaceEl);\n\n\t\t// 初期設定を適用\n\t\tthis.applyGlobalConfig(this.globalConfig);\n\n\t\tif (parentEl !== document.body) {\n\t\t\tthis.container.classList.add(`${LIBRARY_NAME}-is-nested`);\n\n\t\t\t// 親がポジショニングコンテキストとして機能できることを確認\n\t\t\tconst computedStyle = window.getComputedStyle(parentEl);\n\t\t\tif (computedStyle.position === \"static\") {\n\t\t\t\tparentEl.style.position = \"relative\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.globalConfig.enableTaskbar) {\n\t\t\tif (!this.taskbarEl) {\n\t\t\t\t// タスクバーがなければ作成\n\t\t\t\tthis.createTaskbar();\n\t\t\t}\n\t\t}\n\n\t\tif (this.globalConfig.theme) {\n\t\t\tthis.setTheme(this.globalConfig.theme);\n\t\t} else {\n\t\t\tthis.setTheme(\"default\");\n\t\t}\n\n\t\tthis.updateVirtualization();\n\n\t\twindow.addEventListener(\"blur\", () =>\n\t\t\t// 次のイベントサイクルでアクティブな要素を取得\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tconst activeEl = document.activeElement;\n\t\t\t\t// フォーカスがiframeに移った場合\n\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\n\t\t\t\t\t// そのiframeがWinLetのウィンドウ内にあるか探索\n\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\t\t\t\tif (winEl) {\n\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\n\t\t\t\t\t\t// 対象のウィンドウが存在し、まだアクティブでなければフォーカスする\n\t\t\t\t\t\tif (win && this.activeWindow !== win) {\n\t\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tdocument.addEventListener(\n\t\t\t\"pointerdown\",\n\t\t\t() =>\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tconst activeEl = document.activeElement;\n\t\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\n\t\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\t\t\t\t\tif (winEl) {\n\t\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\n\t\t\t\t\t\t\tif (win && this.activeWindow !== win) {\n\t\t\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\ttrue\n\t\t);\n\n\t\t// ウィンドウ外クリックでblurさせる処理を追加\n\t\tdocument.addEventListener(\"pointerdown\", (e: PointerEvent) => {\n\t\t\t// e.targetがHTMLElementでない場合や、アクティブなウィンドウがない場合は何もしない\n\t\t\tif (!(e.target instanceof HTMLElement) || !this.activeWindow || this.activeWindow.options.windowOptions.modal) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// クリックされた場所がウィンドウまたはコンテキストメニューの内側かどうかを判定\n\t\t\tconst clickedWindow = e.target.closest(`.${LIBRARY_NAME}-window`);\n\t\t\tconst clickedContextMenu = e.target.closest(`.${LIBRARY_NAME}-context-menu`);\n\t\t\tconst clickedTaskbar = e.target.closest(`.${LIBRARY_NAME}-taskbar`);\n\n\t\t\t// ウィンドウやコンテキストメニューの外側がクリックされた場合\n\t\t\tif (!clickedWindow && !clickedContextMenu && !clickedTaskbar) {\n\t\t\t\t// アクティブなウィンドウのフォーカスを外す\n\t\t\t\tconst active = this.activeWindow;\n\t\t\t\tthis.activeWindow = null;\n\t\t\t\tactive.blur();\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener(\"click\", () => this.hideContextMenu());\n\n\t\twindow.addEventListener(\"message\", (event) => {\n\t\t\t// メッセージの形式を検証\n\t\t\tif (event.data && event.data.type === \"winlet:createWindow\" && typeof event.data.options === \"object\") {\n\t\t\t\t// メッセージの送信元が管理下のiframeか検証（セキュリティ対策）\n\t\t\t\tlet isSourceValid = false;\n\t\t\t\tlet sourceWindow: WinLetWindow | null = null;\n\t\t\t\tfor (const win of this.windows.values()) {\n\t\t\t\t\tconst iframe = win.el.querySelector(\"iframe\");\n\t\t\t\t\tif (iframe && iframe.contentWindow === event.source) {\n\t\t\t\t\t\tisSourceValid = true;\n\t\t\t\t\t\t// メッセージの送信元ウィンドウを特定\n\t\t\t\t\t\tsourceWindow = win;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (isSourceValid) {\n\t\t\t\t\t// 送信元ウィンドウ(sourceWindow)が存在すれば、それは親ウィンドウであり、\n\t\t\t\t\t// その中に新しいウィンドウを作成する。\n\t\t\t\t\tif (sourceWindow) {\n\t\t\t\t\t\t// iframeの親ウィンドウのcreateWindowを呼び出す\n\t\t\t\t\t\tsourceWindow.createWindow(event.data.options);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 通常のトップレベルでのウィンドウ作成\n\t\t\t\t\t\tthis.createWindow(event.data.options);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"WinLet: Untrusted source attempted to create a window.\", event.origin);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._isInitialized = true;\n\t\tthis.setupShortcutListeners();\n\n\t\t// タブ分離機能のためのグローバルなD&Dリスナー\n\t\tthis.workspaceEl!.addEventListener(\"dragover\", (e) => {\n\t\t\tif (e.dataTransfer?.types.includes(\"application/winlet-tab\")) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\tthis.workspaceEl!.addEventListener(\"drop\", (e) => {\n\t\t\t// ドロップ先がウィンドウやタブバーの中なら何もしない\n\t\t\tconst targetEl = e.target as HTMLElement;\n\t\t\tif (targetEl.closest(`.${LIBRARY_NAME}-window`)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\n\t\t\tconst tabDataJSON = e.dataTransfer?.getData(\"application/winlet-tab\");\n\t\t\tconst sourceWindowId = e.dataTransfer?.getData(\"application/winlet-source-window-id\");\n\t\t\tconst sourceTabId = e.dataTransfer?.getData(\"text/plain\");\n\n\t\t\tif (tabDataJSON && sourceWindowId && sourceTabId) {\n\t\t\t\tconst sourceWindow = this.windows.get(sourceWindowId);\n\t\t\t\tif (!sourceWindow || !sourceWindow.options.tabOptions.detachable) return;\n\n\t\t\t\tconst tabData: TabItem = JSON.parse(tabDataJSON);\n\t\t\t\tconst newTab: TabItem = {\n\t\t\t\t\ttitle: tabData.title,\n\t\t\t\t\tcontent: tabData.content,\n\t\t\t\t};\n\n\t\t\t\tconst mergedWindowOptions = Utils.deepMerge(Utils.deepCopy(sourceWindow.options), {\n\t\t\t\t\ttabs: [newTab],\n\t\t\t\t\tx: e.clientX,\n\t\t\t\t\ty: e.clientY,\n\t\t\t\t\twidth: sourceWindow.getSize().width,\n\t\t\t\t\theight: sourceWindow.getSize().height,\n\t\t\t\t});\n\n\t\t\t\t// 新しいウィンドウを作成\n\t\t\t\tthis.createWindow(mergedWindowOptions);\n\n\t\t\t\t// 元のウィンドウからタブを削除\n\t\t\t\tsourceWindow.closeTab(parseInt(sourceTabId, 10));\n\t\t\t}\n\t\t});\n\t}\n\n\t// ショートカットキーのリスナーを統合\n\tprivate setupShortcutListeners() {\n\t\tdocument.addEventListener(\n\t\t\t\"keydown\",\n\t\t\t(e) => {\n\t\t\t\t// --- 1. グローバルショートカット (ウィンドウ切り替え) ---\n\t\t\t\tif (this.globalConfig.windowSwitchShortcut) {\n\t\t\t\t\tconst shortcut = this.parseShortcut(this.globalConfig.windowSwitchShortcut);\n\n\t\t\t\t\tif (e.key.toLowerCase() === shortcut.key.toLowerCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst windows = Array.from(this.windows.values());\n\n\t\t\t\t\t\tconst currentIndex = this.activeWindow ? windows.findIndex((w) => w === this.activeWindow) : -1;\n\t\t\t\t\t\tconst nextIndex = (currentIndex + 1) % windows.length;\n\n\t\t\t\t\t\tconst win = windows[nextIndex];\n\t\t\t\t\t\tif (win.state === \"minimized\") {\n\t\t\t\t\t\t\twin.restore();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// --- 2. ウィンドウ固有のショートカット ---\n\t\t\t\tconst targetWindow = this.activeWindow;\n\n\t\t\t\t// ターゲットウィンドウがなければ何もしない\n\t\t\t\tif (!targetWindow || !targetWindow.options.enableShortcuts) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// --- 3. タブ切り替えショートカット (Ctrl+Shift+[1-9]) ---\n\t\t\t\tif (e.ctrlKey && e.shiftKey && (targetWindow.options.tabs?.length ?? 0) > 0) {\n\t\t\t\t\t// Shiftキーの影響を受けない e.code で判定する\n\t\t\t\t\tif (e.code.startsWith(\"Digit\")) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\tconst keyNum = parseInt(e.code.replace(\"Digit\", \"\"), 10);\n\n\t\t\t\t\t\tconst tabs = targetWindow.getTabs();\n\t\t\t\t\t\tconst numTabs = tabs.length;\n\t\t\t\t\t\tlet tabIndex = -1;\n\n\t\t\t\t\t\tif (keyNum >= 1 && keyNum <= 8) {\n\t\t\t\t\t\t\ttabIndex = keyNum - 1;\n\t\t\t\t\t\t} else if (keyNum === 9) {\n\t\t\t\t\t\t\ttabIndex = numTabs - 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (tabIndex >= 0 && tabIndex < numTabs) {\n\t\t\t\t\t\t\ttargetWindow.activateTab(tabIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn; // 他のショートカットと重複しないようにreturn\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// --- 4. ショートカットキーを検索して実行 ---\n\t\t\t\tconst findAndExecShortcut = (menuItems: MenuItem[]) => {\n\t\t\t\t\tfor (const item of menuItems) {\n\t\t\t\t\t\tif (item.shortcut) {\n\t\t\t\t\t\t\tconst shortcut = this.parseShortcut(item.shortcut);\n\t\t\t\t\t\t\tif (e.key.toUpperCase() === shortcut.key.toUpperCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\titem.action?.(targetWindow!);\n\t\t\t\t\t\t\t\treturn true; // 実行したら探索終了\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (item.items && findAndExecShortcut(item.items)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\t\tfindAndExecShortcut(targetWindow.options.menu);\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\t}\n\n\t// 未初期化の場合に自動でinitを呼び出すヘルパー\n\tprivate ensureInitialized(): void {\n\t\tif (!this._isInitialized) {\n\t\t\tthis.init();\n\t\t}\n\t}\n\n\t/**\n\t * スタイルシートを取得\n\t */\n\tprivate getStyleData() {\n\t\treturn this.replaceStringVariable(styleData);\n\t}\n\n\t/**\n\t * 変数置換\n\t */\n\tprivate replaceStringVariable(str: string) {\n\t\treturn str.replace(/\\$\\[(\\w+)\\]/g, (a, p) => {\n\t\t\tswitch (p) {\n\t\t\t\tcase \"prefix\":\n\t\t\t\t\treturn LIBRARY_NAME;\n\t\t\t}\n\t\t\treturn p;\n\t\t});\n\t}\n\n\tpublic createWindow(options: WindowOptions): WinLetWindow {\n\t\tthis.ensureInitialized();\n\n\t\tconst ifExists = options.ifExists ?? \"focus\";\n\n\t\tif (options.id && ifExists !== \"create\") {\n\t\t\tconst existingWindow = this.getWindow(options.id);\n\t\t\tif (existingWindow) {\n\t\t\t\tif (ifExists === \"prevent\") {\n\t\t\t\t\treturn existingWindow; // 何もせず既存インスタンスを返す\n\t\t\t\t}\n\t\t\t\tif (ifExists === \"focus\") {\n\t\t\t\t\tif (existingWindow.state === \"minimized\") {\n\t\t\t\t\t\texistingWindow.restore();\n\t\t\t\t\t}\n\t\t\t\t\texistingWindow.focus();\n\t\t\t\t\treturn existingWindow; // フォーカスして既存インスタンスを返す\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst creationOptions: Required<WindowOptions> = Utils.deepMerge(Utils.deepCopy(defaultConfig), options);\n\t\tif (creationOptions.x === \"auto\" || creationOptions.y === \"auto\") {\n\t\t\tconst winWidth = creationOptions.width;\n\t\t\tconst winHeight = creationOptions.height;\n\t\t\tconst containerRect = this.workspaceEl!.getBoundingClientRect();\n\n\t\t\tlet nextX: number;\n\t\t\tlet nextY: number;\n\n\t\t\tif (this.lastAutoPosition === null) {\n\t\t\t\tnextX = 0;\n\t\t\t\tnextY = 0;\n\t\t\t} else {\n\t\t\t\t// 右下へカスケード\n\t\t\t\tnextX = this.lastAutoPosition.x + this.CASCADE_OFFSET;\n\t\t\t\tnextY = this.lastAutoPosition.y + this.CASCADE_OFFSET;\n\t\t\t}\n\n\t\t\t// はみ出しチェックとリセット\n\t\t\tif (nextX + winWidth > containerRect.width) {\n\t\t\t\tnextX = 0;\n\t\t\t}\n\t\t\tif (nextY + winHeight > containerRect.height) {\n\t\t\t\tnextY = 0;\n\t\t\t}\n\n\t\t\t// 計算結果をオプションに反映\n\t\t\tcreationOptions.x = nextX;\n\t\t\tcreationOptions.y = nextY;\n\n\t\t\t// 次回のために位置を保存\n\t\t\tthis.lastAutoPosition = { x: nextX, y: nextY };\n\t\t}\n\n\t\tconst win = new WinLetWindow(creationOptions, this);\n\t\tthis.windows.set(win.id, win);\n\t\tWindowManager.allWindows.set(win.id, win);\n\t\tthis.workspaceEl!.appendChild(win.el);\n\n\t\tif (this.taskbarEl) {\n\t\t\tthis.createTaskbarItem(win);\n\t\t}\n\n\t\twin.setPosition(creationOptions.x, creationOptions.y);\n\t\tif (creationOptions.windowOptions.focus) {\n\t\t\tthis.focusWindow(win);\n\t\t\twin.focus();\n\t\t} else {\n\t\t\twin.el.style.zIndex = `${(win.options.windowOptions.alwaysOnTop ? this.zIndexCounterOnTop : this.zIndexCounter) - 1}`;\n\t\t\tthis.updateVirtualization();\n\t\t\twin.updateDebugOverlay();\n\t\t}\n\t\treturn win;\n\t}\n\n\tpublic popup(options: PopupOptions): WinLetWindow {\n\t\tthis.ensureInitialized();\n\t\tlet buttons: PopupButton[];\n\t\tconst buttonPresets: { [key in PopupButtonPreset]: PopupButton[] } = {\n\t\t\tOk: [{ text: \"OK\", value: 1 }],\n\t\t\tOkCancel: [\n\t\t\t\t{ text: \"OK\", value: 1 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tYes: [{ text: \"Yes\", value: 6 }],\n\t\t\tYesNo: [\n\t\t\t\t{ text: \"Yes\", value: 6 },\n\t\t\t\t{ text: \"No\", value: 7 },\n\t\t\t],\n\t\t\tYesNoCancel: [\n\t\t\t\t{ text: \"Yes\", value: 6 },\n\t\t\t\t{ text: \"No\", value: 7 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tRetry: [{ text: \"Retry\", value: 4 }],\n\t\t\tRetryCancel: [\n\t\t\t\t{ text: \"Retry\", value: 4 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tAbortRetryIgnore: [\n\t\t\t\t{ text: \"Abort\", value: 3 },\n\t\t\t\t{ text: \"Retry\", value: 4 },\n\t\t\t\t{ text: \"Ignore\", value: 5 },\n\t\t\t],\n\t\t};\n\t\tif (Array.isArray(options.buttons)) {\n\t\t\tbuttons = options.buttons;\n\t\t} else {\n\t\t\tbuttons = buttonPresets[options.buttons || \"Ok\"] || buttonPresets.Ok;\n\t\t}\n\n\t\tlet timeoutId: number | null = null;\n\t\tconst closeCallback = (result: PopupResult) => {\n\t\t\tif (timeoutId) clearTimeout(timeoutId);\n\t\t\ttimeoutId = null;\n\t\t\ttry {\n\t\t\t\toptions.onClose?.(result);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t};\n\n\t\tconst messageHTML = `<div class=\"${LIBRARY_NAME}-popup-message\">${Utils.sanitizeHTML(options.message)}</div>`;\n\t\tconst buttonsHTML = buttons.map((btn, index) => `<input class=\"${LIBRARY_NAME}-popup-button\" data-index=\"${index}\" type=\"button\" value=\"${Utils.sanitizeHTML(btn.text)}\" role=\"button\"/>`).join(\"\");\n\t\tconst contentHTML = `${messageHTML}<div class=\"${LIBRARY_NAME}-popup-buttons\" role=\"spinbutton\">${buttonsHTML}</div>`;\n\n\t\tconst winOptions: WindowOptions = {\n\t\t\tid: Utils.generateId(`${LIBRARY_NAME}-popup`),\n\t\t\ttitle: options.title || \"\",\n\t\t\ticon: options.icon,\n\t\t\tvirtualizable: false,\n\t\t\twindowOptions: {\n\t\t\t\tresizableX: false,\n\t\t\t\tresizableY: false,\n\t\t\t\tmovable: true,\n\t\t\t\tclosable: true,\n\t\t\t\tminimizable: false,\n\t\t\t\tmaximizable: false,\n\t\t\t\tmaximizableOnDblClick: false,\n\t\t\t\tmodal: options.modal ?? true,\n\t\t\t\talwaysOnTop: options.alwaysOnTop ?? false,\n\t\t\t\tfocus: options.focus ?? true,\n\t\t\t},\n\t\t\tenableShortcuts: false,\n\t\t\tcontent: { html: contentHTML },\n\t\t\t_isPopup: true,\n\t\t};\n\t\tif (options.onFocus) winOptions.onFocus = options.onFocus;\n\t\tif (options.onBlur) winOptions.onBlur = options.onBlur;\n\n\t\tif (options.autoWidth) {\n\t\t\tconst temp = document.createElement(\"span\");\n\t\t\ttemp.style.visibility = \"hidden\";\n\t\t\ttemp.style.position = \"absolute\";\n\t\t\ttemp.style.whiteSpace = \"pre\";\n\t\t\ttemp.className = `${LIBRARY_NAME}-popup-message`;\n\t\t\ttemp.innerHTML = Utils.sanitizeHTML(options.message);\n\t\t\tthis.workspaceEl?.appendChild(temp);\n\t\t\twinOptions.width = temp.offsetWidth + 80; // メッセージ幅 + パディング\n\t\t\tthis.workspaceEl?.removeChild(temp);\n\t\t} else {\n\t\t\twinOptions.width = 300;\n\t\t}\n\t\twinOptions.height = 150;\n\n\t\twinOptions.x = \"center\";\n\t\twinOptions.y = \"center\";\n\n\t\tconst win = this.createWindow(winOptions);\n\t\t// 計算が面倒なので前回1回分のみで判断\n\t\tlet winPosition = win.getPosition();\n\t\tif (this.lastPopupPosition && this.lastPopupPosition.x === winPosition.x && this.lastPopupPosition.y === winPosition.y) {\n\t\t\twin.setPosition(this.lastPopupPosition.x + this.CASCADE_OFFSET, this.lastPopupPosition.y + this.CASCADE_OFFSET);\n\t\t\twinPosition = win.getPosition();\n\t\t}\n\t\tthis.lastPopupPosition = winPosition;\n\t\twin.popupCloseCallback = closeCallback;\n\n\t\twin.el.querySelectorAll<HTMLButtonElement>(`.${LIBRARY_NAME}-popup-button`).forEach((button) => {\n\t\t\tbutton.addEventListener(\"click\", () => {\n\t\t\t\tconst index = parseInt(button.dataset.index!, 10);\n\t\t\t\tconst result = buttons[index].value;\n\t\t\t\tcloseCallback(result);\n\t\t\t\twin.close();\n\t\t\t});\n\t\t});\n\n\t\tif (options.timeout && options.timeout > 0) {\n\t\t\ttimeoutId = window.setTimeout(() => {\n\t\t\t\tif (this.windows.has(win.id)) {\n\t\t\t\t\tcloseCallback(TIMEOUT_RESULT);\n\t\t\t\t\twin.close();\n\t\t\t\t}\n\t\t\t}, options.timeout);\n\t\t}\n\t\treturn win;\n\t}\n\n\tpublic popupAsync(options: PopupOptions): Promise<PopupResult> {\n\t\tconst opt = Utils.deepCopy(options);\n\t\treturn new Promise((resolve) => {\n\t\t\tconst tmpOnClose = opt.onClose;\n\t\t\topt.onClose = (result) => {\n\t\t\t\ttmpOnClose?.(result);\n\t\t\t\tresolve(result);\n\t\t\t};\n\t\t\tthis.popup(opt);\n\t\t});\n\t}\n\n\tpublic destroyWindow(id: string): void {\n\t\tthis.ensureInitialized();\n\t\tconst win = this.windows.get(id);\n\t\tif (win) {\n\t\t\tif (win.options._taskbarItem) {\n\t\t\t\twin.options._taskbarItem.remove();\n\t\t\t}\n\t\t\tif (win.options.windowOptions.modal) {\n\t\t\t\tthis.deactivateFocusTrap();\n\t\t\t}\n\n\t\t\twin.el.remove();\n\t\t\tthis.windows.delete(id);\n\t\t\tWindowManager.allWindows.delete(id);\n\t\t\tif (this.activeWindow === win) {\n\t\t\t\tthis.activeWindow = null;\n\t\t\t\tconst nextWin = Array.from(this.windows.values()).pop();\n\t\t\t\tif (nextWin) this.focusWindow(nextWin);\n\t\t\t}\n\t\t\t// ウィンドウ破棄後に仮想化状態を更新\n\t\t\tthis.updateVirtualization();\n\t\t}\n\t}\n\n\tpublic focusWindow(win: WinLetWindow): void {\n\t\tthis.ensureInitialized();\n\t\tif (this.activeWindow === win && !win.options.windowOptions.modal) return;\n\n\t\t// 自身が管理する他のウィンドウをぼかす\n\t\tthis.activeWindow?.blur();\n\n\t\t// モーダルかつフォーカストラップ有効ならトラップ開始\n\t\tif (win.options.windowOptions.modal && this.globalConfig.enableFocusTrapping) {\n\t\t\tthis.activateFocusTrap(win);\n\t\t} else {\n\t\t\t// そうでなければ既存のトラップは解除\n\t\t\tthis.deactivateFocusTrap();\n\t\t}\n\n\t\tthis.activeWindow = win;\n\t\twin.el.style.zIndex = `${win.options.windowOptions.alwaysOnTop ? ++this.zIndexCounterOnTop : ++this.zIndexCounter}`;\n\n\t\tthis.windows.forEach((w) => w.options._taskbarItem?.classList.remove(`${LIBRARY_NAME}-active`));\n\t\twin.options._taskbarItem?.classList.add(`${LIBRARY_NAME}-active`);\n\t\t// ウィンドウのフォーカス、移動、リサイズ時に仮想化状態を即時更新\n\t\tthis.updateVirtualization();\n\n\t\t// focus()はWindowクラス側で呼ばれるので不要\n\t}\n\n\tpublic getWindow(id: string): WinLetWindow | undefined {\n\t\tthis.ensureInitialized();\n\t\treturn this.windows.get(id);\n\t}\n\n\tpublic getWindowFromElement(element: HTMLElement): WinLetWindow | undefined {\n\t\tthis.ensureInitialized();\n\t\tconst winEl = element.closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\tif (winEl?.id) {\n\t\t\treturn WindowManager.allWindows.get(winEl.id);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic getActiveWindow(): WinLetWindow | null {\n\t\tthis.ensureInitialized();\n\t\treturn this.activeWindow;\n\t}\n\n\tpublic onTabDragStart(sourceWindowId: string): void {\n\t\tthis.workspaceEl?.classList.add(`${LIBRARY_NAME}-is-tab-dragging`);\n\t\tthis.draggingTabInfo = { sourceWindowId };\n\t}\n\n\tpublic onTabDragEnd(): void {\n\t\tthis.workspaceEl?.classList.remove(`${LIBRARY_NAME}-is-tab-dragging`);\n\t\tthis.draggingTabInfo = null;\n\t}\n\n\tpublic showContextMenu(x: number, y: number, menuItems: ContextMenuItem[], contextWindow: IWindow): void {\n\t\tthis.ensureInitialized();\n\t\tthis.hideContextMenu();\n\n\t\tthis.contextMenuEl = document.createElement(\"ul\");\n\t\tthis.contextMenuEl.className = `${LIBRARY_NAME}-context-menu`;\n\n\t\tmenuItems.forEach((itemData) => {\n\t\t\tconst itemEl = document.createElement(\"li\");\n\t\t\tif (itemData.separator) {\n\t\t\t\titemEl.className = `${LIBRARY_NAME}-separator`;\n\t\t\t} else {\n\t\t\t\titemEl.textContent = itemData.name ?? \"\";\n\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\titemData.action?.(contextWindow);\n\t\t\t\t\tthis.hideContextMenu();\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.contextMenuEl!.appendChild(itemEl);\n\t\t});\n\n\t\tthis.workspaceEl!.appendChild(this.contextMenuEl);\n\n\t\tconst { offsetWidth: menuWidth, offsetHeight: menuHeight } = this.contextMenuEl;\n\t\tconst { innerWidth: screenWidth, innerHeight: screenHeight } = window;\n\n\t\tthis.contextMenuEl.style.left = x + menuWidth > screenWidth ? `${screenWidth - menuWidth}px` : `${x}px`;\n\t\tthis.contextMenuEl.style.top = y + menuHeight > screenHeight ? `${screenHeight - menuHeight}px` : `${y}px`;\n\t}\n\n\tpublic hideContextMenu(): void {\n\t\tthis.contextMenuEl?.remove();\n\t\tthis.contextMenuEl = null;\n\t}\n\n\tpublic registerTheme(theme: Theme): void {\n\t\tthis.themes.set(theme.name, theme);\n\t}\n\n\tpublic getRegisteredThemes(): string[] {\n\t\treturn Array.from(this.themes.keys());\n\t}\n\n\tpublic setTheme(theme: string | Theme): void {\n\t\tconst themeObj = typeof theme === \"string\" ? this.themes.get(theme.toLowerCase()) : theme;\n\t\tif (!themeObj) {\n\t\t\tconsole.warn(`WinLet: Theme \"${theme}\" not found.`);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.container) {\n\t\t\tconsole.warn(\"WinLet: Container not found.\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.activeTheme) {\n\t\t\tfor (const [key, value] of Object.entries(this.activeTheme.variables)) {\n\t\t\t\tif (!(key in themeObj.variables)) {\n\t\t\t\t\tthis.container.style.removeProperty(this.replaceStringVariable(key));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.activeTheme = themeObj;\n\t\tfor (const [key, value] of Object.entries(themeObj.variables)) {\n\t\t\tthis.container.style.setProperty(this.replaceStringVariable(key), this.replaceStringVariable(value));\n\t\t}\n\t}\n\n\tpublic getTheme(): Theme | null {\n\t\treturn this.activeTheme;\n\t}\n\n\tprivate createTaskbar(): void {\n\t\tif (!this.container) return;\n\t\tthis.taskbarEl = document.createElement(\"div\");\n\t\tthis.taskbarEl.className = `${LIBRARY_NAME}-taskbar ${LIBRARY_NAME}-us-none`;\n\t\tthis.updateTaskbarLayout();\n\t\tthis.container.appendChild(this.taskbarEl);\n\t}\n\n\tprivate updateTaskbarLayout(): void {\n\t\tif (!this.taskbarEl || !this.container) return;\n\n\t\tconst taskbarOpts = this.globalConfig.taskbar || {};\n\t\tconst position = taskbarOpts.position || \"bottom\";\n\n\t\tswitch (position) {\n\t\t\tcase \"top\":\n\t\t\tcase \"bottom\":\n\t\t\tcase \"left\":\n\t\t\tcase \"right\":\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new WinLetError(`Invalid taskbar position: ${position}`);\n\t\t}\n\n\t\t// クラスを一度リセット\n\t\tthis.taskbarEl.className = `${LIBRARY_NAME}-taskbar ${LIBRARY_NAME}-us-none`;\n\n\t\t// 位置クラスを追加\n\t\tthis.taskbarEl.classList.add(`${LIBRARY_NAME}-taskbar-${position}`);\n\n\t\tif (!this.taskbarEl.isConnected) {\n\t\t\tthis.container.appendChild(this.taskbarEl);\n\t\t}\n\n\t\tthis.container.style.flexDirection = \"\";\n\t\tthis.taskbarEl.style.order = \"\";\n\t\tif (this.workspaceEl) {\n\t\t\tthis.workspaceEl.style.order = \"\";\n\t\t}\n\n\t\tthis.container.style.paddingTop = \"0\";\n\t\tthis.container.style.paddingBottom = \"0\";\n\t\tthis.container.style.paddingLeft = \"0\";\n\t\tthis.container.style.paddingRight = \"0\";\n\n\t\t// getComputedStyleで実際のタスクバーサイズを取得\n\t\tconst computedStyle = window.getComputedStyle(this.taskbarEl);\n\t\tconst taskbarHeight = computedStyle.height;\n\t\tconst taskbarWidth = computedStyle.width;\n\n\t\tswitch (position) {\n\t\t\tcase \"top\":\n\t\t\t\tthis.container.style.paddingTop = taskbarHeight;\n\t\t\t\tthis.container.style.flexDirection = \"column-reverse\";\n\t\t\t\tthis.taskbarEl.style.order = \"1\";\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"2\";\n\t\t\t\tbreak;\n\t\t\tcase \"bottom\":\n\t\t\t\tthis.container.style.paddingBottom = taskbarHeight;\n\t\t\t\tthis.container.style.flexDirection = \"column\";\n\t\t\t\tthis.taskbarEl.style.order = \"2\";\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"1\";\n\t\t\t\tbreak;\n\t\t\tcase \"left\":\n\t\t\t\tthis.container.style.paddingLeft = taskbarWidth;\n\t\t\t\tthis.container.style.flexDirection = \"row-reverse\";\n\t\t\t\tthis.taskbarEl.style.order = \"1\";\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"2\";\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tthis.container.style.paddingRight = taskbarWidth;\n\t\t\t\tthis.container.style.flexDirection = \"row\";\n\t\t\t\tthis.taskbarEl.style.order = \"2\";\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"1\";\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate createTaskbarItem(win: WinLetWindow): void {\n\t\tif (!this.taskbarEl) return;\n\t\tconst item = document.createElement(\"div\");\n\t\titem.className = `${LIBRARY_NAME}-taskbar-item`;\n\t\titem.textContent = win.getTitle();\n\t\titem.title = win.getTitle();\n\t\titem.dataset.windowId = win.id;\n\n\t\tthis.updateTaskbarItemContent(item, win);\n\n\t\titem.addEventListener(\"click\", () => {\n\t\t\tif (win.state === \"minimized\") {\n\t\t\t\twin.restore();\n\t\t\t} else {\n\t\t\t\tif (this.activeWindow === win) {\n\t\t\t\t\twin.minimize();\n\t\t\t\t} else {\n\t\t\t\t\twin.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\twin.options._taskbarItem = item;\n\t\tthis.taskbarEl.appendChild(item);\n\t}\n\n\tprivate updateTaskbarItemContent(item: HTMLElement, win: WinLetWindow) {\n\t\tconst { icon, taskbarOptions } = win.options;\n\t\titem.innerHTML = \"\"; // Clear existing content\n\t\titem.title = win.getTitle(); // Always set tooltip\n\n\t\tconst showIconOnly = taskbarOptions?.showIconOnly && icon;\n\n\t\titem.classList.toggle(`${LIBRARY_NAME}-icon-only`, !!showIconOnly);\n\n\t\tif (showIconOnly) {\n\t\t\tconst iconEl = document.createElement(\"div\");\n\t\t\ticonEl.className = `${LIBRARY_NAME}-taskbar-item-icon`;\n\t\t\tif (win.isFontAwesome(icon)) {\n\t\t\t\tconst i = document.createElement(\"i\");\n\t\t\t\ti.className = icon;\n\t\t\t\ticonEl.appendChild(i);\n\t\t\t} else {\n\t\t\t\tconst img = document.createElement(\"img\");\n\t\t\t\timg.src = icon;\n\t\t\t\timg.alt = win.getTitle();\n\t\t\t\ticonEl.appendChild(img);\n\t\t\t}\n\t\t\titem.appendChild(iconEl);\n\t\t} else {\n\t\t\titem.textContent = win.getTitle();\n\t\t}\n\t}\n\n\tpublic updateTaskbarItem(win: WinLetWindow, state: \"minimized\" | \"restored\" | \"titleChanged\" | \"iconChanged\" | \"virtualized\" | \"unvirtualized\"): void {\n\t\tconst item = win.options._taskbarItem;\n\t\tif (!item) return;\n\n\t\tswitch (state) {\n\t\t\tcase \"minimized\":\n\t\t\t\titem.classList.add(`${LIBRARY_NAME}-minimized`);\n\t\t\t\tbreak;\n\t\t\tcase \"restored\":\n\t\t\t\titem.classList.remove(`${LIBRARY_NAME}-minimized`);\n\t\t\t\tbreak;\n\t\t\tcase \"titleChanged\":\n\t\t\tcase \"iconChanged\":\n\t\t\t\tthis.updateTaskbarItemContent(item, win);\n\t\t\t\tbreak;\n\t\t\tcase \"virtualized\":\n\t\t\t\tif (this.globalConfig.indicateVirtualizationInTaskbar) {\n\t\t\t\t\titem.classList.add(`${LIBRARY_NAME}-virtualized`);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"unvirtualized\":\n\t\t\t\titem.classList.remove(`${LIBRARY_NAME}-virtualized`);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate activateFocusTrap(win: WinLetWindow): void {\n\t\tthis.deactivateFocusTrap(); // 念のため既存のリスナーを解除\n\n\t\tthis.boundTabPressHandler = (e: KeyboardEvent) => {\n\t\t\tif (e.key === \"Tab\") {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst focusableElements = Array.from(win.el.querySelectorAll<HTMLElement>('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex=\"-1\"])')).filter((el) => !el.hasAttribute(\"disabled\") && !el.closest(\".minimized\"));\n\n\t\t\t\tif (focusableElements.length === 0) return;\n\n\t\t\t\tconst currentIndex = focusableElements.indexOf(document.activeElement as HTMLElement);\n\t\t\t\tlet nextIndex = e.shiftKey ? currentIndex - 1 : currentIndex + 1;\n\n\t\t\t\tif (nextIndex >= focusableElements.length) {\n\t\t\t\t\tnextIndex = 0;\n\t\t\t\t}\n\t\t\t\tif (nextIndex < 0) {\n\t\t\t\t\tnextIndex = focusableElements.length - 1;\n\t\t\t\t}\n\t\t\t\tfocusableElements[nextIndex].focus();\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener(\"keydown\", this.boundTabPressHandler);\n\t}\n\n\tprivate deactivateFocusTrap(): void {\n\t\tif (this.boundTabPressHandler) {\n\t\t\tdocument.removeEventListener(\"keydown\", this.boundTabPressHandler);\n\t\t\tthis.boundTabPressHandler = null;\n\t\t}\n\t}\n\n\t/**\n\t * ショートカット文字列を解析し、修飾キーと主キーのオブジェクトを返す\n\t * @param shortcut - \"Ctrl+Shift+K\"のような文字列\n\t */\n\tprivate parseShortcut(shortcut: string): { ctrl: boolean; alt: boolean; shift: boolean; key: string } {\n\t\tconst keys = shortcut.split(\"+\");\n\t\tconst key = keys.pop() || \"\"; // 主キーを配列から取り出す\n\t\tconst ctrl = keys.includes(\"Ctrl\");\n\t\tconst alt = keys.includes(\"Alt\");\n\t\tconst shift = keys.includes(\"Shift\");\n\t\treturn { ctrl, alt, shift, key };\n\t}\n\n\t/**\n\t * 全てのウィンドウの可視性をチェックし、必要に応じて仮想化/復元を行う\n\t */\n\tpublic updateVirtualization(): void {\n\t\tif (!this.globalConfig.enableVirtualization || !this.workspaceEl) return;\n\n\t\tconst threshold = this.globalConfig.virtualizationThreshold ?? 5;\n\t\tif (this.windows.size <= threshold) {\n\t\t\t// しきい値以下の場合は、すべてのウィンドウが仮想化されていないことを確認\n\t\t\tfor (const win of this.windows.values()) {\n\t\t\t\tif (win.virtualizationLevel !== \"none\") {\n\t\t\t\t\twin.unvirtualize();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn; // さらに処理を停止\n\t\t}\n\n\t\t// z-indexでソートし、奥のウィンドウから手前のウィンドウの順で並べる\n\t\tconst windows = Array.from(this.windows.values()).sort((a, b) => parseInt(a.el.style.zIndex || \"0\", 10) - parseInt(b.el.style.zIndex || \"0\", 10));\n\n\t\tconst viewportRect = this.workspaceEl.getBoundingClientRect();\n\n\t\tfor (let i = 0; i < windows.length; i++) {\n\t\t\tconst targetWin = windows[i];\n\n\t\t\t// 1. 仮想化対象外のウィンドウ、またはアクティブなウィンドウは常に非仮想化\n\t\t\tif (!targetWin.options.virtualizable || targetWin.state !== \"normal\" || targetWin === this.activeWindow) {\n\t\t\t\ttargetWin.unvirtualize();\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst targetRect = targetWin.el.getBoundingClientRect();\n\t\t\t// 面積が非常に小さいウィンドウは非表示として扱う\n\t\t\tif (targetRect.width <= 1 || targetRect.height <= 1) {\n\t\t\t\ttargetWin.virtualize(\"auto\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// 2. 5つのサンプルポイント（四隅と中央）を定義\n\t\t\tconst samplePoints = [\n\t\t\t\t{ x: targetRect.left + 1, y: targetRect.top + 1 }, // Top-left\n\t\t\t\t{ x: targetRect.right - 1, y: targetRect.top + 1 }, // Top-right\n\t\t\t\t{ x: targetRect.right - 1, y: targetRect.bottom - 1 }, // Bottom-right\n\t\t\t\t{ x: targetRect.left + 1, y: targetRect.bottom - 1 }, // Bottom-left\n\t\t\t\t{ x: targetRect.left + targetRect.width * 0.5, y: targetRect.top + targetRect.height * 0.5 }, // Center\n\t\t\t];\n\n\t\t\tlet isVisible = false;\n\t\t\tfor (const point of samplePoints) {\n\t\t\t\t// ポイントがビューポート（ワークスペース）の外側なら、このポイントは不可視\n\t\t\t\tconst inViewport = point.x >= viewportRect.left && point.x < viewportRect.right && point.y >= viewportRect.top && point.y < viewportRect.bottom;\n\t\t\t\tif (!inViewport) {\n\t\t\t\t\tcontinue; // 次のサンプルポイントをチェック\n\t\t\t\t}\n\n\t\t\t\t// ポイントが他のウィンドウに隠されているかチェック\n\t\t\t\tlet pointIsOccluded = false;\n\t\t\t\t// targetWinより手前にあるウィンドウ(occluderWin)をすべてチェック\n\t\t\t\tfor (let j = i + 1; j < windows.length; j++) {\n\t\t\t\t\tconst occluderWin = windows[j];\n\t\t\t\t\t// 隠す能力のないウィンドウ（最小化、透明など）はスキップ\n\t\t\t\t\tif (occluderWin.state !== \"normal\" || (occluderWin.getOpacity() ?? 1) < 0.9) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst occluderRect = occluderWin.el.getBoundingClientRect();\n\t\t\t\t\t// ポイントがoccluderWinの矩形内にあるかチェック\n\t\t\t\t\tif (point.x >= occluderRect.left && point.x < occluderRect.right && point.y >= occluderRect.top && point.y < occluderRect.bottom) {\n\t\t\t\t\t\tpointIsOccluded = true;\n\t\t\t\t\t\tbreak; // １つのウィンドウでも隠していれば、このポイントのチェックは終了\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// このポイントがビューポート内にあり、かつどのウィンドウにも隠されていなければ、可視と判断\n\t\t\t\tif (!pointIsOccluded) {\n\t\t\t\t\tisVisible = true;\n\t\t\t\t\tbreak; // １つでも可視ポイントがあれば、ウィンドウ全体のチェックは終了\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// 3. 最終的な可視性に基づいて仮想化状態を更新\n\t\t\tif (isVisible) {\n\t\t\t\ttargetWin.unvirtualize();\n\t\t\t} else {\n\t\t\t\ttargetWin.virtualize(\"auto\");\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Bootstrapのテーマ属性の変更を監視するMutationObserverを開始します。\n\t */\n\tprivate startBootstrapThemeObserver(): void {\n\t\tif (this.bootstrapThemeObserver || !this.container) return;\n\n\t\t// --- ハイコントラストのリスナー設定 ---\n\t\tthis.highContrastMatcher = window.matchMedia(\"(prefers-contrast: more)\");\n\t\tthis.highContrastListener = (e: MediaQueryListEvent) => {\n\t\t\t// ハイコントラストがONになったら、high-contrastテーマを強制適用\n\t\t\tif (e.matches) {\n\t\t\t\tthis.stopAutoThemeListener();\n\t\t\t\tthis.setTheme(\"high-contrast\");\n\t\t\t} else {\n\t\t\t\t// OFFになったら、Bootstrapのテーマ設定を再評価\n\t\t\t\tthis.applyBootstrapTheme(document.documentElement.getAttribute(\"data-bs-theme\"));\n\t\t\t}\n\t\t};\n\t\tthis.highContrastMatcher.addEventListener(\"change\", this.highContrastListener);\n\n\t\t// --- Bootstrapテーマのリスナー設定 ---\n\t\tconst targetNode = document.documentElement;\n\t\tconst config = { attributes: true, attributeFilter: [\"data-bs-theme\"] };\n\t\tconst callback = (mutationsList: MutationRecord[]) => {\n\t\t\t// ハイコントラストが有効でなければ、テーマ変更を処理\n\t\t\tif (!this.highContrastMatcher?.matches) {\n\t\t\t\tfor (const mutation of mutationsList) {\n\t\t\t\t\tif (mutation.type === \"attributes\" && mutation.attributeName === \"data-bs-theme\") {\n\t\t\t\t\t\tconst themeValue = (mutation.target as HTMLElement).getAttribute(\"data-bs-theme\");\n\t\t\t\t\t\tthis.applyBootstrapTheme(themeValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tthis.bootstrapThemeObserver = new MutationObserver(callback);\n\t\tthis.bootstrapThemeObserver.observe(targetNode, config);\n\n\t\t// --- 初期チェック ---\n\t\t// 優先度1: ハイコントラストモード\n\t\tif (this.highContrastMatcher.matches) {\n\t\t\tthis.setTheme(\"high-contrast\");\n\t\t} else {\n\t\t\t// 優先度2: Bootstrapテーマ\n\t\t\tthis.applyBootstrapTheme(targetNode.getAttribute(\"data-bs-theme\"));\n\t\t}\n\t}\n\n\t/**\n\t * Bootstrapのテーマ属性の監視を停止します。\n\t */\n\tprivate stopBootstrapThemeObserver(): void {\n\t\tif (this.bootstrapThemeObserver) {\n\t\t\tthis.bootstrapThemeObserver.disconnect();\n\t\t\tthis.bootstrapThemeObserver = null;\n\t\t}\n\t\tif (this.highContrastMatcher && this.highContrastListener) {\n\t\t\tthis.highContrastMatcher.removeEventListener(\"change\", this.highContrastListener);\n\t\t}\n\t\tthis.stopAutoThemeListener(); // OSのリスナーも停止\n\t}\n\n\t/**\n\t * 適用されたBootstrapのテーマに応じてWinLetのテーマを設定します。\n\t * @param themeValue - data-bs-theme属性の値 ('dark', 'light', 'auto', or null)\n\t */\n\tprivate applyBootstrapTheme(themeValue: string | null): void {\n\t\tthis.stopAutoThemeListener(); // 競合を避けるため、まずOSのリスナーを停止\n\n\t\tif (themeValue === \"dark\") {\n\t\t\tthis.setTheme(\"dark\");\n\t\t} else if (themeValue === \"auto\") {\n\t\t\tthis.startAutoThemeListener();\n\t\t} else {\n\t\t\t// 'light' または属性が存在しない場合\n\t\t\tthis.setTheme(\"default\");\n\t\t}\n\t}\n\n\t/**\n\t * OSのカラースキーム変更の監視を開始します。\n\t */\n\tprivate startAutoThemeListener(): void {\n\t\tif (this.prefersColorSchemeListener || !window.matchMedia) return;\n\n\t\tthis.prefersDarkMatcher = window.matchMedia(\"(prefers-color-scheme: dark)\");\n\n\t\tthis.prefersColorSchemeListener = (e: MediaQueryListEvent) => {\n\t\t\tthis.setTheme(e.matches ? \"dark\" : \"default\");\n\t\t};\n\n\t\tthis.prefersDarkMatcher.addEventListener(\"change\", this.prefersColorSchemeListener);\n\n\t\t// 現在のOS設定に基づいて初期テーマを適用\n\t\tthis.setTheme(this.prefersDarkMatcher.matches ? \"dark\" : \"default\");\n\t}\n\n\t/**\n\t * OSのカラースキーム変更の監視を停止します。\n\t */\n\tprivate stopAutoThemeListener(): void {\n\t\tif (this.prefersDarkMatcher && this.prefersColorSchemeListener) {\n\t\t\tthis.prefersDarkMatcher.removeEventListener(\"change\", this.prefersColorSchemeListener);\n\t\t}\n\t\tthis.prefersDarkMatcher = null;\n\t\tthis.prefersColorSchemeListener = null;\n\t}\n}\n","// src/index.ts\n\nimport { defaultConfig } from \"./const/config\";\nimport { CLOSE_BUTTON_RESULT, GlobalConfigOptions, IWindow, PopupOptions, PopupResult, Theme, TIMEOUT_RESULT, WindowOptions, WinLetApi } from \"./const/types\";\nimport WinLetWindow from \"./function/window\";\nimport WindowManager from \"./function/window_manager\";\nimport Utils from \"./libs/utils\";\nimport { LIB_VERSION } from \"./version\";\n\nconst selfUrl = (document?.currentScript as HTMLScriptElement)?.src || \"\";\n\nconst globalConfig: GlobalConfigOptions = {\n\twindowSwitchShortcut: \"Ctrl+`\", // デフォルトショートカット（バッククォート）\n\tlibraryPath: selfUrl,\n\tenableAnimations: true,\n\tenableFocusTrapping: true,\n\tenableVirtualization: true,\n\tindicateVirtualizationInTaskbar: true,\n\tvirtualizationThreshold: 5,\n\tvirtualizationDelay: 1000 * 10,\n\ttaskbar: {\n\t\tposition: \"bottom\",\n\t},\n\tautoDetectBootstrapTheme: true,\n\tenableDebugMode: false,\n};\n\n// シングルトンインスタンス\nconst manager = new WindowManager(globalConfig);\n\n// 公開するAPI\nconst api: WinLetApi = {\n\t/**\n\t * ライブラリを初期化します。DOMの準備ができた後に呼び出してください。\n\t * (例: document.addEventListener('DOMContentLoaded', WinLet.init);)\n\t *\n\t * @param options - グローバル設定。コンテナ要素などを指定できます。\n\t */\n\tinit: (options: GlobalConfigOptions = {}): void => {\n\t\tapi.setGlobalConfig(options);\n\t\tmanager.init();\n\t},\n\n\t/**\n\t * 新しいウィンドウを作成\n\t */\n\tcreateWindow: (options: WindowOptions = {}): IWindow => {\n\t\treturn manager.createWindow(options);\n\t},\n\n\t/**\n\t * 新しいポップアップウィンドウを作成\n\t */\n\tcreatePopup: (options: PopupOptions): IWindow => {\n\t\treturn manager.popup(options);\n\t},\n\n\t/**\n\t * 新しいポップアップウィンドウを作成\n\t */\n\tcreateAsyncPopup: (options: PopupOptions): Promise<PopupResult> => {\n\t\treturn manager.popupAsync(options);\n\t},\n\n\t/**\n\t * ウィンドウを取得\n\t */\n\tgetWindow: (id: string): IWindow | undefined => {\n\t\treturn manager.getWindow(id);\n\t},\n\n\t/**\n\t * 指定されたDOM要素を内包するウィンドウインスタンスを取得します。\n\t */\n\tgetWindowFromElement: (element: HTMLElement): IWindow | undefined => {\n\t\treturn manager.getWindowFromElement(element);\n\t},\n\n\t/**\n\t * アクティブなウィンドウを取得\n\t */\n\tgetActiveWindow: (): IWindow | null => {\n\t\treturn manager.getActiveWindow();\n\t},\n\n\t/**\n\t * タスクバーのアイテムを更新\n\t */\n\tupdateTaskbarItem(win: IWindow, state: \"minimized\" | \"restored\" | \"titleChanged\" | \"iconChanged\" | \"virtualized\" | \"unvirtualized\"): void {\n\t\tmanager.updateTaskbarItem(win as WinLetWindow, state);\n\t},\n\n\t/**\n\t * デフォルトのウィンドウ設定を変更\n\t */\n\tsetDefaultConfig: (options: WindowOptions): void => {\n\t\tUtils.deepMerge(defaultConfig, options);\n\t},\n\n\t/**\n\t * グローバル設定を変更\n\t */\n\tsetGlobalConfig: (options: GlobalConfigOptions): void => {\n\t\t// 初期化後にコンテナを変更しようとした場合は警告を出す\n\t\tif (manager.isInitialized && options.container) {\n\t\t\tconsole.warn(\"WinLet: The container cannot be changed after initialization.\");\n\t\t\tdelete options.container;\n\t\t}\n\t\tObject.assign(globalConfig, options);\n\t\tmanager.applyGlobalConfig(globalConfig);\n\t},\n\n\t/**\n\t * 表示テーマを登録します。\n\t */\n\tregisterTheme: (theme: Theme): void => {\n\t\tmanager.registerTheme(theme);\n\t},\n\n\t/**\n\t * 登録済みのテーマ名の配列を取得します。\n\t */\n\tgetRegisteredThemes: () => {\n\t\treturn manager.getRegisteredThemes();\n\t},\n\n\t/**\n\t * 表示テーマを変更します。\n\t */\n\tsetTheme: (theme: string | Theme): void => {\n\t\tmanager.setTheme(theme);\n\t},\n\n\t/**\n\t * 現在の表示テーマを取得します。\n\t */\n\tgetTheme: (): Theme | null => {\n\t\treturn manager.getTheme();\n\t},\n\n\t/**\n\t * ライブラリのバージョンを取得\n\t */\n\tget version() {\n\t\treturn LIB_VERSION;\n\t},\n\n\t/**\n\t * ポップアップウィンドウのタイムアウト結果\n\t */\n\tPOPUP_TIMEOUT_RESULT: TIMEOUT_RESULT,\n\t/**\n\t * ポップアップウィンドウの閉じるボタンの結果\n\t */\n\tPOPUP_CLOSE_BUTTON_RESULT: CLOSE_BUTTON_RESULT,\n};\n\n// グローバルスコープにAPIをアタッチ\nif (typeof window !== \"undefined\") {\n\twindow.WinLet = api;\n}\n\n// モジュールとしてエクスポートも可能\nexport default api;\n","export default class WinLetBaseClass {}\n","import WinLetBaseClass from \"./baseclass\";\n\nexport default class Utils extends WinLetBaseClass {\n\t/**\n\t * ユニークなIDを生成します。\n\t * @param prefix - IDのプレフィックス\n\t * @returns 生成されたID\n\t */\n\tpublic static generateId(prefix: string = \"win\"): string {\n\t\treturn `${prefix}-${Math.random().toString(36).substring(2, 9)}`;\n\t}\n\n\tpublic static deepCopy<T>(value: T, seen: WeakMap<object, any> = new WeakMap()): T {\n\t\tif (value === null || typeof value !== \"object\") return value;\n\n\t\tif (value instanceof Date) return new Date(value.getTime()) as T;\n\n\t\tif (value instanceof Map) {\n\t\t\tconst copiedMap = new Map();\n\t\t\tvalue.forEach((v, k) => {\n\t\t\t\tcopiedMap.set(this.deepCopy(k, seen), this.deepCopy(v, seen));\n\t\t\t});\n\t\t\treturn copiedMap as T;\n\t\t}\n\n\t\tif (value instanceof Set) {\n\t\t\tconst copiedSet = new Set();\n\t\t\tvalue.forEach((v) => {\n\t\t\t\tcopiedSet.add(this.deepCopy(v, seen));\n\t\t\t});\n\t\t\treturn copiedSet as T;\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\tif (seen.has(value)) return seen.get(value);\n\t\t\tconst arrCopy: any[] = [];\n\t\t\tseen.set(value, arrCopy);\n\t\t\tfor (const item of value) {\n\t\t\t\tarrCopy.push(this.deepCopy(item, seen));\n\t\t\t}\n\t\t\treturn arrCopy as T;\n\t\t}\n\n\t\tif (seen.has(value)) return seen.get(value);\n\t\tconst copiedObj: { [key: string]: any } = {};\n\t\tseen.set(value, copiedObj);\n\t\tfor (const key in value) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(value, key)) {\n\t\t\t\tcopiedObj[key] = this.deepCopy((value as any)[key], seen);\n\t\t\t}\n\t\t}\n\t\treturn copiedObj as T;\n\t}\n\n\t/**\n\t * オブジェクトをディープマージします。\n\t */\n\tpublic static deepMerge<T extends object, U extends object>(target: T, source: U): T & U {\n\t\tconst output = { ...target } as T & U;\n\n\t\tfor (const key in source) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(source, key)) {\n\t\t\t\tconst sourceValue = source[key];\n\t\t\t\tconst targetValue = (target as any)[key];\n\n\t\t\t\tif (Array.isArray(sourceValue)) {\n\t\t\t\t\t// ソースの値が配列の場合は、そのまま上書きする\n\t\t\t\t\t(output as any)[key] = sourceValue;\n\t\t\t\t} else if (sourceValue instanceof Object && typeof sourceValue !== \"function\" && targetValue instanceof Object) {\n\t\t\t\t\t(output as any)[key] = this.deepMerge(targetValue, sourceValue);\n\t\t\t\t} else {\n\t\t\t\t\t(output as any)[key] = sourceValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\t/**\n\t * オブジェクトが空でないかとどうかを判定します。\n\t * @param obj - 判定するオブジェクト\n\t * @returns オブジェクトが空である場合はfalse、そうでない場合はtrue\n\t */\n\tpublic static isNonEmptyObject<T extends object>(obj: T | undefined): obj is T & Record<string | symbol, unknown> {\n\t\tif (!obj) return false;\n\t\tfor (const _ in obj) return true;\n\t\treturn false;\n\t}\n\n\t/**\n\t * HTML文字列をサニタイズします。\n\t * @param str - サニタイズする文字列\n\t * @returns サニタイズされたHTML文字列\n\t */\n\tpublic static sanitizeHTML(str: string): string {\n\t\tconst temp = document.createElement(\"div\");\n\t\ttemp.textContent = str;\n\t\treturn temp.innerHTML;\n\t}\n}\n","const styleData: string = `\n/* ========================================================================\n    1. 基本設定・変数\n   ======================================================================== */\n:root {\n    /* 基本色・シャドウ */\n    --$[prefix]-text-color: #000;\n    --$[prefix]-bg: #f0f0f0;\n    --$[prefix]-border: #a0a0a0;\n    --$[prefix]-shadow-color-light: rgba(0,0,0,0.15);\n    --$[prefix]-shadow-color-strong: rgba(0,0,0,0.3);\n    --$[prefix]-shadow-color-active: rgba(0,0,0,0.45);\n\n    /* タイトルバー */\n    --$[prefix]-title-bar-height: 32px;\n    --$[prefix]-title-bar-bg: #e0e0e0;\n    --$[prefix]-title-bar-active-bg: #0078d7;\n    --$[prefix]-title-text-color: #000;\n    --$[prefix]-title-text-active-color: #fff;\n\n    /* コントロールボタン */\n    --$[prefix]-control-bg: #d0d0d0;\n    --$[prefix]-control-hover-bg: #e5e5e5;\n    --$[prefix]-control-close-hover-bg: #e81123;\n    --$[prefix]-control-close-hover-color: #fff;\n\n    /* メニュー */\n    --$[prefix]-menu-bg: #fff;\n    --$[prefix]-menu-border: #ccc;\n    --$[prefix]-menu-item-color: #000;\n    --$[prefix]-menu-item-hover-bg: #0078d7;\n    --$[prefix]-menu-item-hover-color: #fff;\n    --$[prefix]-shortcut-text-color: #666;\n\n    /* タブ */\n    --$[prefix]-tab-bg: #dcdcdc;\n    --$[prefix]-tab-active-bg: #f0f0f0;\n    --$[prefix]-tab-border: #b0b0b0;\n    --$[prefix]-tab-bar-bg: #e1e1e1;\n    --$[prefix]-tab-close-btn-hover-bg: #ccc;\n    --$[prefix]-tab-active-close-btn-hover-bg: #ddd;\n\n    /* ポップアップボタン */\n    --$[prefix]-popup-button-hover-bg: #e9e9e9;\n    --$[prefix]-popup-button-hover-border-color: #bbb;\n\n    /* リサイズハンドル */\n    --$[prefix]-resize-handle-size: 8px;\n    --$[prefix]-resize-handle-offset: -4px;\n\n    /* タスクバー */\n    --$[prefix]-taskbar-bg: rgba(240, 240, 240, 0.9);\n    --$[prefix]-taskbar-border: #a0a0a0;\n    --$[prefix]-taskbar-item-bg: #d0d0d0;\n    --$[prefix]-taskbar-item-active-bg: #0078d7;\n    --$[prefix]-taskbar-item-active-color: #fff;\n    --$[prefix]-taskbar-height: 40px;\n    --$[prefix]-taskbar-width: 40px;\n\n    /* ローディングインジケーター */\n    --$[prefix]-loader-bg: rgba(255, 255, 255, 0.7);\n    --$[prefix]-loader-color: var(--$[prefix]-title-bar-active-bg);\n\n    /* その他 */\n    --$[prefix]-scrollbar-thumb-bg: rgba(100, 100, 100, 0.5);\n}\n\n/* ========================================================================\n    2. ユーティリティクラス\n   ========================================================================= */\n/**\n * テキスト選択を無効化\n */\n.$[prefix]-us-none {\n    user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n}\n/**\n * テキスト選択を有効化\n */\n.$[prefix]-us-auto {\n    user-select: auto;\n    -webkit-user-select: auto;\n    -ms-user-select: auto;\n}\n\n/* ========================================================================\n    3. コンテナ\n   ========================================================================= */\n/**\n * 全てのウィンドウを内包する最上位コンテナ\n */\n.$[prefix]-container {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    box-sizing: border-box;\n    pointer-events: none;\n    overflow: hidden;\n    z-index: 999;\n    display: flex;\n    pointer-events: none;\n}\n.$[prefix]-container > * {\n    pointer-events: all; /* 子要素(workspace, taskbar)のイベントは有効化 */\n}\n/**\n * 特定の要素内にネストされた場合のコンテナ\n */\n.$[prefix]-container.$[prefix]-is-nested {\n    position: absolute;\n}\n\n.$[prefix]-workspace {\n    position: relative;\n    flex-grow: 1; /* 残りのスペースをすべて占有 */\n    overflow: hidden; /* ウィンドウがはみ出さないように */\n    min-width: 0; /* flexアイテムの縮小問題を回避 */\n    min-height: 0; /* flexアイテムの縮小問題を回避 */\n    pointer-events: none;\n}\n/**\n * タブのドラッグ中にポインターイベントを有効化し、ドロップを受け付ける\n */\n.$[prefix]-workspace.$[prefix]-is-tab-dragging {\n    pointer-events: auto;\n}\n\n/* ========================================================================\n    4. 仮想化技術\n   ======================================================================== */\n/**\n * 仮想化(アンロード)されたウィンドウ\n */\n.$[prefix]-window.$[prefix]-is-virtualized > .$[prefix]-main-content {\n    display: none;\n}\n.$[prefix]-window.$[prefix]-is-virtualized::after {\n    content: \"Unloaded\";\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    color: var(--$[prefix]-border);\n    font-size: 1.5em;\n    font-weight: bold;\n    pointer-events: none;\n}\n\n/**\n * 中断されたウィンドウ\n */\n.$[prefix]-window.$[prefix]-is-suspended > .$[prefix]-main-content {\n    display: none;\n}\n.$[prefix]-window.$[prefix]-is-suspended::after {\n    content: \"Suspended\";\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    color: var(--$[prefix]-border);\n    font-size: 1.5em;\n    font-weight: bold;\n    pointer-events: none;\n    z-index: 15;\n}\n\n/**\n * フリーズされたウィンドウ\n */\n.$[prefix]-window.$[prefix]-is-frozen > .$[prefix]-main-content {\n    pointer-events: none; /* コンテンツの操作を無効化 */\n}\n.$[prefix]-window.$[prefix]-is-frozen > .$[prefix]-main-content iframe {\n    visibility: hidden;\n}\n.$[prefix]-window.$[prefix]-is-frozen::after {\n    content: \"Frozen\";\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    color: var(--$[prefix]-border);\n    background: rgba(128, 128, 128, 0.1);\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-size: 1.5em;\n    font-weight: bold;\n    pointer-events: none;\n    z-index: 15; /* ローダーより手前 */\n}\n/* ========================================================================\n    5. ウィンドウ\n   ======================================================================== */\n/* --- ウィンドウ基本スタイル --- */\n.$[prefix]-window {\n    position: absolute;\n    display: flex;\n    flex-direction: column;\n    min-width: 200px;\n    min-height: 150px;\n    border: 1px solid var(--$[prefix]-border);\n    background-color: var(--$[prefix]-bg);\n    box-shadow: 0 5px 15px var(--$[prefix]-shadow-color-strong);\n    box-sizing: border-box;\n    border-radius: 5px;\n    overflow: hidden;\n    pointer-events: all;\n    transition: opacity 0.2s, transform 0.2s, top 0.25s ease-in-out, left 0.25s ease-in-out, width 0.25s ease-in-out, height 0.25s ease-in-out;\n    touch-action: none;\n}\n\n/* --- ウィンドウ状態別スタイル --- */\n/**\n * 最小化されたウィンドウのアニメーション\n */\n.$[prefix]-window.$[prefix]-is-minimizing,\n.$[prefix]-window.$[prefix]-minimized {\n    transform: scale(0);\n    opacity: 0;\n    transition: opacity 0.25s, transform 0.25s;\n    pointer-events: none;\n}\n.$[prefix]-window.$[prefix]-minimized {\n    display: none;\n}\n/**\n * 最大化されたウィンドウのアニメーション\n */\n.$[prefix]-window.$[prefix]-maximized {\n    transition: top 0.25s ease-in-out, left 0.25s ease-in-out, width 0.25s ease-in-out, height 0.25s ease-in-out;\n}\n/**\n * 最大化状態ではリサイズハンドルを非表示\n */\n.$[prefix]-window.$[prefix]-maximized > .$[prefix]-resize-handle {\n    display: none;\n}\n/**\n * 復元中のアニメーション\n */\n.$[prefix]-window.$[prefix]-is-restoring {\n    transition: top 0.25s ease-in-out, left 0.25s ease-in-out, width 0.25s ease-in-out, height 0.25s ease-in-out;\n}\n\n/**\n * ドラッグ中・リサイズ中のトランジションを短縮し、操作性を向上\n */\n.$[prefix]-window.$[prefix]-is-dragging,\n.$[prefix]-window.$[prefix]-is-resizing {\n    transition: opacity 0.1s, transform 0.1s;\n}\n\n/**\n * アクティブ（フォーカスされている）ウィンドウ\n */\n.$[prefix]-window.$[prefix]-active {\n    box-shadow: 0 8px 25px var(--$[prefix]-shadow-color-active); /* アクティブ時のシャドウ */\n}\n/**\n * アクティブ（フォーカスされている）ウィンドウのタイトルバー\n */\n.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar {\n    background-color: var(--$[prefix]-title-bar-active-bg);\n    color: var(--$[prefix]-title-text-active-color);\n}\n.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar .$[prefix]-title {\n    color: var(--$[prefix]-title-text-active-color);\n}\n\n/* --- ウィンドウ特殊スタイル --- */\n/**\n * 「常に手前に表示」が有効なウィンドウ\n */\n.$[prefix]-window.$[prefix]-always-on-top .$[prefix]-title-bar {\n    background-image: repeating-linear-gradient(\n        -45deg,\n        transparent,\n        transparent 4px,\n        rgba(255, 255, 255, 0.05) 4px,\n        rgba(255, 255, 255, 0.05) 8px\n    );\n}\n\n/**\n * ウィンドウシェイクアニメーション\n */\n@keyframes $[prefix]-shake {\n    10%, 90% { transform: translate3d(-1px, 0, 0); }\n    20%, 80% { transform: translate3d(2px, 0, 0); }\n    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }\n    40%, 60% { transform: translate3d(4px, 0, 0); }\n}\n.$[prefix]-window.$[prefix]-is-shaking {\n    animation: $[prefix]-shake 0.82s cubic-bezier(.36,.07,.19,.97) both;\n}\n\n/* ========================================================================\n    6. ゴーストウィンドウ\n   ======================================================================== */\n/**\n * ドラッグ・リサイズ時に表示される輪郭\n */\n.$[prefix]-ghost-window {\n    position: absolute;\n    box-sizing: border-box;\n    border: 2px dashed var(--$[prefix]-title-bar-active-bg);\n    background-color: rgba(0, 120, 215, 0.1);\n    z-index: 99999;\n    pointer-events: none;\n}\n\n/* ========================================================================\n    7. タイトルバー\n   ======================================================================== */\n/* --- タイトルバー基本スタイル --- */\n.$[prefix]-title-bar {\n    display: flex;\n    align-items: center;\n    height: var(--$[prefix]-title-bar-height);\n    background-color: var(--$[prefix]-title-bar-bg);\n    color: var(--$[prefix]-title-text-color);\n    cursor: move;\n    flex-shrink: 0;\n    touch-action: none;\n}\n/**\n * コントロールが左側にある場合のタイトルバー\n */\n.$[prefix]-title-bar.$[prefix]-controls-left {\n    flex-direction: row-reverse;\n}\n\n/* --- アイコン・タイトル --- */\n.$[prefix]-icon {\n    min-width: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    height: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    margin: 0 4px;\n    pointer-events: none;\n    flex-shrink: 0;\n}\n\n.$[prefix]-icon:empty {\n    display: none;\n}\n\n.$[prefix]-icon i {\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\n    line-height: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    text-align: center;\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n.$[prefix]-icon img {\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n.$[prefix]-title {\n    flex-grow: 1;\n    padding: 0 8px;\n    font-family: sans-serif;\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.44);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    pointer-events: none;\n}\n\n.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-title {\n    text-align: right;\n}\n\n/* --- コントロールボタン --- */\n.$[prefix]-controls {\n    display: flex;\n    height: 100%;\n    margin-left: auto;\n    flex-shrink: 0;\n}\n\n.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-controls {\n    margin-left: 0;\n    margin-right: auto;\n    flex-direction: row-reverse;\n}\n\n.$[prefix]-control-btn {\n    display: inline-flex;\n    justify-content: center;\n    align-items: center;\n    width: calc(var(--$[prefix]-title-bar-height) * 1.3);\n    height: 100%;\n    border: none;\n    border-radius: 0;\n    box-sizing: border-box;\n    background-color: transparent;\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\n    cursor: pointer;\n    text-align: center;\n    vertical-align: middle;\n    font-family: sans-serif;\n    transition: background-color 0.2s;\n    touch-action: auto;\n    padding: 0;\n    margin: 0;\n    color: inherit;\n}\n\n.$[prefix]-custom-control-btn > * {\n    pointer-events: none;\n}\n\n.$[prefix]-control-btn:hover {\n    background-color: var(--$[prefix]-control-hover-bg);\n}\n\n.$[prefix]-control-btn.$[prefix]-close-btn:hover {\n    background-color: var(--$[prefix]-control-close-hover-bg);\n    color: var(--$[prefix]-control-close-hover-color);\n}\n\n/* ========================================================================\n    8. メインコンテンツエリア\n   ======================================================================== */\n.$[prefix]-main-content {\n    all: initial;\n    position: relative;\n    display:flex;\n    color: var(--$[prefix]-text-color);\n    flex-direction:column;\n    flex-grow:1;\n    overflow:hidden;\n}\n\n.$[prefix]-content {\n    flex-grow: 1;\n    position: relative;\n    overflow: auto;\n    touch-action: auto;\n}\n\n.$[prefix]-content iframe {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: none;\n}\n\n/* --- ローディングインジケーター --- */\n.$[prefix]-loader-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: var(--$[prefix]-loader-bg);\n    display: none;\n    justify-content: center;\n    align-items: center;\n    z-index: 20;\n}\n@keyframes $[prefix]-spinner-rotation {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n.$[prefix]-loader-spinner {\n    width: 48px;\n    height: 48px;\n    border-radius: 50%;\n    border: 5px solid #fff;\n    border-bottom-color: var(--$[prefix]-loader-color);\n    animation: $[prefix]-spinner-rotation 1s linear infinite;\n}\n\n/* ========================================================================\n    9. メニューバー\n   ======================================================================== */\n.$[prefix]-menu-bar {\n    color: var(--$[prefix]-menu-item-color);\n    display: flex;\n    background-color: var(--$[prefix]-bg);\n    padding: 2px;\n    flex-shrink: 0;\n    border-bottom: 1px solid var(--$[prefix]-border);\n    touch-action: auto;\n}\n\n.$[prefix]-menu-item {\n    font-family: sans-serif;\n    font-size: clamp(0px , calc(var(--winlet-title-bar-height) * 0.6), 14px);\n    padding: 4px 8px;\n    cursor: default;\n    position: relative;\n}\n\n.$[prefix]-menu-item:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n\n/* --- ドロップダウンメニュー --- */\n.$[prefix]-menu-dropdown {\n    color: var(--$[prefix]-menu-item-color);\n    display: none;\n    position: absolute;\n    top: 100%;\n    left: 0;\n    background-color: var(--$[prefix]-menu-bg);\n    border: 1px solid var(--$[prefix]-menu-border);\n    box-shadow: 0 2px 8px var(--$[prefix]-shadow-color-light);\n    list-style: none;\n    margin: 0;\n    padding: 4px 0;\n    min-width: 150px;\n    z-index: 10;\n    touch-action: auto;\n}\n\n.$[prefix]-menu-dropdown li {\n    padding: 0 20px;\n    font-size: 14px;\n    cursor: pointer;\n}\n\n.$[prefix]-menu-dropdown li:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n\n.$[prefix]-menu-dropdown li.$[prefix]-separator {\n    height: 1px;\n    background-color: var(--$[prefix]-menu-border);\n    margin: 4px 0;\n    padding: 0;\n}\n\n.$[prefix]-menu-dropdown-item {\n    display: flex;\n    line-height: 1.6em;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    width: 100%;\n    white-space: nowrap;\n}\n\n/* --- サブメニュー --- */\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu {\n    position: relative;\n}\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu::after {\n    content: '▶';\n    position: absolute;\n    top: 50%;\n    right: 10px;\n    margin-top: calc(var(--winlet-title-bar-height) * -0.5);\n    font-size: 0.8em;\n    color: inherit;\n}\n/**\n * ネストされたサブメニューの表示位置\n */\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu > .$[prefix]-menu-dropdown {\n    top: -5px; /* liのpaddingを考慮 */\n    left: 100%;\n}\n/**\n * サブメニューはホバーで開く\n */\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu:hover > .$[prefix]-menu-dropdown {\n    display: block;\n}\n\n/* --- ショートカットテキスト --- */\n.$[prefix]-shortcut-text {\n    color: var(--$[prefix]-shortcut-text-color);\n    margin-left: 1em;\n}\n.$[prefix]-menu-dropdown li:hover .$[prefix]-shortcut-text {\n    color: inherit;\n}\n\n/* --- タブ --- */\n.$[prefix]-tab-bar {\n    color: var(--$[prefix]-menu-item-color);\n    overflow-x: auto;\n    overflow-y: hidden;\n    -ms-overflow-style: -ms-autohiding-scrollbar;\n    scrollbar-width: thin;\n    display: flex;\n    background-color: var(--$[prefix]-tab-bar-bg);\n    flex-shrink: 0;\n    align-items: flex-end;\n    touch-action: auto;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar{\n    width: 6px;\n    height: 6px;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar-thumb {\n    background-color: var(--$[prefix]-scrollbar-thumb-bg);\n    border-radius: 3px;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar-track {\n    background-color: transparent;\n}\n\n/* --- タブ --- */\n.$[prefix]-tab {\n    white-space: nowrap;\n    padding: 8px 16px;\n    font-family: sans-serif;\n    font-size: 14px;\n    cursor: pointer;\n    border-right: 1px solid var(--$[prefix]-tab-border);\n    background-color: var(--$[prefix]-tab-bg);\n}\n\n.$[prefix]-tab.$[prefix]-active {\n    background-color: var(--$[prefix]-tab-active-bg);\n    border-bottom: 2px solid var(--$[prefix]-title-bar-active-bg);\n}\n\n.$[prefix]-tab.$[prefix]-active .$[prefix]-tab-close-btn:hover {\n    background-color: var(--$[prefix]-tab-active-close-btn-hover-bg);\n}\n\n/**\n * ドラッグ中のタブのスタイル\n */\n.$[prefix]-tab.$[prefix]-dragging {\n    opacity: 0.5;\n}\n\n/* --- タブ関連ボタン --- */\n/**\n * タブの閉じるボタン\n */\n.$[prefix]-tab-close-btn {\n    margin-left: 8px;\n    padding: 0 4px;\n    border-radius: 50%;\n    cursor: pointer;\n    font-weight: bold;\n    font-size: 14px;\n    line-height: 1;\n}\n.$[prefix]-tab-close-btn:hover {\n    background-color: var(--$[prefix]-tab-close-btn-hover-bg);\n}\n\n/**\n * タブ追加ボタン\n */\n.$[prefix]-tab-add-btn {\n    padding: 8px;\n    font-size: 14px;\n    cursor: pointer;\n    border-bottom: 1px solid var(--$[prefix]-tab-border);\n}\n.$[prefix]-tab-add-btn:hover {\n    background-color: var(--$[prefix]-title-bar-bg);\n}\n\n/* --- タブコンテンツ --- */\n.$[prefix]-tab-content {\n    display: none;\n}\n\n.$[prefix]-tab-content.$[prefix]-active {\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n\n/* ========================================================================\n    10. リサイズハンドル\n   ======================================================================== */\n.$[prefix]-resize-handle {\n    position: absolute;\n    z-index: 5;\n    touch-action: none;\n}\n\n.$[prefix]-resize-handle.$[prefix]-n { top: var(--$[prefix]-resize-handle-offset); left: 0; right: 0; height: var(--$[prefix]-resize-handle-size); cursor: n-resize; }\n.$[prefix]-resize-handle.$[prefix]-s { bottom: var(--$[prefix]-resize-handle-offset); left: 0; right: 0; height: var(--$[prefix]-resize-handle-size); cursor: s-resize; }\n.$[prefix]-resize-handle.$[prefix]-w { top: 0; bottom: 0; left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); cursor: w-resize; }\n.$[prefix]-resize-handle.$[prefix]-e { top: 0; bottom: 0; right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); cursor: e-resize; }\n.$[prefix]-resize-handle.$[prefix]-nw { top: var(--$[prefix]-resize-handle-offset); left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: nw-resize; }\n.$[prefix]-resize-handle.$[prefix]-ne { top: var(--$[prefix]-resize-handle-offset); right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: ne-resize; }\n.$[prefix]-resize-handle.$[prefix]-sw { bottom: var(--$[prefix]-resize-handle-offset); left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: sw-resize; }\n.$[prefix]-resize-handle.$[prefix]-se { bottom: var(--$[prefix]-resize-handle-offset); right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: se-resize; }\n\n/* ========================================================================\n    11. コンテキストメニュー\n   ======================================================================== */\n.$[prefix]-context-menu {\n    color: var(--$[prefix]-menu-item-color);\n    pointer-events: all;\n    position: fixed;\n    z-index: 10000;\n    background-color: var(--$[prefix]-menu-bg);\n    border: 1px solid var(--$[prefix]-menu-border);\n    box-shadow: 0 2px 8px var(--$[prefix]-shadow-color-light);\n    list-style: none;\n    margin: 0;\n    padding: 4px 0;\n    min-width: 160px;\n}\n.$[prefix]-context-menu li {\n    padding: 6px 24px;\n    font-family: sans-serif;\n    font-size: 14px;\n    cursor: pointer;\n}\n.$[prefix]-context-menu li:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n.$[prefix]-context-menu li.$[prefix]-separator {\n    height: 1px;\n    background-color: var(--$[prefix]-menu-border);\n    margin: 4px 0;\n    padding: 0;\n}\n\n/* ========================================================================\n    12. ポップアップ\n   ======================================================================== */\n.$[prefix]-popup-window .$[prefix]-content {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding: 20px;\n    box-sizing: border-box;\n}\n.$[prefix]-popup-message {\n    font-family: sans-serif;\n    font-size: 14px;\n    line-height: 1.5;\n    flex-grow: 1;\n    word-wrap: break-word;\n}\n.$[prefix]-popup-buttons {\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n    margin-top: 20px;\n    flex-shrink: 0;\n    touch-action: auto;\n}\n.$[prefix]-popup-button {\n    color: var(--$[prefix]-menu-item-color);\n    min-width: 80px;\n    padding: 8px 12px;\n    margin: 0;\n    border: 1px solid var(--$[prefix]-menu-border);\n    border-radius: 3px;\n    background-color: var(--$[prefix]-bg);\n    cursor: pointer;\n    font-size: 14px;\n    box-shadow: 0 1px 1px var(--$[prefix]-shadow-color-light);\n}\n.$[prefix]-popup-button:hover {\n    border-color: var(--$[prefix]-popup-button-hover-border-color);\n    background-color: var(--$[prefix]-popup-button-hover-bg);\n}\n.$[prefix]-popup-button:active {\n    background-color: var(--$[prefix]-tab-bg);\n}\n\n/* ========================================================================\n    13. 統合スタイル (Merged Styles)\n   ======================================================================== */\n/* --- メニュー/タブ統合時の基本タイトルバー --- */\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-title-bar,\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-title-bar {\n    height: auto;\n    align-items: flex-end;\n    padding: 0;\n}\n\n/* --- メニュー統合スタイル --- */\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-icon {\n    margin-block: auto;\n}\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-title {\n    flex-grow: 1;\n    margin-block: auto;\n}\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-menu-bar {\n    border-bottom: none;\n    background: transparent;\n    padding: 0 6px;\n    align-self: center;\n}\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-menu-item {\n    line-height: var(--$[prefix]-title-bar-height);\n    padding-top: 0;\n    padding-bottom: 0;\n}\n/* アクティブウィンドウの統合メニューの文字色 */\n.$[prefix]-window.$[prefix]-menu-style-merged.$[prefix]-active:not(.$[prefix]-tab-style-merged) .$[prefix]-menu-item {\n    color: var(--winlet-menu-item-hover-color);\n}\n.$[prefix]-window.$[prefix]-menu-style-merged.$[prefix]-active:not(.$[prefix]-tab-style-merged) .$[prefix]-menu-item:hover {\n    background-color: var(--$[prefix]-title-bar-bg);\n    color: var(--$[prefix]-menu-item-color);\n}\n\n/* --- タブ統合スタイル (Chrome風) --- */\n.$[prefix]-window.$[prefix]-tab-style-merged.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar {\n    background-color: var(--$[prefix]-title-bar-bg);\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-title {\n    display: none;\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar {\n    background-color: transparent;\n    flex-grow: 1;\n    flex-shrink: 1;\n    min-width: 0;\n    align-items: flex-end;\n    height: calc(var(--$[prefix]-title-bar-height) + 4px);\n    margin: 0;\n    order: 1; /* controlsより前に配置 */\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar::-webkit-scrollbar{\n    display: none;\n}\n.$[prefix]-window.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-tab-bar {\n    order: -1;\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab {\n    border: 1px solid var(--$[prefix]-border);\n    border-bottom: none;\n    border-radius: 6px 6px 0 0;\n    margin-top: 4px;\n    margin-left: -1px;\n    position: relative;\n    bottom: -1px;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab.$[prefix]-active {\n    background-color: var(--$[prefix]-bg);\n    border-color: var(--$[prefix]-border);\n    border-bottom: 1px solid var(--$[prefix]-bg);\n    z-index: 2;\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-add-btn {\n    border: none;\n    align-self: center;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-main-content {\n    border-top: none;\n}\n\n/* --- 統合時のコントロールボタン --- */\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-controls,\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-controls {\n    align-self: flex-start;\n    order: 2;\n}\n\n/* ========================================================================\n    14. タスクバー\n   ======================================================================== */\n.$[prefix]-taskbar {\n    position: absolute;\n    background-color: var(--$[prefix]-taskbar-bg);\n    box-sizing: border-box;\n    display: flex;\n    align-items: center;\n    padding: 0 5px;\n    z-index: 50000;\n    flex-shrink: 0;\n    display: flex;\n    gap: 5px;\n    overflow: auto;\n    scrollbar-width: none;\n    -ms-overflow-style: none;\n    backdrop-filter: blur(5px);\n    pointer-events: all;\n}\n.$[prefix]-taskbar::-webkit-scrollbar{\n    display: none;\n}\n\n/* --- 位置 --- */\n.$[prefix]-taskbar.$[prefix]-taskbar-bottom {\n    bottom: 0;\n    left: 0;\n    border-top: 1px solid var(--$[prefix]-taskbar-border);\n}\n.$[prefix]-taskbar.$[prefix]-taskbar-top {\n    top: 0;\n    left: 0;\n    border-bottom: 1px solid var(--$[prefix]-taskbar-border);\n}\n.$[prefix]-taskbar.$[prefix]-taskbar-left {\n    top: 0;\n    left: 0;\n    border-right: 1px solid var(--$[prefix]-taskbar-border);\n}\n.$[prefix]-taskbar.$[prefix]-taskbar-right {\n    top: 0;\n    right: 0;\n    border-left: 1px solid var(--$[prefix]-taskbar-border);\n}\n\n.$[prefix]-taskbar.$[prefix]-taskbar-bottom,\n.$[prefix]-taskbar.$[prefix]-taskbar-top {\n    --$[prefix]-taskbar-icon-size: var(--$[prefix]-taskbar-height);\n    width: 100%;\n    height: var(--$[prefix]-taskbar-height);\n    flex-direction: row;\n}\n.$[prefix]-taskbar.$[prefix]-taskbar-left,\n.$[prefix]-taskbar.$[prefix]-taskbar-right {\n    --$[prefix]-taskbar-icon-size: var(--$[prefix]-taskbar-width);\n    width: var(--$[prefix]-taskbar-width);\n    height: 100%;\n    flex-direction: column;\n}\n\n\n.$[prefix]-taskbar-item {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: auto;\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\n    padding: 0 10px;\n    border-radius: 3px;\n    background-color: var(--$[prefix]-taskbar-item-bg);\n    cursor: pointer;\n    flex-shrink: 0;\n    max-width: 150px;\n    transition: background-color 0.2s;\n    font-family: sans-serif;\n    font-size: 14px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    box-sizing: border-box;\n}\n/* 縦向きタスクバーのアイテム */\n.$[prefix]-taskbar.$[prefix]-taskbar-left .$[prefix]-taskbar-item,\n.$[prefix]-taskbar.$[prefix]-taskbar-right .$[prefix]-taskbar-item {\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\n    height: auto;\n    min-height: 40px;\n    max-width: none;\n    padding: 10px 0;\n    writing-mode: vertical-rl;\n}\n\n.$[prefix]-taskbar-item-icon {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.$[prefix]-taskbar-item-icon img {\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\n    object-fit: contain;\n}\n.$[prefix]-taskbar-item-icon i {\n    font-size: calc((var(--winlet-taskbar-icon-size) - 12px) * 0.8);\n    line-height: calc(var(--winlet-taskbar-icon-size) - 18px);\n    text-align: center;\n    object-fit: contain;\n}\n.$[prefix]-taskbar-item.$[prefix]-icon-only {\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\n    padding: 6px;\n}\n/* 縦向きアイコンモード */\n.$[prefix]-taskbar.$[prefix]-taskbar-left .$[prefix]-taskbar-item.$[prefix]-icon-only,\n.$[prefix]-taskbar.$[prefix]-taskbar-right .$[prefix]-taskbar-item.$[prefix]-icon-only {\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\n}\n\n.$[prefix]-taskbar-item.$[prefix]-active {\n    background-color: var(--$[prefix]-taskbar-item-active-bg);\n    color: var(--$[prefix]-taskbar-item-active-color);\n}\n.$[prefix]-taskbar-item.$[prefix]-minimized {\n    opacity: 0.7;\n}\n\n/**\n * 仮想化されたウィンドウを示すタスクバーアイテム\n */\n.$[prefix]-taskbar-item.$[prefix]-virtualized {\n    filter: grayscale(80%);\n    opacity: 0.7;\n    font-style: italic;\n}\n\n/* ========================================================================\n    15. モバイル・タッチデバイス対応\n   ======================================================================== */\n@media (pointer: coarse), (max-width: 768px) {\n    /* リサイズハンドルとコントロールボタンを大きくして操作しやすくする */\n    :root {\n        --$[prefix]-resize-handle-size: 16px;\n        --$[prefix]-resize-handle-offset: -8px;\n    }\n    .$[prefix]-control-btn {\n        width: calc(var(--$[prefix]-title-bar-height) * 1.5);\n    }\n}\n\n/* ========================================================================\n    16. ハイコントラストモード対応\n   ======================================================================== */\n/* high-contrast.tsと合わせる */\n@media (prefers-contrast: more) {\n    .$[prefix]-window,\n    .$[prefix]-window.$[prefix]-active {\n        box-shadow: none;\n    }\n    .$[prefix]-window.$[prefix]-active {\n        border: 2px solid var(--$[prefix]-title-bar-active-bg);\n    }\n}\n\n/* ========================================================================\n    17. アニメーション無効化\n   ======================================================================== */\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window,\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-minimized,\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-maximized,\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-is-restoring {\n    transition: none;\n}\n\n/* ========================================================================\n    18. デバッグモード\n   ======================================================================== */\n.$[prefix]-debug-overlay {\n    display: none;\n    position: absolute;\n    top: calc(var(--$[prefix]-title-bar-height) + 5px);\n    left: 5px;\n    background: rgba(0,0,0,0.5);\n    color: #fff;\n    padding: 5px;\n    border-radius: 3px;\n    font-family: monospace;\n    font-size: 12px;\n    line-height: 1.4;\n    pointer-events: none;\n    z-index: 100;\n    white-space: pre;\n}\n\n.$[prefix]-container.$[prefix]-debug-mode-enabled .$[prefix]-debug-overlay {\n    display: block;\n}\n`;\n\nexport default styleData;\n","// src/themes/dark.ts\nimport { Theme } from \"../../const/types\";\n\nexport const darkTheme: Theme = {\n\tname: \"dark\",\n\tvariables: {\n\t\t// 基本色・シャドウ\n\t\t\"--$[prefix]-text-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-bg\": \"#2d2d2d\",\n\t\t\"--$[prefix]-border\": \"#555\",\n\t\t\"--$[prefix]-shadow-color-light\": \"rgba(0,0,0,0.3)\",\n\t\t\"--$[prefix]-shadow-color-strong\": \"rgba(0,0,0,0.5)\",\n\t\t\"--$[prefix]-shadow-color-active\": \"rgba(0,0,0,0.7)\",\n\n\t\t// タイトルバー\n\t\t\"--$[prefix]-title-bar-bg\": \"#3c3c3c\",\n\t\t\"--$[prefix]-title-text-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-title-text-active-color\": \"#fff\",\n\n\t\t// コントロールボタン\n\t\t\"--$[prefix]-control-bg\": \"#4a4a4a\",\n\t\t\"--$[prefix]-control-hover-bg\": \"#5a5a5a\",\n\n\t\t// メニュー\n\t\t\"--$[prefix]-menu-bg\": \"#252525\",\n\t\t\"--$[prefix]-menu-border\": \"#444\",\n\t\t\"--$[prefix]-menu-item-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-shortcut-text-color\": \"#b0b0b0\",\n\n\t\t// タブ\n\t\t\"--$[prefix]-tab-bg\": \"#383838\",\n\t\t\"--$[prefix]-tab-active-bg\": \"#2d2d2d\",\n\t\t\"--$[prefix]-tab-border\": \"#505050\",\n\t\t\"--$[prefix]-tab-bar-bg\": \"#383838\",\n\t\t\"--$[prefix]-tab-close-btn-hover-bg\": \"#5a5a5a\",\n\t\t\"--$[prefix]-tab-active-close-btn-hover-bg\": \"#6a6a6a\",\n\n\t\t// ポップアップボタン\n\t\t\"--$[prefix]-popup-button-hover-bg\": \"#5a5a5a\",\n\t\t\"--$[prefix]-popup-button-hover-border-color\": \"#777\",\n\n\t\t// タスクバー\n\t\t\"--$[prefix]-taskbar-bg\": \"rgba(45, 45, 45, 0.9)\",\n\t\t\"--$[prefix]-taskbar-border\": \"#555\",\n\t\t\"--$[prefix]-taskbar-item-bg\": \"#5a5a5a\",\n\n\t\t// その他\n\t\t\"--$[prefix]-scrollbar-thumb-bg\": \"rgba(180, 180, 180, 0.5)\",\n\t},\n};\n","// src/themes/default.ts\nimport { Theme } from \"../../const/types\";\n\nexport const defaultTheme: Theme = {\n\tname: \"default\",\n\tvariables: {\n\t\t// 基本色・シャドウ\n\t\t\"--$[prefix]-text-color\": \"#000\",\n\t\t\"--$[prefix]-bg\": \"#f0f0f0\",\n\t\t\"--$[prefix]-border\": \"#a0a0a0\",\n\t\t\"--$[prefix]-shadow-color-light\": \"rgba(0,0,0,0.15)\",\n\t\t\"--$[prefix]-shadow-color-strong\": \"rgba(0,0,0,0.3)\",\n\t\t\"--$[prefix]-shadow-color-active\": \"rgba(0,0,0,0.45)\",\n\n\t\t// タイトルバー\n\t\t\"--$[prefix]-title-bar-bg\": \"#e0e0e0\",\n\t\t\"--$[prefix]-title-bar-active-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-title-text-color\": \"#000\",\n\t\t\"--$[prefix]-title-text-active-color\": \"#fff\",\n\n\t\t// コントロールボタン\n\t\t\"--$[prefix]-control-bg\": \"#d0d0d0\",\n\t\t\"--$[prefix]-control-hover-bg\": \"#e5e5e5\",\n\t\t\"--$[prefix]-control-close-hover-bg\": \"#e81123\",\n\t\t\"--$[prefix]-control-close-hover-color\": \"#fff\",\n\n\t\t// メニュー\n\t\t\"--$[prefix]-menu-bg\": \"#fff\",\n\t\t\"--$[prefix]-menu-border\": \"#ccc\",\n\t\t\"--$[prefix]-menu-item-color\": \"#000\",\n\t\t\"--$[prefix]-menu-item-hover-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-menu-item-hover-color\": \"#fff\",\n\t\t\"--$[prefix]-shortcut-text-color\": \"#666\",\n\n\t\t// タブ\n\t\t\"--$[prefix]-tab-bg\": \"#dcdcdc\",\n\t\t\"--$[prefix]-tab-active-bg\": \"#f0f0f0\",\n\t\t\"--$[prefix]-tab-border\": \"#b0b0b0\",\n\t\t\"--$[prefix]-tab-bar-bg\": \"#e1e1e1\",\n\t\t\"--$[prefix]-tab-close-btn-hover-bg\": \"#ccc\",\n\t\t\"--$[prefix]-tab-active-close-btn-hover-bg\": \"#ddd\",\n\n\t\t// ポップアップボタン\n\t\t\"--$[prefix]-popup-button-hover-bg\": \"#e9e9e9\",\n\t\t\"--$[prefix]-popup-button-hover-border-color\": \"#bbb\",\n\n\t\t// タスクバー\n\t\t\"--$[prefix]-taskbar-bg\": \"rgba(240, 240, 240, 0.9)\",\n\t\t\"--$[prefix]-taskbar-border\": \"#a0a0a0\",\n\t\t\"--$[prefix]-taskbar-item-bg\": \"#d0d0d0\",\n\t\t\"--$[prefix]-taskbar-item-active-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-taskbar-item-active-color\": \"#fff\",\n\n\t\t/* ローディングインジケーター */\n\t\t\"--$[prefix]-loader-bg\": \"rgba(255, 255, 255, 0.7)\",\n\t\t\"--$[prefix]-loader-color\": \"var(--$[prefix]-title-bar-active-bg)\",\n\n\t\t// その他\n\t\t\"--$[prefix]-scrollbar-thumb-bg\": \"rgba(100, 100, 100, 0.5)\",\n\t},\n};\n","import { Theme } from \"../../const/types\";\n\n/**\n * 高コントラストテーマ\n * @see https://github.com/hi2ma-bu4/winlet/blob/main/src/style/style.ts (prefers-contrast: more)\n */\nexport const highContrastTheme: Theme = {\n\tname: \"high-contrast\",\n\tvariables: {\n\t\t// 基本色・シャドウ\n\t\t\"--$[prefix]-text-color\": \"#fff\",\n\t\t\"--$[prefix]-bg\": \"#000\",\n\t\t\"--$[prefix]-border\": \"#fff\",\n\t\t\"--$[prefix]-shadow-color-light\": \"transparent\",\n\t\t\"--$[prefix]-shadow-color-strong\": \"transparent\",\n\t\t\"--$[prefix]-shadow-color-active\": \"transparent\",\n\n\t\t// タイトルバー\n\t\t\"--$[prefix]-title-bar-bg\": \"#000\",\n\t\t\"--$[prefix]-title-bar-active-bg\": \"#0000ff\",\n\t\t\"--$[prefix]-title-text-color\": \"#fff\",\n\t\t\"--$[prefix]-title-text-active-color\": \"#000\",\n\n\t\t// コントロールボタン\n\t\t\"--$[prefix]-control-bg\": \"#000\",\n\t\t\"--$[prefix]-control-hover-bg\": \"#444\",\n\t\t\"--$[prefix]-control-close-hover-bg\": \"#ff0000\",\n\t\t\"--$[prefix]-control-close-hover-color\": \"#fff\",\n\n\t\t// メニュー\n\t\t\"--$[prefix]-menu-bg\": \"#000\",\n\t\t\"--$[prefix]-menu-border\": \"#fff\",\n\t\t\"--$[prefix]-menu-item-color\": \"#fff\",\n\t\t\"--$[prefix]-menu-item-hover-bg\": \"#0000ff\",\n\t\t\"--$[prefix]-menu-item-hover-color\": \"#fff\",\n\n\t\t// タブ\n\t\t\"--$[prefix]-tab-bg\": \"#000\",\n\t\t\"--$[prefix]-tab-active-bg\": \"#000\",\n\t\t\"--$[prefix]-tab-border\": \"#fff\",\n\n\t\t// タスクバー\n\t\t\"--$[prefix]-taskbar-bg\": \"rgba(0, 0, 0, 0.9)\",\n\t\t\"--$[prefix]-taskbar-border\": \"#fff\",\n\t\t\"--$[prefix]-taskbar-item-bg\": \"#000\",\n\t\t\"--$[prefix]-taskbar-item-active-bg\": \"#0000ff\",\n\t\t\"--$[prefix]-taskbar-item-active-color\": \"#fff\",\n\t},\n};\n","// このファイルは自動生成されます\nexport const LIB_VERSION = \"v1.0.2.0\";\n"],"mappings":"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","ignoreList":[]}