{"version":3,"file":"winlet.min.js","names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","module","Array","__esModule","isArray","arrayLikeToArray","ReferenceError","TypeError","isNativeReflectConstruct","setPrototypeOf","Reflect","construct","apply","arguments","push","bind","prototype","toPropertyKey","_defineProperties","enumerable","configurable","writable","Object","defineProperty","key","value","_getPrototypeOf","getPrototypeOf","__proto__","create","constructor","default","Function","toString","indexOf","_isNativeReflectConstruct","Boolean","valueOf","Symbol","iterator","from","l","next","done","_typeof","assertThisInitialized","_setPrototypeOf","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arrayWithoutHoles","iterableToArray","nonIterableSpread","toPrimitive","String","Number","slice","name","test","isNativeFunction","_wrapNativeSuper","Map","has","get","set","Wrapper","this","defaultConfig","id","ifExists","title","icon","x","y","width","height","minWidth","minHeight","windowOptions","resizableX","resizableY","movable","closable","minimizable","maximizable","maximizableOnDblClick","focus","alwaysOnTop","useGhostWindow","opacity","modal","content","html","iframe","src","srcdoc","allow","referrerPolicy","loading","sandbox","loadWinLet","template","menu","menuStyle","tabs","tabStyle","tabOptions","reorderable","addable","detachable","mergeable","allowIncomingMerge","onAdd","undefined","onMergeAttempt","taskbarOptions","showIconOnly","contextMenu","enableShortcuts","controlsPosition","showLoadingIndicator","onOpen","onClose","onFocus","onBlur","onResize","onMove","onReload","_isPopup","_parent","_taskbarItem","WinLetBaseError","_Error","message","_this","_classCallCheck2","_callSuper","BuiltInError","captureStackTrace","_inherits2","_createClass2","_wrapNativeSuper2","SimpleError","_WinLetBaseError","WinLetError","_SimpleError","LIBRARY_NAME","TIMEOUT_RESULT","CLOSE_BUTTON_RESULT","_config","_errors","_types","_baseclass","_interopRequireDefault","_utils","_window_manager","_WinLetBaseClass","WinLetWindow","options","manager","_getPrototypeOf2","_possibleConstructorReturn2","_defineProperty2","generateId","concat","existingEl","document","getElementById","classList","contains","deepMerge","deepCopy","parentWindow","el","createDOM","add","setAttribute","titleBarEl","querySelector","iconEl","titleEl","mainContentEl","contentEl","loaderEl","applyOptions","setupEventListeners","windowEl","createElement","className","state","handles","resizableHandlesHTML","join","hasMenu","hasTabs","isMergedMenu","isMergedTabs","controlsHTML","titleBarContentHTML","loaderHTML","innerHTML","setTitle","setIcon","setSize","style","createTabs","renderContent","createMenu","display","container","_this2","hideLoader","tagName","appendChild","cloneNode","console","warn","isNonEmptyObject","showLoader","iframeConfig","finalSrcDoc","globalConfig","getGlobalConfig","libraryPath","scriptTag","addEventListener","querySelectorAll","forEach","dd","isMenuOpen","_this3","menuBar","menuItemData","_menuItemData$name","menuItemEl","textContent","items","dropdownEl","createDropdownMenu","stopPropagation","isVisible","closeAllMenus","_this4","itemData","itemEl","separator","_itemData$name","text","shortcut","_itemData$action","action","subMenuEl","_this$options$tabOpti","_this5","tabBar","tabOpts","tabData","index","createTabElement","addTabBtn","_tabOpts$onAdd","newTabItem","addTab","setupTabBarDropZone","activateTab","_this6","_e$dataTransfer","dataTransfer","types","includes","preventDefault","dropEffect","remove","_e$dataTransfer2","_e$dataTransfer3","_e$dataTransfer4","_this6$manager$contai","tabDataJSON","getData","sourceWindowId","sourceTabId","draggingEl","sourceWindow","getWindow","_sourceOpts$mergeable","_targetOpts$allowInco","sourceOpts","targetOpts","isMergeable","allowsIncoming","customFilterPassed","JSON","parse","closeTab","parseInt","updateTabOrderFromDOM","_this$options$tabOpti2","_this7","tabEl","dataset","tabId","insertBefore","closeBtn","indexToClose","findIndex","tabContentEl","splice","makeTabReorderable","_this8","draggable","setData","tabIndex","isNaN","stringify","onTabDragStart","onTabDragEnd","_this8$manager$draggi","draggingTabInfo","rect","getBoundingClientRect","isAfter","clientX","left","parent","parentNode","nextSibling","passive","_this$tabs$index","wasActive","tab","newActiveIndex","Math","max","close","toggle","tabItem","setActive","newIndex","tabElements","newTabs","newOptionsTabs","oldTabs","_toConsumableArray2","oldOptionsTabs","oldIndex","_this9","boundGlobalClickHandler","_this9$popupCloseCall","popupCloseCallback","maxBtn","toggleMaximize","minBtn","minimize","makeMovable","makeResizable","showContextMenu","clientY","pointerType","contextMenuTimer","window","setTimeout","MOBILE_CONTEXT_MENU_TIMEOUT","clearContextMenuTimer","clearTimeout","_this0","target","closest","button","initialLeft","initialTop","_this0$manager$contai","startX","startY","isDragging","ghostEl","offsetLeft","top","offsetTop","offsetWidth","offsetHeight","onPointerMove","moveE","_this0$el","isConnected","deltaX","abs","deltaY","DRAG_THRESHOLD","setPointerCapture","pointerId","pointerEvents","restoredWidth","lastState","clickRatio","titleBarRect","offsetY","posX","posY","restore","setPosition","newLeft","newTop","_onPointerUp","removeEventListener","releasePointerCapture","_this1","handle","_this1$manager$contai","direction","replace","_this1$el","startWidth","startHeight","startLeft","startTop","_this1$options","newWidth","newHeight","_onPointerUp2","classStr","classes","trim","split","hasPrefix","some","hasIcon","destroyWindow","_this10","doMinimize","updateTaskbarItem","blur","enableAnimations","once","maximize","_this11","doMaximize","_this12","wasMinimized","removeAttribute","doRestore","focused","focusWindow","_this13","_this14","reloadContent","_iframe$contentWindow","contentWindow","location","reload","activeTabIndex","activeTab","tabContentOptions","contentContainer","childManager","applyGlobalConfig","init","type","postMessage","getChildManager","createWindow","winOptions","popup","assign","sanitizeHTML","isFontAwesome","img","alt","finalX","finalY","parentRect","winWidth","winHeight","min","clampedOpacity","getPosition","getSize","setOpacity","_styles","_dark","_default","_window2","_createForOfIteratorHelper","_arrayLikeToArray","_unsupportedIterableToArray","_n","F","s","WindowManager","initialConfig","registerTheme","defaultTheme","darkTheme","_isInitialized","enableTaskbar","taskbarEl","createTaskbar","updateTaskbarLayout","flexDirection","parentEl","HTMLElement","body","styleTag","getStyleData","head","containerEl","workspaceEl","getComputedStyle","position","theme","setTheme","requestAnimationFrame","activeEl","activeElement","winEl","win","windows","activeWindow","clickedWindow","clickedContextMenu","clickedTaskbar","active","hideContextMenu","event","data","_typeof2","_step","isSourceValid","_iterator","values","source","err","origin","setupShortcutListeners","newTab","mergedWindowOptions","_targetWindow$options","_targetWindow$options2","windowSwitchShortcut","parseShortcut","toLowerCase","ctrlKey","ctrl","altKey","shiftKey","shift","currentIndex","w","targetWindow","startsWith","keyNum","numTabs","getTabs","_findAndExecShortcut","menuItems","_step2","_iterator2","item","_item$action","_shortcut","toUpperCase","replaceStringVariable","str","_options$ifExists","ensureInitialized","existingWindow","creationOptions","nextX","nextY","containerRect","lastAutoPosition","CASCADE_OFFSET","allWindows","createTaskbarItem","zIndex","zIndexCounterOnTop","zIndexCounter","_options$modal","_options$alwaysOnTop","_options$focus","buttons","buttonPresets","Ok","OkCancel","Yes","YesNo","YesNoCancel","Retry","RetryCancel","AbortRetryIgnore","timeoutId","closeCallback","result","_options$onClose","messageHTML","buttonsHTML","map","btn","contentHTML","autoWidth","_this$workspaceEl","_this$workspaceEl2","temp","visibility","whiteSpace","removeChild","winPosition","lastPopupPosition","timeout","deactivateFocusTrap","nextWin","pop","_this$activeWindow","_win$options$_taskbar","enableFocusTrapping","activateFocusTrap","_w$options$_taskbarIt","element","_this$workspaceEl3","_this$workspaceEl4","contextWindow","contextMenuEl","_this$contextMenuEl","menuWidth","menuHeight","_window","screenWidth","innerWidth","screenHeight","innerHeight","_this$contextMenuEl2","themes","keys","themeObj","activeTheme","_i","_Object$entries","entries","variables","_Object$entries$_i","_slicedToArray2","removeProperty","_i2","_Object$entries2","_Object$entries2$_i","_key","_value","setProperty","taskbar","order","paddingTop","paddingBottom","paddingLeft","paddingRight","computedStyle","taskbarHeight","taskbarWidth","getTitle","windowId","updateTaskbarItemContent","_win$options","boundTabPressHandler","focusableElements","filter","hasAttribute","nextIndex","_document","_version","currentScript","api","setGlobalConfig","createPopup","getWindowFromElement","getActiveWindow","setDefaultConfig","isInitialized","getRegisteredThemes","getTheme","version","LIB_VERSION","POPUP_TIMEOUT_RESULT","POPUP_CLOSE_BUTTON_RESULT","WinLet","WinLetBaseClass","ownKeys","getOwnPropertySymbols","getOwnPropertyDescriptor","Utils","random","substring","seen","WeakMap","Date","getTime","copiedMap","v","k","Set","copiedSet","arrCopy","copiedObj","hasOwnProperty","output","getOwnPropertyDescriptors","defineProperties","_objectSpread","sourceValue","targetValue","obj","_"],"sources":["node_modules/browser-pack/_prelude.js","node_modules/@babel/runtime/helpers/arrayLikeToArray.js","node_modules/@babel/runtime/helpers/arrayWithHoles.js","node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","node_modules/@babel/runtime/helpers/assertThisInitialized.js","node_modules/@babel/runtime/helpers/classCallCheck.js","node_modules/@babel/runtime/helpers/construct.js","node_modules/@babel/runtime/helpers/createClass.js","node_modules/@babel/runtime/helpers/defineProperty.js","node_modules/@babel/runtime/helpers/getPrototypeOf.js","node_modules/@babel/runtime/helpers/inherits.js","node_modules/@babel/runtime/helpers/interopRequireDefault.js","node_modules/@babel/runtime/helpers/isNativeFunction.js","node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js","node_modules/@babel/runtime/helpers/iterableToArray.js","node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","node_modules/@babel/runtime/helpers/nonIterableRest.js","node_modules/@babel/runtime/helpers/nonIterableSpread.js","node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","node_modules/@babel/runtime/helpers/setPrototypeOf.js","node_modules/@babel/runtime/helpers/slicedToArray.js","node_modules/@babel/runtime/helpers/toConsumableArray.js","node_modules/@babel/runtime/helpers/toPrimitive.js","node_modules/@babel/runtime/helpers/toPropertyKey.js","node_modules/@babel/runtime/helpers/typeof.js","node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","node_modules/@babel/runtime/helpers/wrapNativeSuper.js","src/const/config.ts","src/const/errors.ts","src/const/types.ts","src/function/window.ts","src/function/window_manager.ts","src/index.ts","src/libs/baseclass.ts","src/libs/utils.ts","src/style/styles.ts","src/style/themes/dark.ts","src/style/themes/default.ts","src/version.ts"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nmodule.exports = _arrayWithHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return arrayLikeToArray(r);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var isNativeReflectConstruct = require(\"./isNativeReflectConstruct.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _construct(t, e, r) {\n  if (isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments);\n  var o = [null];\n  o.push.apply(o, e);\n  var p = new (t.bind.apply(t, o))();\n  return r && setPrototypeOf(p, r.prototype), p;\n}\nmodule.exports = _construct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _getPrototypeOf(t) {\n  return module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _getPrototypeOf(t);\n}\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _interopRequireDefault(e) {\n  return e && e.__esModule ? e : {\n    \"default\": e\n  };\n}\nmodule.exports = _interopRequireDefault, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _isNativeFunction(t) {\n  try {\n    return -1 !== Function.toString.call(t).indexOf(\"[native code]\");\n  } catch (n) {\n    return \"function\" == typeof t;\n  }\n}\nmodule.exports = _isNativeFunction, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (module.exports = _isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _isNativeReflectConstruct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nmodule.exports = _iterableToArrayLimit, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableRest, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _setPrototypeOf(t, e) {\n  return module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _setPrototypeOf(t, e);\n}\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableRest = require(\"./nonIterableRest.js\");\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nmodule.exports = _slicedToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(r) {\n  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var getPrototypeOf = require(\"./getPrototypeOf.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nvar isNativeFunction = require(\"./isNativeFunction.js\");\nvar construct = require(\"./construct.js\");\nfunction _wrapNativeSuper(t) {\n  var r = \"function\" == typeof Map ? new Map() : void 0;\n  return module.exports = _wrapNativeSuper = function _wrapNativeSuper(t) {\n    if (null === t || !isNativeFunction(t)) return t;\n    if (\"function\" != typeof t) throw new TypeError(\"Super expression must either be null or a function\");\n    if (void 0 !== r) {\n      if (r.has(t)) return r.get(t);\n      r.set(t, Wrapper);\n    }\n    function Wrapper() {\n      return construct(t, arguments, getPrototypeOf(this).constructor);\n    }\n    return Wrapper.prototype = Object.create(t.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    }), setPrototypeOf(Wrapper, t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _wrapNativeSuper(t);\n}\nmodule.exports = _wrapNativeSuper, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","import { WindowOptions } from \"./types\";\n\n// Partial<WindowOptions>ではなく、全てのキーを定義して型安全にする\nexport const defaultConfig: Required<WindowOptions> = {\n\tid: null,\n\tifExists: \"focus\",\n\ttitle: \"New Window\",\n\ticon: null,\n\tx: \"auto\",\n\ty: \"auto\",\n\twidth: 500,\n\theight: 400,\n\tminWidth: 200,\n\tminHeight: 150,\n\twindowOptions: {\n\t\tresizableX: true,\n\t\tresizableY: true,\n\t\tmovable: true,\n\t\tclosable: true,\n\t\tminimizable: true,\n\t\tmaximizable: true,\n\t\tmaximizableOnDblClick: true,\n\t\tfocus: true,\n\t\talwaysOnTop: false,\n\t\tuseGhostWindow: false,\n\t\topacity: 1.0,\n\t\tmodal: false,\n\t},\n\tcontent: {\n\t\thtml: \"\",\n\t\tiframe: {\n\t\t\tsrc: \"\",\n\t\t\tsrcdoc: \"\",\n\t\t\tallow: \"\",\n\t\t\treferrerPolicy: \"\",\n\t\t\tloading: \"lazy\",\n\t\t\tsandbox: \"\",\n\t\t\tloadWinLet: false,\n\t\t},\n\t\ttemplate: \"\",\n\t},\n\tmenu: [],\n\tmenuStyle: \"default\",\n\ttabs: [],\n\ttabStyle: \"default\",\n\ttabOptions: {\n\t\treorderable: false,\n\t\tclosable: false,\n\t\taddable: false,\n\t\tdetachable: false,\n\t\tmergeable: false,\n\t\tallowIncomingMerge: false,\n\t\tonAdd: undefined,\n\t\tonMergeAttempt: undefined,\n\t},\n\ttaskbarOptions: {\n\t\tshowIconOnly: true,\n\t},\n\tcontextMenu: [],\n\tenableShortcuts: true,\n\tcontrolsPosition: \"right\",\n\tshowLoadingIndicator: true,\n\tonOpen: () => {},\n\tonClose: () => {},\n\tonFocus: () => {},\n\tonBlur: () => {},\n\tonResize: () => {},\n\tonMove: () => {},\n\tonReload: () => {},\n\n\t_isPopup: false,\n\t_parent: null,\n\t_taskbarItem: null,\n};\n","interface ErrorConstructor {\n\tcaptureStackTrace?(targetObject: object, constructorOpt?: Function): void;\n}\n\n/**\n * すべてのカスタムエラーの基底クラス\n */\nexport class WinLetBaseError extends Error {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t\tthis.name = this.constructor.name;\n\n\t\tconst BuiltInError: ErrorConstructor = Error as ErrorConstructor;\n\t\tif (BuiltInError.captureStackTrace) {\n\t\t\tBuiltInError.captureStackTrace(this, this.constructor);\n\t\t}\n\t}\n}\n\n/**\n * 単純なメッセージのみのエラー\n */\nexport class SimpleError extends WinLetBaseError {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t}\n}\n\nexport class WinLetError extends SimpleError {}\n","export const LIBRARY_NAME = \"winlet\";\n\nexport type WindowState = \"normal\" | \"minimized\" | \"maximized\";\n\nexport interface WindowContentOptions {\n\t/**\n\t * 直接埋め込むHTML\n\t */\n\thtml?: string;\n\t/**\n\t * iframe設定\n\t */\n\tiframe?: {\n\t\tsrc?: HTMLIFrameElement[\"src\"];\n\t\tsrcdoc?: HTMLIFrameElement[\"srcdoc\"];\n\t\tallow?: HTMLIFrameElement[\"allow\"];\n\t\treferrerPolicy?: HTMLIFrameElement[\"referrerPolicy\"];\n\t\tloading?: HTMLIFrameElement[\"loading\"];\n\t\tsandbox?: string[] | string;\n\t\t/**\n\t\t * srcdocで生成されるiframe内にWinLetライブラリ自身を読み込むかどうか。\n\t\t * trueにする場合、GlobalConfigOptionsでlibraryPathを指定する必要があります。\n\t\t */\n\t\tloadWinLet?: boolean;\n\t};\n\t/**\n\t * HTMLテンプレートのselector\n\t */\n\ttemplate?: string;\n}\n\n// IWindowインターフェースを先に定義することで循環参照を回避\nexport interface IWindow {\n\treadonly id: string;\n\toptions: Required<WindowOptions>;\n\tel: HTMLElement;\n\tstate: WindowState;\n\n\t// --- Public API ---\n\t/**\n\t * ウィンドウを閉じます。\n\t */\n\tclose(): void;\n\t/**\n\t * ウィンドウを最小化します。\n\t */\n\tminimize(): void;\n\t/**\n\t * ウィンドウを最大化/元に戻します。\n\t */\n\ttoggleMaximize(): void;\n\t/**\n\t * ウィンドウを最大化します。\n\t */\n\tmaximize(): void;\n\t/**\n\t * ウィンドウを元に戻します。\n\t */\n\trestore(): void;\n\t/**\n\t * ウィンドウをフォーカスします。\n\t */\n\tfocus(): void;\n\t/**\n\t * ウィンドウからフォーカスを外します。\n\t */\n\tblur(): void;\n\t/**\n\t * 注意を引くためにウィンドウを揺らします。\n\t */\n\tshake(): void;\n\tgetTitle(): string;\n\tsetTitle(title: string): void;\n\tsetIcon(icon: string | null): void;\n\tgetPosition(): { x: number; y: number };\n\tsetPosition(x: number | \"center\" | \"left\" | \"right\" | \"auto\", y: number | \"center\" | \"top\" | \"bottom\" | \"auto\"): void;\n\tgetSize(): { width: number; height: number };\n\tsetSize(width: number | string, height: number | string): void;\n\t/**\n\t * ウィンドウの不透明度を設定します。\n\t * @param opacity 0.0 (透明) から 1.0 (不透明) の間の値\n\t */\n\tsetOpacity(opacity: number): void;\n\t/**\n\t * 現在のウィンドウの不透明度を取得します。\n\t * @returns 0.0 から 1.0 の間の値\n\t */\n\treload(): void;\n\n\t/**\n\t * ウィンドウのコンテンツ要素（またはiframe要素）を取得します。\n\t * @returns コンテンツを内包するHTMLElement、またはiframeウィンドウの場合はHTMLIFrameElement\n\t */\n\tgetContent(): HTMLElement | HTMLIFrameElement;\n\n\t/**\n\t * このウィンドウの内部に新しいウィンドウを作成します。\n\t * @param options - 新しいウィンドウのオプション\n\t * @returns 作成されたIWindowインスタンス\n\t */\n\tcreateWindow(options?: WindowOptions): IWindow;\n\n\t/**\n\t * このウィンドウの内部に新しいポップアップを作成します。\n\t * @param options - 新しいポップアップのオプション\n\t * @returns 作成されたIWindowインスタンス\n\t */\n\tcreatePopup(options: PopupOptions): IWindow;\n\n\t/**\n\t * ウィンドウのオプションを動的に変更します。\n\t *\n\t * (初期化時に使用されるオプションは変更されず、警告なども出力されません。)\n\t *\n\t * @param options - 変更したいオプション\n\t */\n\tsetOptions(options: Partial<WindowOptions>): void;\n}\n\nexport interface MenuItem {\n\tname?: string;\n\taction?: (win: IWindow) => void;\n\titems?: MenuItem[];\n\tseparator?: boolean;\n\tshortcut?: string;\n}\n\nexport interface TabItem {\n\ttitle: string;\n\tcontent: WindowContentOptions;\n}\n\nexport interface ContextMenuItem {\n\tname?: string;\n\taction?: (win: IWindow) => void;\n\tseparator?: boolean;\n}\n\nexport interface WindowOptions {\n\t/**\n\t * ウィンドウのID\n\t */\n\tid?: string | null;\n\t/**\n\t * 既に同名のウィンドウが存在する場合の動作\n\t *\n\t * focus (デフォルト): 既存のウィンドウを復元し、フォーカスします。\n\t * prevent: 新しいウィンドウを作成せず、処理を中断します。\n\t * create: IDの重複を無視して、常に新しいウィンドウを作成します。\n\t */\n\tifExists?: \"focus\" | \"prevent\" | \"create\";\n\t/**\n\t * ウィンドウのタイトル\n\t */\n\ttitle?: string;\n\t/**\n\t * ウィンドウのアイコン\n\t *\n\t * url / font-awesomeのクラス名の指定可能\n\t */\n\ticon?: string | null;\n\t/**\n\t * ウィンドウのX座標\n\t */\n\tx?: number | \"center\" | \"left\" | \"right\" | \"auto\";\n\t/**\n\t * ウィンドウのY座標\n\t */\n\ty?: number | \"center\" | \"top\" | \"bottom\" | \"auto\";\n\t/**\n\t * ウィンドウのサイズX\n\t */\n\twidth?: number;\n\t/**\n\t * ウィンドウのサイズY\n\t */\n\theight?: number;\n\t/**\n\t * ウィンドウの最小サイズX\n\t */\n\tminWidth?: number;\n\t/**\n\t * ウィンドウの最小サイズY\n\t */\n\tminHeight?: number;\n\t/**\n\t * ウィンドウのオプション\n\t */\n\twindowOptions?: {\n\t\t/**\n\t\t * 水平方向のリサイズ\n\t\t */\n\t\tresizableX?: boolean;\n\t\t/**\n\t\t * 垂直方向のリサイズ\n\t\t */\n\t\tresizableY?: boolean;\n\t\t/**\n\t\t * ウィンドウの移動\n\t\t */\n\t\tmovable?: boolean;\n\t\t/**\n\t\t * ウィンドウを閉じるボタンの表示\n\t\t */\n\t\tclosable?: boolean;\n\t\t/**\n\t\t * ウィンドウを最小化するボタンの表示\n\t\t */\n\t\tminimizable?: boolean;\n\t\t/**\n\t\t * ウィンドウを最大化するボタンの表示\n\t\t */\n\t\tmaximizable?: boolean;\n\t\t/**\n\t\t * タイトルバーのダブルクリックで最大化\n\t\t */\n\t\tmaximizableOnDblClick?: boolean;\n\t\t/**\n\t\t * ウィンドウを常に最前面に表示するかどうか\n\t\t */\n\t\talwaysOnTop?: boolean;\n\t\t/**\n\t\t * ドラッグ・リサイズ時にゴーストウィンドウ（輪郭）を表示するか\n\t\t */\n\t\tuseGhostWindow?: boolean;\n\t\t/**\n\t\t * 作成時にウィンドウにフォーカスを当てるか\n\t\t */\n\t\tfocus?: boolean;\n\t\t/**\n\t\t * ウィンドウの不透明度 (0.0 - 1.0)\n\t\t */\n\t\topacity?: number;\n\t\t/**\n\t\t * ウィンドウをモーダルとして扱うか\n\t\t * trueの場合、このウィンドウ以外は操作できなくなります。\n\t\t */\n\t\tmodal?: boolean;\n\t};\n\t/**\n\t * ウィンドウのコンテンツ\n\t */\n\tcontent?: WindowContentOptions;\n\t/**\n\t * メニュー\n\t */\n\tmenu?: MenuItem[];\n\t/**\n\t * メニューの表示形式\n\t * - default: 通常のメニューバー\n\t * - merged: タイトルバーに統合\n\t */\n\tmenuStyle?: \"default\" | \"merged\";\n\t/**\n\t * タブ\n\t */\n\ttabs?: TabItem[];\n\t/**\n\t * タブの表示形式\n\t * - default: 通常のタブバー\n\t * - merged: タイトルバーに統合されたChrome風タブ\n\t */\n\ttabStyle?: \"default\" | \"merged\";\n\ttabOptions?: {\n\t\t/**\n\t\t * タブの入れ替え\n\t\t */\n\t\treorderable?: boolean;\n\t\t/**\n\t\t * タブを閉じるボタン\n\t\t */\n\t\tclosable?: boolean;\n\t\t/**\n\t\t * タブ追加ボタン\n\t\t */\n\t\taddable?: boolean;\n\t\t/**\n\t\t * タブをドラッグして新しいウィンドウとして分離できるようにするか\n\t\t */\n\t\tdetachable?: boolean;\n\t\t/**\n\t\t * タブを別の既存のウィンドウにマージすることができます。\n\t\t */\n\t\tmergeable?: boolean;\n\t\t/**\n\t\t * このウィンドウが他のウィンドウからマージされたタブを受け入れることができます。\n\t\t */\n\t\tallowIncomingMerge?: boolean;\n\t\t/**\n\t\t * 追加ボタン押下時の処理\n\t\t */\n\t\tonAdd?: (win: IWindow) => TabItem;\n\t\t/**\n\t\t * マージが許可されているかどうかを動的に決定するコールバック関数。\n\t\t * @param sourceWindow タブの元ウィンドウ\n\t\t * @param targetWindow ドロップされたタブのウィンドウ\n\t\t * @returns true:マージ許可 false:マージ禁止\n\t\t */\n\t\tonMergeAttempt?: (sourceWindow: IWindow, targetWindow: IWindow) => boolean;\n\t};\n\t/**\n\t * タスクバーアイテムの表示設定\n\t */\n\ttaskbarOptions?: {\n\t\t/**\n\t\t * trueにすると、タスクバーにタイトルではなくアイコンを表示します。\n\t\t * アイコンが設定されている必要があります。\n\t\t */\n\t\tshowIconOnly?: boolean;\n\t};\n\t/**\n\t * 右クリックメニュー\n\t */\n\tcontextMenu?: ContextMenuItem[];\n\t/**\n\t * ショートカットキーを有効化\n\t */\n\tenableShortcuts?: boolean;\n\t/**\n\t * コントロールの位置\n\t */\n\tcontrolsPosition?: \"left\" | \"right\";\n\t/**\n\t * iframeや非同期コンテンツの読み込み中にローディングインジケーターを表示するか\n\t */\n\tshowLoadingIndicator?: boolean;\n\t/**\n\t * ウィンドウオープン時\n\t */\n\tonOpen?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウクローズ時\n\t */\n\tonClose?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウフォーカス時\n\t */\n\tonFocus?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウブラー時\n\t */\n\tonBlur?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウリサイズ時\n\t */\n\tonResize?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウ移動時\n\t */\n\tonMove?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウリロード時\n\t *\n\t * デフォルトのリロード動作（iframeの再読み込みやhtmlの再描画）をキャンセルする場合は `false` を返します。\n\t */\n\tonReload?: (win: IWindow) => boolean | void;\n\n\t// 内部利用フラグ\n\t_isPopup?: boolean;\n\t/**\n\t * 親ウィンドウのインスタンス (内部利用)\n\t */\n\t_parent?: IWindow | null;\n\t/**\n\t * タスクバーのアイテム要素 (内部利用)\n\t */\n\t_taskbarItem?: HTMLElement | null;\n}\n\n// --- Popup ---\nexport const TIMEOUT_RESULT = Symbol(\"timeout\");\nexport const CLOSE_BUTTON_RESULT = Symbol(\"close\");\n\nexport type PopupResult = string | number | symbol | null;\n\nexport interface PopupButton {\n\ttext: string;\n\tvalue: PopupResult;\n}\n\nexport type PopupButtonPreset = \"Ok\" | \"OkCancel\" | \"Yes\" | \"YesNo\" | \"YesNoCancel\" | \"Retry\" | \"RetryCancel\" | \"AbortRetryIgnore\";\n\nexport interface PopupOptions {\n\tmessage: string;\n\ttitle?: string;\n\ticon?: string | null;\n\tbuttons?: PopupButton[] | PopupButtonPreset;\n\ttimeout?: number;\n\tautoWidth?: boolean;\n\tfocus?: boolean;\n\talwaysOnTop?: boolean;\n\tmodal?: boolean;\n\n\t/**\n\t * ウィンドウクローズ時\n\t */\n\tonClose?: (result: PopupResult) => void;\n\t/**\n\t * ウィンドウフォーカス時\n\t */\n\tonFocus?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウブラー時\n\t */\n\tonBlur?: (win: IWindow) => void;\n}\n\nexport interface TaskbarOptions {\n\t/**\n\t * タスクバーの表示位置\n\t * @default 'bottom'\n\t */\n\tposition?: \"top\" | \"bottom\" | \"left\" | \"right\";\n}\n\nexport interface GlobalConfigOptions {\n\twindowSwitchShortcut?: string | null; // 例: \"Ctrl+`\"\n\t/**\n\t * ウィンドウマネージャを内包する親要素。\n\t * セレクタ文字列またはHTMLElementを指定します。\n\t * 未指定の場合はbody直下に配置されます。\n\t */\n\tcontainer?: string | HTMLElement;\n\t/**\n\t * `srcdoc` iframeでWinLetを自己読込する場合のライブラリのパス。\n\t */\n\tlibraryPath?: string;\n\t/**\n\t * ウィンドウ操作時のアニメーションを有効にするか\n\t */\n\tenableAnimations?: boolean;\n\t/**\n\t * タスクバーを表示するか\n\t */\n\tenableTaskbar?: boolean;\n\t/**\n\t * タスクバーの設定\n\t */\n\ttaskbar?: TaskbarOptions;\n\t/**\n\t * モーダルウィンドウのフォーカストラップを有効にするか\n\t */\n\tenableFocusTrapping?: boolean;\n\t/**\n\t * 初期テーマ\n\t * 'dark'などの登録済みテーマ名、またはThemeオブジェクトを指定\n\t */\n\ttheme?: string | Theme;\n}\n\n/**\n * テーマの定義\n */\nexport interface Theme {\n\tname: string;\n\tvariables: Record<string, string>;\n}\n\n// WinLetの公開APIの型\nexport interface WinLetApi {\n\tinit: (options?: GlobalConfigOptions) => void;\n\t/**\n\t * ウィンドウを作成します。\n\t */\n\tcreateWindow: (options?: WindowOptions) => IWindow;\n\t/**\n\t * ポップアップウィンドウを作成します。\n\t */\n\tcreatePopup: (options: PopupOptions) => IWindow;\n\t/**\n\t * 指定されたIDのウィンドウインスタンスを取得します。\n\t * @param id - 取得するウィンドウのID\n\t */\n\tgetWindow: (id: string) => IWindow | undefined;\n\t/**\n\t * 指定されたDOM要素を内包するウィンドウインスタンスを取得します。\n\t * 入れ子ウィンドウの場合、最も内側にある子ウィンドウを返します。\n\t * @param element - 検索の起点となるDOM要素\n\t * @returns 発見されたIWindowインスタンス、またはundefined\n\t */\n\tgetWindowFromElement: (element: HTMLElement) => IWindow | undefined;\n\t/**\n\t * 現在アクティブなウィンドウを取得します。\n\t */\n\tgetActiveWindow: () => IWindow | null;\n\t/**\n\t * ウィンドウのデフォルトの設定を変更します。\n\t */\n\tsetDefaultConfig: (options: WindowOptions) => void;\n\t/**\n\t * グローバル設定を変更します。\n\t */\n\tsetGlobalConfig: (options: GlobalConfigOptions) => void;\n\t/**\n\t * 表示テーマを登録します。\n\t * @param theme - 登録するテーマ\n\t */\n\tregisterTheme: (theme: Theme) => void;\n\t/**\n\t * 登録済みのテーマ名の配列を取得します。\n\t * @returns 登録済みのテーマ名の配列\n\t */\n\tgetRegisteredThemes: () => string[];\n\t/**\n\t * 表示テーマを変更します。\n\t * @param theme - 登録済みのテーマ名（'default', 'dark'など）またはThemeオブジェクト\n\t */\n\tsetTheme: (theme: string | Theme) => void;\n\t/**\n\t * 現在の表示テーマを取得します。\n\t * @returns 現在の表示テーマ\n\t */\n\tgetTheme: () => Theme | null;\n\t/**\n\t * WinLetのバージョンを取得します。\n\t */\n\tget version(): string;\n\tPOPUP_TIMEOUT_RESULT: typeof TIMEOUT_RESULT;\n\tPOPUP_CLOSE_BUTTON_RESULT: typeof CLOSE_BUTTON_RESULT;\n}\n\n// グローバルスコープのWindowにWinLetプロパティを追加\ndeclare global {\n\tinterface Window {\n\t\tWinLet: WinLetApi;\n\t}\n}\n","import { defaultConfig } from \"../const/config\";\nimport { WinLetError } from \"../const/errors\";\nimport { CLOSE_BUTTON_RESULT, IWindow, LIBRARY_NAME, MenuItem, PopupOptions, PopupResult, TabItem, WindowContentOptions, WindowOptions, WindowState } from \"../const/types\";\nimport WinLetBaseClass from \"../libs/baseclass\";\nimport Utils from \"../libs/utils\";\nimport WindowManager from \"./window_manager\";\n\nexport default class WinLetWindow extends WinLetBaseClass implements IWindow {\n\tpublic readonly id: string;\n\tpublic options: Required<WindowOptions>;\n\tpublic el: HTMLElement;\n\tpublic state: WindowState = \"normal\";\n\n\tprivate manager: WindowManager;\n\tprivate lastState = { x: 0, y: 0, width: 0, height: 0 };\n\tprivate focused: boolean = false;\n\tprivate readonly DRAG_THRESHOLD = 5;\n\n\tprivate titleBarEl: HTMLElement;\n\tprivate iconEl: HTMLElement;\n\tprivate titleEl: HTMLElement;\n\tprivate mainContentEl: HTMLElement;\n\tprivate contentEl: HTMLElement;\n\tprivate loaderEl: HTMLElement;\n\tprivate tabs: { tabEl: HTMLElement; contentEl: HTMLElement }[] = [];\n\tprivate addTabBtn: HTMLElement | null = null;\n\tprivate isMenuOpen = false;\n\tprivate boundGlobalClickHandler: ((event: MouseEvent) => void) | null = null;\n\n\t// モバイル対応\n\tprivate readonly MOBILE_CONTEXT_MENU_TIMEOUT = 700;\n\tprivate contextMenuTimer: number | null = null;\n\n\t// Popup用\n\tpublic popupCloseCallback: ((result: PopupResult) => void) | null = null;\n\n\tprivate childManager: WindowManager | null = null;\n\tprivate parentWindow: IWindow | null;\n\n\tconstructor(options: WindowOptions, manager: WindowManager) {\n\t\tsuper();\n\t\tthis.id = options.id || Utils.generateId(`${LIBRARY_NAME}-window`);\n\t\tif (options.id) {\n\t\t\tconst existingEl = document.getElementById(options.id);\n\t\t\tif (existingEl && existingEl.classList.contains(`${LIBRARY_NAME}-window`)) {\n\t\t\t\tthrow new WinLetError(`WinLet: Window with ID \"${options.id}\" already exists. New window will not be created.`);\n\t\t\t}\n\t\t}\n\t\tthis.manager = manager;\n\t\tthis.options = Utils.deepMerge(Utils.deepCopy(defaultConfig), options) as Required<WindowOptions>;\n\t\tthis.parentWindow = options._parent || null;\n\n\t\tthis.el = this.createDOM();\n\n\t\t// _isPopupによってクラスを追加\n\t\tif (this.options._isPopup) {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-popup-window`);\n\t\t}\n\t\t// tabStyleとmenuStyleによってクラスを追加\n\t\tif (this.options.tabStyle === \"merged\") {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-tab-style-merged`);\n\t\t}\n\t\tif (this.options.menuStyle === \"merged\") {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-menu-style-merged`);\n\t\t}\n\t\t// 最前面/モーダル指定によりクラスを追加\n\t\tif (this.options.windowOptions.alwaysOnTop) {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-always-on-top`);\n\t\t}\n\t\tif (this.options.windowOptions.modal) {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-modal`);\n\t\t\tthis.el.setAttribute(\"aria-modal\", \"true\");\n\t\t}\n\n\t\tthis.titleBarEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title-bar`)!;\n\t\tthis.iconEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-icon`)!;\n\t\tthis.titleEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title`)!;\n\t\tthis.mainContentEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-main-content`)!;\n\t\tthis.contentEl = this.mainContentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-content`)!;\n\t\tthis.loaderEl = this.mainContentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-loader-overlay`)!;\n\n\t\tthis.applyOptions();\n\t\tthis.setupEventListeners();\n\n\t\tthis.options.onOpen(this);\n\t}\n\n\tprivate createDOM(): HTMLElement {\n\t\tconst windowEl = document.createElement(\"div\");\n\t\twindowEl.className = `${LIBRARY_NAME}-window`;\n\t\twindowEl.id = this.id;\n\n\t\t// ARIA属性\n\t\twindowEl.setAttribute(\"role\", \"application\");\n\t\twindowEl.setAttribute(\"aria-labelledby\", `${this.id}-title`);\n\t\tif (this.state === \"minimized\") {\n\t\t\twindowEl.setAttribute(\"inert\", \"\");\n\t\t\twindowEl.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\n\t\tconst handles: string[] = [];\n\t\tif (this.options.windowOptions.resizableY) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-n\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-s\"></div>`);\n\t\t}\n\t\tif (this.options.windowOptions.resizableX) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-w\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-e\"></div>`);\n\t\t}\n\t\tif (this.options.windowOptions.resizableX && this.options.windowOptions.resizableY) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-nw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-ne\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-sw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-se\"></div>`);\n\t\t}\n\t\tconst resizableHandlesHTML = handles.join(\"\");\n\n\t\tconst hasMenu = this.options.menu.length > 0;\n\t\tconst hasTabs = this.options.tabs.length > 0;\n\t\tconst isMergedMenu = this.options.menuStyle === \"merged\" && hasMenu;\n\t\tconst isMergedTabs = this.options.tabStyle === \"merged\" && hasTabs;\n\n\t\tconst controlsHTML = `\n            <div class=\"${LIBRARY_NAME}-controls\">\n                ${this.options.windowOptions.minimizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-minimize-btn\" type=\"button\" value=\"\\uff3f\" title=\"Minimize\" />` : \"\"}\n                ${this.options.windowOptions.maximizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-maximize-btn\" type=\"button\" value=\"\\u25a1\" title=\"Maximize\" />` : \"\"}\n                ${this.options.windowOptions.closable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-close-btn\" type=\"button\" value=\"\\u2573\" title=\"Close\">` : \"\"}\n            </div>`;\n\n\t\tconst titleBarContentHTML = `\n            <div class=\"${LIBRARY_NAME}-icon\"></div>\n            ${isMergedMenu ? `<div class=\"${LIBRARY_NAME}-menu-bar\"></div>` : \"\"}\n            <div id=\"${this.id}-title\" class=\"${LIBRARY_NAME}-title\"></div>\n            ${isMergedTabs ? `<div class=\"${LIBRARY_NAME}-tab-bar\"></div>` : \"\"}\n            ${controlsHTML}\n        `;\n\n\t\tconst loaderHTML = `\n            <div class=\"${LIBRARY_NAME}-loader-overlay\" style=\"display: none;\">\n                <div class=\"${LIBRARY_NAME}-loader-spinner\"></div>\n            </div>\n        `;\n\n\t\twindowEl.innerHTML = `\n            <div class=\"${LIBRARY_NAME}-title-bar ${LIBRARY_NAME}-us-none\">\n                ${titleBarContentHTML}\n            </div>\n            <div class=\"${LIBRARY_NAME}-main-content\">\n                ${!isMergedMenu && hasMenu ? `<div class=\"${LIBRARY_NAME}-menu-bar\" role=\"menubar\"></div>` : \"\"}\n                ${!isMergedTabs && hasTabs ? `<div class=\"${LIBRARY_NAME}-tab-bar\" role=\"tablist\"></div>` : \"\"}\n                <div class=\"${LIBRARY_NAME}-content\"></div>\n\t\t\t\t${loaderHTML}\n            </div>\n            ${resizableHandlesHTML}\n        `;\n\t\treturn windowEl;\n\t}\n\n\tprivate applyOptions(): void {\n\t\tthis.setTitle(this.options.title);\n\t\tthis.setIcon(this.options.icon);\n\t\tthis.setSize(this.options.width, this.options.height);\n\t\tthis.el.style.minWidth = `${this.options.minWidth}px`;\n\t\tthis.el.style.minHeight = `${this.options.minHeight}px`;\n\n\t\tif (this.options.controlsPosition === \"left\") {\n\t\t\tthis.titleBarEl.classList.add(`${LIBRARY_NAME}-controls-left`);\n\t\t}\n\n\t\tif (this.options.tabs.length > 0) {\n\t\t\tthis.createTabs();\n\t\t} else {\n\t\t\tthis.renderContent(this.contentEl, this.options.content);\n\t\t}\n\n\t\tif (this.options.menu.length > 0) {\n\t\t\tthis.createMenu();\n\t\t}\n\t}\n\n\tprivate showLoader(): void {\n\t\tif (this.options.showLoadingIndicator) {\n\t\t\tthis.loaderEl.style.display = \"flex\";\n\t\t}\n\t}\n\n\tprivate hideLoader(): void {\n\t\tthis.loaderEl.style.display = \"none\";\n\t}\n\n\tprivate renderContent(container: HTMLElement, content: WindowContentOptions): void {\n\t\tcontainer.innerHTML = \"\";\n\t\tthis.hideLoader();\n\n\t\tif (content.template) {\n\t\t\tconst template = document.querySelector<HTMLTemplateElement>(content.template);\n\t\t\tif (template?.tagName === \"TEMPLATE\") {\n\t\t\t\tcontainer.appendChild(template.content.cloneNode(true));\n\t\t\t} else {\n\t\t\t\tcontainer.innerHTML = \"Error: Template not found or invalid.\";\n\t\t\t\tconsole.warn(\"WinLet Warning: Template not found or invalid.\");\n\t\t\t}\n\t\t} else if (content.html) {\n\t\t\tcontainer.innerHTML = content.html;\n\t\t} else if (Utils.isNonEmptyObject(content.iframe) && (content.iframe.src || content.iframe.srcdoc)) {\n\t\t\tthis.showLoader();\n\t\t\tconst iframe = document.createElement(\"iframe\");\n\t\t\tconst iframeConfig = content.iframe;\n\t\t\tif (iframeConfig.src) {\n\t\t\t\tiframe.src = iframeConfig.src;\n\t\t\t}\n\t\t\tif (iframeConfig.srcdoc) {\n\t\t\t\tlet finalSrcDoc = iframeConfig.srcdoc;\n\t\t\t\tif (iframeConfig.loadWinLet) {\n\t\t\t\t\tconst globalConfig = this.manager.getGlobalConfig();\n\t\t\t\t\tif (globalConfig.libraryPath) {\n\t\t\t\t\t\tconst scriptTag = `<script src=\"${globalConfig.libraryPath}\"><\\/script>`;\n\t\t\t\t\t\tconst initScript = `<script>document.addEventListener('DOMContentLoaded', () => window.WinLet.init({ container: document.body }));<\\/script>`;\n\t\t\t\t\t\tfinalSrcDoc = `<!DOCTYPE html><html><head><meta charset=\"UTF-8\">${scriptTag}${initScript}</head><body>${iframeConfig.srcdoc}</body></html>`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"WinLet Warning: `loadWinLet` is true, but `libraryPath` is not set in global config.\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tiframe.srcdoc = finalSrcDoc;\n\t\t\t}\n\t\t\tif (iframeConfig.allow) {\n\t\t\t\tiframe.allow = iframeConfig.allow;\n\t\t\t}\n\t\t\tif (iframeConfig.referrerPolicy) {\n\t\t\t\tiframe.referrerPolicy = iframeConfig.referrerPolicy;\n\t\t\t}\n\t\t\tif (iframeConfig.loading) {\n\t\t\t\tiframe.loading = iframeConfig.loading;\n\t\t\t}\n\t\t\tif (iframeConfig.sandbox) {\n\t\t\t\tif (!Array.isArray(iframeConfig.sandbox)) {\n\t\t\t\t\tiframeConfig.sandbox = [iframeConfig.sandbox];\n\t\t\t\t}\n\t\t\t\tif (iframeConfig.sandbox.length > 0) {\n\t\t\t\t\tiframe.setAttribute(\"sandbox\", iframeConfig.sandbox.join(\" \"));\n\t\t\t\t}\n\t\t\t}\n\t\t\tiframe.addEventListener(\"load\", () => this.hideLoader());\n\t\t\tiframe.addEventListener(\"error\", () => this.hideLoader());\n\t\t\tcontainer.appendChild(iframe);\n\t\t} else {\n\t\t\tcontainer.innerHTML = \"\";\n\t\t}\n\t}\n\n\tprivate closeAllMenus(): void {\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-menu-item > .${LIBRARY_NAME}-menu-dropdown`).forEach((dd) => {\n\t\t\tdd.style.display = \"none\";\n\t\t});\n\t\tthis.isMenuOpen = false;\n\t}\n\n\tprivate createMenu(): void {\n\t\tconst menuBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-menu-bar`)!;\n\t\tmenuBar.innerHTML = \"\";\n\n\t\tthis.options.menu.forEach((menuItemData) => {\n\t\t\tconst menuItemEl = document.createElement(\"div\");\n\t\t\tmenuItemEl.className = `${LIBRARY_NAME}-menu-item ${LIBRARY_NAME}-us-none`;\n\t\t\tmenuItemEl.textContent = menuItemData.name ?? \"\";\n\t\t\tmenuItemEl.setAttribute(\"role\", \"menu\");\n\n\t\t\tif (menuItemData.items) {\n\t\t\t\tconst dropdownEl = this.createDropdownMenu(menuItemData.items);\n\n\t\t\t\tmenuItemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tconst isVisible = dropdownEl.style.display === \"block\";\n\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\tif (!isVisible) {\n\t\t\t\t\t\tdropdownEl.style.display = \"block\";\n\t\t\t\t\t\tthis.isMenuOpen = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuItemEl.addEventListener(\"mouseenter\", () => {\n\t\t\t\t\tif (this.isMenuOpen) {\n\t\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\t\tdropdownEl.style.display = \"block\";\n\t\t\t\t\t\tthis.isMenuOpen = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuItemEl.appendChild(dropdownEl);\n\t\t\t}\n\t\t\tmenuBar.appendChild(menuItemEl);\n\t\t});\n\t}\n\n\tprivate createDropdownMenu(items: MenuItem[]): HTMLUListElement {\n\t\tconst dropdownEl = document.createElement(\"ul\");\n\t\tdropdownEl.className = `${LIBRARY_NAME}-menu-dropdown`;\n\n\t\titems.forEach((itemData) => {\n\t\t\tconst itemEl = document.createElement(\"li\");\n\t\t\tif (itemData.separator) {\n\t\t\t\titemEl.className = `${LIBRARY_NAME}-separator`;\n\t\t\t} else {\n\t\t\t\tlet text = itemData.name ?? \"\";\n\t\t\t\ttext = `<span>${text}</span>`;\n\t\t\t\tif (this.options.enableShortcuts && itemData.shortcut) {\n\t\t\t\t\ttext += `<span class=\"${LIBRARY_NAME}-shortcut-text\">(${itemData.shortcut})</span>`;\n\t\t\t\t}\n\t\t\t\titemEl.innerHTML = `<div class=\"${LIBRARY_NAME}-menu-dropdown-item\" role=\"menuitem\">${text}</div>`;\n\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\titemData.action?.(this);\n\t\t\t\t});\n\t\t\t\tif (itemData.items) {\n\t\t\t\t\titemEl.classList.add(`${LIBRARY_NAME}-has-submenu`); // スタイル付けのためのクラス\n\t\t\t\t\tconst subMenuEl = this.createDropdownMenu(itemData.items);\n\t\t\t\t\titemEl.appendChild(subMenuEl);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdropdownEl.appendChild(itemEl);\n\t\t});\n\t\treturn dropdownEl;\n\t}\n\n\tprivate createTabs(): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\ttabBar.innerHTML = \"\";\n\t\tthis.tabs = [];\n\t\tconst tabOpts = this.options.tabOptions ?? {};\n\n\t\tthis.options.tabs.forEach((tabData, index) => {\n\t\t\tthis.createTabElement(tabData, index);\n\t\t});\n\n\t\tif (tabOpts.addable) {\n\t\t\tthis.addTabBtn = document.createElement(\"div\");\n\t\t\tthis.addTabBtn.className = `${LIBRARY_NAME}-tab-add-btn`;\n\t\t\tthis.addTabBtn.textContent = \"+\";\n\t\t\tthis.addTabBtn.addEventListener(\"click\", (e) => {\n\t\t\t\tconst newTabItem = tabOpts.onAdd?.(this);\n\t\t\t\tif (newTabItem) {\n\t\t\t\t\tthis.addTab(newTabItem);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttabBar.appendChild(this.addTabBtn);\n\t\t}\n\t\t// タブの並び替えと統合のためのドロップゾーンを設定\n\t\tthis.setupTabBarDropZone();\n\n\t\tif (this.tabs.length > 0) this.activateTab(0);\n\t}\n\n\tprivate setupTabBarDropZone(): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\tif (!tabBar || !this.options.tabOptions.reorderable) return;\n\n\t\ttabBar.addEventListener(\"dragover\", (e) => {\n\t\t\tif (e.dataTransfer?.types.includes(\"application/winlet-tab\")) {\n\t\t\t\te.preventDefault();\n\t\t\t\tif (e.dataTransfer) e.dataTransfer.dropEffect = \"move\";\n\t\t\t\ttabBar.classList.add(`${LIBRARY_NAME}-drag-over`);\n\t\t\t}\n\t\t});\n\t\ttabBar.addEventListener(\"dragleave\", () => {\n\t\t\ttabBar.classList.remove(`${LIBRARY_NAME}-drag-over`);\n\t\t});\n\t\ttabBar.addEventListener(\"drop\", (e) => {\n\t\t\te.preventDefault();\n\t\t\ttabBar.classList.remove(`${LIBRARY_NAME}-drag-over`);\n\n\t\t\tconst tabDataJSON = e.dataTransfer?.getData(\"application/winlet-tab\");\n\t\t\tconst sourceWindowId = e.dataTransfer?.getData(\"application/winlet-source-window-id\");\n\t\t\tconst sourceTabId = e.dataTransfer?.getData(\"text/plain\");\n\t\t\tif (!tabDataJSON || !sourceWindowId || !sourceTabId) return;\n\n\t\t\tconst draggingEl = this.manager.container?.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.${LIBRARY_NAME}-dragging`);\n\n\t\t\t// 自分自身のウィンドウ内での並び替え\n\t\t\tif (sourceWindowId === this.id) {\n\t\t\t\tif (draggingEl) {\n\t\t\t\t\t// ドロップされた位置に挿入\n\t\t\t\t\tthis.updateTabOrderFromDOM();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// 外部ウィンドウからのタブ統合\n\t\t\tconst sourceWindow = this.manager.getWindow(sourceWindowId);\n\t\t\tif (sourceWindow) {\n\t\t\t\tconst sourceOpts = sourceWindow.options.tabOptions;\n\t\t\t\tconst targetOpts = this.options.tabOptions;\n\n\t\t\t\tconst isMergeable = sourceOpts.mergeable ?? sourceOpts.detachable; // ソースをマージできるかどうかを確認\n\t\t\t\tconst allowsIncoming = targetOpts.allowIncomingMerge ?? true; // ターゲットが受け入れるかどうかを確認\n\t\t\t\tconst customFilterPassed = !targetOpts.onMergeAttempt || targetOpts.onMergeAttempt(sourceWindow, this);\n\n\t\t\t\tif (!isMergeable || !allowsIncoming || !customFilterPassed) {\n\t\t\t\t\treturn; // 条件が満たされていない場合は、マージを中止\n\t\t\t\t}\n\n\t\t\t\tconst tabData: TabItem = JSON.parse(tabDataJSON);\n\t\t\t\tthis.addTab(tabData, true);\n\n\t\t\t\tsourceWindow.closeTab(parseInt(sourceTabId, 10));\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate createTabElement(tabData: TabItem, index: number): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\tconst tabOpts = this.options.tabOptions ?? {};\n\n\t\tconst tabEl = document.createElement(\"div\");\n\t\ttabEl.className = `${LIBRARY_NAME}-tab`;\n\t\ttabEl.setAttribute(\"role\", \"tab\");\n\t\ttabEl.dataset.tabId = index.toString(); // IDを紐付け\n\n\t\tconst titleEl = document.createElement(\"span\");\n\t\ttitleEl.textContent = tabData.title;\n\t\ttabEl.appendChild(titleEl);\n\n\t\t// +ボタンが存在すればその前に、なければ末尾に追加\n\t\ttabBar.insertBefore(tabEl, this.addTabBtn);\n\n\t\tif (tabOpts.closable) {\n\t\t\tconst closeBtn = document.createElement(\"span\");\n\t\t\tcloseBtn.className = `${LIBRARY_NAME}-tab-close-btn`;\n\t\t\tcloseBtn.innerHTML = \"&times;\";\n\t\t\tcloseBtn.addEventListener(\"click\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\t// クロージャのindexに依存せず、クリックされた時点の最新のインデックスを探す\n\t\t\t\tconst indexToClose = this.tabs.findIndex((t) => t.tabEl === tabEl);\n\t\t\t\tif (indexToClose !== -1) {\n\t\t\t\t\tthis.closeTab(indexToClose);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttabEl.appendChild(closeBtn);\n\t\t}\n\n\t\t// タブコンテント生成ロジック\n\t\tconst tabContentEl = document.createElement(\"div\");\n\t\ttabContentEl.className = `${LIBRARY_NAME}-tab-content`;\n\t\ttabContentEl.setAttribute(\"role\", \"tabpanel\");\n\t\tthis.contentEl.appendChild(tabContentEl);\n\t\tthis.renderContent(tabContentEl, tabData.content);\n\n\t\ttabEl.addEventListener(\"click\", (e) => {\n\t\t\tthis.activateTab(+tabEl.dataset.tabId!);\n\t\t});\n\t\tthis.tabs.splice(index, 0, { tabEl, contentEl: tabContentEl }); // 指定位置に挿入\n\n\t\tif (tabOpts.reorderable) {\n\t\t\tthis.makeTabReorderable(tabEl);\n\t\t}\n\t}\n\n\tprivate makeTabReorderable(tabEl: HTMLElement) {\n\t\ttabEl.draggable = true;\n\t\ttabEl.addEventListener(\"dragstart\", (e) => {\n\t\t\te.dataTransfer!.setData(\"text/plain\", tabEl.dataset.tabId!);\n\t\t\ttabEl.classList.add(`${LIBRARY_NAME}-dragging`);\n\n\t\t\t// 分離機能が有効な場合、追加情報をセット\n\t\t\tif (this.options.tabOptions.detachable) {\n\t\t\t\tconst tabIndex = parseInt(tabEl.dataset.tabId!, 10);\n\t\t\t\tif (!isNaN(tabIndex) && this.options.tabs[tabIndex]) {\n\t\t\t\t\tconst tabData = this.options.tabs[tabIndex];\n\t\t\t\t\te.dataTransfer!.setData(\"application/winlet-tab\", JSON.stringify(tabData));\n\t\t\t\t\te.dataTransfer!.setData(\"application/winlet-source-window-id\", this.id);\n\n\t\t\t\t\tthis.manager.onTabDragStart(this.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\ttabEl.addEventListener(\"dragend\", () => {\n\t\t\ttabEl.classList.remove(`${LIBRARY_NAME}-dragging`);\n\t\t\tthis.manager.onTabDragEnd();\n\t\t});\n\n\t\ttabEl.addEventListener(\n\t\t\t\"dragover\",\n\t\t\t(e) => {\n\t\t\t\tif (this.manager.draggingTabInfo?.sourceWindowId !== this.id) {\n\t\t\t\t\treturn; //タブが別のウィンドウからである場合、何もしない\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t\tconst draggingEl = document.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.${LIBRARY_NAME}-dragging`);\n\t\t\t\tif (draggingEl && draggingEl !== tabEl) {\n\t\t\t\t\tconst rect = tabEl.getBoundingClientRect();\n\t\t\t\t\t// カーソルの位置によって挿入位置を左右に決める\n\t\t\t\t\tconst isAfter = e.clientX > rect.left + rect.width / 2;\n\t\t\t\t\tconst parent = tabEl.parentNode!;\n\t\t\t\t\tif (isAfter) {\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl.nextSibling);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\n\t\ttabEl.addEventListener(\n\t\t\t\"drop\",\n\t\t\t(e) => {\n\t\t\t\te.preventDefault();\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\t}\n\n\t// タブを閉じるロジック\n\tpublic closeTab(index: number) {\n\t\t// アクティブなタブが閉じられるかチェック\n\t\tconst wasActive = this.tabs[index]?.tabEl.classList.contains(`${LIBRARY_NAME}-active`);\n\n\t\t// DOMから要素を削除\n\t\tthis.tabs[index].tabEl.remove();\n\t\tthis.tabs[index].contentEl.remove();\n\t\t// 配列から削除\n\t\tthis.tabs.splice(index, 1);\n\t\tthis.options.tabs.splice(index, 1);\n\n\t\t// IDの再割り当て\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\n\n\t\t// アクティブなタブを再設定\n\t\tif (this.tabs.length > 0) {\n\t\t\tif (wasActive) {\n\t\t\t\tconst newActiveIndex = Math.max(0, index - 1);\n\t\t\t\tthis.activateTab(newActiveIndex);\n\t\t\t}\n\t\t} else {\n\t\t\t// タブが0になったらウィンドウを閉じる\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tpublic activateTab(index: number): void {\n\t\tthis.tabs.forEach((tab, i) => {\n\t\t\ttab.tabEl.classList.toggle(`${LIBRARY_NAME}-active`, i === index);\n\t\t\ttab.contentEl.classList.toggle(`${LIBRARY_NAME}-active`, i === index);\n\t\t});\n\t}\n\n\tpublic addTab(tabItem: TabItem, setActive: boolean = true): void {\n\t\tthis.options.tabs.push(tabItem);\n\t\tconst newIndex = this.options.tabs.length - 1;\n\t\tthis.createTabElement(tabItem, newIndex);\n\t\tif (setActive) {\n\t\t\tthis.activateTab(newIndex);\n\t\t\t// タブが追加されアクティブになったウィンドウにフォーカスを当てる\n\t\t\tthis.focus();\n\t\t}\n\t}\n\n\tpublic getTabs(): { tabEl: HTMLElement; contentEl: HTMLElement }[] {\n\t\treturn this.tabs;\n\t}\n\n\tprivate updateTabOrderFromDOM(): void {\n\t\tconst tabElements = Array.from(this.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-tab-bar > .${LIBRARY_NAME}-tab`));\n\n\t\tconst newTabs: typeof this.tabs = [];\n\t\tconst newOptionsTabs: TabItem[] = [];\n\n\t\tconst oldTabs = [...this.tabs];\n\t\tconst oldOptionsTabs = [...this.options.tabs];\n\n\t\ttabElements.forEach((tabEl) => {\n\t\t\t// dataset.tabIdはもはや信頼できない可能性があるため、DOM要素で直接比較する\n\t\t\tconst oldIndex = oldTabs.findIndex((t) => t.tabEl === tabEl);\n\t\t\tif (oldIndex !== -1) {\n\t\t\t\tnewTabs.push(oldTabs[oldIndex]);\n\t\t\t\tnewOptionsTabs.push(oldOptionsTabs[oldIndex]);\n\t\t\t}\n\t\t});\n\n\t\tthis.tabs = newTabs;\n\t\tthis.options.tabs = newOptionsTabs;\n\n\t\t// 新しい順序でdataset.tabIdを再設定\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\n\t}\n\n\tprivate setupEventListeners(): void {\n\t\tthis.el.addEventListener(\"click\", () => this.focus(), true);\n\n\t\t// iframeなどにフォーカスが移った際にウィンドウ自体をアクティブにする\n\t\tthis.el.addEventListener(\"focusin\", () => this.focus());\n\n\t\t// グローバルクリックリスナーを追加して、外側をクリックするときにメニューを閉じる\n\t\tthis.boundGlobalClickHandler = () => {\n\t\t\tif (this.isMenuOpen) {\n\t\t\t\tthis.closeAllMenus();\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener(\"click\", this.boundGlobalClickHandler);\n\n\t\tconst closeBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-close-btn`);\n\t\tcloseBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tif (this.options._isPopup) {\n\t\t\t\tthis.popupCloseCallback?.(CLOSE_BUTTON_RESULT);\n\t\t\t}\n\t\t\tthis.close();\n\t\t});\n\t\tcloseBtn?.setAttribute(\"aria-label\", \"Close\");\n\n\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\tmaxBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tthis.toggleMaximize();\n\t\t});\n\t\tmaxBtn?.setAttribute(\"aria-label\", \"Maximize\");\n\n\t\tconst minBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-minimize-btn`);\n\t\tminBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tthis.minimize();\n\t\t});\n\t\tminBtn?.setAttribute(\"aria-label\", \"Minimize\");\n\n\t\tif (this.options.windowOptions.movable) this.makeMovable();\n\t\tif (this.options.windowOptions.resizableX || this.options.windowOptions.resizableY) this.makeResizable();\n\t\tif (this.options.contextMenu.length > 0) {\n\t\t\t// PC用: 右クリック\n\t\t\tthis.el.addEventListener(\n\t\t\t\t\"contextmenu\",\n\t\t\t\t(e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\n\t\t\t\t},\n\t\t\t\t{ passive: false }\n\t\t\t);\n\t\t\t// モバイル用: 長押し\n\t\t\tthis.el.addEventListener(\"pointerdown\", (e) => {\n\t\t\t\tif (e.pointerType !== \"touch\") return;\n\t\t\t\tthis.contextMenuTimer = window.setTimeout(() => {\n\t\t\t\t\tthis.contextMenuTimer = null;\n\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\n\t\t\t\t}, this.MOBILE_CONTEXT_MENU_TIMEOUT);\n\t\t\t});\n\t\t\tconst clearContextMenuTimer = () => {\n\t\t\t\tif (this.contextMenuTimer) {\n\t\t\t\t\tclearTimeout(this.contextMenuTimer);\n\t\t\t\t\tthis.contextMenuTimer = null;\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.el.addEventListener(\"pointermove\", clearContextMenuTimer);\n\t\t\tthis.el.addEventListener(\"pointerup\", clearContextMenuTimer);\n\t\t\tthis.el.addEventListener(\"pointercancel\", clearContextMenuTimer);\n\t\t}\n\t}\n\n\tprivate makeMovable(): void {\n\t\tconst onPointerDown = (e: PointerEvent) => {\n\t\t\tconst target = e.target as HTMLElement;\n\t\t\t// 操作UI要素の上なら移動させない\n\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-resize-handle, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab, .${LIBRARY_NAME}-tab-add-btn`)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// メインボタン（マウスの左ボタン、タッチ）でのみ移動\n\t\t\tif (e.button !== 0) return;\n\n\t\t\te.preventDefault();\n\t\t\tthis.focus();\n\n\t\t\tconst { clientX: startX, clientY: startY } = e;\n\t\t\tlet isDragging = false;\n\n\t\t\t// ドラッグ開始時のウィンドウ座標。isDraggingがtrueになったときに設定される。\n\t\t\tlet initialLeft: number;\n\t\t\tlet initialTop: number;\n\n\t\t\t// --- ゴーストウィンドウ処理 ---\n\t\t\tlet ghostEl: HTMLElement | null = null;\n\t\t\tif (this.options.windowOptions.useGhostWindow) {\n\t\t\t\tghostEl = document.createElement(\"div\");\n\t\t\t\tghostEl.className = `${LIBRARY_NAME}-ghost-window`;\n\t\t\t\tthis.manager.container?.appendChild(ghostEl);\n\t\t\t\tghostEl.style.left = `${this.el.offsetLeft}px`;\n\t\t\t\tghostEl.style.top = `${this.el.offsetTop}px`;\n\t\t\t\tghostEl.style.width = `${this.el.offsetWidth}px`;\n\t\t\t\tghostEl.style.height = `${this.el.offsetHeight}px`;\n\t\t\t}\n\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-dragging`);\n\n\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\n\t\t\t\tif (!this.el?.isConnected) return;\n\t\t\t\tif (!isDragging) {\n\t\t\t\t\tconst deltaX = Math.abs(moveE.clientX - startX);\n\t\t\t\t\tconst deltaY = Math.abs(moveE.clientY - startY);\n\n\t\t\t\t\t// 閾値を超えたらドラッグモードを開始\n\t\t\t\t\tif (deltaX > this.DRAG_THRESHOLD || deltaY > this.DRAG_THRESHOLD) {\n\t\t\t\t\t\tisDragging = true;\n\t\t\t\t\t\tthis.el.setPointerCapture(e.pointerId);\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\n\n\t\t\t\t\t\t// 最大化状態からのドラッグ開始の場合、ウィンドウを復元\n\t\t\t\t\t\tif (this.state === \"maximized\") {\n\t\t\t\t\t\t\tconst restoredWidth = this.lastState.width;\n\t\t\t\t\t\t\tconst clickRatio = e.clientX / this.el.offsetWidth;\n\t\t\t\t\t\t\tconst titleBarRect = this.titleBarEl.getBoundingClientRect();\n\t\t\t\t\t\t\tconst offsetY = e.clientY - titleBarRect.top;\n\t\t\t\t\t\t\tconst posX = e.clientX - restoredWidth * clickRatio;\n\t\t\t\t\t\t\tconst posY = e.clientY - offsetY;\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.setPosition(posX, posY);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// ドラッグ開始時点の座標を記録\n\t\t\t\t\t\tinitialLeft = this.el.offsetLeft;\n\t\t\t\t\t\tinitialTop = this.el.offsetTop;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 閾値に達していなければ何もしない\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ドラッグ中の移動処理\n\t\t\t\tconst newLeft = initialLeft + moveE.clientX - startX;\n\t\t\t\tconst newTop = initialTop + moveE.clientY - startY;\n\t\t\t\tif (ghostEl) {\n\t\t\t\t\tghostEl.style.left = `${newLeft}px`;\n\t\t\t\t\tghostEl.style.top = `${newTop}px`;\n\t\t\t\t} else {\n\t\t\t\t\tthis.setPosition(newLeft, newTop);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst onPointerUp = () => {\n\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\n\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerUp);\n\n\t\t\t\tif (ghostEl) {\n\t\t\t\t\tthis.setPosition(ghostEl.offsetLeft, ghostEl.offsetTop);\n\t\t\t\t\tghostEl.remove();\n\t\t\t\t}\n\t\t\t\t// ドラッグが発生した場合のみ後処理とコールバック呼び出し\n\t\t\t\tif (isDragging) {\n\t\t\t\t\tthis.el.releasePointerCapture(e.pointerId);\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\n\t\t\t\t\tthis.options.onMove(this);\n\t\t\t\t}\n\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-dragging`);\n\t\t\t};\n\n\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove);\n\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp);\n\t\t};\n\n\t\tthis.titleBarEl.addEventListener(\"pointerdown\", onPointerDown, { passive: false });\n\n\t\tif (this.options.windowOptions.maximizable) {\n\t\t\tthis.titleBarEl.addEventListener(\"dblclick\", (e: MouseEvent) => {\n\t\t\t\tif (this.options.windowOptions.maximizableOnDblClick) {\n\t\t\t\t\tconst target = e.target as HTMLElement;\n\t\t\t\t\t// 操作UI（コントロールボタン、メニュー、タブ）の上では発火しないようにする\n\t\t\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab`)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.toggleMaximize();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate makeResizable(): void {\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-resize-handle`).forEach((handle) => {\n\t\t\thandle.addEventListener(\n\t\t\t\t\"pointerdown\",\n\t\t\t\t(e: PointerEvent) => {\n\t\t\t\t\tif (e.button !== 0 || !handle?.isConnected) return;\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\n\t\t\t\t\thandle.setPointerCapture(e.pointerId);\n\n\t\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-resizing`);\n\n\t\t\t\t\t// --- ゴーストウィンドウ処理 ---\n\t\t\t\t\tlet ghostEl: HTMLElement | null = null;\n\t\t\t\t\tif (this.options.windowOptions.useGhostWindow) {\n\t\t\t\t\t\tghostEl = document.createElement(\"div\");\n\t\t\t\t\t\tghostEl.className = `${LIBRARY_NAME}-ghost-window`;\n\t\t\t\t\t\tthis.manager.container?.appendChild(ghostEl);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst direction = handle.className.replace(`${LIBRARY_NAME}-resize-handle `, \"\");\n\t\t\t\t\tconst { clientX: startX, clientY: startY } = e;\n\t\t\t\t\tconst { offsetWidth: startWidth, offsetHeight: startHeight, offsetLeft: startLeft, offsetTop: startTop } = this.el;\n\t\t\t\t\tconst { minWidth, minHeight } = this.options;\n\n\t\t\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\n\t\t\t\t\t\tlet newWidth = startWidth,\n\t\t\t\t\t\t\tnewHeight = startHeight,\n\t\t\t\t\t\t\tnewLeft = startLeft,\n\t\t\t\t\t\t\tnewTop = startTop;\n\t\t\t\t\t\tconst deltaX = moveE.clientX - startX;\n\t\t\t\t\t\tconst deltaY = moveE.clientY - startY;\n\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-e`)) newWidth = Math.max(minWidth, startWidth + deltaX);\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-w`)) {\n\t\t\t\t\t\t\tnewWidth = Math.max(minWidth, startWidth - deltaX);\n\t\t\t\t\t\t\tnewLeft = startLeft + deltaX;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-s`)) newHeight = Math.max(minHeight, startHeight + deltaY);\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-n`)) {\n\t\t\t\t\t\t\tnewHeight = Math.max(minHeight, startHeight - deltaY);\n\t\t\t\t\t\t\tnewTop = startTop + deltaY;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ghostEl) {\n\t\t\t\t\t\t\tghostEl.style.left = `${newLeft}px`;\n\t\t\t\t\t\t\tghostEl.style.top = `${newTop}px`;\n\t\t\t\t\t\t\tghostEl.style.width = `${newWidth}px`;\n\t\t\t\t\t\t\tghostEl.style.height = `${newHeight}px`;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.setSize(newWidth, newHeight);\n\t\t\t\t\t\t\tthis.setPosition(newLeft, newTop);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tconst onPointerUp = () => {\n\t\t\t\t\t\thandle.releasePointerCapture(e.pointerId);\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\n\n\t\t\t\t\t\tif (ghostEl) {\n\t\t\t\t\t\t\tthis.setSize(ghostEl.offsetWidth, ghostEl.offsetHeight);\n\t\t\t\t\t\t\tthis.setPosition(ghostEl.offsetLeft, ghostEl.offsetTop);\n\t\t\t\t\t\t\tghostEl.remove();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\n\t\t\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerUp);\n\t\t\t\t\t\tthis.options.onResize(this);\n\n\t\t\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-resizing`);\n\t\t\t\t\t};\n\t\t\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove);\n\t\t\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp);\n\t\t\t\t},\n\t\t\t\t{ passive: false }\n\t\t\t);\n\t\t});\n\t}\n\n\tpublic isFontAwesome(classStr: string): boolean {\n\t\tconst classes = classStr.trim().split(/\\s+/);\n\t\tconst hasPrefix = classes.some((c) => /^fa[bslr]?$/.test(c));\n\t\tconst hasIcon = classes.some((c) => /^fa-[a-z0-9-]+$/.test(c));\n\t\treturn hasPrefix && hasIcon;\n\t}\n\n\t// --- Public API ---\n\n\tpublic close(): void {\n\t\t// Clean up global event listeners\n\t\tif (this.boundGlobalClickHandler) {\n\t\t\tdocument.removeEventListener(\"click\", this.boundGlobalClickHandler);\n\t\t}\n\t\tthis.options.onClose(this);\n\t\tthis.manager.destroyWindow(this.id);\n\t}\n\n\tpublic minimize(): void {\n\t\tif (this.state !== \"minimized\") {\n\t\t\tif (this.state !== \"normal\") this.restore();\n\n\t\t\tconst doMinimize = () => {\n\t\t\t\tthis.state = \"minimized\";\n\t\t\t\tthis.el.setAttribute(\"aria-hidden\", \"true\");\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-minimized`);\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-minimizing`);\n\t\t\t\tthis.manager.updateTaskbarItem(this, \"minimized\");\n\t\t\t\tthis.blur();\n\t\t\t};\n\n\t\t\tthis.el.setAttribute(\"inert\", \"\");\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations) {\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-minimizing`);\n\t\t\t\tthis.el.setAttribute(\"inert\", \"\");\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doMinimize, { once: true });\n\t\t\t} else {\n\t\t\t\tdoMinimize();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic toggleMaximize(): void {\n\t\tthis.state === \"maximized\" ? this.restore() : this.maximize();\n\t}\n\n\tpublic maximize(): void {\n\t\tif (this.state !== \"maximized\") {\n\t\t\tif (this.state !== \"normal\") this.restore();\n\t\t\tthis.lastState = { x: this.el.offsetLeft, y: this.el.offsetTop, width: this.el.offsetWidth, height: this.el.offsetHeight };\n\t\t\tthis.state = \"maximized\";\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-maximized`);\n\n\t\t\tconst doMaximize = () => {\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-maximizing`);\n\t\t\t\tthis.setPosition(0, 0);\n\t\t\t\tthis.setSize(\"100%\", \"100%\");\n\t\t\t};\n\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations) {\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-maximizing`);\n\t\t\t\t// アニメーションのために先にサイズと位置を設定\n\t\t\t\tthis.el.style.top = \"0px\";\n\t\t\t\tthis.el.style.left = \"0px\";\n\t\t\t\tthis.el.style.width = \"100%\";\n\t\t\t\tthis.el.style.height = \"100%\";\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doMaximize, { once: true });\n\t\t\t} else {\n\t\t\t\tdoMaximize();\n\t\t\t}\n\n\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\t\tif (maxBtn) {\n\t\t\t\tmaxBtn.title = \"Restore\";\n\t\t\t\tmaxBtn.value = \"\\u274f\";\n\t\t\t\tmaxBtn.setAttribute(\"aria-label\", \"Restore\");\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic restore(): void {\n\t\tconst wasMinimized = this.state === \"minimized\";\n\t\tif (this.state === \"minimized\") {\n\t\t\tthis.state = \"normal\";\n\t\t\tthis.el.removeAttribute(\"aria-hidden\");\n\t\t\tthis.el.removeAttribute(\"inert\");\n\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-minimized`);\n\t\t\tthis.manager.updateTaskbarItem(this, \"restored\");\n\t\t\tthis.focus();\n\t\t} else if (this.state === \"maximized\") {\n\t\t\tconst doRestore = () => {\n\t\t\t\tthis.state = \"normal\";\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-maximized`, `${LIBRARY_NAME}-is-restoring`);\n\t\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\t\t\tif (maxBtn) {\n\t\t\t\t\tmaxBtn.title = \"Maximize\";\n\t\t\t\t\tmaxBtn.value = \"\\u25a1\";\n\t\t\t\t\tmaxBtn.setAttribute(\"aria-label\", \"Maximize\");\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations && !wasMinimized) {\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-restoring`);\n\t\t\t\tthis.setSize(this.lastState.width, this.lastState.height);\n\t\t\t\tthis.setPosition(this.lastState.x, this.lastState.y);\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doRestore, { once: true });\n\t\t\t} else {\n\t\t\t\tthis.setSize(this.lastState.width, this.lastState.height);\n\t\t\t\tthis.setPosition(this.lastState.x, this.lastState.y);\n\t\t\t\tdoRestore();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic focus(): void {\n\t\tif (this.focused) return;\n\n\t\t// 階層を遡ってすべての親ウィンドウをフォーカスする\n\t\tif (this.parentWindow) {\n\t\t\tthis.parentWindow.focus();\n\t\t}\n\n\t\tthis.manager.focusWindow(this);\n\t\tthis.focused = true;\n\t\tthis.el.classList.add(`${LIBRARY_NAME}-active`);\n\t\tthis.options.onFocus(this);\n\t}\n\n\tpublic blur(): void {\n\t\tif (!this.focused) return;\n\t\tthis.focused = false;\n\t\tthis.el.classList.remove(`${LIBRARY_NAME}-active`);\n\t\tthis.options.onBlur(this);\n\t}\n\n\tpublic shake(): void {\n\t\tconst className = `${LIBRARY_NAME}-is-shaking`;\n\t\tif (this.el.classList.contains(className)) {\n\t\t\treturn; // Already shaking\n\t\t}\n\t\tthis.el.classList.add(className);\n\t\tthis.el.addEventListener(\n\t\t\t\"animationend\",\n\t\t\t() => {\n\t\t\t\tthis.el.classList.remove(className);\n\t\t\t},\n\t\t\t{ once: true }\n\t\t);\n\t}\n\n\tpublic reload(): void {\n\t\t// onReloadがfalseを返した場合、デフォルトのリロード処理を中断\n\t\tif (this.options.onReload(this) === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst reloadContent = (container: HTMLElement, content: WindowContentOptions) => {\n\t\t\tif (Utils.isNonEmptyObject(content.iframe) && (content.iframe.src || content.iframe.srcdoc)) {\n\t\t\t\tconst iframe = container.querySelector(\"iframe\");\n\t\t\t\t// srcがあり、srcdocがない場合はiframeのreloadを試みる\n\t\t\t\tif (iframe && iframe.src && !content.iframe.srcdoc) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// クロスオリジンフレームへのアクセスはエラーになる可能性がある\n\t\t\t\t\t\tiframe.contentWindow?.location.reload();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// 失敗した場合はiframe要素を再生成する\n\t\t\t\t\t\tconsole.warn(\"WinLet: Cross-origin iframe could not be reloaded directly. Recreating iframe element.\", e);\n\t\t\t\t\t\tthis.renderContent(container, content);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// srcdocの場合やiframeが見つからない場合は要素を再生成\n\t\t\t\t\tthis.renderContent(container, content);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// htmlまたはtemplateの場合は常に再描画\n\t\t\t\tthis.renderContent(container, content);\n\t\t\t}\n\t\t};\n\n\t\tif (this.options.tabs.length > 0) {\n\t\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(`${LIBRARY_NAME}-active`));\n\t\t\tif (activeTabIndex > -1) {\n\t\t\t\tconst activeTab = this.tabs[activeTabIndex];\n\t\t\t\tconst tabContentOptions = this.options.tabs[activeTabIndex].content;\n\t\t\t\treloadContent(activeTab.contentEl, tabContentOptions);\n\t\t\t}\n\t\t} else {\n\t\t\treloadContent(this.contentEl, this.options.content);\n\t\t}\n\t}\n\n\tpublic getContent(): HTMLElement | HTMLIFrameElement {\n\t\tlet contentContainer: HTMLElement;\n\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(`${LIBRARY_NAME}-active`));\n\n\t\tif (activeTabIndex > -1) {\n\t\t\t// If there's an active tab, use its content element\n\t\t\tcontentContainer = this.tabs[activeTabIndex].contentEl;\n\t\t} else {\n\t\t\t// Otherwise, use the main content element\n\t\t\tcontentContainer = this.contentEl;\n\t\t}\n\n\t\tconst iframe = contentContainer.querySelector(\"iframe\");\n\t\treturn iframe || contentContainer;\n\t}\n\n\t/**\n\t * 子ウィンドウマネージャを初期化または取得します。\n\t */\n\tprivate getChildManager(): WindowManager {\n\t\tif (!this.childManager) {\n\t\t\t// WindowManagerのコンストラクタとGlobalConfigの整合性を取る必要がある\n\t\t\t// ここでは簡易的に空のconfigで生成\n\t\t\tconst childConfig = {};\n\t\t\tthis.childManager = new WindowManager(childConfig);\n\n\t\t\t// 子マネージャのコンテナとして、このウィンドウのcontentElを指定\n\t\t\tthis.childManager.applyGlobalConfig({ container: this.contentEl });\n\t\t\tthis.childManager.init();\n\t\t}\n\t\treturn this.childManager;\n\t}\n\n\t/**\n\t * このウィンドウ内に新しいウィンドウを作成します。\n\t */\n\tpublic createWindow(options: WindowOptions = {}): IWindow {\n\t\t// iframeコンテンツの場合は、直接DOM操作する代わりにpostMessageを使用\n\t\tconst iframe = this.contentEl.querySelector(\"iframe\");\n\t\tif (iframe && iframe.contentWindow) {\n\t\t\tconst message = {\n\t\t\t\ttype: \"winlet:createWindow\",\n\t\t\t\toptions: options,\n\t\t\t};\n\t\t\t// iframeのオリジンを尊重\n\t\t\tiframe.contentWindow.postMessage(message, \"*\");\n\t\t\t// postMessageでは直接インスタンスを返せないため、暫定的にnullを返すか、Promiseベースの設計にする必要がある\n\t\t\t// ここでは未対応とし、コンソールに警告を出す\n\t\t\tconsole.warn(\"WinLet: Window creation inside an iframe is asynchronous and does not return an instance directly.\");\n\t\t\t// ダミーのインスタンスを返すか、APIの戻り値をvoidにするなどの検討が必要\n\t\t\treturn null as any; // 暫定\n\t\t}\n\n\t\t// 通常のHTMLコンテンツの場合\n\t\tconst manager = this.getChildManager();\n\t\t// 新しいウィンドウに自身を親として設定\n\t\toptions._parent = this;\n\t\treturn manager.createWindow(options);\n\t}\n\n\t/**\n\t * このウィンドウ内に新しいポップアップを作成します。\n\t */\n\tpublic createPopup(options: PopupOptions): IWindow {\n\t\tconst manager = this.getChildManager();\n\t\t// ポップアップにも自身を親として設定\n\t\tconst winOptions: WindowOptions = { _parent: this };\n\t\treturn manager.popup(Object.assign(options, winOptions));\n\t}\n\n\tpublic getTitle(): string {\n\t\treturn this.options.title;\n\t}\n\n\tpublic setTitle(title: string): void {\n\t\tthis.options.title = title;\n\t\tthis.titleEl.textContent = Utils.sanitizeHTML(title);\n\t\tthis.titleEl.setAttribute(\"aria-label\", Utils.sanitizeHTML(title));\n\t\tthis.manager.updateTaskbarItem(this, \"titleChanged\");\n\t}\n\n\tpublic setIcon(icon: string | null): void {\n\t\tthis.options.icon = icon;\n\t\tthis.iconEl.innerHTML = \"\";\n\t\tif (!icon) {\n\t\t\tthis.manager.updateTaskbarItem(this, \"iconChanged\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isFontAwesome(icon)) {\n\t\t\tconst i = document.createElement(\"i\");\n\t\t\ti.className = icon;\n\t\t\tthis.iconEl.appendChild(i);\n\t\t} else {\n\t\t\tconst img = document.createElement(\"img\");\n\t\t\timg.src = icon;\n\t\t\timg.alt = \"window icon\";\n\t\t\tthis.iconEl.appendChild(img);\n\t\t}\n\t\tthis.manager.updateTaskbarItem(this, \"iconChanged\");\n\t}\n\n\tpublic getPosition(): { x: number; y: number } {\n\t\tif (this.state === \"maximized\") {\n\t\t\treturn { x: this.lastState.x, y: this.lastState.y };\n\t\t}\n\t\treturn { x: this.el.offsetLeft, y: this.el.offsetTop };\n\t}\n\n\tpublic setPosition(x: number | \"center\" | \"left\" | \"right\", y: number | \"center\" | \"top\" | \"bottom\"): void {\n\t\t// containerが存在しない（初期化前）場合は処理を中断\n\t\tif (!this.manager.container) {\n\t\t\tconsole.warn(\"WinLet Warning: setPosition called before manager is initialized.\");\n\t\t\treturn;\n\t\t}\n\t\tconst parentRect = this.manager.container.getBoundingClientRect();\n\t\tconst winWidth = this.el.offsetWidth;\n\t\tconst winHeight = this.el.offsetHeight;\n\n\t\tlet finalX: number;\n\t\tlet finalY: number;\n\n\t\t// X座標の計算\n\t\tswitch (x) {\n\t\t\tcase \"left\":\n\t\t\t\tfinalX = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"center\":\n\t\t\t\tfinalX = (parentRect.width - winWidth) / 2;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tfinalX = parentRect.width - winWidth;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfinalX = x as number;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Y座標の計算\n\t\tswitch (y) {\n\t\t\tcase \"top\":\n\t\t\t\tfinalY = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"center\":\n\t\t\t\tfinalY = (parentRect.height - winHeight) / 2;\n\t\t\t\tbreak;\n\t\t\tcase \"bottom\":\n\t\t\t\tfinalY = parentRect.height - winHeight;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfinalY = y as number;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// 画面外にはみ出さないようにする既存のロジックを適用\n\t\tthis.el.style.left = `${Math.min(Math.max(150 - winWidth, finalX), parentRect.width - 150)}px`;\n\t\tthis.el.style.top = `${Math.min(Math.max(0, finalY), parentRect.height - 50)}px`;\n\t}\n\n\tpublic getSize(): { width: number; height: number } {\n\t\tif (this.state === \"maximized\") {\n\t\t\treturn { width: this.lastState.width, height: this.lastState.height };\n\t\t}\n\t\treturn { width: this.el.offsetWidth, height: this.el.offsetHeight };\n\t}\n\n\tpublic setSize(width: number | string, height: number | string): void {\n\t\tthis.el.style.width = typeof width === \"number\" ? `${width}px` : width;\n\t\tthis.el.style.height = typeof height === \"number\" ? `${height}px` : height;\n\t}\n\n\tpublic setOpacity(opacity: number): void {\n\t\tconst clampedOpacity = Math.max(0, Math.min(1, opacity));\n\t\tthis.options.windowOptions.opacity = clampedOpacity;\n\t\tthis.el.style.opacity = clampedOpacity.toString();\n\t}\n\n\tpublic getOpacity(): number {\n\t\treturn this.options.windowOptions.opacity!;\n\t}\n\n\tpublic setOptions(options: Partial<WindowOptions>): void {\n\t\t// ifExists\n\t\tif (typeof options.ifExists === \"boolean\") {\n\t\t\tthis.options.ifExists = options.ifExists;\n\t\t}\n\t\t// タイトル\n\t\tif (typeof options.title === \"string\") {\n\t\t\tthis.setTitle(options.title);\n\t\t}\n\t\t// アイコン\n\t\tif (typeof options.icon === \"string\" || options.icon === null) {\n\t\t\tthis.setIcon(options.icon);\n\t\t}\n\t\t// 位置\n\t\tlet x: number | \"center\" | \"left\" | \"right\" | null = null;\n\t\tif (typeof options.x === \"number\" || options.x === \"center\" || options.x === \"left\" || options.x === \"right\") {\n\t\t\tx = options.x;\n\t\t}\n\t\tlet y: number | \"center\" | \"top\" | \"bottom\" | null = null;\n\t\tif (typeof options.y === \"number\" || options.y === \"center\" || options.y === \"top\" || options.y === \"bottom\") {\n\t\t\ty = options.y;\n\t\t}\n\t\tif (x !== null || y !== null) {\n\t\t\tif (x === null) {\n\t\t\t\tx = this.getPosition().x;\n\t\t\t}\n\t\t\tif (y === null) {\n\t\t\t\ty = this.getPosition().y;\n\t\t\t}\n\t\t\tthis.setPosition(x, y);\n\t\t}\n\t\t// サイズ\n\t\tlet width: number | string | null = null;\n\t\tif (typeof options.width === \"number\" || typeof options.width === \"string\") {\n\t\t\twidth = options.width;\n\t\t}\n\t\tlet height: number | string | null = null;\n\t\tif (typeof options.height === \"number\" || typeof options.height === \"string\") {\n\t\t\theight = options.height;\n\t\t}\n\t\tif (width !== null || height !== null) {\n\t\t\tif (width === null) {\n\t\t\t\twidth = this.getSize().width;\n\t\t\t}\n\t\t\tif (height === null) {\n\t\t\t\theight = this.getSize().height;\n\t\t\t}\n\t\t\tthis.setSize(width, height);\n\t\t}\n\n\t\tconst windowOptions = options.windowOptions || {};\n\n\t\t// 不透明度\n\t\tif (typeof windowOptions.opacity === \"number\") {\n\t\t\tthis.setOpacity(windowOptions.opacity);\n\t\t}\n\t\t// 常に手前に表示\n\t\tif (typeof windowOptions.alwaysOnTop === \"boolean\") {\n\t\t\tthis.options.windowOptions.alwaysOnTop = windowOptions.alwaysOnTop;\n\t\t\tthis.el.classList.toggle(`${LIBRARY_NAME}-always-on-top`, windowOptions.alwaysOnTop);\n\t\t\t// z-indexを再評価するためにフォーカスする\n\t\t\tthis.focus();\n\t\t}\n\t\t// ゴーストウィンドウ\n\t\tif (typeof windowOptions.useGhostWindow === \"boolean\") {\n\t\t\tthis.options.windowOptions.useGhostWindow = windowOptions.useGhostWindow;\n\t\t}\n\t}\n}\n","// src/WindowManager.ts\n\nimport { defaultConfig } from \"../const/config\";\nimport { WinLetError } from \"../const/errors\";\nimport { ContextMenuItem, GlobalConfigOptions, IWindow, LIBRARY_NAME, MenuItem, PopupButton, PopupButtonPreset, PopupOptions, PopupResult, TabItem, Theme, TIMEOUT_RESULT, WindowOptions } from \"../const/types\";\nimport WinLetBaseClass from \"../libs/baseclass\";\nimport Utils from \"../libs/utils\";\nimport styleData from \"../style/styles\";\nimport { darkTheme } from \"../style/themes/dark\";\nimport { defaultTheme } from \"../style/themes/default\";\nimport WinLetWindow from \"./window\";\n\nexport default class WindowManager extends WinLetBaseClass {\n\tpublic container: HTMLElement | null = null;\n\tprivate workspaceEl: HTMLElement | null = null;\n\tprivate static allWindows = new Map<string, WinLetWindow>();\n\tprivate windows = new Map<string, WinLetWindow>();\n\t// z-indexを通常と最前面で分離\n\tprivate zIndexCounter = 1000;\n\tprivate zIndexCounterOnTop = 50000;\n\tprivate activeWindow: WinLetWindow | null = null;\n\tprivate contextMenuEl: HTMLElement | null = null;\n\tprivate _isInitialized = false;\n\n\tprivate globalConfig: GlobalConfigOptions;\n\n\tprivate lastAutoPosition: { x: number; y: number } | null = null;\n\tprivate lastPopupPosition: { x: number; y: number } | null = null;\n\tprivate readonly CASCADE_OFFSET = 30;\n\n\tpublic draggingTabInfo: { sourceWindowId: string } | null = null;\n\n\tprivate taskbarEl: HTMLElement | null = null;\n\tprivate themes = new Map<string, Theme>();\n\tprivate activeTheme: Theme | null = null;\n\tprivate boundTabPressHandler: ((e: KeyboardEvent) => void) | null = null;\n\n\tconstructor(initialConfig: GlobalConfigOptions) {\n\t\tsuper();\n\t\tthis.globalConfig = initialConfig;\n\t\tthis.registerTheme(defaultTheme);\n\t\tthis.registerTheme(darkTheme);\n\t}\n\n\t/**\n\t * ライブラリが初期化済みかどうかを取得します。\n\t */\n\tpublic get isInitialized(): boolean {\n\t\treturn this._isInitialized;\n\t}\n\n\tpublic applyGlobalConfig(options: GlobalConfigOptions) {\n\t\tObject.assign(this.globalConfig, options);\n\t\t// アニメーション設定をコンテナクラスに反映\n\t\tif (this.container) {\n\t\t\tthis.container.classList.toggle(`${LIBRARY_NAME}-animations-disabled`, !this.globalConfig.enableAnimations);\n\n\t\t\t// タスクバーの有効・無効切り替えとレイアウト更新\n\t\t\tif (this.globalConfig.enableTaskbar) {\n\t\t\t\tif (!this.taskbarEl) {\n\t\t\t\t\t// タスクバーがなければ作成\n\t\t\t\t\tthis.createTaskbar();\n\t\t\t\t}\n\t\t\t\tthis.updateTaskbarLayout();\n\t\t\t} else if (this.taskbarEl) {\n\t\t\t\t// 無効化された場合\n\t\t\t\tthis.taskbarEl.remove();\n\t\t\t\tthis.taskbarEl = null;\n\t\t\t\t// flex-directionをリセット\n\t\t\t\tthis.container.style.flexDirection = \"\";\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic getGlobalConfig(): GlobalConfigOptions {\n\t\treturn this.globalConfig;\n\t}\n\n\tpublic init(): void {\n\t\tif (this._isInitialized) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet parentEl: HTMLElement | null = null;\n\t\tif (typeof this.globalConfig.container === \"string\") {\n\t\t\tparentEl = document.querySelector<HTMLElement>(this.globalConfig.container);\n\t\t\tif (!parentEl) {\n\t\t\t\tthrow new WinLetError(`WinLet: The specified container \"${this.globalConfig.container}\" was not found.`);\n\t\t\t}\n\t\t} else if (this.globalConfig.container instanceof HTMLElement) {\n\t\t\tparentEl = this.globalConfig.container;\n\t\t}\n\n\t\t// 親が指定されていない場合は、デフォルトでbodyに設定\n\t\tif (!parentEl) {\n\t\t\tif (!document.body) {\n\t\t\t\tthrow new WinLetError(\"Cannot initialize before document.body is ready. Please call WinLet.init() after DOMContentLoaded.\");\n\t\t\t}\n\t\t\tparentEl = document.body;\n\t\t}\n\n\t\tif (!document.getElementById(`${LIBRARY_NAME}-styles`)) {\n\t\t\tconst styleTag = document.createElement(\"style\");\n\t\t\tstyleTag.id = `${LIBRARY_NAME}-styles`;\n\t\t\tstyleTag.innerHTML = this.getStyleData();\n\t\t\tdocument.head.appendChild(styleTag);\n\t\t}\n\t\tlet containerEl = parentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-container`);\n\t\tif (!containerEl) {\n\t\t\tcontainerEl = document.createElement(\"div\");\n\t\t\tcontainerEl.className = `${LIBRARY_NAME}-container`;\n\t\t\tparentEl.appendChild(containerEl);\n\t\t}\n\t\tthis.container = containerEl;\n\n\t\tthis.workspaceEl = document.createElement(\"div\");\n\t\tthis.workspaceEl.className = `${LIBRARY_NAME}-workspace`;\n\t\tthis.container.appendChild(this.workspaceEl);\n\n\t\t// 初期設定を適用\n\t\tthis.applyGlobalConfig(this.globalConfig);\n\n\t\tif (parentEl !== document.body) {\n\t\t\tthis.container.classList.add(`${LIBRARY_NAME}-is-nested`);\n\n\t\t\t// Ensure the parent can act as a positioning context\n\t\t\tconst computedStyle = window.getComputedStyle(parentEl);\n\t\t\tif (computedStyle.position === \"static\") {\n\t\t\t\tparentEl.style.position = \"relative\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.globalConfig.enableTaskbar) {\n\t\t\tif (!this.taskbarEl) {\n\t\t\t\t// タスクバーがなければ作成\n\t\t\t\tthis.createTaskbar();\n\t\t\t}\n\t\t}\n\n\t\tif (this.globalConfig.theme) {\n\t\t\tthis.setTheme(this.globalConfig.theme);\n\t\t} else {\n\t\t\tthis.setTheme(\"default\");\n\t\t}\n\n\t\twindow.addEventListener(\"blur\", () =>\n\t\t\t// 次のイベントサイクルでアクティブな要素を取得\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tconst activeEl = document.activeElement;\n\t\t\t\t// フォーカスがiframeに移った場合\n\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\n\t\t\t\t\t// そのiframeがWinLetのウィンドウ内にあるか探索\n\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\t\t\t\tif (winEl) {\n\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\n\t\t\t\t\t\t// 対象のウィンドウが存在し、まだアクティブでなければフォーカスする\n\t\t\t\t\t\tif (win && this.activeWindow !== win) {\n\t\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tdocument.addEventListener(\n\t\t\t\"pointerdown\",\n\t\t\t() =>\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tconst activeEl = document.activeElement;\n\t\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\n\t\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\t\t\t\t\tif (winEl) {\n\t\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\n\t\t\t\t\t\t\tif (win && this.activeWindow !== win) {\n\t\t\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\ttrue\n\t\t);\n\n\t\t// ウィンドウ外クリックでblurさせる処理を追加\n\t\tdocument.addEventListener(\"pointerdown\", (e: PointerEvent) => {\n\t\t\t// e.targetがHTMLElementでない場合や、アクティブなウィンドウがない場合は何もしない\n\t\t\tif (!(e.target instanceof HTMLElement) || !this.activeWindow || this.activeWindow.options.windowOptions.modal) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// クリックされた場所がウィンドウまたはコンテキストメニューの内側かどうかを判定\n\t\t\tconst clickedWindow = e.target.closest(`.${LIBRARY_NAME}-window`);\n\t\t\tconst clickedContextMenu = e.target.closest(`.${LIBRARY_NAME}-context-menu`);\n\t\t\tconst clickedTaskbar = e.target.closest(`.${LIBRARY_NAME}-taskbar`);\n\n\t\t\t// ウィンドウやコンテキストメニューの外側がクリックされた場合\n\t\t\tif (!clickedWindow && !clickedContextMenu && !clickedTaskbar) {\n\t\t\t\t// アクティブなウィンドウのフォーカスを外す\n\t\t\t\tconst active = this.activeWindow;\n\t\t\t\tthis.activeWindow = null;\n\t\t\t\tactive.blur();\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener(\"click\", () => this.hideContextMenu());\n\n\t\twindow.addEventListener(\"message\", (event) => {\n\t\t\t// メッセージの形式を検証\n\t\t\tif (event.data && event.data.type === \"winlet:createWindow\" && typeof event.data.options === \"object\") {\n\t\t\t\t// メッセージの送信元が管理下のiframeか検証（セキュリティ対策）\n\t\t\t\tlet isSourceValid = false;\n\t\t\t\tlet sourceWindow: WinLetWindow | null = null;\n\t\t\t\tfor (const win of this.windows.values()) {\n\t\t\t\t\tconst iframe = win.el.querySelector(\"iframe\");\n\t\t\t\t\tif (iframe && iframe.contentWindow === event.source) {\n\t\t\t\t\t\tisSourceValid = true;\n\t\t\t\t\t\t// メッセージの送信元ウィンドウを特定\n\t\t\t\t\t\tsourceWindow = win;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (isSourceValid) {\n\t\t\t\t\t// 送信元ウィンドウ(sourceWindow)が存在すれば、それは親ウィンドウであり、\n\t\t\t\t\t// その中に新しいウィンドウを作成する。\n\t\t\t\t\tif (sourceWindow) {\n\t\t\t\t\t\t// iframeの親ウィンドウのcreateWindowを呼び出す\n\t\t\t\t\t\tsourceWindow.createWindow(event.data.options);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 通常のトップレベルでのウィンドウ作成\n\t\t\t\t\t\tthis.createWindow(event.data.options);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"WinLet: Untrusted source attempted to create a window.\", event.origin);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._isInitialized = true;\n\t\tthis.setupShortcutListeners();\n\n\t\t// タブ分離機能のためのグローバルなD&Dリスナー\n\t\tthis.workspaceEl!.addEventListener(\"dragover\", (e) => {\n\t\t\tif (e.dataTransfer?.types.includes(\"application/winlet-tab\")) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\tthis.workspaceEl!.addEventListener(\"drop\", (e) => {\n\t\t\t// ドロップ先がウィンドウやタブバーの中なら何もしない\n\t\t\tconst targetEl = e.target as HTMLElement;\n\t\t\tif (targetEl.closest(`.${LIBRARY_NAME}-window`)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\n\t\t\tconst tabDataJSON = e.dataTransfer?.getData(\"application/winlet-tab\");\n\t\t\tconst sourceWindowId = e.dataTransfer?.getData(\"application/winlet-source-window-id\");\n\t\t\tconst sourceTabId = e.dataTransfer?.getData(\"text/plain\");\n\n\t\t\tif (tabDataJSON && sourceWindowId && sourceTabId) {\n\t\t\t\tconst sourceWindow = this.windows.get(sourceWindowId);\n\t\t\t\tif (!sourceWindow || !sourceWindow.options.tabOptions.detachable) return;\n\n\t\t\t\tconst tabData: TabItem = JSON.parse(tabDataJSON);\n\t\t\t\tconst newTab: TabItem = {\n\t\t\t\t\ttitle: tabData.title,\n\t\t\t\t\tcontent: tabData.content,\n\t\t\t\t};\n\n\t\t\t\tconst mergedWindowOptions = Utils.deepMerge(Utils.deepCopy(sourceWindow.options), {\n\t\t\t\t\ttabs: [newTab],\n\t\t\t\t\tx: e.clientX,\n\t\t\t\t\ty: e.clientY,\n\t\t\t\t\twidth: sourceWindow.getSize().width,\n\t\t\t\t\theight: sourceWindow.getSize().height,\n\t\t\t\t});\n\n\t\t\t\t// 新しいウィンドウを作成\n\t\t\t\tthis.createWindow(mergedWindowOptions);\n\n\t\t\t\t// 元のウィンドウからタブを削除\n\t\t\t\tsourceWindow.closeTab(parseInt(sourceTabId, 10));\n\t\t\t}\n\t\t});\n\t}\n\n\t// ショートカットキーのリスナーを統合\n\tprivate setupShortcutListeners() {\n\t\tdocument.addEventListener(\n\t\t\t\"keydown\",\n\t\t\t(e) => {\n\t\t\t\t// --- 1. グローバルショートカット (ウィンドウ切り替え) ---\n\t\t\t\tif (this.globalConfig.windowSwitchShortcut) {\n\t\t\t\t\tconst shortcut = this.parseShortcut(this.globalConfig.windowSwitchShortcut);\n\n\t\t\t\t\tif (e.key.toLowerCase() === shortcut.key.toLowerCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst windows = Array.from(this.windows.values());\n\n\t\t\t\t\t\tconst currentIndex = this.activeWindow ? windows.findIndex((w) => w === this.activeWindow) : -1;\n\t\t\t\t\t\tconst nextIndex = (currentIndex + 1) % windows.length;\n\n\t\t\t\t\t\tconst win = windows[nextIndex];\n\t\t\t\t\t\tif (win.state === \"minimized\") {\n\t\t\t\t\t\t\twin.restore();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// --- 2. ウィンドウ固有のショートカット ---\n\t\t\t\tconst targetWindow = this.activeWindow;\n\n\t\t\t\t// ターゲットウィンドウがなければ何もしない\n\t\t\t\tif (!targetWindow || !targetWindow.options.enableShortcuts) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// --- 3. タブ切り替えショートカット (Ctrl+Shift+[1-9]) ---\n\t\t\t\tif (e.ctrlKey && e.shiftKey && (targetWindow.options.tabs?.length ?? 0) > 0) {\n\t\t\t\t\t// Shiftキーの影響を受けない e.code で判定する\n\t\t\t\t\tif (e.code.startsWith(\"Digit\")) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\tconst keyNum = parseInt(e.code.replace(\"Digit\", \"\"), 10);\n\n\t\t\t\t\t\tconst tabs = targetWindow.getTabs();\n\t\t\t\t\t\tconst numTabs = tabs.length;\n\t\t\t\t\t\tlet tabIndex = -1;\n\n\t\t\t\t\t\tif (keyNum >= 1 && keyNum <= 8) {\n\t\t\t\t\t\t\ttabIndex = keyNum - 1;\n\t\t\t\t\t\t} else if (keyNum === 9) {\n\t\t\t\t\t\t\ttabIndex = numTabs - 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (tabIndex >= 0 && tabIndex < numTabs) {\n\t\t\t\t\t\t\ttargetWindow.activateTab(tabIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn; // 他のショートカットと重複しないようにreturn\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// --- 4. ショートカットキーを検索して実行 ---\n\t\t\t\tconst findAndExecShortcut = (menuItems: MenuItem[]) => {\n\t\t\t\t\tfor (const item of menuItems) {\n\t\t\t\t\t\tif (item.shortcut) {\n\t\t\t\t\t\t\tconst shortcut = this.parseShortcut(item.shortcut);\n\t\t\t\t\t\t\tif (e.key.toUpperCase() === shortcut.key.toUpperCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\titem.action?.(targetWindow!);\n\t\t\t\t\t\t\t\treturn true; // 実行したら探索終了\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (item.items && findAndExecShortcut(item.items)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\t\tfindAndExecShortcut(targetWindow.options.menu);\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\t}\n\n\t// 未初期化の場合に自動でinitを呼び出すヘルパー\n\tprivate ensureInitialized(): void {\n\t\tif (!this._isInitialized) {\n\t\t\tthis.init();\n\t\t}\n\t}\n\n\t/**\n\t * スタイルシートを取得\n\t */\n\tprivate getStyleData() {\n\t\treturn this.replaceStringVariable(styleData);\n\t}\n\n\t/**\n\t * 変数置換\n\t */\n\tprivate replaceStringVariable(str: string) {\n\t\treturn str.replace(/\\$\\[(\\w+)\\]/g, (a, p) => {\n\t\t\tswitch (p) {\n\t\t\t\tcase \"prefix\":\n\t\t\t\t\treturn LIBRARY_NAME;\n\t\t\t}\n\t\t\treturn p;\n\t\t});\n\t}\n\n\tpublic createWindow(options: WindowOptions): WinLetWindow {\n\t\tthis.ensureInitialized();\n\n\t\tconst ifExists = options.ifExists ?? \"focus\";\n\n\t\tif (options.id && ifExists !== \"create\") {\n\t\t\tconst existingWindow = this.getWindow(options.id);\n\t\t\tif (existingWindow) {\n\t\t\t\tif (ifExists === \"prevent\") {\n\t\t\t\t\treturn existingWindow; // 何もせず既存インスタンスを返す\n\t\t\t\t}\n\t\t\t\tif (ifExists === \"focus\") {\n\t\t\t\t\tif (existingWindow.state === \"minimized\") {\n\t\t\t\t\t\texistingWindow.restore();\n\t\t\t\t\t}\n\t\t\t\t\texistingWindow.focus();\n\t\t\t\t\treturn existingWindow; // フォーカスして既存インスタンスを返す\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst creationOptions: Required<WindowOptions> = Utils.deepMerge(Utils.deepCopy(defaultConfig), options);\n\t\tif (creationOptions.x === \"auto\" || creationOptions.y === \"auto\") {\n\t\t\tconst winWidth = creationOptions.width;\n\t\t\tconst winHeight = creationOptions.height;\n\t\t\tconst containerRect = this.workspaceEl!.getBoundingClientRect();\n\n\t\t\tlet nextX: number;\n\t\t\tlet nextY: number;\n\n\t\t\tif (this.lastAutoPosition === null) {\n\t\t\t\tnextX = 0;\n\t\t\t\tnextY = 0;\n\t\t\t} else {\n\t\t\t\t// 右下へカスケード\n\t\t\t\tnextX = this.lastAutoPosition.x + this.CASCADE_OFFSET;\n\t\t\t\tnextY = this.lastAutoPosition.y + this.CASCADE_OFFSET;\n\t\t\t}\n\n\t\t\t// はみ出しチェックとリセット\n\t\t\tif (nextX + winWidth > containerRect.width) {\n\t\t\t\tnextX = 0;\n\t\t\t}\n\t\t\tif (nextY + winHeight > containerRect.height) {\n\t\t\t\tnextY = 0;\n\t\t\t}\n\n\t\t\t// 計算結果をオプションに反映\n\t\t\tcreationOptions.x = nextX;\n\t\t\tcreationOptions.y = nextY;\n\n\t\t\t// 次回のために位置を保存\n\t\t\tthis.lastAutoPosition = { x: nextX, y: nextY };\n\t\t}\n\n\t\tconst win = new WinLetWindow(creationOptions, this);\n\t\tthis.windows.set(win.id, win);\n\t\tWindowManager.allWindows.set(win.id, win);\n\t\tthis.workspaceEl!.appendChild(win.el);\n\n\t\tif (this.taskbarEl) {\n\t\t\tthis.createTaskbarItem(win);\n\t\t}\n\n\t\twin.setPosition(creationOptions.x, creationOptions.y);\n\t\tif (creationOptions.windowOptions.focus) {\n\t\t\tthis.focusWindow(win);\n\t\t\twin.focus();\n\t\t} else {\n\t\t\t// フォーカスしない場合でも、z-indexの管理は必要\n\t\t\twin.el.style.zIndex = `${win.options.windowOptions.alwaysOnTop ? ++this.zIndexCounterOnTop : ++this.zIndexCounter}`;\n\t\t}\n\t\treturn win;\n\t}\n\n\tpublic popup(options: PopupOptions): WinLetWindow {\n\t\tthis.ensureInitialized();\n\t\tlet buttons: PopupButton[];\n\t\tconst buttonPresets: { [key in PopupButtonPreset]: PopupButton[] } = {\n\t\t\tOk: [{ text: \"OK\", value: 1 }],\n\t\t\tOkCancel: [\n\t\t\t\t{ text: \"OK\", value: 1 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tYes: [{ text: \"Yes\", value: 6 }],\n\t\t\tYesNo: [\n\t\t\t\t{ text: \"Yes\", value: 6 },\n\t\t\t\t{ text: \"No\", value: 7 },\n\t\t\t],\n\t\t\tYesNoCancel: [\n\t\t\t\t{ text: \"Yes\", value: 6 },\n\t\t\t\t{ text: \"No\", value: 7 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tRetry: [{ text: \"Retry\", value: 4 }],\n\t\t\tRetryCancel: [\n\t\t\t\t{ text: \"Retry\", value: 4 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tAbortRetryIgnore: [\n\t\t\t\t{ text: \"Abort\", value: 3 },\n\t\t\t\t{ text: \"Retry\", value: 4 },\n\t\t\t\t{ text: \"Ignore\", value: 5 },\n\t\t\t],\n\t\t};\n\t\tif (Array.isArray(options.buttons)) {\n\t\t\tbuttons = options.buttons;\n\t\t} else {\n\t\t\tbuttons = buttonPresets[options.buttons || \"Ok\"] || buttonPresets.Ok;\n\t\t}\n\n\t\tlet timeoutId: number | null = null;\n\t\tconst closeCallback = (result: PopupResult) => {\n\t\t\tif (timeoutId) clearTimeout(timeoutId);\n\t\t\ttimeoutId = null;\n\t\t\toptions.onClose?.(result);\n\t\t};\n\n\t\tconst messageHTML = `<div class=\"${LIBRARY_NAME}-popup-message\">${Utils.sanitizeHTML(options.message)}</div>`;\n\t\tconst buttonsHTML = buttons.map((btn, index) => `<input class=\"${LIBRARY_NAME}-popup-button\" data-index=\"${index}\" type=\"button\" value=\"${Utils.sanitizeHTML(btn.text)}\" role=\"button\"/>`).join(\"\");\n\t\tconst contentHTML = `${messageHTML}<div class=\"${LIBRARY_NAME}-popup-buttons\" role=\"spinbutton\">${buttonsHTML}</div>`;\n\n\t\tconst winOptions: WindowOptions = {\n\t\t\tid: Utils.generateId(`${LIBRARY_NAME}-popup`),\n\t\t\ttitle: options.title || \"\",\n\t\t\ticon: options.icon,\n\t\t\twindowOptions: {\n\t\t\t\tresizableX: false,\n\t\t\t\tresizableY: false,\n\t\t\t\tmovable: true,\n\t\t\t\tclosable: true,\n\t\t\t\tminimizable: false,\n\t\t\t\tmaximizable: false,\n\t\t\t\tmaximizableOnDblClick: false,\n\t\t\t\tmodal: options.modal ?? true,\n\t\t\t\talwaysOnTop: options.alwaysOnTop ?? false,\n\t\t\t\tfocus: options.focus ?? true,\n\t\t\t},\n\t\t\tenableShortcuts: false,\n\t\t\tcontent: { html: contentHTML },\n\t\t\t_isPopup: true,\n\t\t};\n\t\tif (options.onFocus) winOptions.onFocus = options.onFocus;\n\t\tif (options.onBlur) winOptions.onBlur = options.onBlur;\n\n\t\tif (options.autoWidth) {\n\t\t\tconst temp = document.createElement(\"span\");\n\t\t\ttemp.style.visibility = \"hidden\";\n\t\t\ttemp.style.position = \"absolute\";\n\t\t\ttemp.style.whiteSpace = \"pre\";\n\t\t\ttemp.className = `${LIBRARY_NAME}-popup-message`;\n\t\t\ttemp.innerHTML = Utils.sanitizeHTML(options.message);\n\t\t\tthis.workspaceEl?.appendChild(temp);\n\t\t\twinOptions.width = temp.offsetWidth + 80; // メッセージ幅 + パディング\n\t\t\tthis.workspaceEl?.removeChild(temp);\n\t\t} else {\n\t\t\twinOptions.width = 300;\n\t\t}\n\t\twinOptions.height = 150;\n\n\t\twinOptions.x = \"center\";\n\t\twinOptions.y = \"center\";\n\n\t\tconst win = this.createWindow(winOptions);\n\t\t// 計算が面倒なので前回1回分のみで判断\n\t\tlet winPosition = win.getPosition();\n\t\tif (this.lastPopupPosition && this.lastPopupPosition.x === winPosition.x && this.lastPopupPosition.y === winPosition.y) {\n\t\t\twin.setPosition(this.lastPopupPosition.x + this.CASCADE_OFFSET, this.lastPopupPosition.y + this.CASCADE_OFFSET);\n\t\t\twinPosition = win.getPosition();\n\t\t}\n\t\tthis.lastPopupPosition = winPosition;\n\t\twin.popupCloseCallback = closeCallback;\n\n\t\twin.el.querySelectorAll<HTMLButtonElement>(`.${LIBRARY_NAME}-popup-button`).forEach((button) => {\n\t\t\tbutton.addEventListener(\"click\", () => {\n\t\t\t\tconst index = parseInt(button.dataset.index!, 10);\n\t\t\t\tconst result = buttons[index].value;\n\t\t\t\tcloseCallback(result);\n\t\t\t\twin.close();\n\t\t\t});\n\t\t});\n\n\t\tif (options.timeout && options.timeout > 0) {\n\t\t\ttimeoutId = window.setTimeout(() => {\n\t\t\t\tif (this.windows.has(win.id)) {\n\t\t\t\t\tcloseCallback(TIMEOUT_RESULT);\n\t\t\t\t\twin.close();\n\t\t\t\t}\n\t\t\t}, options.timeout);\n\t\t}\n\t\treturn win;\n\t}\n\n\tpublic destroyWindow(id: string): void {\n\t\tthis.ensureInitialized();\n\t\tconst win = this.windows.get(id);\n\t\tif (win) {\n\t\t\tif (win.options._taskbarItem) {\n\t\t\t\twin.options._taskbarItem.remove();\n\t\t\t}\n\t\t\tif (win.options.windowOptions.modal) {\n\t\t\t\tthis.deactivateFocusTrap();\n\t\t\t}\n\n\t\t\twin.el.remove();\n\t\t\tthis.windows.delete(id);\n\t\t\tWindowManager.allWindows.delete(id);\n\t\t\tif (this.activeWindow === win) {\n\t\t\t\tthis.activeWindow = null;\n\t\t\t\tconst nextWin = Array.from(this.windows.values()).pop();\n\t\t\t\tif (nextWin) this.focusWindow(nextWin);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic focusWindow(win: WinLetWindow): void {\n\t\tthis.ensureInitialized();\n\t\tif (this.activeWindow === win && !win.options.windowOptions.modal) return;\n\n\t\t// 自身が管理する他のウィンドウをぼかす\n\t\tthis.activeWindow?.blur();\n\n\t\t// モーダルかつフォーカストラップ有効ならトラップ開始\n\t\tif (win.options.windowOptions.modal && this.globalConfig.enableFocusTrapping) {\n\t\t\tthis.activateFocusTrap(win);\n\t\t} else {\n\t\t\t// そうでなければ既存のトラップは解除\n\t\t\tthis.deactivateFocusTrap();\n\t\t}\n\n\t\tthis.activeWindow = win;\n\t\twin.el.style.zIndex = `${win.options.windowOptions.alwaysOnTop ? ++this.zIndexCounterOnTop : ++this.zIndexCounter}`;\n\n\t\tthis.windows.forEach((w) => w.options._taskbarItem?.classList.remove(`${LIBRARY_NAME}-active`));\n\t\twin.options._taskbarItem?.classList.add(`${LIBRARY_NAME}-active`);\n\t\t// focus()はWindowクラス側で呼ばれるので不要\n\t}\n\n\tpublic getWindow(id: string): WinLetWindow | undefined {\n\t\tthis.ensureInitialized();\n\t\treturn this.windows.get(id);\n\t}\n\n\tpublic getWindowFromElement(element: HTMLElement): WinLetWindow | undefined {\n\t\tthis.ensureInitialized();\n\t\tconst winEl = element.closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\tif (winEl?.id) {\n\t\t\treturn WindowManager.allWindows.get(winEl.id);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic getActiveWindow(): WinLetWindow | null {\n\t\tthis.ensureInitialized();\n\t\treturn this.activeWindow;\n\t}\n\n\tpublic onTabDragStart(sourceWindowId: string): void {\n\t\tthis.workspaceEl?.classList.add(`${LIBRARY_NAME}-is-tab-dragging`);\n\t\tthis.draggingTabInfo = { sourceWindowId };\n\t}\n\n\tpublic onTabDragEnd(): void {\n\t\tthis.workspaceEl?.classList.remove(`${LIBRARY_NAME}-is-tab-dragging`);\n\t\tthis.draggingTabInfo = null;\n\t}\n\n\tpublic showContextMenu(x: number, y: number, menuItems: ContextMenuItem[], contextWindow: IWindow): void {\n\t\tthis.ensureInitialized();\n\t\tthis.hideContextMenu();\n\n\t\tthis.contextMenuEl = document.createElement(\"ul\");\n\t\tthis.contextMenuEl.className = `${LIBRARY_NAME}-context-menu`;\n\n\t\tmenuItems.forEach((itemData) => {\n\t\t\tconst itemEl = document.createElement(\"li\");\n\t\t\tif (itemData.separator) {\n\t\t\t\titemEl.className = `${LIBRARY_NAME}-separator`;\n\t\t\t} else {\n\t\t\t\titemEl.textContent = itemData.name ?? \"\";\n\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\titemData.action?.(contextWindow);\n\t\t\t\t\tthis.hideContextMenu();\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.contextMenuEl!.appendChild(itemEl);\n\t\t});\n\n\t\tthis.workspaceEl!.appendChild(this.contextMenuEl);\n\n\t\tconst { offsetWidth: menuWidth, offsetHeight: menuHeight } = this.contextMenuEl;\n\t\tconst { innerWidth: screenWidth, innerHeight: screenHeight } = window;\n\n\t\tthis.contextMenuEl.style.left = x + menuWidth > screenWidth ? `${screenWidth - menuWidth}px` : `${x}px`;\n\t\tthis.contextMenuEl.style.top = y + menuHeight > screenHeight ? `${screenHeight - menuHeight}px` : `${y}px`;\n\t}\n\n\tpublic hideContextMenu(): void {\n\t\tthis.contextMenuEl?.remove();\n\t\tthis.contextMenuEl = null;\n\t}\n\n\tpublic registerTheme(theme: Theme): void {\n\t\tthis.themes.set(theme.name, theme);\n\t}\n\n\tpublic getRegisteredThemes(): string[] {\n\t\treturn Array.from(this.themes.keys());\n\t}\n\n\tpublic setTheme(theme: string | Theme): void {\n\t\tconst themeObj = typeof theme === \"string\" ? this.themes.get(theme.toLowerCase()) : theme;\n\t\tif (!themeObj) {\n\t\t\tconsole.warn(`WinLet: Theme \"${theme}\" not found.`);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.container) {\n\t\t\tconsole.warn(\"WinLet: Container not found.\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.activeTheme) {\n\t\t\tfor (const [key, value] of Object.entries(this.activeTheme.variables)) {\n\t\t\t\tif (!(key in themeObj.variables)) {\n\t\t\t\t\tthis.container.style.removeProperty(this.replaceStringVariable(key));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.activeTheme = themeObj;\n\t\tfor (const [key, value] of Object.entries(themeObj.variables)) {\n\t\t\tthis.container.style.setProperty(this.replaceStringVariable(key), this.replaceStringVariable(value));\n\t\t}\n\t}\n\n\tpublic getTheme(): Theme | null {\n\t\treturn this.activeTheme;\n\t}\n\n\tprivate createTaskbar(): void {\n\t\tif (!this.container) return;\n\t\tthis.taskbarEl = document.createElement(\"div\");\n\t\tthis.taskbarEl.className = `${LIBRARY_NAME}-taskbar ${LIBRARY_NAME}-us-none`;\n\t\tthis.updateTaskbarLayout();\n\t\tthis.container.appendChild(this.taskbarEl);\n\t}\n\n\tprivate updateTaskbarLayout(): void {\n\t\tif (!this.taskbarEl || !this.container) return;\n\n\t\tconst taskbarOpts = this.globalConfig.taskbar || {};\n\t\tconst position = taskbarOpts.position || \"bottom\";\n\n\t\tswitch (position) {\n\t\t\tcase \"top\":\n\t\t\tcase \"bottom\":\n\t\t\tcase \"left\":\n\t\t\tcase \"right\":\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new WinLetError(`Invalid taskbar position: ${position}`);\n\t\t}\n\n\t\t// クラスを一度リセット\n\t\tthis.taskbarEl.className = `${LIBRARY_NAME}-taskbar ${LIBRARY_NAME}-us-none`;\n\n\t\t// 位置クラスを追加\n\t\tthis.taskbarEl.classList.add(`${LIBRARY_NAME}-taskbar-${position}`);\n\n\t\tif (!this.taskbarEl.isConnected) {\n\t\t\tthis.container.appendChild(this.taskbarEl);\n\t\t}\n\n\t\tthis.container.style.flexDirection = \"\";\n\t\tthis.taskbarEl.style.order = \"\";\n\t\tif (this.workspaceEl) {\n\t\t\tthis.workspaceEl.style.order = \"\";\n\t\t}\n\n\t\tthis.container.style.paddingTop = \"0\";\n\t\tthis.container.style.paddingBottom = \"0\";\n\t\tthis.container.style.paddingLeft = \"0\";\n\t\tthis.container.style.paddingRight = \"0\";\n\n\t\t// getComputedStyleで実際のタスクバーサイズを取得\n\t\tconst computedStyle = window.getComputedStyle(this.taskbarEl);\n\t\tconst taskbarHeight = computedStyle.height;\n\t\tconst taskbarWidth = computedStyle.width;\n\n\t\tswitch (position) {\n\t\t\tcase \"top\":\n\t\t\t\tthis.container.style.paddingTop = taskbarHeight;\n\t\t\t\tthis.container.style.flexDirection = \"column-reverse\";\n\t\t\t\tthis.taskbarEl.style.order = \"1\";\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"2\";\n\t\t\t\tbreak;\n\t\t\tcase \"bottom\":\n\t\t\t\tthis.container.style.paddingBottom = taskbarHeight;\n\t\t\t\tthis.container.style.flexDirection = \"column\";\n\t\t\t\tthis.taskbarEl.style.order = \"2\";\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"1\";\n\t\t\t\tbreak;\n\t\t\tcase \"left\":\n\t\t\t\tthis.container.style.paddingLeft = taskbarWidth;\n\t\t\t\tthis.container.style.flexDirection = \"row-reverse\";\n\t\t\t\tthis.taskbarEl.style.order = \"1\";\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"2\";\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tthis.container.style.paddingRight = taskbarWidth;\n\t\t\t\tthis.container.style.flexDirection = \"row\";\n\t\t\t\tthis.taskbarEl.style.order = \"2\";\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"1\";\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate createTaskbarItem(win: WinLetWindow): void {\n\t\tif (!this.taskbarEl) return;\n\t\tconst item = document.createElement(\"div\");\n\t\titem.className = `${LIBRARY_NAME}-taskbar-item`;\n\t\titem.textContent = win.getTitle();\n\t\titem.title = win.getTitle();\n\t\titem.dataset.windowId = win.id;\n\n\t\tthis.updateTaskbarItemContent(item, win);\n\n\t\titem.addEventListener(\"click\", () => {\n\t\t\tif (win.state === \"minimized\") {\n\t\t\t\twin.restore();\n\t\t\t} else {\n\t\t\t\tif (this.activeWindow === win) {\n\t\t\t\t\twin.minimize();\n\t\t\t\t} else {\n\t\t\t\t\twin.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\twin.options._taskbarItem = item;\n\t\tthis.taskbarEl.appendChild(item);\n\t}\n\n\tprivate updateTaskbarItemContent(item: HTMLElement, win: WinLetWindow) {\n\t\tconst { icon, taskbarOptions } = win.options;\n\t\titem.innerHTML = \"\"; // Clear existing content\n\t\titem.title = win.getTitle(); // Always set tooltip\n\n\t\tconst showIconOnly = taskbarOptions?.showIconOnly && icon;\n\n\t\titem.classList.toggle(`${LIBRARY_NAME}-icon-only`, !!showIconOnly);\n\n\t\tif (showIconOnly) {\n\t\t\tconst iconEl = document.createElement(\"div\");\n\t\t\ticonEl.className = `${LIBRARY_NAME}-taskbar-item-icon`;\n\t\t\tif (win.isFontAwesome(icon)) {\n\t\t\t\tconst i = document.createElement(\"i\");\n\t\t\t\ti.className = icon;\n\t\t\t\ticonEl.appendChild(i);\n\t\t\t} else {\n\t\t\t\tconst img = document.createElement(\"img\");\n\t\t\t\timg.src = icon;\n\t\t\t\timg.alt = win.getTitle();\n\t\t\t\ticonEl.appendChild(img);\n\t\t\t}\n\t\t\titem.appendChild(iconEl);\n\t\t} else {\n\t\t\titem.textContent = win.getTitle();\n\t\t}\n\t}\n\n\tpublic updateTaskbarItem(win: WinLetWindow, state: \"minimized\" | \"restored\" | \"titleChanged\" | \"iconChanged\"): void {\n\t\tconst item = win.options._taskbarItem;\n\t\tif (!item) return;\n\n\t\tswitch (state) {\n\t\t\tcase \"minimized\":\n\t\t\t\titem.classList.add(`${LIBRARY_NAME}-minimized`);\n\t\t\t\tbreak;\n\t\t\tcase \"restored\":\n\t\t\t\titem.classList.remove(`${LIBRARY_NAME}-minimized`);\n\t\t\t\tbreak;\n\t\t\tcase \"titleChanged\":\n\t\t\tcase \"iconChanged\":\n\t\t\t\titem.textContent = win.getTitle();\n\t\t\t\titem.title = win.getTitle();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate activateFocusTrap(win: WinLetWindow): void {\n\t\tthis.deactivateFocusTrap(); // 念のため既存のリスナーを解除\n\n\t\tthis.boundTabPressHandler = (e: KeyboardEvent) => {\n\t\t\tif (e.key === \"Tab\") {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst focusableElements = Array.from(win.el.querySelectorAll<HTMLElement>('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex=\"-1\"])')).filter((el) => !el.hasAttribute(\"disabled\") && !el.closest(\".minimized\"));\n\n\t\t\t\tif (focusableElements.length === 0) return;\n\n\t\t\t\tconst currentIndex = focusableElements.indexOf(document.activeElement as HTMLElement);\n\t\t\t\tlet nextIndex = e.shiftKey ? currentIndex - 1 : currentIndex + 1;\n\n\t\t\t\tif (nextIndex >= focusableElements.length) {\n\t\t\t\t\tnextIndex = 0;\n\t\t\t\t}\n\t\t\t\tif (nextIndex < 0) {\n\t\t\t\t\tnextIndex = focusableElements.length - 1;\n\t\t\t\t}\n\t\t\t\tfocusableElements[nextIndex].focus();\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener(\"keydown\", this.boundTabPressHandler);\n\t}\n\n\tprivate deactivateFocusTrap(): void {\n\t\tif (this.boundTabPressHandler) {\n\t\t\tdocument.removeEventListener(\"keydown\", this.boundTabPressHandler);\n\t\t\tthis.boundTabPressHandler = null;\n\t\t}\n\t}\n\n\t/**\n\t * ショートカット文字列を解析し、修飾キーと主キーのオブジェクトを返す\n\t * @param shortcut - \"Ctrl+Shift+K\"のような文字列\n\t */\n\tprivate parseShortcut(shortcut: string): { ctrl: boolean; alt: boolean; shift: boolean; key: string } {\n\t\tconst keys = shortcut.split(\"+\");\n\t\tconst key = keys.pop() || \"\"; // 主キーを配列から取り出す\n\t\tconst ctrl = keys.includes(\"Ctrl\");\n\t\tconst alt = keys.includes(\"Alt\");\n\t\tconst shift = keys.includes(\"Shift\");\n\t\treturn { ctrl, alt, shift, key };\n\t}\n}\n","// src/index.ts\n\nimport { defaultConfig } from \"./const/config\";\nimport { CLOSE_BUTTON_RESULT, GlobalConfigOptions, IWindow, PopupOptions, Theme, TIMEOUT_RESULT, WindowOptions, WinLetApi } from \"./const/types\";\nimport WindowManager from \"./function/window_manager\";\nimport Utils from \"./libs/utils\";\nimport { LIB_VERSION } from \"./version\";\n\nconst selfUrl = (document?.currentScript as HTMLScriptElement)?.src || \"\";\n\nconst globalConfig: GlobalConfigOptions = {\n\twindowSwitchShortcut: \"Ctrl+`\", // デフォルトショートカット（バッククォート）\n\tlibraryPath: selfUrl,\n\tenableAnimations: true,\n\tenableFocusTrapping: true,\n\ttaskbar: {\n\t\tposition: \"bottom\",\n\t},\n};\n\n// シングルトンインスタンス\nconst manager = new WindowManager(globalConfig);\n\n// 公開するAPI\nconst api: WinLetApi = {\n\t/**\n\t * ライブラリを初期化します。DOMの準備ができた後に呼び出してください。\n\t * (例: document.addEventListener('DOMContentLoaded', WinLet.init);)\n\t *\n\t * @param options - グローバル設定。コンテナ要素などを指定できます。\n\t */\n\tinit: (options: GlobalConfigOptions = {}): void => {\n\t\tapi.setGlobalConfig(options);\n\t\tmanager.init();\n\t},\n\n\t/**\n\t * 新しいウィンドウを作成\n\t */\n\tcreateWindow: (options: WindowOptions = {}): IWindow => {\n\t\treturn manager.createWindow(options);\n\t},\n\n\t/**\n\t * 新しいポップアップウィンドウを作成\n\t */\n\tcreatePopup: (options: PopupOptions): IWindow => {\n\t\treturn manager.popup(options);\n\t},\n\n\t/**\n\t * ウィンドウを取得\n\t */\n\tgetWindow: (id: string): IWindow | undefined => {\n\t\treturn manager.getWindow(id);\n\t},\n\n\t/**\n\t * 指定されたDOM要素を内包するウィンドウインスタンスを取得します。\n\t */\n\tgetWindowFromElement: (element: HTMLElement): IWindow | undefined => {\n\t\treturn manager.getWindowFromElement(element);\n\t},\n\n\t/**\n\t * アクティブなウィンドウを取得\n\t */\n\tgetActiveWindow: (): IWindow | null => {\n\t\treturn manager.getActiveWindow();\n\t},\n\n\t/**\n\t * デフォルトのウィンドウ設定を変更\n\t */\n\tsetDefaultConfig: (options: WindowOptions): void => {\n\t\tUtils.deepMerge(defaultConfig, options);\n\t},\n\n\t/**\n\t * グローバル設定を変更\n\t */\n\tsetGlobalConfig: (options: GlobalConfigOptions): void => {\n\t\t// 初期化後にコンテナを変更しようとした場合は警告を出す\n\t\tif (manager.isInitialized && options.container) {\n\t\t\tconsole.warn(\"WinLet: The container cannot be changed after initialization.\");\n\t\t\tdelete options.container;\n\t\t}\n\t\tObject.assign(globalConfig, options);\n\t\tmanager.applyGlobalConfig(globalConfig);\n\t},\n\n\t/**\n\t * 表示テーマを登録します。\n\t */\n\tregisterTheme: (theme: Theme): void => {\n\t\tmanager.registerTheme(theme);\n\t},\n\n\t/**\n\t * 登録済みのテーマ名の配列を取得します。\n\t */\n\tgetRegisteredThemes: () => {\n\t\treturn manager.getRegisteredThemes();\n\t},\n\n\t/**\n\t * 表示テーマを変更します。\n\t */\n\tsetTheme: (theme: string | Theme): void => {\n\t\tmanager.setTheme(theme);\n\t},\n\n\t/**\n\t * 現在の表示テーマを取得します。\n\t */\n\tgetTheme: (): Theme | null => {\n\t\treturn manager.getTheme();\n\t},\n\n\t/**\n\t * ライブラリのバージョンを取得\n\t */\n\tget version() {\n\t\treturn LIB_VERSION;\n\t},\n\n\t/**\n\t * ポップアップウィンドウのタイムアウト結果\n\t */\n\tPOPUP_TIMEOUT_RESULT: TIMEOUT_RESULT,\n\t/**\n\t * ポップアップウィンドウの閉じるボタンの結果\n\t */\n\tPOPUP_CLOSE_BUTTON_RESULT: CLOSE_BUTTON_RESULT,\n};\n\n// グローバルスコープにAPIをアタッチ\nif (typeof window !== \"undefined\") {\n\twindow.WinLet = api;\n}\n\n// モジュールとしてエクスポートも可能\nexport default api;\n","export default class WinLetBaseClass {}\n","import WinLetBaseClass from \"./baseclass\";\n\nexport default class Utils extends WinLetBaseClass {\n\t/**\n\t * ユニークなIDを生成します。\n\t * @param prefix - IDのプレフィックス\n\t * @returns 生成されたID\n\t */\n\tpublic static generateId(prefix: string = \"win\"): string {\n\t\treturn `${prefix}-${Math.random().toString(36).substring(2, 9)}`;\n\t}\n\n\tpublic static deepCopy<T>(value: T, seen: WeakMap<object, any> = new WeakMap()): T {\n\t\tif (value === null || typeof value !== \"object\") return value;\n\n\t\tif (value instanceof Date) return new Date(value.getTime()) as T;\n\n\t\tif (value instanceof Map) {\n\t\t\tconst copiedMap = new Map();\n\t\t\tvalue.forEach((v, k) => {\n\t\t\t\tcopiedMap.set(this.deepCopy(k, seen), this.deepCopy(v, seen));\n\t\t\t});\n\t\t\treturn copiedMap as T;\n\t\t}\n\n\t\tif (value instanceof Set) {\n\t\t\tconst copiedSet = new Set();\n\t\t\tvalue.forEach((v) => {\n\t\t\t\tcopiedSet.add(this.deepCopy(v, seen));\n\t\t\t});\n\t\t\treturn copiedSet as T;\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\tif (seen.has(value)) return seen.get(value);\n\t\t\tconst arrCopy: any[] = [];\n\t\t\tseen.set(value, arrCopy);\n\t\t\tfor (const item of value) {\n\t\t\t\tarrCopy.push(this.deepCopy(item, seen));\n\t\t\t}\n\t\t\treturn arrCopy as T;\n\t\t}\n\n\t\tif (seen.has(value)) return seen.get(value);\n\t\tconst copiedObj: { [key: string]: any } = {};\n\t\tseen.set(value, copiedObj);\n\t\tfor (const key in value) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(value, key)) {\n\t\t\t\tcopiedObj[key] = this.deepCopy((value as any)[key], seen);\n\t\t\t}\n\t\t}\n\t\treturn copiedObj as T;\n\t}\n\n\t/**\n\t * オブジェクトをディープマージします。\n\t */\n\tpublic static deepMerge<T extends object, U extends object>(target: T, source: U): T & U {\n\t\tconst output = { ...target } as T & U;\n\n\t\tfor (const key in source) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(source, key)) {\n\t\t\t\tconst sourceValue = source[key];\n\t\t\t\tconst targetValue = (target as any)[key];\n\n\t\t\t\tif (Array.isArray(sourceValue)) {\n\t\t\t\t\t// ソースの値が配列の場合は、そのまま上書きする\n\t\t\t\t\t(output as any)[key] = sourceValue;\n\t\t\t\t} else if (sourceValue instanceof Object && typeof sourceValue !== \"function\" && targetValue instanceof Object) {\n\t\t\t\t\t(output as any)[key] = this.deepMerge(targetValue, sourceValue);\n\t\t\t\t} else {\n\t\t\t\t\t(output as any)[key] = sourceValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\t/**\n\t * オブジェクトが空でないかとどうかを判定します。\n\t * @param obj - 判定するオブジェクト\n\t * @returns オブジェクトが空である場合はfalse、そうでない場合はtrue\n\t */\n\tpublic static isNonEmptyObject<T extends object>(obj: T | undefined): obj is T & Record<string | symbol, unknown> {\n\t\tif (!obj) return false;\n\t\tfor (const _ in obj) return true;\n\t\treturn false;\n\t}\n\n\t/**\n\t * HTML文字列をサニタイズします。\n\t * @param str - サニタイズする文字列\n\t * @returns サニタイズされたHTML文字列\n\t */\n\tpublic static sanitizeHTML(str: string): string {\n\t\tconst temp = document.createElement(\"div\");\n\t\ttemp.textContent = str;\n\t\treturn temp.innerHTML;\n\t}\n}\n","const styleData: string = `\n/* ========================================================================\n    1. 基本設定・変数\n   ======================================================================== */\n:root {\n    /* 基本色・シャドウ */\n    --$[prefix]-text-color: #000;\n    --$[prefix]-bg: #f0f0f0;\n    --$[prefix]-border: #a0a0a0;\n    --$[prefix]-shadow-color-light: rgba(0,0,0,0.15);\n    --$[prefix]-shadow-color-strong: rgba(0,0,0,0.3);\n    --$[prefix]-shadow-color-active: rgba(0,0,0,0.45);\n\n    /* タイトルバー */\n    --$[prefix]-title-bar-height: 32px;\n    --$[prefix]-title-bar-bg: #e0e0e0;\n    --$[prefix]-title-bar-active-bg: #0078d7;\n    --$[prefix]-title-text-color: #000;\n    --$[prefix]-title-text-active-color: #fff;\n\n    /* コントロールボタン */\n    --$[prefix]-control-bg: #d0d0d0;\n    --$[prefix]-control-hover-bg: #e5e5e5;\n    --$[prefix]-control-close-hover-bg: #e81123;\n    --$[prefix]-control-close-hover-color: #fff;\n\n    /* メニュー */\n    --$[prefix]-menu-bg: #fff;\n    --$[prefix]-menu-border: #ccc;\n    --$[prefix]-menu-item-color: #000;\n    --$[prefix]-menu-item-hover-bg: #0078d7;\n    --$[prefix]-menu-item-hover-color: #fff;\n    --$[prefix]-shortcut-text-color: #666;\n\n    /* タブ */\n    --$[prefix]-tab-bg: #dcdcdc;\n    --$[prefix]-tab-active-bg: #f0f0f0;\n    --$[prefix]-tab-border: #b0b0b0;\n    --$[prefix]-tab-bar-bg: #e1e1e1;\n    --$[prefix]-tab-close-btn-hover-bg: #ccc;\n    --$[prefix]-tab-active-close-btn-hover-bg: #ddd;\n\n    /* ポップアップボタン */\n    --$[prefix]-popup-button-hover-bg: #e9e9e9;\n    --$[prefix]-popup-button-hover-border-color: #bbb;\n\n    /* リサイズハンドル */\n    --$[prefix]-resize-handle-size: 8px;\n    --$[prefix]-resize-handle-offset: -4px;\n\n    /* タスクバー */\n    --$[prefix]-taskbar-bg: rgba(240, 240, 240, 0.9);\n    --$[prefix]-taskbar-border: #a0a0a0;\n    --$[prefix]-taskbar-item-bg: #d0d0d0;\n    --$[prefix]-taskbar-item-active-bg: #0078d7;\n    --$[prefix]-taskbar-item-active-color: #fff;\n    --$[prefix]-taskbar-height: 40px;\n    --$[prefix]-taskbar-width: 40px;\n\n    /* ローディングインジケーター */\n    --$[prefix]-loader-bg: rgba(255, 255, 255, 0.7);\n    --$[prefix]-loader-color: var(--$[prefix]-title-bar-active-bg);\n\n    /* その他 */\n    --$[prefix]-scrollbar-thumb-bg: rgba(100, 100, 100, 0.5);\n}\n\n/* ========================================================================\n    2. ユーティリティクラス\n   ========================================================================= */\n/**\n * テキスト選択を無効化\n */\n.$[prefix]-us-none {\n    user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n}\n/**\n * テキスト選択を有効化\n */\n.$[prefix]-us-auto {\n    user-select: auto;\n    -webkit-user-select: auto;\n    -ms-user-select: auto;\n}\n\n/* ========================================================================\n    3. コンテナ\n   ========================================================================= */\n/**\n * 全てのウィンドウを内包する最上位コンテナ\n */\n.$[prefix]-container {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    box-sizing: border-box;\n    pointer-events: none;\n    overflow: hidden;\n    z-index: 999;\n    display: flex;\n    pointer-events: none;\n}\n.$[prefix]-container > * {\n    pointer-events: all; /* 子要素(workspace, taskbar)のイベントは有効化 */\n}\n/**\n * 特定の要素内にネストされた場合のコンテナ\n */\n.$[prefix]-container.$[prefix]-is-nested {\n    position: absolute;\n}\n\n.$[prefix]-workspace {\n    position: relative;\n    flex-grow: 1; /* 残りのスペースをすべて占有 */\n    overflow: hidden; /* ウィンドウがはみ出さないように */\n    min-width: 0; /* flexアイテムの縮小問題を回避 */\n    min-height: 0; /* flexアイテムの縮小問題を回避 */\n    pointer-events: none;\n}\n/**\n * タブのドラッグ中にポインターイベントを有効化し、ドロップを受け付ける\n */\n.$[prefix]-workspace.$[prefix]-is-tab-dragging {\n    pointer-events: auto;\n}\n/* ========================================================================\n    4. ウィンドウ\n   ======================================================================== */\n/* --- ウィンドウ基本スタイル --- */\n.$[prefix]-window {\n    position: absolute;\n    display: flex;\n    flex-direction: column;\n    min-width: 200px;\n    min-height: 150px;\n    border: 1px solid var(--$[prefix]-border);\n    background-color: var(--$[prefix]-bg);\n    box-shadow: 0 5px 15px var(--$[prefix]-shadow-color-strong);\n    box-sizing: border-box;\n    border-radius: 5px;\n    overflow: hidden;\n    pointer-events: all;\n    transition: opacity 0.2s, transform 0.2s, top 0.25s ease-in-out, left 0.25s ease-in-out, width 0.25s ease-in-out, height 0.25s ease-in-out;\n    touch-action: none;\n}\n\n/* --- ウィンドウ状態別スタイル --- */\n/**\n * 最小化されたウィンドウのアニメーション\n */\n.$[prefix]-window.$[prefix]-is-minimizing,\n.$[prefix]-window.$[prefix]-minimized {\n    transform: scale(0);\n    opacity: 0;\n    transition: opacity 0.25s, transform 0.25s;\n    pointer-events: none;\n}\n.$[prefix]-window.$[prefix]-minimized {\n    display: none;\n}\n/**\n * 最大化されたウィンドウのアニメーション\n */\n.$[prefix]-window.$[prefix]-maximized {\n    transition: top 0.25s ease-in-out, left 0.25s ease-in-out, width 0.25s ease-in-out, height 0.25s ease-in-out;\n}\n/**\n * 最大化状態ではリサイズハンドルを非表示\n */\n.$[prefix]-window.$[prefix]-maximized > .$[prefix]-resize-handle {\n    display: none;\n}\n/**\n * 復元中のアニメーション\n */\n.$[prefix]-window.$[prefix]-is-restoring {\n    transition: top 0.25s ease-in-out, left 0.25s ease-in-out, width 0.25s ease-in-out, height 0.25s ease-in-out;\n}\n\n/**\n * ドラッグ中・リサイズ中のトランジションを短縮し、操作性を向上\n */\n.$[prefix]-window.$[prefix]-is-dragging,\n.$[prefix]-window.$[prefix]-is-resizing {\n    transition: opacity 0.1s, transform 0.1s;\n}\n\n/**\n * アクティブ（フォーカスされている）ウィンドウ\n */\n.$[prefix]-window.$[prefix]-active {\n    box-shadow: 0 8px 25px var(--$[prefix]-shadow-color-active); /* アクティブ時のシャドウ */\n}\n/**\n * アクティブ（フォーカスされている）ウィンドウのタイトルバー\n */\n.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar {\n    background-color: var(--$[prefix]-title-bar-active-bg);\n    color: var(--$[prefix]-title-text-active-color);\n}\n.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar .$[prefix]-title {\n    color: var(--$[prefix]-title-text-active-color);\n}\n\n/* --- ウィンドウ特殊スタイル --- */\n/**\n * 「常に手前に表示」が有効なウィンドウ\n */\n.$[prefix]-window.$[prefix]-always-on-top .$[prefix]-title-bar {\n    background-image: repeating-linear-gradient(\n        -45deg,\n        transparent,\n        transparent 4px,\n        rgba(255, 255, 255, 0.05) 4px,\n        rgba(255, 255, 255, 0.05) 8px\n    );\n}\n\n/**\n * ウィンドウシェイクアニメーション\n */\n@keyframes $[prefix]-shake {\n    10%, 90% { transform: translate3d(-1px, 0, 0); }\n    20%, 80% { transform: translate3d(2px, 0, 0); }\n    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }\n    40%, 60% { transform: translate3d(4px, 0, 0); }\n}\n.$[prefix]-window.$[prefix]-is-shaking {\n    animation: $[prefix]-shake 0.82s cubic-bezier(.36,.07,.19,.97) both;\n}\n\n/* ========================================================================\n    5. ゴーストウィンドウ\n   ======================================================================== */\n/**\n * ドラッグ・リサイズ時に表示される輪郭\n */\n.$[prefix]-ghost-window {\n    position: absolute;\n    box-sizing: border-box;\n    border: 2px dashed var(--$[prefix]-title-bar-active-bg);\n    background-color: rgba(0, 120, 215, 0.1);\n    z-index: 99999;\n    pointer-events: none;\n}\n\n/* ========================================================================\n    6. タイトルバー\n   ======================================================================== */\n/* --- タイトルバー基本スタイル --- */\n.$[prefix]-title-bar {\n    display: flex;\n    align-items: center;\n    height: var(--$[prefix]-title-bar-height);\n    background-color: var(--$[prefix]-title-bar-bg);\n    color: var(--$[prefix]-title-text-color);\n    cursor: move;\n    flex-shrink: 0;\n    touch-action: none;\n}\n/**\n * コントロールが左側にある場合のタイトルバー\n */\n.$[prefix]-title-bar.$[prefix]-controls-left {\n    flex-direction: row-reverse;\n}\n\n/* --- アイコン・タイトル --- */\n.$[prefix]-icon {\n    min-width: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    height: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    margin: 0 4px;\n    pointer-events: none;\n    flex-shrink: 0;\n}\n\n.$[prefix]-icon:empty {\n    display: none;\n}\n\n.$[prefix]-icon i {\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\n    line-height: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    text-align: center;\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n.$[prefix]-icon img {\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n.$[prefix]-title {\n    flex-grow: 1;\n    padding: 0 8px;\n    font-family: sans-serif;\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.44);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    pointer-events: none;\n}\n\n.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-title {\n    text-align: right;\n}\n\n/* --- コントロールボタン --- */\n.$[prefix]-controls {\n    display: flex;\n    height: 100%;\n    margin-left: auto;\n    flex-shrink: 0;\n}\n\n.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-controls {\n    margin-left: 0;\n    margin-right: auto;\n    flex-direction: row-reverse;\n}\n\n.$[prefix]-control-btn {\n    width: calc(var(--$[prefix]-title-bar-height) * 1.3);\n    height: 100%;\n    border: none;\n    box-sizing: border-box;\n    background-color: transparent;\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\n    cursor: pointer;\n    text-align: center;\n    vertical-align: middle;\n    font-family: sans-serif;\n    transition: background-color 0.2s;\n    touch-action: auto;\n}\n\n.$[prefix]-control-btn:hover {\n    background-color: var(--$[prefix]-control-hover-bg);\n}\n\n.$[prefix]-control-btn.$[prefix]-close-btn:hover {\n    background-color: var(--$[prefix]-control-close-hover-bg);\n    color: var(--$[prefix]-control-close-hover-color);\n}\n\n/* ========================================================================\n    7. メインコンテンツエリア\n   ======================================================================== */\n.$[prefix]-main-content {\n    all: initial;\n    position: relative;\n    display:flex;\n    color: var(--$[prefix]-text-color);\n    flex-direction:column;\n    flex-grow:1;\n    overflow:hidden;\n}\n\n.$[prefix]-content {\n    flex-grow: 1;\n    position: relative;\n    overflow: auto;\n    touch-action: auto;\n}\n\n.$[prefix]-content iframe {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: none;\n}\n\n/* --- ローディングインジケーター --- */\n.$[prefix]-loader-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: var(--$[prefix]-loader-bg);\n    display: none;\n    justify-content: center;\n    align-items: center;\n    z-index: 20;\n}\n@keyframes $[prefix]-spinner-rotation {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n.$[prefix]-loader-spinner {\n    width: 48px;\n    height: 48px;\n    border-radius: 50%;\n    border: 5px solid #fff;\n    border-bottom-color: var(--$[prefix]-loader-color);\n    animation: $[prefix]-spinner-rotation 1s linear infinite;\n}\n\n/* ========================================================================\n    8. メニューバー\n   ======================================================================== */\n.$[prefix]-menu-bar {\n    color: var(--$[prefix]-menu-item-color);\n    display: flex;\n    background-color: var(--$[prefix]-bg);\n    padding: 2px;\n    flex-shrink: 0;\n    border-bottom: 1px solid var(--$[prefix]-border);\n    touch-action: auto;\n}\n\n.$[prefix]-menu-item {\n    font-family: sans-serif;\n    font-size: clamp(0px , calc(var(--winlet-title-bar-height) * 0.6), 14px);\n    padding: 4px 8px;\n    cursor: default;\n    position: relative;\n}\n\n.$[prefix]-menu-item:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n\n/* --- ドロップダウンメニュー --- */\n.$[prefix]-menu-dropdown {\n    color: var(--$[prefix]-menu-item-color);\n    display: none;\n    position: absolute;\n    top: 100%;\n    left: 0;\n    background-color: var(--$[prefix]-menu-bg);\n    border: 1px solid var(--$[prefix]-menu-border);\n    box-shadow: 0 2px 8px var(--$[prefix]-shadow-color-light);\n    list-style: none;\n    margin: 0;\n    padding: 4px 0;\n    min-width: 150px;\n    z-index: 10;\n    touch-action: auto;\n}\n\n.$[prefix]-menu-dropdown li {\n    padding: 0 20px;\n    font-size: 14px;\n    cursor: pointer;\n}\n\n.$[prefix]-menu-dropdown li:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n\n.$[prefix]-menu-dropdown li.$[prefix]-separator {\n    height: 1px;\n    background-color: var(--$[prefix]-menu-border);\n    margin: 4px 0;\n    padding: 0;\n}\n\n.$[prefix]-menu-dropdown-item {\n    display: flex;\n    line-height: 1.6em;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    width: 100%;\n    white-space: nowrap;\n}\n\n/* --- サブメニュー --- */\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu {\n    position: relative;\n}\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu::after {\n    content: '▶';\n    position: absolute;\n    top: 50%;\n    right: 10px;\n    margin-top: calc(var(--winlet-title-bar-height) * -0.5);\n    font-size: 0.8em;\n    color: inherit;\n}\n/**\n * ネストされたサブメニューの表示位置\n */\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu > .$[prefix]-menu-dropdown {\n    top: -5px; /* liのpaddingを考慮 */\n    left: 100%;\n}\n/**\n * サブメニューはホバーで開く\n */\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu:hover > .$[prefix]-menu-dropdown {\n    display: block;\n}\n\n/* --- ショートカットテキスト --- */\n.$[prefix]-shortcut-text {\n    color: var(--$[prefix]-shortcut-text-color);\n    margin-left: 1em;\n}\n.$[prefix]-menu-dropdown li:hover .$[prefix]-shortcut-text {\n    color: inherit;\n}\n\n/* --- タブ --- */\n.$[prefix]-tab-bar {\n    color: var(--$[prefix]-menu-item-color);\n    overflow-x: auto;\n    overflow-y: hidden;\n    -ms-overflow-style: -ms-autohiding-scrollbar;\n    scrollbar-width: thin;\n    display: flex;\n    background-color: var(--$[prefix]-tab-bar-bg);\n    flex-shrink: 0;\n    align-items: flex-end;\n    touch-action: auto;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar{\n    width: 6px;\n    height: 6px;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar-thumb {\n    background-color: var(--$[prefix]-scrollbar-thumb-bg);\n    border-radius: 3px;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar-track {\n    background-color: transparent;\n}\n\n/* --- タブ --- */\n.$[prefix]-tab {\n    white-space: nowrap;\n    padding: 8px 16px;\n    font-family: sans-serif;\n    font-size: 14px;\n    cursor: pointer;\n    border-right: 1px solid var(--$[prefix]-tab-border);\n    background-color: var(--$[prefix]-tab-bg);\n}\n\n.$[prefix]-tab.$[prefix]-active {\n    background-color: var(--$[prefix]-tab-active-bg);\n    border-bottom: 2px solid var(--$[prefix]-title-bar-active-bg);\n}\n\n.$[prefix]-tab.$[prefix]-active .$[prefix]-tab-close-btn:hover {\n    background-color: var(--$[prefix]-tab-active-close-btn-hover-bg);\n}\n\n/**\n * ドラッグ中のタブのスタイル\n */\n.$[prefix]-tab.$[prefix]-dragging {\n    opacity: 0.5;\n}\n\n/* --- タブ関連ボタン --- */\n/**\n * タブの閉じるボタン\n */\n.$[prefix]-tab-close-btn {\n    margin-left: 8px;\n    padding: 0 4px;\n    border-radius: 50%;\n    cursor: pointer;\n    font-weight: bold;\n    font-size: 14px;\n    line-height: 1;\n}\n.$[prefix]-tab-close-btn:hover {\n    background-color: var(--$[prefix]-tab-close-btn-hover-bg);\n}\n\n/**\n * タブ追加ボタン\n */\n.$[prefix]-tab-add-btn {\n    padding: 8px;\n    font-size: 14px;\n    cursor: pointer;\n    border-bottom: 1px solid var(--$[prefix]-tab-border);\n}\n.$[prefix]-tab-add-btn:hover {\n    background-color: var(--$[prefix]-title-bar-bg);\n}\n\n/* --- タブコンテンツ --- */\n.$[prefix]-tab-content {\n    display: none;\n}\n\n.$[prefix]-tab-content.$[prefix]-active {\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n\n/* ========================================================================\n    10. リサイズハンドル\n   ======================================================================== */\n.$[prefix]-resize-handle {\n    position: absolute;\n    z-index: 5;\n    touch-action: none;\n}\n\n.$[prefix]-resize-handle.$[prefix]-n { top: var(--$[prefix]-resize-handle-offset); left: 0; right: 0; height: var(--$[prefix]-resize-handle-size); cursor: n-resize; }\n.$[prefix]-resize-handle.$[prefix]-s { bottom: var(--$[prefix]-resize-handle-offset); left: 0; right: 0; height: var(--$[prefix]-resize-handle-size); cursor: s-resize; }\n.$[prefix]-resize-handle.$[prefix]-w { top: 0; bottom: 0; left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); cursor: w-resize; }\n.$[prefix]-resize-handle.$[prefix]-e { top: 0; bottom: 0; right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); cursor: e-resize; }\n.$[prefix]-resize-handle.$[prefix]-nw { top: var(--$[prefix]-resize-handle-offset); left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: nw-resize; }\n.$[prefix]-resize-handle.$[prefix]-ne { top: var(--$[prefix]-resize-handle-offset); right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: ne-resize; }\n.$[prefix]-resize-handle.$[prefix]-sw { bottom: var(--$[prefix]-resize-handle-offset); left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: sw-resize; }\n.$[prefix]-resize-handle.$[prefix]-se { bottom: var(--$[prefix]-resize-handle-offset); right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: se-resize; }\n\n/* ========================================================================\n    11. コンテキストメニュー\n   ======================================================================== */\n.$[prefix]-context-menu {\n    color: var(--$[prefix]-menu-item-color);\n    pointer-events: all;\n    position: fixed;\n    z-index: 10000;\n    background-color: var(--$[prefix]-menu-bg);\n    border: 1px solid var(--$[prefix]-menu-border);\n    box-shadow: 0 2px 8px var(--$[prefix]-shadow-color-light);\n    list-style: none;\n    margin: 0;\n    padding: 4px 0;\n    min-width: 160px;\n}\n.$[prefix]-context-menu li {\n    padding: 6px 24px;\n    font-family: sans-serif;\n    font-size: 14px;\n    cursor: pointer;\n}\n.$[prefix]-context-menu li:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n.$[prefix]-context-menu li.$[prefix]-separator {\n    height: 1px;\n    background-color: var(--$[prefix]-menu-border);\n    margin: 4px 0;\n    padding: 0;\n}\n\n/* ========================================================================\n    12. ポップアップ\n   ======================================================================== */\n.$[prefix]-popup-window .$[prefix]-content {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding: 20px;\n    box-sizing: border-box;\n}\n.$[prefix]-popup-message {\n    font-family: sans-serif;\n    font-size: 14px;\n    line-height: 1.5;\n    flex-grow: 1;\n    word-wrap: break-word;\n}\n.$[prefix]-popup-buttons {\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n    margin-top: 20px;\n    flex-shrink: 0;\n    touch-action: auto;\n}\n.$[prefix]-popup-button {\n    color: var(--$[prefix]-menu-item-color);\n    min-width: 80px;\n    padding: 8px 12px;\n    margin: 0;\n    border: 1px solid var(--$[prefix]-menu-border);\n    border-radius: 3px;\n    background-color: var(--$[prefix]-bg);\n    cursor: pointer;\n    font-size: 14px;\n    box-shadow: 0 1px 1px var(--$[prefix]-shadow-color-light);\n}\n.$[prefix]-popup-button:hover {\n    border-color: var(--$[prefix]-popup-button-hover-border-color);\n    background-color: var(--$[prefix]-popup-button-hover-bg);\n}\n.$[prefix]-popup-button:active {\n    background-color: var(--$[prefix]-tab-bg);\n}\n\n/* ========================================================================\n    13. 統合スタイル (Merged Styles)\n   ======================================================================== */\n/* --- メニュー/タブ統合時の基本タイトルバー --- */\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-title-bar,\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-title-bar {\n    height: auto;\n    align-items: flex-end;\n    padding: 0;\n}\n\n/* --- メニュー統合スタイル --- */\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-icon {\n    margin-block: auto;\n}\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-title {\n    flex-grow: 1;\n    margin-block: auto;\n}\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-menu-bar {\n    border-bottom: none;\n    background: transparent;\n    padding: 0 6px;\n    align-self: center;\n}\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-menu-item {\n    line-height: var(--$[prefix]-title-bar-height);\n    padding-top: 0;\n    padding-bottom: 0;\n}\n/* アクティブウィンドウの統合メニューの文字色 */\n.$[prefix]-window.$[prefix]-menu-style-merged.$[prefix]-active:not(.$[prefix]-tab-style-merged) .$[prefix]-menu-item {\n    color: var(--winlet-menu-item-hover-color);\n}\n.$[prefix]-window.$[prefix]-menu-style-merged.$[prefix]-active:not(.$[prefix]-tab-style-merged) .$[prefix]-menu-item:hover {\n    background-color: var(--$[prefix]-title-bar-bg);\n    color: var(--$[prefix]-menu-item-color);\n}\n\n/* --- タブ統合スタイル (Chrome風) --- */\n.$[prefix]-window.$[prefix]-tab-style-merged.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar {\n    background-color: var(--$[prefix]-title-bar-bg);\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-title {\n    display: none;\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar {\n    background-color: transparent;\n    flex-grow: 1;\n    flex-shrink: 1;\n    min-width: 0;\n    align-items: flex-end;\n    height: calc(var(--$[prefix]-title-bar-height) + 4px);\n    margin: 0;\n    order: 1; /* controlsより前に配置 */\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar::-webkit-scrollbar{\n    display: none;\n}\n.$[prefix]-window.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-tab-bar {\n    order: -1;\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab {\n    border: 1px solid var(--$[prefix]-border);\n    border-bottom: none;\n    border-radius: 6px 6px 0 0;\n    margin-top: 4px;\n    margin-left: -1px;\n    position: relative;\n    bottom: -1px;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab.$[prefix]-active {\n    background-color: var(--$[prefix]-bg);\n    border-color: var(--$[prefix]-border);\n    border-bottom: 1px solid var(--$[prefix]-bg);\n    z-index: 2;\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-add-btn {\n    border: none;\n    align-self: center;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-main-content {\n    border-top: none;\n}\n\n/* --- 統合時のコントロールボタン --- */\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-controls,\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-controls {\n    align-self: flex-start;\n    order: 2;\n}\n\n/* ========================================================================\n    14. タスクバー\n   ======================================================================== */\n.$[prefix]-taskbar {\n    position: absolute;\n    background-color: var(--$[prefix]-taskbar-bg);\n    box-sizing: border-box;\n    display: flex;\n    align-items: center;\n    padding: 0 5px;\n    z-index: 50000;\n    flex-shrink: 0;\n    display: flex;\n    gap: 5px;\n    overflow: auto;\n    scrollbar-width: none;\n    -ms-overflow-style: none;\n    backdrop-filter: blur(5px);\n    pointer-events: all;\n}\n.$[prefix]-taskbar::-webkit-scrollbar{\n    display: none;\n}\n\n/* --- 位置 --- */\n.$[prefix]-taskbar.$[prefix]-taskbar-bottom {\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: var(--$[prefix]-taskbar-height);\n    flex-direction: row;\n    border-top: 1px solid var(--$[prefix]-taskbar-border);\n}\n.$[prefix]-taskbar.$[prefix]-taskbar-top {\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: var(--$[prefix]-taskbar-height);\n    flex-direction: row;\n    border-bottom: 1px solid var(--$[prefix]-taskbar-border);\n}\n.$[prefix]-taskbar.$[prefix]-taskbar-left {\n    top: 0;\n    left: 0;\n    width: var(--$[prefix]-taskbar-width);\n    height: 100%;\n    flex-direction: column;\n    border-right: 1px solid var(--$[prefix]-taskbar-border);\n}\n.$[prefix]-taskbar.$[prefix]-taskbar-right {\n    top: 0;\n    right: 0;\n    width: var(--$[prefix]-taskbar-width);\n    height: 100%;\n    flex-direction: column;\n    border-left: 1px solid var(--$[prefix]-taskbar-border);\n}\n\n.$[prefix]-taskbar.$[prefix]-taskbar-bottom,\n.$[prefix]-taskbar.$[prefix]-taskbar-top {\n    --$[prefix]-taskbar-icon-size: var(--$[prefix]-taskbar-height);\n}\n.$[prefix]-taskbar.$[prefix]-taskbar-left,\n.$[prefix]-taskbar.$[prefix]-taskbar-right {\n    --$[prefix]-taskbar-icon-size: var(--$[prefix]-taskbar-width);\n}\n\n\n.$[prefix]-taskbar-item {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: auto;\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\n    padding: 0 10px;\n    border-radius: 3px;\n    background-color: var(--$[prefix]-taskbar-item-bg);\n    cursor: pointer;\n    flex-shrink: 0;\n    max-width: 150px;\n    transition: background-color 0.2s;\n    font-family: sans-serif;\n    font-size: 14px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    box-sizing: border-box;\n}\n/* 縦向きタスクバーのアイテム */\n.$[prefix]-taskbar.$[prefix]-taskbar-left .$[prefix]-taskbar-item,\n.$[prefix]-taskbar.$[prefix]-taskbar-right .$[prefix]-taskbar-item {\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\n    height: auto;\n    min-height: 40px;\n    max-width: none;\n    padding: 10px 0;\n    writing-mode: vertical-rl;\n}\n\n.$[prefix]-taskbar-item-icon {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.$[prefix]-taskbar-item-icon img {\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\n    object-fit: contain;\n}\n.$[prefix]-taskbar-item-icon i {\n    font-size: calc((var(--winlet-taskbar-icon-size) - 12px) * 0.8);\n    line-height: calc(var(--winlet-taskbar-icon-size) - 18px);\n    text-align: center;\n    object-fit: contain;\n}\n.$[prefix]-taskbar-item.$[prefix]-icon-only {\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\n    padding: 6px;\n}\n/* 縦向きアイコンモード */\n.$[prefix]-taskbar.$[prefix]-taskbar-left .$[prefix]-taskbar-item.$[prefix]-icon-only,\n.$[prefix]-taskbar.$[prefix]-taskbar-right .$[prefix]-taskbar-item.$[prefix]-icon-only {\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\n}\n\n.$[prefix]-taskbar-item.$[prefix]-active {\n    background-color: var(--$[prefix]-taskbar-item-active-bg);\n    color: var(--$[prefix]-taskbar-item-active-color);\n}\n.$[prefix]-taskbar-item.$[prefix]-minimized {\n    opacity: 0.7;\n}\n\n/* ========================================================================\n    15. モバイル・タッチデバイス対応\n   ======================================================================== */\n@media (pointer: coarse), (max-width: 768px) {\n    /* リサイズハンドルとコントロールボタンを大きくして操作しやすくする */\n    :root {\n        --$[prefix]-resize-handle-size: 16px;\n        --$[prefix]-resize-handle-offset: -8px;\n    }\n    .$[prefix]-control-btn {\n        width: calc(var(--$[prefix]-title-bar-height) * 1.5);\n    }\n}\n\n/* ========================================================================\n    16. アニメーション無効化\n   ======================================================================== */\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window,\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-minimized,\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-maximized,\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-is-restoring {\n    transition: none;\n}\n`;\n\nexport default styleData;\n","// src/themes/dark.ts\nimport { Theme } from \"../../const/types\";\n\nexport const darkTheme: Theme = {\n\tname: \"dark\",\n\tvariables: {\n\t\t// 基本色・シャドウ\n\t\t\"--$[prefix]-text-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-bg\": \"#2d2d2d\",\n\t\t\"--$[prefix]-border\": \"#555\",\n\t\t\"--$[prefix]-shadow-color-light\": \"rgba(0,0,0,0.3)\",\n\t\t\"--$[prefix]-shadow-color-strong\": \"rgba(0,0,0,0.5)\",\n\t\t\"--$[prefix]-shadow-color-active\": \"rgba(0,0,0,0.7)\",\n\n\t\t// タイトルバー\n\t\t\"--$[prefix]-title-bar-bg\": \"#3c3c3c\",\n\t\t\"--$[prefix]-title-text-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-title-text-active-color\": \"#fff\",\n\n\t\t// コントロールボタン\n\t\t\"--$[prefix]-control-bg\": \"#4a4a4a\",\n\t\t\"--$[prefix]-control-hover-bg\": \"#5a5a5a\",\n\n\t\t// メニュー\n\t\t\"--$[prefix]-menu-bg\": \"#252525\",\n\t\t\"--$[prefix]-menu-border\": \"#444\",\n\t\t\"--$[prefix]-menu-item-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-shortcut-text-color\": \"#b0b0b0\",\n\n\t\t// タブ\n\t\t\"--$[prefix]-tab-bg\": \"#383838\",\n\t\t\"--$[prefix]-tab-active-bg\": \"#2d2d2d\",\n\t\t\"--$[prefix]-tab-border\": \"#505050\",\n\t\t\"--$[prefix]-tab-bar-bg\": \"#383838\",\n\t\t\"--$[prefix]-tab-close-btn-hover-bg\": \"#5a5a5a\",\n\t\t\"--$[prefix]-tab-active-close-btn-hover-bg\": \"#6a6a6a\",\n\n\t\t// ポップアップボタン\n\t\t\"--$[prefix]-popup-button-hover-bg\": \"#5a5a5a\",\n\t\t\"--$[prefix]-popup-button-hover-border-color\": \"#777\",\n\n\t\t// タスクバー\n\t\t\"--$[prefix]-taskbar-bg\": \"rgba(45, 45, 45, 0.9)\",\n\t\t\"--$[prefix]-taskbar-border\": \"#555\",\n\t\t\"--$[prefix]-taskbar-item-bg\": \"#5a5a5a\",\n\n\t\t// その他\n\t\t\"--$[prefix]-scrollbar-thumb-bg\": \"rgba(180, 180, 180, 0.5)\",\n\t},\n};\n","// src/themes/default.ts\nimport { Theme } from \"../../const/types\";\n\nexport const defaultTheme: Theme = {\n\tname: \"default\",\n\tvariables: {\n\t\t// 基本色・シャドウ\n\t\t\"--$[prefix]-text-color\": \"#000\",\n\t\t\"--$[prefix]-bg\": \"#f0f0f0\",\n\t\t\"--$[prefix]-border\": \"#a0a0a0\",\n\t\t\"--$[prefix]-shadow-color-light\": \"rgba(0,0,0,0.15)\",\n\t\t\"--$[prefix]-shadow-color-strong\": \"rgba(0,0,0,0.3)\",\n\t\t\"--$[prefix]-shadow-color-active\": \"rgba(0,0,0,0.45)\",\n\n\t\t// タイトルバー\n\t\t\"--$[prefix]-title-bar-bg\": \"#e0e0e0\",\n\t\t\"--$[prefix]-title-bar-active-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-title-text-color\": \"#000\",\n\t\t\"--$[prefix]-title-text-active-color\": \"#fff\",\n\n\t\t// コントロールボタン\n\t\t\"--$[prefix]-control-bg\": \"#d0d0d0\",\n\t\t\"--$[prefix]-control-hover-bg\": \"#e5e5e5\",\n\t\t\"--$[prefix]-control-close-hover-bg\": \"#e81123\",\n\t\t\"--$[prefix]-control-close-hover-color\": \"#fff\",\n\n\t\t// メニュー\n\t\t\"--$[prefix]-menu-bg\": \"#fff\",\n\t\t\"--$[prefix]-menu-border\": \"#ccc\",\n\t\t\"--$[prefix]-menu-item-color\": \"#000\",\n\t\t\"--$[prefix]-menu-item-hover-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-menu-item-hover-color\": \"#fff\",\n\t\t\"--$[prefix]-shortcut-text-color\": \"#666\",\n\n\t\t// タブ\n\t\t\"--$[prefix]-tab-bg\": \"#dcdcdc\",\n\t\t\"--$[prefix]-tab-active-bg\": \"#f0f0f0\",\n\t\t\"--$[prefix]-tab-border\": \"#b0b0b0\",\n\t\t\"--$[prefix]-tab-bar-bg\": \"#e1e1e1\",\n\t\t\"--$[prefix]-tab-close-btn-hover-bg\": \"#ccc\",\n\t\t\"--$[prefix]-tab-active-close-btn-hover-bg\": \"#ddd\",\n\n\t\t// ポップアップボタン\n\t\t\"--$[prefix]-popup-button-hover-bg\": \"#e9e9e9\",\n\t\t\"--$[prefix]-popup-button-hover-border-color\": \"#bbb\",\n\n\t\t// タスクバー\n\t\t\"--$[prefix]-taskbar-bg\": \"rgba(240, 240, 240, 0.9)\",\n\t\t\"--$[prefix]-taskbar-border\": \"#a0a0a0\",\n\t\t\"--$[prefix]-taskbar-item-bg\": \"#d0d0d0\",\n\t\t\"--$[prefix]-taskbar-item-active-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-taskbar-item-active-color\": \"#fff\",\n\n\t\t/* ローディングインジケーター */\n\t\t\"--$[prefix]-loader-bg\": \"rgba(255, 255, 255, 0.7)\",\n\t\t\"--$[prefix]-loader-color\": \"var(--$[prefix]-title-bar-active-bg)\",\n\n\t\t// その他\n\t\t\"--$[prefix]-scrollbar-thumb-bg\": \"rgba(100, 100, 100, 0.5)\",\n\t},\n};\n","// このファイルは自動生成されます\nexport const LIB_VERSION = \"v1.0.1.4\";\n"],"mappings":"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","ignoreList":[]}