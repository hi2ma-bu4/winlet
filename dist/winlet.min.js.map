{"version":3,"file":"winlet.min.js","names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","module","Array","__esModule","arrayLikeToArray","isArray","ReferenceError","TypeError","isNativeReflectConstruct","setPrototypeOf","Reflect","construct","apply","arguments","push","bind","prototype","toPropertyKey","_defineProperties","enumerable","configurable","writable","Object","defineProperty","key","value","_getPrototypeOf","getPrototypeOf","__proto__","create","constructor","default","Function","toString","indexOf","_isNativeReflectConstruct","Boolean","valueOf","Symbol","iterator","from","_typeof","assertThisInitialized","_setPrototypeOf","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","toPrimitive","String","Number","slice","name","test","isNativeFunction","_wrapNativeSuper","Map","has","get","set","Wrapper","this","defaultConfig","id","ifExists","title","icon","x","y","width","height","minWidth","minHeight","resizableX","resizableY","movable","closable","minimizable","maximizable","maximizableOnDblClick","enableShortcuts","controlsPosition","content","html","iframe","src","srcdoc","allow","referrerPolicy","loading","sandbox","loadWinLet","template","menu","menuStyle","tabs","tabStyle","tabOptions","reorderable","addable","detachable","mergeable","allowIncomingMerge","onAdd","undefined","onMergeAttempt","contextMenu","focus","onOpen","onClose","onFocus","onBlur","onResize","onMove","onReload","_isPopup","_parent","WinLetBaseError","_Error","message","_this","_classCallCheck2","_callSuper","BuiltInError","captureStackTrace","_inherits2","_createClass2","_wrapNativeSuper2","SimpleError","_WinLetBaseError","WinLetError","_SimpleError","LIBRARY_NAME","TIMEOUT_RESULT","CLOSE_BUTTON_RESULT","_config","_errors","_types","_baseclass","_interopRequireDefault","_utils","_window_manager","_WinLetBaseClass","WinLetWindow","options","manager","_getPrototypeOf2","_possibleConstructorReturn2","_defineProperty2","generateId","existingEl","document","getElementById","classList","contains","concat","deepMerge","parentWindow","el","createDOM","add","titleBarEl","querySelector","iconEl","titleEl","contentEl","applyOptions","setupEventListeners","windowEl","createElement","className","handles","resizableHandlesHTML","join","hasMenu","hasTabs","isMergedMenu","isMergedTabs","controlsHTML","titleBarContentHTML","innerHTML","setTitle","setIcon","setSize","style","createTabs","renderContent","createMenu","container","tagName","appendChild","cloneNode","console","warn","isNonEmptyObject","iframeConfig","finalSrcDoc","globalConfig","getGlobalConfig","libraryPath","scriptTag","setAttribute","querySelectorAll","forEach","dd","display","isMenuOpen","_this2","menuBar","menuItemData","_menuItemData$name","menuItemEl","textContent","items","dropdownEl","createDropdownMenu","addEventListener","stopPropagation","isVisible","closeAllMenus","_this3","itemData","itemEl","separator","_itemData$name","text","shortcut","_itemData$action","action","subMenuEl","_this$options$tabOpti","_this4","tabBar","tabOpts","tabData","index","createTabElement","addTabBtn","_tabOpts$onAdd","newTabItem","addTab","setupTabBarDropZone","activateTab","_this5","_e$dataTransfer","dataTransfer","types","includes","preventDefault","dropEffect","remove","_e$dataTransfer2","_e$dataTransfer3","_e$dataTransfer4","_this5$manager$contai","tabDataJSON","getData","sourceWindowId","sourceTabId","draggingEl","sourceWindow","getWindow","_sourceOpts$mergeable","_targetOpts$allowInco","sourceOpts","targetOpts","isMergeable","allowsIncoming","customFilterPassed","JSON","parse","closeTab","parseInt","updateTabOrderFromDOM","_this$options$tabOpti2","_this6","tabEl","dataset","tabId","insertBefore","closeBtn","indexToClose","findIndex","tabContentEl","splice","makeTabReorderable","_this7","draggable","setData","tabIndex","isNaN","stringify","onTabDragStart","onTabDragEnd","_this7$manager$draggi","draggingTabInfo","rect","getBoundingClientRect","isAfter","clientX","left","parent","parentNode","nextSibling","passive","_this$tabs$index","wasActive","tab","newActiveIndex","Math","max","close","toggle","tabItem","setActive","newIndex","tabElements","newTabs","newOptionsTabs","oldTabs","_toConsumableArray2","oldOptionsTabs","oldIndex","_this8","boundGlobalClickHandler","_this8$popupCloseCall","popupCloseCallback","maxBtn","toggleMaximize","minBtn","minimize","makeMovable","makeResizable","showContextMenu","clientY","pointerType","contextMenuTimer","window","setTimeout","MOBILE_CONTEXT_MENU_TIMEOUT","clearContextMenuTimer","clearTimeout","_this9","target","closest","button","initialLeft","initialTop","startX","startY","isDragging","onPointerMove","moveE","_this9$el","isConnected","deltaX","abs","deltaY","DRAG_THRESHOLD","setPointerCapture","pointerId","pointerEvents","state","restoredWidth","lastState","clickRatio","offsetWidth","titleBarRect","offsetY","top","posX","posY","restore","setPosition","offsetLeft","offsetTop","newLeft","newTop","removeEventListener","releasePointerCapture","_this0","handle","direction","replace","_this0$el","startWidth","startHeight","offsetHeight","startLeft","startTop","_this0$options","newWidth","newHeight","_onPointerUp","classStr","classes","trim","split","hasPrefix","some","hasIcon","destroyWindow","blur","maximize","focused","focusWindow","_this1","reloadContent","_iframe$contentWindow","contentWindow","location","reload","activeTabIndex","activeTab","tabContentOptions","contentContainer","childManager","applyGlobalConfig","init","type","postMessage","getChildManager","createWindow","winOptions","popup","assign","sanitizeHTML","isFontAwesome","img","alt","finalX","finalY","parentRect","winWidth","winHeight","min","_styles","_window2","_createForOfIteratorHelper","_arrayLikeToArray","_unsupportedIterableToArray","_n","F","s","done","next","WindowManager","initialConfig","_isInitialized","parentEl","HTMLElement","body","styleTag","getStyleData","head","containerEl","getComputedStyle","position","requestAnimationFrame","activeEl","activeElement","winEl","win","windows","activeWindow","active","hideContextMenu","event","data","_typeof2","_step","isSourceValid","_iterator","values","source","err","origin","setupShortcutListeners","newTab","mergedWindowOptions","getSize","_targetWindow$options","_targetWindow$options2","windowSwitchShortcut","parseShortcut","toLowerCase","ctrlKey","ctrl","altKey","shiftKey","shift","currentIndex","w","targetWindow","startsWith","keyNum","numTabs","getTabs","_findAndExecShortcut","menuItems","_step2","_iterator2","item","_item$action","_shortcut","toUpperCase","_options$ifExists","ensureInitialized","existingWindow","creationOptions","nextX","nextY","containerRect","lastAutoPosition","CASCADE_OFFSET","allWindows","zIndex","zIndexCounter","buttons","buttonPresets","Ok","OkCancel","Yes","YesNo","YesNoCancel","Retry","RetryCancel","AbortRetryIgnore","timeoutId","closeCallback","result","_options$onClose","messageHTML","buttonsHTML","map","btn","contentHTML","autoWidth","_this$container","_this$container2","temp","visibility","whiteSpace","removeChild","winPosition","getPosition","lastPopupPosition","timeout","nextWin","pop","_this$activeWindow","element","_this$container3","_this$container4","contextWindow","contextMenuEl","_this$contextMenuEl","menuWidth","menuHeight","_window","screenWidth","innerWidth","screenHeight","innerHeight","_this$contextMenuEl2","keys","_document","_version","currentScript","api","setGlobalConfig","createPopup","getWindowFromElement","getActiveWindow","setDefaultConfig","isInitialized","version","LIB_VERSION","POPUP_TIMEOUT_RESULT","POPUP_CLOSE_BUTTON_RESULT","WinLet","WinLetBaseClass","ownKeys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","Utils","random","substring","output","getOwnPropertyDescriptors","defineProperties","_objectSpread","hasOwnProperty","sourceValue","targetValue","obj","_","str"],"sources":["node_modules/browser-pack/_prelude.js","node_modules/@babel/runtime/helpers/arrayLikeToArray.js","node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","node_modules/@babel/runtime/helpers/assertThisInitialized.js","node_modules/@babel/runtime/helpers/classCallCheck.js","node_modules/@babel/runtime/helpers/construct.js","node_modules/@babel/runtime/helpers/createClass.js","node_modules/@babel/runtime/helpers/defineProperty.js","node_modules/@babel/runtime/helpers/getPrototypeOf.js","node_modules/@babel/runtime/helpers/inherits.js","node_modules/@babel/runtime/helpers/interopRequireDefault.js","node_modules/@babel/runtime/helpers/isNativeFunction.js","node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js","node_modules/@babel/runtime/helpers/iterableToArray.js","node_modules/@babel/runtime/helpers/nonIterableSpread.js","node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","node_modules/@babel/runtime/helpers/setPrototypeOf.js","node_modules/@babel/runtime/helpers/toConsumableArray.js","node_modules/@babel/runtime/helpers/toPrimitive.js","node_modules/@babel/runtime/helpers/toPropertyKey.js","node_modules/@babel/runtime/helpers/typeof.js","node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","node_modules/@babel/runtime/helpers/wrapNativeSuper.js","src/const/config.ts","src/const/errors.ts","src/const/types.ts","src/function/window.ts","src/function/window_manager.ts","src/index.ts","src/libs/baseclass.ts","src/libs/utils.ts","src/style/styles.ts","src/version.ts"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return arrayLikeToArray(r);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var isNativeReflectConstruct = require(\"./isNativeReflectConstruct.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _construct(t, e, r) {\n  if (isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments);\n  var o = [null];\n  o.push.apply(o, e);\n  var p = new (t.bind.apply(t, o))();\n  return r && setPrototypeOf(p, r.prototype), p;\n}\nmodule.exports = _construct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _getPrototypeOf(t) {\n  return module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _getPrototypeOf(t);\n}\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _interopRequireDefault(e) {\n  return e && e.__esModule ? e : {\n    \"default\": e\n  };\n}\nmodule.exports = _interopRequireDefault, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _isNativeFunction(t) {\n  try {\n    return -1 !== Function.toString.call(t).indexOf(\"[native code]\");\n  } catch (n) {\n    return \"function\" == typeof t;\n  }\n}\nmodule.exports = _isNativeFunction, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (module.exports = _isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _isNativeReflectConstruct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _setPrototypeOf(t, e) {\n  return module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _setPrototypeOf(t, e);\n}\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(r) {\n  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var getPrototypeOf = require(\"./getPrototypeOf.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nvar isNativeFunction = require(\"./isNativeFunction.js\");\nvar construct = require(\"./construct.js\");\nfunction _wrapNativeSuper(t) {\n  var r = \"function\" == typeof Map ? new Map() : void 0;\n  return module.exports = _wrapNativeSuper = function _wrapNativeSuper(t) {\n    if (null === t || !isNativeFunction(t)) return t;\n    if (\"function\" != typeof t) throw new TypeError(\"Super expression must either be null or a function\");\n    if (void 0 !== r) {\n      if (r.has(t)) return r.get(t);\n      r.set(t, Wrapper);\n    }\n    function Wrapper() {\n      return construct(t, arguments, getPrototypeOf(this).constructor);\n    }\n    return Wrapper.prototype = Object.create(t.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    }), setPrototypeOf(Wrapper, t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _wrapNativeSuper(t);\n}\nmodule.exports = _wrapNativeSuper, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","import { WindowOptions } from \"./types\";\n\n// Partial<WindowOptions>ではなく、全てのキーを定義して型安全にする\nexport const defaultConfig: Required<WindowOptions> = {\n\tid: null,\n\tifExists: \"focus\",\n\ttitle: \"New Window\",\n\ticon: null,\n\tx: \"auto\",\n\ty: \"auto\",\n\twidth: 500,\n\theight: 400,\n\tminWidth: 200,\n\tminHeight: 150,\n\tresizableX: true,\n\tresizableY: true,\n\tmovable: true,\n\tclosable: true,\n\tminimizable: true,\n\tmaximizable: true,\n\tmaximizableOnDblClick: true,\n\tenableShortcuts: true,\n\tcontrolsPosition: \"right\",\n\tcontent: {\n\t\thtml: \"\",\n\t\tiframe: {\n\t\t\tsrc: \"\",\n\t\t\tsrcdoc: \"\",\n\t\t\tallow: \"\",\n\t\t\treferrerPolicy: \"\",\n\t\t\tloading: \"lazy\",\n\t\t\tsandbox: \"\",\n\t\t\tloadWinLet: false,\n\t\t},\n\t\ttemplate: \"\",\n\t},\n\tmenu: [],\n\tmenuStyle: \"default\",\n\ttabs: [],\n\ttabStyle: \"default\",\n\ttabOptions: {\n\t\treorderable: false,\n\t\tclosable: false,\n\t\taddable: false,\n\t\tdetachable: false,\n\t\tmergeable: false,\n\t\tallowIncomingMerge: false,\n\t\tonAdd: undefined,\n\t\tonMergeAttempt: undefined,\n\t},\n\tcontextMenu: [],\n\tfocus: true,\n\tonOpen: () => {},\n\tonClose: () => {},\n\tonFocus: () => {},\n\tonBlur: () => {},\n\tonResize: () => {},\n\tonMove: () => {},\n\tonReload: () => {},\n\n\t_isPopup: false,\n\t_parent: null,\n};\n","interface ErrorConstructor {\n\tcaptureStackTrace?(targetObject: object, constructorOpt?: Function): void;\n}\n\n/**\n * すべてのカスタムエラーの基底クラス\n */\nexport class WinLetBaseError extends Error {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t\tthis.name = this.constructor.name;\n\n\t\tconst BuiltInError: ErrorConstructor = Error as ErrorConstructor;\n\t\tif (BuiltInError.captureStackTrace) {\n\t\t\tBuiltInError.captureStackTrace(this, this.constructor);\n\t\t}\n\t}\n}\n\n/**\n * 単純なメッセージのみのエラー\n */\nexport class SimpleError extends WinLetBaseError {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t}\n}\n\nexport class WinLetError extends SimpleError {}\n","export const LIBRARY_NAME = \"winlet\";\n\nexport type WindowState = \"normal\" | \"minimized\" | \"maximized\";\n\nexport interface WindowContentOptions {\n\t/**\n\t * 直接埋め込むHTML\n\t */\n\thtml?: string;\n\t/**\n\t * iframe設定\n\t */\n\tiframe?: {\n\t\tsrc?: HTMLIFrameElement[\"src\"];\n\t\tsrcdoc?: HTMLIFrameElement[\"srcdoc\"];\n\t\tallow?: HTMLIFrameElement[\"allow\"];\n\t\treferrerPolicy?: HTMLIFrameElement[\"referrerPolicy\"];\n\t\tloading?: HTMLIFrameElement[\"loading\"];\n\t\tsandbox?: string[] | string;\n\t\t/**\n\t\t * srcdocで生成されるiframe内にWinLetライブラリ自身を読み込むかどうか。\n\t\t * trueにする場合、GlobalConfigOptionsでlibraryPathを指定する必要があります。\n\t\t */\n\t\tloadWinLet?: boolean;\n\t};\n\t/**\n\t * HTMLテンプレートのselector\n\t */\n\ttemplate?: string;\n}\n\n// IWindowインターフェースを先に定義することで循環参照を回避\nexport interface IWindow {\n\treadonly id: string;\n\toptions: Required<WindowOptions>;\n\tel: HTMLElement;\n\tstate: WindowState;\n\n\t// --- Public API ---\n\tclose(): void;\n\tminimize(): void;\n\ttoggleMaximize(): void;\n\tmaximize(): void;\n\trestore(): void;\n\tfocus(): void;\n\tblur(): void;\n\tgetTitle(): string;\n\tsetTitle(title: string): void;\n\tsetIcon(icon: string | null): void;\n\tgetPosition(): { x: number; y: number };\n\tsetPosition(x: number | \"center\" | \"left\" | \"right\" | \"auto\", y: number | \"center\" | \"top\" | \"bottom\" | \"auto\"): void;\n\tgetSize(): { width: number; height: number };\n\tsetSize(width: number | string, height: number | string): void;\n\treload(): void;\n\n\t/**\n\t * ウィンドウのコンテンツ要素（またはiframe要素）を取得します。\n\t * @returns コンテンツを内包するHTMLElement、またはiframeウィンドウの場合はHTMLIFrameElement\n\t */\n\tgetContent(): HTMLElement | HTMLIFrameElement;\n\n\t/**\n\t * このウィンドウの内部に新しいウィンドウを作成します。\n\t * @param options - 新しいウィンドウのオプション\n\t * @returns 作成されたIWindowインスタンス\n\t */\n\tcreateWindow(options?: WindowOptions): IWindow;\n\n\t/**\n\t * このウィンドウの内部に新しいポップアップを作成します。\n\t * @param options - 新しいポップアップのオプション\n\t * @returns 作成されたIWindowインスタンス\n\t */\n\tcreatePopup(options: PopupOptions): IWindow;\n}\n\nexport interface MenuItem {\n\tname?: string;\n\taction?: (win: IWindow) => void;\n\titems?: MenuItem[];\n\tseparator?: boolean;\n\tshortcut?: string;\n}\n\nexport interface TabItem {\n\ttitle: string;\n\tcontent: WindowContentOptions;\n}\n\nexport interface ContextMenuItem {\n\tname?: string;\n\taction?: (win: IWindow) => void;\n\tseparator?: boolean;\n}\n\nexport interface WindowOptions {\n\t/**\n\t * ウィンドウのID\n\t */\n\tid?: string | null;\n\t/**\n\t * 既に同名のウィンドウが存在する場合の動作\n\t *\n\t * focus (デフォルト): 既存のウィンドウを復元し、フォーカスします。\n\t * prevent: 新しいウィンドウを作成せず、処理を中断します。\n\t * create: IDの重複を無視して、常に新しいウィンドウを作成します。\n\t */\n\tifExists?: \"focus\" | \"prevent\" | \"create\";\n\t/**\n\t * ウィンドウのタイトル\n\t */\n\ttitle?: string;\n\t/**\n\t * ウィンドウのアイコン\n\t *\n\t * url / font-awesomeのクラス名の指定可能\n\t */\n\ticon?: string | null;\n\t/**\n\t * ウィンドウのX座標\n\t */\n\tx?: number | \"center\" | \"left\" | \"right\" | \"auto\";\n\t/**\n\t * ウィンドウのY座標\n\t */\n\ty?: number | \"center\" | \"top\" | \"bottom\" | \"auto\";\n\t/**\n\t * ウィンドウのサイズX\n\t */\n\twidth?: number;\n\t/**\n\t * ウィンドウのサイズY\n\t */\n\theight?: number;\n\t/**\n\t * ウィンドウの最小サイズX\n\t */\n\tminWidth?: number;\n\t/**\n\t * ウィンドウの最小サイズY\n\t */\n\tminHeight?: number;\n\t/**\n\t * 水平方向のリサイズ\n\t */\n\tresizableX?: boolean;\n\t/**\n\t * 垂直方向のリサイズ\n\t */\n\tresizableY?: boolean;\n\t/**\n\t * ウィンドウの移動\n\t */\n\tmovable?: boolean;\n\t/**\n\t * ウィンドウを閉じるボタンの表示\n\t */\n\tclosable?: boolean;\n\t/**\n\t * ウィンドウを最小化するボタンの表示\n\t */\n\tminimizable?: boolean;\n\t/**\n\t * ウィンドウを最大化するボタンの表示\n\t */\n\tmaximizable?: boolean;\n\t/**\n\t * タイトルバーのダブルクリックで最大化\n\t */\n\tmaximizableOnDblClick?: boolean;\n\t/**\n\t * ショートカットキーを有効化\n\t */\n\tenableShortcuts?: boolean;\n\t/**\n\t * コントロールの位置\n\t */\n\tcontrolsPosition?: \"left\" | \"right\";\n\t/**\n\t * ウィンドウのコンテンツ\n\t */\n\tcontent?: WindowContentOptions;\n\t/**\n\t * メニュー\n\t */\n\tmenu?: MenuItem[];\n\t/**\n\t * メニューの表示形式\n\t * - default: 通常のメニューバー\n\t * - merged: タイトルバーに統合\n\t */\n\tmenuStyle?: \"default\" | \"merged\";\n\t/**\n\t * タブ\n\t */\n\ttabs?: TabItem[];\n\t/**\n\t * タブの表示形式\n\t * - default: 通常のタブバー\n\t * - merged: タイトルバーに統合されたChrome風タブ\n\t */\n\ttabStyle?: \"default\" | \"merged\";\n\ttabOptions?: {\n\t\t/**\n\t\t * タブの入れ替え\n\t\t */\n\t\treorderable?: boolean;\n\t\t/**\n\t\t * タブを閉じるボタン\n\t\t */\n\t\tclosable?: boolean;\n\t\t/**\n\t\t * タブ追加ボタン\n\t\t */\n\t\taddable?: boolean;\n\t\t/**\n\t\t * タブをドラッグして新しいウィンドウとして分離できるようにするか\n\t\t */\n\t\tdetachable?: boolean;\n\t\t/**\n\t\t * タブを別の既存のウィンドウにマージすることができます。\n\t\t */\n\t\tmergeable?: boolean;\n\t\t/**\n\t\t * このウィンドウが他のウィンドウからマージされたタブを受け入れることができます。\n\t\t */\n\t\tallowIncomingMerge?: boolean;\n\t\t/**\n\t\t * 追加ボタン押下時の処理\n\t\t */\n\t\tonAdd?: (win: IWindow) => TabItem;\n\t\t/**\n\t\t * マージが許可されているかどうかを動的に決定するコールバック関数。\n\t\t * @param sourceWindow タブの元ウィンドウ\n\t\t * @param targetWindow ドロップされたタブのウィンドウ\n\t\t * @returns true:マージ許可 false:マージ禁止\n\t\t */\n\t\tonMergeAttempt?: (sourceWindow: IWindow, targetWindow: IWindow) => boolean;\n\t};\n\t/**\n\t * 右クリックメニュー\n\t */\n\tcontextMenu?: ContextMenuItem[];\n\t/**\n\t * 作成時にウィンドウにフォーカスを当てるか\n\t */\n\tfocus?: boolean;\n\t/**\n\t * ウィンドウオープン時\n\t */\n\tonOpen?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウクローズ時\n\t */\n\tonClose?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウフォーカス時\n\t */\n\tonFocus?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウブラー時\n\t */\n\tonBlur?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウリサイズ時\n\t */\n\tonResize?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウ移動時\n\t */\n\tonMove?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウリロード時\n\t *\n\t * デフォルトのリロード動作（iframeの再読み込みやhtmlの再描画）をキャンセルする場合は `false` を返します。\n\t */\n\tonReload?: (win: IWindow) => boolean | void;\n\n\t// 内部利用フラグ\n\t_isPopup?: boolean;\n\t/**\n\t * 親ウィンドウのインスタンス (内部利用)\n\t */\n\t_parent?: IWindow | null;\n}\n\n// --- Popup ---\nexport const TIMEOUT_RESULT = Symbol(\"timeout\");\nexport const CLOSE_BUTTON_RESULT = Symbol(\"close\");\n\nexport type PopupResult = string | number | symbol | null;\n\nexport interface PopupButton {\n\ttext: string;\n\tvalue: PopupResult;\n}\n\nexport type PopupButtonPreset = \"Ok\" | \"OkCancel\" | \"Yes\" | \"YesNo\" | \"YesNoCancel\" | \"Retry\" | \"RetryCancel\" | \"AbortRetryIgnore\";\n\nexport interface PopupOptions {\n\tmessage: string;\n\ttitle?: string;\n\ticon?: string | null;\n\tbuttons?: PopupButton[] | PopupButtonPreset;\n\ttimeout?: number;\n\tautoWidth?: boolean;\n\tfocus?: boolean;\n\n\t/**\n\t * ウィンドウクローズ時\n\t */\n\tonClose?: (result: PopupResult) => void;\n\t/**\n\t * ウィンドウフォーカス時\n\t */\n\tonFocus?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウブラー時\n\t */\n\tonBlur?: (win: IWindow) => void;\n}\n\nexport interface GlobalConfigOptions {\n\twindowSwitchShortcut?: string | null; // 例: \"Ctrl+`\"\n\t/**\n\t * ウィンドウマネージャを内包する親要素。\n\t * セレクタ文字列またはHTMLElementを指定します。\n\t * 未指定の場合はbody直下に配置されます。\n\t */\n\tcontainer?: string | HTMLElement;\n\t/**\n\t * `srcdoc` iframeでWinLetを自己読込する場合のライブラリのパス。\n\t */\n\tlibraryPath?: string;\n}\n\n// WinLetの公開APIの型\nexport interface WinLetApi {\n\tinit: (options?: GlobalConfigOptions) => void;\n\t/**\n\t * ウィンドウを作成します。\n\t */\n\tcreateWindow: (options?: WindowOptions) => IWindow;\n\t/**\n\t * ポップアップウィンドウを作成します。\n\t */\n\tcreatePopup: (options: PopupOptions) => IWindow;\n\t/**\n\t * 指定されたIDのウィンドウインスタンスを取得します。\n\t * @param id - 取得するウィンドウのID\n\t */\n\tgetWindow: (id: string) => IWindow | undefined;\n\t/**\n\t * 指定されたDOM要素を内包するウィンドウインスタンスを取得します。\n\t * 入れ子ウィンドウの場合、最も内側にある子ウィンドウを返します。\n\t * @param element - 検索の起点となるDOM要素\n\t * @returns 発見されたIWindowインスタンス、またはundefined\n\t */\n\tgetWindowFromElement: (element: HTMLElement) => IWindow | undefined;\n\t/**\n\t * 現在アクティブなウィンドウを取得します。\n\t */\n\tgetActiveWindow: () => IWindow | null;\n\t/**\n\t * ウィンドウのデフォルトの設定を変更します。\n\t */\n\tsetDefaultConfig: (options: WindowOptions) => void;\n\t/**\n\t * グローバル設定を変更します。\n\t */\n\tsetGlobalConfig: (options: GlobalConfigOptions) => void;\n\t/**\n\t * WinLetのバージョンを取得します。\n\t */\n\tget version(): string;\n\tPOPUP_TIMEOUT_RESULT: typeof TIMEOUT_RESULT;\n\tPOPUP_CLOSE_BUTTON_RESULT: typeof CLOSE_BUTTON_RESULT;\n}\n\n// グローバルスコープのWindowにWinLetプロパティを追加\ndeclare global {\n\tinterface Window {\n\t\tWinLet: WinLetApi;\n\t}\n}\n","import { defaultConfig } from \"../const/config\";\nimport { WinLetError } from \"../const/errors\";\nimport { CLOSE_BUTTON_RESULT, IWindow, LIBRARY_NAME, MenuItem, PopupOptions, PopupResult, TabItem, WindowContentOptions, WindowOptions, WindowState } from \"../const/types\";\nimport WinLetBaseClass from \"../libs/baseclass\";\nimport Utils from \"../libs/utils\";\nimport WindowManager from \"./window_manager\";\n\nexport default class WinLetWindow extends WinLetBaseClass implements IWindow {\n\tpublic readonly id: string;\n\tpublic options: Required<WindowOptions>;\n\tpublic el: HTMLElement;\n\tpublic state: WindowState = \"normal\";\n\n\tprivate manager: WindowManager;\n\tprivate lastState = { x: 0, y: 0, width: 0, height: 0 };\n\tprivate focused: boolean = false;\n\tprivate readonly DRAG_THRESHOLD = 5;\n\n\tprivate titleBarEl: HTMLElement;\n\tprivate iconEl: HTMLElement;\n\tprivate titleEl: HTMLElement;\n\tprivate contentEl: HTMLElement;\n\tprivate tabs: { tabEl: HTMLElement; contentEl: HTMLElement }[] = [];\n\tprivate addTabBtn: HTMLElement | null = null;\n\tprivate isMenuOpen = false;\n\tprivate boundGlobalClickHandler: ((event: MouseEvent) => void) | null = null;\n\n\t// モバイル対応\n\tprivate readonly MOBILE_CONTEXT_MENU_TIMEOUT = 700;\n\tprivate contextMenuTimer: number | null = null;\n\n\t// Popup用\n\tpublic popupCloseCallback: ((result: PopupResult) => void) | null = null;\n\n\tprivate childManager: WindowManager | null = null;\n\tprivate parentWindow: IWindow | null;\n\n\tconstructor(options: WindowOptions, manager: WindowManager) {\n\t\tsuper();\n\t\tthis.id = options.id || Utils.generateId(\"window\");\n\t\tif (options.id) {\n\t\t\tconst existingEl = document.getElementById(options.id);\n\t\t\tif (existingEl && existingEl.classList.contains(`${LIBRARY_NAME}-window`)) {\n\t\t\t\tthrow new WinLetError(`WinLet: Window with ID \"${options.id}\" already exists. New window will not be created.`);\n\t\t\t}\n\t\t}\n\t\tthis.manager = manager;\n\t\tthis.options = Utils.deepMerge(defaultConfig, options) as Required<WindowOptions>;\n\t\tthis.parentWindow = options._parent || null;\n\n\t\tthis.el = this.createDOM();\n\n\t\t// _isPopupによってクラスを追加\n\t\tif (this.options._isPopup) {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-popup-window`);\n\t\t}\n\t\t// tabStyleとmenuStyleによってクラスを追加\n\t\tif (this.options.tabStyle === \"merged\") {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-tab-style-merged`);\n\t\t}\n\t\tif (this.options.menuStyle === \"merged\") {\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-menu-style-merged`);\n\t\t}\n\n\t\tthis.titleBarEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title-bar`)!;\n\t\tthis.iconEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-icon`)!;\n\t\tthis.titleEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title`)!;\n\t\tthis.contentEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-content`)!;\n\n\t\tthis.applyOptions();\n\t\tthis.setupEventListeners();\n\n\t\tthis.options.onOpen(this);\n\t}\n\n\tprivate createDOM(): HTMLElement {\n\t\tconst windowEl = document.createElement(\"div\");\n\t\twindowEl.className = `${LIBRARY_NAME}-window`;\n\t\twindowEl.id = this.id;\n\n\t\tconst handles: string[] = [];\n\t\tif (this.options.resizableY) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle n\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle s\"></div>`);\n\t\t}\n\t\tif (this.options.resizableX) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle w\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle e\"></div>`);\n\t\t}\n\t\tif (this.options.resizableX && this.options.resizableY) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle nw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ne\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle sw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle se\"></div>`);\n\t\t}\n\t\tconst resizableHandlesHTML = handles.join(\"\");\n\n\t\tconst hasMenu = this.options.menu.length > 0;\n\t\tconst hasTabs = this.options.tabs.length > 0;\n\t\tconst isMergedMenu = this.options.menuStyle === \"merged\" && hasMenu;\n\t\tconst isMergedTabs = this.options.tabStyle === \"merged\" && hasTabs;\n\n\t\tconst controlsHTML = `\n            <div class=\"${LIBRARY_NAME}-controls\">\n                ${this.options.minimizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-minimize-btn\" type=\"button\" value=\"\\uff3f\" title=\"Minimize\" />` : \"\"}\n                ${this.options.maximizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-maximize-btn\" type=\"button\" value=\"\\u25a1\" title=\"Maximize\" />` : \"\"}\n                ${this.options.closable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-close-btn\" type=\"button\" value=\"\\u2573\" title=\"Close\">` : \"\"}\n            </div>`;\n\n\t\tconst titleBarContentHTML = `\n            <div class=\"${LIBRARY_NAME}-icon\"></div>\n            ${isMergedMenu ? `<div class=\"${LIBRARY_NAME}-menu-bar\"></div>` : \"\"}\n            <div class=\"${LIBRARY_NAME}-title\"></div>\n            ${isMergedTabs ? `<div class=\"${LIBRARY_NAME}-tab-bar\"></div>` : \"\"}\n            ${controlsHTML}\n        `;\n\n\t\twindowEl.innerHTML = `\n            <div class=\"${LIBRARY_NAME}-title-bar ${LIBRARY_NAME}-us-none\">\n                ${titleBarContentHTML}\n            </div>\n            <div class=\"${LIBRARY_NAME}-main-content\">\n                ${!isMergedMenu && hasMenu ? `<div class=\"${LIBRARY_NAME}-menu-bar\"></div>` : \"\"}\n                ${!isMergedTabs && hasTabs ? `<div class=\"${LIBRARY_NAME}-tab-bar\"></div>` : \"\"}\n                <div class=\"${LIBRARY_NAME}-content\"></div>\n            </div>\n            ${resizableHandlesHTML}\n        `;\n\t\treturn windowEl;\n\t}\n\n\tprivate applyOptions(): void {\n\t\tthis.setTitle(this.options.title);\n\t\tthis.setIcon(this.options.icon);\n\t\tthis.setSize(this.options.width, this.options.height);\n\t\tthis.el.style.minWidth = `${this.options.minWidth}px`;\n\t\tthis.el.style.minHeight = `${this.options.minHeight}px`;\n\n\t\tif (this.options.controlsPosition === \"left\") {\n\t\t\tthis.titleBarEl.classList.add(\"controls-left\");\n\t\t}\n\n\t\tif (this.options.tabs.length > 0) {\n\t\t\tthis.createTabs();\n\t\t} else {\n\t\t\tthis.renderContent(this.contentEl, this.options.content);\n\t\t}\n\n\t\tif (this.options.menu.length > 0) {\n\t\t\tthis.createMenu();\n\t\t}\n\t}\n\n\tprivate renderContent(container: HTMLElement, content: WindowContentOptions): void {\n\t\tcontainer.innerHTML = \"\";\n\t\tif (content.template) {\n\t\t\tconst template = document.querySelector<HTMLTemplateElement>(content.template);\n\t\t\tif (template?.tagName === \"TEMPLATE\") {\n\t\t\t\tcontainer.appendChild(template.content.cloneNode(true));\n\t\t\t} else {\n\t\t\t\tcontainer.innerHTML = \"Error: Template not found or invalid.\";\n\t\t\t\tconsole.warn(\"WinLet Warning: Template not found or invalid.\");\n\t\t\t}\n\t\t} else if (content.html) {\n\t\t\tcontainer.innerHTML = content.html;\n\t\t} else if (Utils.isNonEmptyObject(content.iframe)) {\n\t\t\tconst iframe = document.createElement(\"iframe\");\n\t\t\tconst iframeConfig = content.iframe;\n\t\t\tif (iframeConfig.src) {\n\t\t\t\tiframe.src = iframeConfig.src;\n\t\t\t}\n\t\t\tif (iframeConfig.srcdoc) {\n\t\t\t\tlet finalSrcDoc = iframeConfig.srcdoc;\n\t\t\t\tif (iframeConfig.loadWinLet) {\n\t\t\t\t\tconst globalConfig = this.manager.getGlobalConfig();\n\t\t\t\t\tif (globalConfig.libraryPath) {\n\t\t\t\t\t\tconst scriptTag = `<script src=\"${globalConfig.libraryPath}\"><\\/script>`;\n\t\t\t\t\t\tconst initScript = `<script>document.addEventListener('DOMContentLoaded', () => window.WinLet.init({ container: document.body }));<\\/script>`;\n\t\t\t\t\t\tfinalSrcDoc = `<!DOCTYPE html><html><head><meta charset=\"UTF-8\">${scriptTag}${initScript}</head><body>${iframeConfig.srcdoc}</body></html>`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"WinLet Warning: `loadWinLet` is true, but `libraryPath` is not set in global config.\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tiframe.srcdoc = finalSrcDoc;\n\t\t\t}\n\t\t\tif (iframeConfig.allow) {\n\t\t\t\tiframe.allow = iframeConfig.allow;\n\t\t\t}\n\t\t\tif (iframeConfig.referrerPolicy) {\n\t\t\t\tiframe.referrerPolicy = iframeConfig.referrerPolicy;\n\t\t\t}\n\t\t\tif (iframeConfig.loading) {\n\t\t\t\tiframe.loading = iframeConfig.loading;\n\t\t\t}\n\t\t\tif (iframeConfig.sandbox) {\n\t\t\t\tif (!Array.isArray(iframeConfig.sandbox)) {\n\t\t\t\t\tiframeConfig.sandbox = [iframeConfig.sandbox];\n\t\t\t\t}\n\t\t\t\tif (iframeConfig.sandbox.length > 0) {\n\t\t\t\t\tiframe.setAttribute(\"sandbox\", iframeConfig.sandbox.join(\" \"));\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontainer.appendChild(iframe);\n\t\t}\n\t}\n\n\tprivate closeAllMenus(): void {\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-menu-item > .${LIBRARY_NAME}-menu-dropdown`).forEach((dd) => {\n\t\t\tdd.style.display = \"none\";\n\t\t});\n\t\tthis.isMenuOpen = false;\n\t}\n\n\tprivate createMenu(): void {\n\t\tconst menuBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-menu-bar`)!;\n\t\tmenuBar.innerHTML = \"\";\n\n\t\tthis.options.menu.forEach((menuItemData) => {\n\t\t\tconst menuItemEl = document.createElement(\"div\");\n\t\t\tmenuItemEl.className = `${LIBRARY_NAME}-menu-item ${LIBRARY_NAME}-us-none`;\n\t\t\tmenuItemEl.textContent = menuItemData.name ?? \"\";\n\n\t\t\tif (menuItemData.items) {\n\t\t\t\tconst dropdownEl = this.createDropdownMenu(menuItemData.items);\n\n\t\t\t\tmenuItemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tconst isVisible = dropdownEl.style.display === \"block\";\n\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\tif (!isVisible) {\n\t\t\t\t\t\tdropdownEl.style.display = \"block\";\n\t\t\t\t\t\tthis.isMenuOpen = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuItemEl.addEventListener(\"mouseenter\", () => {\n\t\t\t\t\tif (this.isMenuOpen) {\n\t\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\t\tdropdownEl.style.display = \"block\";\n\t\t\t\t\t\tthis.isMenuOpen = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuItemEl.appendChild(dropdownEl);\n\t\t\t}\n\t\t\tmenuBar.appendChild(menuItemEl);\n\t\t});\n\t}\n\n\tprivate createDropdownMenu(items: MenuItem[]): HTMLUListElement {\n\t\tconst dropdownEl = document.createElement(\"ul\");\n\t\tdropdownEl.className = `${LIBRARY_NAME}-menu-dropdown`;\n\n\t\titems.forEach((itemData) => {\n\t\t\tconst itemEl = document.createElement(\"li\");\n\t\t\tif (itemData.separator) {\n\t\t\t\titemEl.className = \"separator\";\n\t\t\t} else {\n\t\t\t\tlet text = itemData.name ?? \"\";\n\t\t\t\ttext = `<span>${text}</span>`;\n\t\t\t\tif (this.options.enableShortcuts && itemData.shortcut) {\n\t\t\t\t\ttext += `<span class=\"${LIBRARY_NAME}-shortcut-text\">(${itemData.shortcut})</span>`;\n\t\t\t\t}\n\t\t\t\titemEl.innerHTML = `<div class=\"${LIBRARY_NAME}-menu-dropdown-item\">${text}</div>`;\n\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.closeAllMenus();\n\t\t\t\t\titemData.action?.(this);\n\t\t\t\t});\n\t\t\t\tif (itemData.items) {\n\t\t\t\t\titemEl.classList.add(\"has-submenu\"); // スタイル付けのためのクラス\n\t\t\t\t\tconst subMenuEl = this.createDropdownMenu(itemData.items);\n\t\t\t\t\titemEl.appendChild(subMenuEl);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdropdownEl.appendChild(itemEl);\n\t\t});\n\t\treturn dropdownEl;\n\t}\n\n\tprivate createTabs(): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\ttabBar.innerHTML = \"\";\n\t\tthis.tabs = [];\n\t\tconst tabOpts = this.options.tabOptions ?? {};\n\n\t\tthis.options.tabs.forEach((tabData, index) => {\n\t\t\tthis.createTabElement(tabData, index);\n\t\t});\n\n\t\tif (tabOpts.addable) {\n\t\t\tthis.addTabBtn = document.createElement(\"div\");\n\t\t\tthis.addTabBtn.className = `${LIBRARY_NAME}-tab-add-btn`;\n\t\t\tthis.addTabBtn.textContent = \"+\";\n\t\t\tthis.addTabBtn.addEventListener(\"click\", (e) => {\n\t\t\t\tconst newTabItem = tabOpts.onAdd?.(this);\n\t\t\t\tif (newTabItem) {\n\t\t\t\t\tthis.addTab(newTabItem);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttabBar.appendChild(this.addTabBtn);\n\t\t}\n\t\t// タブの並び替えと統合のためのドロップゾーンを設定\n\t\tthis.setupTabBarDropZone();\n\n\t\tif (this.tabs.length > 0) this.activateTab(0);\n\t}\n\n\tprivate setupTabBarDropZone(): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\tif (!tabBar || !this.options.tabOptions.reorderable) return;\n\n\t\ttabBar.addEventListener(\"dragover\", (e) => {\n\t\t\tif (e.dataTransfer?.types.includes(\"application/winlet-tab\")) {\n\t\t\t\te.preventDefault();\n\t\t\t\tif (e.dataTransfer) e.dataTransfer.dropEffect = \"move\";\n\t\t\t\ttabBar.classList.add(\"drag-over\");\n\t\t\t}\n\t\t});\n\t\ttabBar.addEventListener(\"dragleave\", () => {\n\t\t\ttabBar.classList.remove(\"drag-over\");\n\t\t});\n\t\ttabBar.addEventListener(\"drop\", (e) => {\n\t\t\te.preventDefault();\n\t\t\ttabBar.classList.remove(\"drag-over\");\n\n\t\t\tconst tabDataJSON = e.dataTransfer?.getData(\"application/winlet-tab\");\n\t\t\tconst sourceWindowId = e.dataTransfer?.getData(\"application/winlet-source-window-id\");\n\t\t\tconst sourceTabId = e.dataTransfer?.getData(\"text/plain\");\n\t\t\tif (!tabDataJSON || !sourceWindowId || !sourceTabId) return;\n\n\t\t\tconst draggingEl = this.manager.container?.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.dragging`);\n\n\t\t\t// 自分自身のウィンドウ内での並び替え\n\t\t\tif (sourceWindowId === this.id) {\n\t\t\t\tif (draggingEl) {\n\t\t\t\t\t// ドロップされた位置に挿入\n\t\t\t\t\tthis.updateTabOrderFromDOM();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// 外部ウィンドウからのタブ統合\n\t\t\tconst sourceWindow = this.manager.getWindow(sourceWindowId);\n\t\t\tif (sourceWindow) {\n\t\t\t\tconst sourceOpts = sourceWindow.options.tabOptions;\n\t\t\t\tconst targetOpts = this.options.tabOptions;\n\n\t\t\t\tconst isMergeable = sourceOpts.mergeable ?? sourceOpts.detachable; // ソースをマージできるかどうかを確認\n\t\t\t\tconst allowsIncoming = targetOpts.allowIncomingMerge ?? true; // ターゲットが受け入れるかどうかを確認\n\t\t\t\tconst customFilterPassed = !targetOpts.onMergeAttempt || targetOpts.onMergeAttempt(sourceWindow, this);\n\n\t\t\t\tif (!isMergeable || !allowsIncoming || !customFilterPassed) {\n\t\t\t\t\treturn; // 条件が満たされていない場合は、マージを中止\n\t\t\t\t}\n\n\t\t\t\tconst tabData: TabItem = JSON.parse(tabDataJSON);\n\t\t\t\tthis.addTab(tabData, true);\n\n\t\t\t\tsourceWindow.closeTab(parseInt(sourceTabId, 10));\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate createTabElement(tabData: TabItem, index: number): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\tconst tabOpts = this.options.tabOptions ?? {};\n\n\t\tconst tabEl = document.createElement(\"div\");\n\t\ttabEl.className = `${LIBRARY_NAME}-tab`;\n\t\ttabEl.dataset.tabId = index.toString(); // IDを紐付け\n\n\t\tconst titleEl = document.createElement(\"span\");\n\t\ttitleEl.textContent = tabData.title;\n\t\ttabEl.appendChild(titleEl);\n\n\t\t// +ボタンが存在すればその前に、なければ末尾に追加\n\t\ttabBar.insertBefore(tabEl, this.addTabBtn);\n\n\t\tif (tabOpts.closable) {\n\t\t\tconst closeBtn = document.createElement(\"span\");\n\t\t\tcloseBtn.className = `${LIBRARY_NAME}-tab-close-btn`;\n\t\t\tcloseBtn.innerHTML = \"&times;\";\n\t\t\tcloseBtn.addEventListener(\"click\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\t// クロージャのindexに依存せず、クリックされた時点の最新のインデックスを探す\n\t\t\t\tconst indexToClose = this.tabs.findIndex((t) => t.tabEl === tabEl);\n\t\t\t\tif (indexToClose !== -1) {\n\t\t\t\t\tthis.closeTab(indexToClose);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttabEl.appendChild(closeBtn);\n\t\t}\n\n\t\t// タブコンテント生成ロジック\n\t\tconst tabContentEl = document.createElement(\"div\");\n\t\ttabContentEl.className = `${LIBRARY_NAME}-tab-content`;\n\t\tthis.contentEl.appendChild(tabContentEl);\n\t\tthis.renderContent(tabContentEl, tabData.content);\n\n\t\ttabEl.addEventListener(\"click\", (e) => {\n\t\t\tthis.activateTab(+tabEl.dataset.tabId!);\n\t\t});\n\t\tthis.tabs.splice(index, 0, { tabEl, contentEl: tabContentEl }); // 指定位置に挿入\n\n\t\tif (tabOpts.reorderable) {\n\t\t\tthis.makeTabReorderable(tabEl);\n\t\t}\n\t}\n\n\tprivate makeTabReorderable(tabEl: HTMLElement) {\n\t\ttabEl.draggable = true;\n\t\ttabEl.addEventListener(\"dragstart\", (e) => {\n\t\t\te.dataTransfer!.setData(\"text/plain\", tabEl.dataset.tabId!);\n\t\t\ttabEl.classList.add(\"dragging\");\n\n\t\t\t// 分離機能が有効な場合、追加情報をセット\n\t\t\tif (this.options.tabOptions.detachable) {\n\t\t\t\tconst tabIndex = parseInt(tabEl.dataset.tabId!, 10);\n\t\t\t\tif (!isNaN(tabIndex) && this.options.tabs[tabIndex]) {\n\t\t\t\t\tconst tabData = this.options.tabs[tabIndex];\n\t\t\t\t\te.dataTransfer!.setData(\"application/winlet-tab\", JSON.stringify(tabData));\n\t\t\t\t\te.dataTransfer!.setData(\"application/winlet-source-window-id\", this.id);\n\n\t\t\t\t\tthis.manager.onTabDragStart(this.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\ttabEl.addEventListener(\"dragend\", () => {\n\t\t\ttabEl.classList.remove(\"dragging\");\n\t\t\tthis.manager.onTabDragEnd();\n\t\t});\n\n\t\ttabEl.addEventListener(\n\t\t\t\"dragover\",\n\t\t\t(e) => {\n\t\t\t\tif (this.manager.draggingTabInfo?.sourceWindowId !== this.id) {\n\t\t\t\t\treturn; //タブが別のウィンドウからである場合、何もしない\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t\tconst draggingEl = document.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.dragging`);\n\t\t\t\tif (draggingEl && draggingEl !== tabEl) {\n\t\t\t\t\tconst rect = tabEl.getBoundingClientRect();\n\t\t\t\t\t// カーソルの位置によって挿入位置を左右に決める\n\t\t\t\t\tconst isAfter = e.clientX > rect.left + rect.width / 2;\n\t\t\t\t\tconst parent = tabEl.parentNode!;\n\t\t\t\t\tif (isAfter) {\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl.nextSibling);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\n\t\ttabEl.addEventListener(\n\t\t\t\"drop\",\n\t\t\t(e) => {\n\t\t\t\te.preventDefault();\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\t}\n\n\t// タブを閉じるロジック\n\tpublic closeTab(index: number) {\n\t\t// アクティブなタブが閉じられるかチェック\n\t\tconst wasActive = this.tabs[index]?.tabEl.classList.contains(\"active\");\n\n\t\t// DOMから要素を削除\n\t\tthis.tabs[index].tabEl.remove();\n\t\tthis.tabs[index].contentEl.remove();\n\t\t// 配列から削除\n\t\tthis.tabs.splice(index, 1);\n\t\tthis.options.tabs.splice(index, 1);\n\n\t\t// IDの再割り当て\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\n\n\t\t// アクティブなタブを再設定\n\t\tif (this.tabs.length > 0) {\n\t\t\tif (wasActive) {\n\t\t\t\tconst newActiveIndex = Math.max(0, index - 1);\n\t\t\t\tthis.activateTab(newActiveIndex);\n\t\t\t}\n\t\t} else {\n\t\t\t// タブが0になったらウィンドウを閉じる\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tpublic activateTab(index: number): void {\n\t\tthis.tabs.forEach((tab, i) => {\n\t\t\ttab.tabEl.classList.toggle(\"active\", i === index);\n\t\t\ttab.contentEl.classList.toggle(\"active\", i === index);\n\t\t});\n\t}\n\n\tpublic addTab(tabItem: TabItem, setActive: boolean = true): void {\n\t\tthis.options.tabs.push(tabItem);\n\t\tconst newIndex = this.options.tabs.length - 1;\n\t\tthis.createTabElement(tabItem, newIndex);\n\t\tif (setActive) {\n\t\t\tthis.activateTab(newIndex);\n\t\t\t// タブが追加されアクティブになったウィンドウにフォーカスを当てる\n\t\t\tthis.focus();\n\t\t}\n\t}\n\n\tpublic getTabs(): { tabEl: HTMLElement; contentEl: HTMLElement }[] {\n\t\treturn this.tabs;\n\t}\n\n\tprivate updateTabOrderFromDOM(): void {\n\t\tconst tabElements = Array.from(this.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-tab-bar > .${LIBRARY_NAME}-tab`));\n\n\t\tconst newTabs: typeof this.tabs = [];\n\t\tconst newOptionsTabs: TabItem[] = [];\n\n\t\tconst oldTabs = [...this.tabs];\n\t\tconst oldOptionsTabs = [...this.options.tabs];\n\n\t\ttabElements.forEach((tabEl) => {\n\t\t\t// dataset.tabIdはもはや信頼できない可能性があるため、DOM要素で直接比較する\n\t\t\tconst oldIndex = oldTabs.findIndex((t) => t.tabEl === tabEl);\n\t\t\tif (oldIndex !== -1) {\n\t\t\t\tnewTabs.push(oldTabs[oldIndex]);\n\t\t\t\tnewOptionsTabs.push(oldOptionsTabs[oldIndex]);\n\t\t\t}\n\t\t});\n\n\t\tthis.tabs = newTabs;\n\t\tthis.options.tabs = newOptionsTabs;\n\n\t\t// 新しい順序でdataset.tabIdを再設定\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\n\t}\n\n\tprivate setupEventListeners(): void {\n\t\tthis.el.addEventListener(\"click\", () => this.focus(), true);\n\n\t\t// iframeなどにフォーカスが移った際にウィンドウ自体をアクティブにする\n\t\tthis.el.addEventListener(\"focusin\", () => this.focus());\n\n\t\t// Add a global click listener to close menus when clicking outside\n\t\tthis.boundGlobalClickHandler = () => {\n\t\t\tif (this.isMenuOpen) {\n\t\t\t\tthis.closeAllMenus();\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener(\"click\", this.boundGlobalClickHandler);\n\n\t\tconst closeBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-close-btn`);\n\t\tcloseBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tif (this.options._isPopup) {\n\t\t\t\tthis.popupCloseCallback?.(CLOSE_BUTTON_RESULT);\n\t\t\t}\n\t\t\tthis.close();\n\t\t});\n\n\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\tmaxBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tthis.toggleMaximize();\n\t\t});\n\n\t\tconst minBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-minimize-btn`);\n\t\tminBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tthis.minimize();\n\t\t});\n\n\t\tif (this.options.movable) this.makeMovable();\n\t\tif (this.options.resizableX || this.options.resizableY) this.makeResizable();\n\t\tif (this.options.contextMenu.length > 0) {\n\t\t\t// PC用: 右クリック\n\t\t\tthis.el.addEventListener(\n\t\t\t\t\"contextmenu\",\n\t\t\t\t(e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\n\t\t\t\t},\n\t\t\t\t{ passive: false }\n\t\t\t);\n\t\t\t// モバイル用: 長押し\n\t\t\tthis.el.addEventListener(\"pointerdown\", (e) => {\n\t\t\t\tif (e.pointerType !== \"touch\") return;\n\t\t\t\tthis.contextMenuTimer = window.setTimeout(() => {\n\t\t\t\t\tthis.contextMenuTimer = null;\n\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\n\t\t\t\t}, this.MOBILE_CONTEXT_MENU_TIMEOUT);\n\t\t\t});\n\t\t\tconst clearContextMenuTimer = () => {\n\t\t\t\tif (this.contextMenuTimer) {\n\t\t\t\t\tclearTimeout(this.contextMenuTimer);\n\t\t\t\t\tthis.contextMenuTimer = null;\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.el.addEventListener(\"pointermove\", clearContextMenuTimer);\n\t\t\tthis.el.addEventListener(\"pointerup\", clearContextMenuTimer);\n\t\t\tthis.el.addEventListener(\"pointercancel\", clearContextMenuTimer);\n\t\t}\n\t}\n\n\tprivate makeMovable(): void {\n\t\tconst onPointerDown = (e: PointerEvent) => {\n\t\t\tconst target = e.target as HTMLElement;\n\t\t\t// 操作UI要素の上なら移動させない\n\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-resize-handle, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab, .${LIBRARY_NAME}-tab-add-btn`)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// メインボタン（マウスの左ボタン、タッチ）でのみ移動\n\t\t\tif (e.button !== 0) return;\n\n\t\t\te.preventDefault();\n\t\t\tthis.focus();\n\n\t\t\tconst { clientX: startX, clientY: startY } = e;\n\t\t\tlet isDragging = false;\n\n\t\t\t// ドラッグ開始時のウィンドウ座標。isDraggingがtrueになったときに設定される。\n\t\t\tlet initialLeft: number;\n\t\t\tlet initialTop: number;\n\n\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\n\t\t\t\tif (!this.el?.isConnected) return;\n\t\t\t\tif (!isDragging) {\n\t\t\t\t\tconst deltaX = Math.abs(moveE.clientX - startX);\n\t\t\t\t\tconst deltaY = Math.abs(moveE.clientY - startY);\n\n\t\t\t\t\t// 閾値を超えたらドラッグモードを開始\n\t\t\t\t\tif (deltaX > this.DRAG_THRESHOLD || deltaY > this.DRAG_THRESHOLD) {\n\t\t\t\t\t\tisDragging = true;\n\t\t\t\t\t\tthis.el.setPointerCapture(e.pointerId);\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\n\n\t\t\t\t\t\t// 最大化状態からのドラッグ開始の場合、ウィンドウを復元\n\t\t\t\t\t\tif (this.state === \"maximized\") {\n\t\t\t\t\t\t\tconst restoredWidth = this.lastState.width;\n\t\t\t\t\t\t\tconst clickRatio = e.clientX / this.el.offsetWidth;\n\t\t\t\t\t\t\tconst titleBarRect = this.titleBarEl.getBoundingClientRect();\n\t\t\t\t\t\t\tconst offsetY = e.clientY - titleBarRect.top;\n\t\t\t\t\t\t\tconst posX = e.clientX - restoredWidth * clickRatio;\n\t\t\t\t\t\t\tconst posY = e.clientY - offsetY;\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.setPosition(posX, posY);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// ドラッグ開始時点の座標を記録\n\t\t\t\t\t\tinitialLeft = this.el.offsetLeft;\n\t\t\t\t\t\tinitialTop = this.el.offsetTop;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 閾値に達していなければ何もしない\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ドラッグ中の移動処理\n\t\t\t\tconst newLeft = initialLeft + moveE.clientX - startX;\n\t\t\t\tconst newTop = initialTop + moveE.clientY - startY;\n\t\t\t\tthis.setPosition(newLeft, newTop);\n\t\t\t};\n\n\t\t\tconst onPointerUp = () => {\n\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\n\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerMove);\n\n\t\t\t\t// ドラッグが発生した場合のみ後処理とコールバック呼び出し\n\t\t\t\tif (isDragging) {\n\t\t\t\t\tthis.el.releasePointerCapture(e.pointerId);\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\n\t\t\t\t\tthis.options.onMove(this);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove);\n\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp);\n\t\t};\n\n\t\tthis.titleBarEl.addEventListener(\"pointerdown\", onPointerDown, { passive: false });\n\n\t\tif (this.options.maximizable) {\n\t\t\tthis.titleBarEl.addEventListener(\"dblclick\", (e: MouseEvent) => {\n\t\t\t\tif (this.options.maximizableOnDblClick) {\n\t\t\t\t\tconst target = e.target as HTMLElement;\n\t\t\t\t\t// 操作UI（コントロールボタン、メニュー、タブ）の上では発火しないようにする\n\t\t\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab`)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.toggleMaximize();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate makeResizable(): void {\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-resize-handle`).forEach((handle) => {\n\t\t\thandle.addEventListener(\n\t\t\t\t\"pointerdown\",\n\t\t\t\t(e: PointerEvent) => {\n\t\t\t\t\tif (e.button !== 0 || !handle?.isConnected) return;\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\n\t\t\t\t\thandle.setPointerCapture(e.pointerId);\n\n\t\t\t\t\tconst direction = handle.className.replace(`${LIBRARY_NAME}-resize-handle `, \"\");\n\t\t\t\t\tconst { clientX: startX, clientY: startY } = e;\n\t\t\t\t\tconst { offsetWidth: startWidth, offsetHeight: startHeight, offsetLeft: startLeft, offsetTop: startTop } = this.el;\n\t\t\t\t\tconst { minWidth, minHeight } = this.options;\n\n\t\t\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\n\t\t\t\t\t\tlet newWidth = startWidth,\n\t\t\t\t\t\t\tnewHeight = startHeight,\n\t\t\t\t\t\t\tnewLeft = startLeft,\n\t\t\t\t\t\t\tnewTop = startTop;\n\t\t\t\t\t\tconst deltaX = moveE.clientX - startX;\n\t\t\t\t\t\tconst deltaY = moveE.clientY - startY;\n\n\t\t\t\t\t\tif (direction.includes(\"e\")) newWidth = Math.max(minWidth, startWidth + deltaX);\n\t\t\t\t\t\tif (direction.includes(\"w\")) {\n\t\t\t\t\t\t\tnewWidth = Math.max(minWidth, startWidth - deltaX);\n\t\t\t\t\t\t\tnewLeft = startLeft + deltaX;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (direction.includes(\"s\")) newHeight = Math.max(minHeight, startHeight + deltaY);\n\t\t\t\t\t\tif (direction.includes(\"n\")) {\n\t\t\t\t\t\t\tnewHeight = Math.max(minHeight, startHeight - deltaY);\n\t\t\t\t\t\t\tnewTop = startTop + deltaY;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setSize(newWidth, newHeight);\n\t\t\t\t\t\tthis.setPosition(newLeft, newTop);\n\t\t\t\t\t};\n\t\t\t\t\tconst onPointerUp = () => {\n\t\t\t\t\t\thandle.releasePointerCapture(e.pointerId);\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\n\n\t\t\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\n\t\t\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerUp);\n\t\t\t\t\t\tthis.options.onResize(this);\n\t\t\t\t\t};\n\t\t\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove);\n\t\t\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp);\n\t\t\t\t},\n\t\t\t\t{ passive: false }\n\t\t\t);\n\t\t});\n\t}\n\n\tprivate isFontAwesome(classStr: string): boolean {\n\t\tconst classes = classStr.trim().split(/\\s+/);\n\t\tconst hasPrefix = classes.some((c) => /^fa[bslr]?$/.test(c));\n\t\tconst hasIcon = classes.some((c) => /^fa-[a-z0-9-]+$/.test(c));\n\t\treturn hasPrefix && hasIcon;\n\t}\n\n\t// --- Public API ---\n\n\tpublic close(): void {\n\t\t// Clean up global event listeners\n\t\tif (this.boundGlobalClickHandler) {\n\t\t\tdocument.removeEventListener(\"click\", this.boundGlobalClickHandler);\n\t\t}\n\t\tthis.options.onClose(this);\n\t\tthis.manager.destroyWindow(this.id);\n\t}\n\n\tpublic minimize(): void {\n\t\tif (this.state !== \"minimized\") {\n\t\t\tif (this.state !== \"normal\") this.restore();\n\t\t\tthis.state = \"minimized\";\n\t\t\tthis.el.classList.add(\"minimized\");\n\t\t\tthis.blur();\n\t\t}\n\t}\n\n\tpublic toggleMaximize(): void {\n\t\tthis.state === \"maximized\" ? this.restore() : this.maximize();\n\t}\n\n\tpublic maximize(): void {\n\t\tif (this.state !== \"maximized\") {\n\t\t\tif (this.state !== \"normal\") this.restore();\n\t\t\tthis.lastState = { x: this.el.offsetLeft, y: this.el.offsetTop, width: this.el.offsetWidth, height: this.el.offsetHeight };\n\t\t\tthis.state = \"maximized\";\n\t\t\tthis.el.classList.add(\"maximized\");\n\t\t\tthis.setPosition(0, 0);\n\t\t\tthis.setSize(\"100%\", \"100%\");\n\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\t\tif (maxBtn) {\n\t\t\t\tmaxBtn.title = \"Restore\";\n\t\t\t\tmaxBtn.value = \"\\u274f\";\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic restore(): void {\n\t\tif (this.state === \"minimized\") {\n\t\t\tthis.state = \"normal\";\n\t\t\tthis.el.classList.remove(\"minimized\");\n\t\t\tthis.focus();\n\t\t} else if (this.state === \"maximized\") {\n\t\t\tthis.state = \"normal\";\n\t\t\tthis.el.classList.remove(\"maximized\");\n\t\t\tthis.setSize(this.lastState.width, this.lastState.height);\n\t\t\tthis.setPosition(this.lastState.x, this.lastState.y);\n\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\t\tif (maxBtn) {\n\t\t\t\tmaxBtn.title = \"Maximize\";\n\t\t\t\tmaxBtn.value = \"\\u25a1\";\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic focus(): void {\n\t\tif (this.focused) return;\n\n\t\t// 階層を遡ってすべての親ウィンドウをフォーカスする\n\t\tif (this.parentWindow) {\n\t\t\tthis.parentWindow.focus();\n\t\t}\n\n\t\tthis.manager.focusWindow(this);\n\t\tthis.focused = true;\n\t\tthis.el.classList.add(\"active\");\n\t\tthis.options.onFocus(this);\n\t}\n\n\tpublic blur(): void {\n\t\tif (!this.focused) return;\n\t\tthis.focused = false;\n\t\tthis.el.classList.remove(\"active\");\n\t\tthis.options.onBlur(this);\n\t}\n\n\tpublic reload(): void {\n\t\t// onReloadがfalseを返した場合、デフォルトのリロード処理を中断\n\t\tif (this.options.onReload(this) === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst reloadContent = (container: HTMLElement, content: WindowContentOptions) => {\n\t\t\tif (Utils.isNonEmptyObject(content.iframe)) {\n\t\t\t\tconst iframe = container.querySelector(\"iframe\");\n\t\t\t\t// srcがあり、srcdocがない場合はiframeのreloadを試みる\n\t\t\t\tif (iframe && iframe.src && !content.iframe.srcdoc) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// クロスオリジンフレームへのアクセスはエラーになる可能性がある\n\t\t\t\t\t\tiframe.contentWindow?.location.reload();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// 失敗した場合はiframe要素を再生成する\n\t\t\t\t\t\tconsole.warn(\"WinLet: Cross-origin iframe could not be reloaded directly. Recreating iframe element.\", e);\n\t\t\t\t\t\tthis.renderContent(container, content);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// srcdocの場合やiframeが見つからない場合は要素を再生成\n\t\t\t\t\tthis.renderContent(container, content);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// htmlまたはtemplateの場合は常に再描画\n\t\t\t\tthis.renderContent(container, content);\n\t\t\t}\n\t\t};\n\n\t\tif (this.options.tabs.length > 0) {\n\t\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(\"active\"));\n\t\t\tif (activeTabIndex > -1) {\n\t\t\t\tconst activeTab = this.tabs[activeTabIndex];\n\t\t\t\tconst tabContentOptions = this.options.tabs[activeTabIndex].content;\n\t\t\t\treloadContent(activeTab.contentEl, tabContentOptions);\n\t\t\t}\n\t\t} else {\n\t\t\treloadContent(this.contentEl, this.options.content);\n\t\t}\n\t}\n\n\tpublic getContent(): HTMLElement | HTMLIFrameElement {\n\t\tlet contentContainer: HTMLElement;\n\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(\"active\"));\n\n\t\tif (activeTabIndex > -1) {\n\t\t\t// If there's an active tab, use its content element\n\t\t\tcontentContainer = this.tabs[activeTabIndex].contentEl;\n\t\t} else {\n\t\t\t// Otherwise, use the main content element\n\t\t\tcontentContainer = this.contentEl;\n\t\t}\n\n\t\tconst iframe = contentContainer.querySelector(\"iframe\");\n\t\treturn iframe || contentContainer;\n\t}\n\n\t/**\n\t * 子ウィンドウマネージャを初期化または取得します。\n\t */\n\tprivate getChildManager(): WindowManager {\n\t\tif (!this.childManager) {\n\t\t\t// WindowManagerのコンストラクタとGlobalConfigの整合性を取る必要がある\n\t\t\t// ここでは簡易的に空のconfigで生成\n\t\t\tconst childConfig = {};\n\t\t\tthis.childManager = new WindowManager(childConfig);\n\n\t\t\t// 子マネージャのコンテナとして、このウィンドウのcontentElを指定\n\t\t\tthis.childManager.applyGlobalConfig({ container: this.contentEl });\n\t\t\tthis.childManager.init();\n\t\t}\n\t\treturn this.childManager;\n\t}\n\n\t/**\n\t * このウィンドウ内に新しいウィンドウを作成します。\n\t */\n\tpublic createWindow(options: WindowOptions = {}): IWindow {\n\t\t// iframeコンテンツの場合は、直接DOM操作する代わりにpostMessageを使用\n\t\tconst iframe = this.contentEl.querySelector(\"iframe\");\n\t\tif (iframe && iframe.contentWindow) {\n\t\t\tconst message = {\n\t\t\t\ttype: \"winlet:createWindow\",\n\t\t\t\toptions: options,\n\t\t\t};\n\t\t\t// iframeのオリジンを尊重\n\t\t\tiframe.contentWindow.postMessage(message, \"*\");\n\t\t\t// postMessageでは直接インスタンスを返せないため、暫定的にnullを返すか、Promiseベースの設計にする必要がある\n\t\t\t// ここでは未対応とし、コンソールに警告を出す\n\t\t\tconsole.warn(\"WinLet: Window creation inside an iframe is asynchronous and does not return an instance directly.\");\n\t\t\t// ダミーのインスタンスを返すか、APIの戻り値をvoidにするなどの検討が必要\n\t\t\treturn null as any; // 暫定\n\t\t}\n\n\t\t// 通常のHTMLコンテンツの場合\n\t\tconst manager = this.getChildManager();\n\t\t// 新しいウィンドウに自身を親として設定\n\t\toptions._parent = this;\n\t\treturn manager.createWindow(options);\n\t}\n\n\t/**\n\t * このウィンドウ内に新しいポップアップを作成します。\n\t */\n\tpublic createPopup(options: PopupOptions): IWindow {\n\t\tconst manager = this.getChildManager();\n\t\t// ポップアップにも自身を親として設定\n\t\tconst winOptions: WindowOptions = { _parent: this };\n\t\treturn manager.popup(Object.assign(options, winOptions));\n\t}\n\n\tpublic getTitle(): string {\n\t\treturn this.options.title;\n\t}\n\n\tpublic setTitle(title: string): void {\n\t\tthis.options.title = title;\n\t\tthis.titleEl.textContent = Utils.sanitizeHTML(title);\n\t}\n\n\tpublic setIcon(icon: string | null): void {\n\t\tthis.options.icon = icon;\n\t\tthis.iconEl.innerHTML = \"\";\n\t\tif (!icon) return;\n\n\t\tif (this.isFontAwesome(icon)) {\n\t\t\tconst i = document.createElement(\"i\");\n\t\t\ti.className = icon;\n\t\t\tthis.iconEl.appendChild(i);\n\t\t} else {\n\t\t\tconst img = document.createElement(\"img\");\n\t\t\timg.src = icon;\n\t\t\timg.alt = \"window icon\";\n\t\t\tthis.iconEl.appendChild(img);\n\t\t}\n\t}\n\n\tpublic getPosition(): { x: number; y: number } {\n\t\tif (this.state === \"maximized\") {\n\t\t\treturn { x: this.lastState.x, y: this.lastState.y };\n\t\t}\n\t\treturn { x: this.el.offsetLeft, y: this.el.offsetTop };\n\t}\n\n\tpublic setPosition(x: number | \"center\" | \"left\" | \"right\", y: number | \"center\" | \"top\" | \"bottom\"): void {\n\t\t// containerが存在しない（初期化前）場合は処理を中断\n\t\tif (!this.manager.container) {\n\t\t\tconsole.warn(\"WinLet Warning: setPosition called before manager is initialized.\");\n\t\t\treturn;\n\t\t}\n\t\tconst parentRect = this.manager.container.getBoundingClientRect();\n\t\tconst winWidth = this.el.offsetWidth;\n\t\tconst winHeight = this.el.offsetHeight;\n\n\t\tlet finalX: number;\n\t\tlet finalY: number;\n\n\t\t// X座標の計算\n\t\tswitch (x) {\n\t\t\tcase \"left\":\n\t\t\t\tfinalX = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"center\":\n\t\t\t\tfinalX = (parentRect.width - winWidth) / 2;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tfinalX = parentRect.width - winWidth;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfinalX = x as number;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Y座標の計算\n\t\tswitch (y) {\n\t\t\tcase \"top\":\n\t\t\t\tfinalY = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"center\":\n\t\t\t\tfinalY = (parentRect.height - winHeight) / 2;\n\t\t\t\tbreak;\n\t\t\tcase \"bottom\":\n\t\t\t\tfinalY = parentRect.height - winHeight;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfinalY = y as number;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// 画面外にはみ出さないようにする既存のロジックを適用\n\t\tthis.el.style.left = `${Math.min(Math.max(150 - winWidth, finalX), parentRect.width - 20)}px`;\n\t\tthis.el.style.top = `${Math.min(Math.max(0, finalY), parentRect.height - 50)}px`;\n\t}\n\n\tpublic getSize(): { width: number; height: number } {\n\t\tif (this.state === \"maximized\") {\n\t\t\treturn { width: this.lastState.width, height: this.lastState.height };\n\t\t}\n\t\treturn { width: this.el.offsetWidth, height: this.el.offsetHeight };\n\t}\n\n\tpublic setSize(width: number | string, height: number | string): void {\n\t\tthis.el.style.width = typeof width === \"number\" ? `${width}px` : width;\n\t\tthis.el.style.height = typeof height === \"number\" ? `${height}px` : height;\n\t}\n}\n","// src/WindowManager.ts\n\nimport { defaultConfig } from \"../const/config\";\nimport { WinLetError } from \"../const/errors\";\nimport { ContextMenuItem, GlobalConfigOptions, IWindow, LIBRARY_NAME, MenuItem, PopupButton, PopupButtonPreset, PopupOptions, PopupResult, TabItem, TIMEOUT_RESULT, WindowOptions } from \"../const/types\";\nimport WinLetBaseClass from \"../libs/baseclass\";\nimport Utils from \"../libs/utils\";\nimport styleData from \"../style/styles\";\nimport WinLetWindow from \"./window\";\n\nexport default class WindowManager extends WinLetBaseClass {\n\tpublic container: HTMLElement | null = null;\n\tprivate static allWindows = new Map<string, WinLetWindow>();\n\tprivate windows = new Map<string, WinLetWindow>();\n\tprivate zIndexCounter = 1000;\n\tprivate activeWindow: WinLetWindow | null = null;\n\tprivate contextMenuEl: HTMLElement | null = null;\n\tprivate _isInitialized = false;\n\n\tprivate globalConfig: GlobalConfigOptions;\n\n\tprivate lastAutoPosition: { x: number; y: number } | null = null;\n\tprivate lastPopupPosition: { x: number; y: number } | null = null;\n\tprivate readonly CASCADE_OFFSET = 30;\n\n\tpublic draggingTabInfo: { sourceWindowId: string } | null = null;\n\n\tconstructor(initialConfig: GlobalConfigOptions) {\n\t\tsuper();\n\t\tthis.globalConfig = initialConfig;\n\t}\n\n\t/**\n\t * ライブラリが初期化済みかどうかを取得します。\n\t */\n\tpublic get isInitialized(): boolean {\n\t\treturn this._isInitialized;\n\t}\n\n\tpublic applyGlobalConfig(options: GlobalConfigOptions) {\n\t\tObject.assign(this.globalConfig, options);\n\t}\n\n\tpublic getGlobalConfig(): GlobalConfigOptions {\n\t\treturn this.globalConfig;\n\t}\n\n\tpublic init(): void {\n\t\tif (this._isInitialized) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet parentEl: HTMLElement | null = null;\n\t\tif (typeof this.globalConfig.container === \"string\") {\n\t\t\tparentEl = document.querySelector<HTMLElement>(this.globalConfig.container);\n\t\t\tif (!parentEl) {\n\t\t\t\tthrow new WinLetError(`WinLet: The specified container \"${this.globalConfig.container}\" was not found.`);\n\t\t\t}\n\t\t} else if (this.globalConfig.container instanceof HTMLElement) {\n\t\t\tparentEl = this.globalConfig.container;\n\t\t}\n\n\t\t// 親が指定されていない場合は、デフォルトでbodyに設定\n\t\tif (!parentEl) {\n\t\t\tif (!document.body) {\n\t\t\t\tthrow new WinLetError(\"Cannot initialize before document.body is ready. Please call WinLet.init() after DOMContentLoaded.\");\n\t\t\t}\n\t\t\tparentEl = document.body;\n\t\t}\n\n\t\tif (!document.getElementById(`${LIBRARY_NAME}-styles`)) {\n\t\t\tconst styleTag = document.createElement(\"style\");\n\t\t\tstyleTag.id = `${LIBRARY_NAME}-styles`;\n\t\t\tstyleTag.innerHTML = this.getStyleData();\n\t\t\tdocument.head.appendChild(styleTag);\n\t\t}\n\t\tlet containerEl = parentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-container`);\n\t\tif (!containerEl) {\n\t\t\tcontainerEl = document.createElement(\"div\");\n\t\t\tcontainerEl.className = `${LIBRARY_NAME}-container`;\n\t\t\tparentEl.appendChild(containerEl);\n\t\t}\n\t\tthis.container = containerEl;\n\n\t\tif (parentEl !== document.body) {\n\t\t\tthis.container.classList.add(`${LIBRARY_NAME}-is-nested`);\n\n\t\t\t// Ensure the parent can act as a positioning context\n\t\t\tconst computedStyle = window.getComputedStyle(parentEl);\n\t\t\tif (computedStyle.position === \"static\") {\n\t\t\t\tparentEl.style.position = \"relative\";\n\t\t\t}\n\t\t}\n\n\t\twindow.addEventListener(\"blur\", () =>\n\t\t\t// 次のイベントサイクルでアクティブな要素を取得\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tconst activeEl = document.activeElement;\n\t\t\t\t// フォーカスがiframeに移った場合\n\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\n\t\t\t\t\t// そのiframeがWinLetのウィンドウ内にあるか探索\n\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\t\t\t\tif (winEl) {\n\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\n\t\t\t\t\t\t// 対象のウィンドウが存在し、まだアクティブでなければフォーカスする\n\t\t\t\t\t\tif (win && this.activeWindow !== win) {\n\t\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tdocument.addEventListener(\n\t\t\t\"pointerdown\",\n\t\t\t() =>\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tconst activeEl = document.activeElement;\n\t\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\n\t\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\t\t\t\t\tif (winEl) {\n\t\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\n\t\t\t\t\t\t\tif (win && this.activeWindow !== win) {\n\t\t\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\ttrue\n\t\t);\n\n\t\t// ウィンドウ外クリックでblurさせる処理を追加\n\t\tthis.container!.addEventListener(\"pointerdown\", (e: PointerEvent) => {\n\t\t\t// クリックされたのがコンテナ自身（ウィンドウやその中身ではない）の場合\n\t\t\tif (e.target === this.container) {\n\t\t\t\tif (this.activeWindow) {\n\t\t\t\t\tconst active = this.activeWindow;\n\t\t\t\t\tthis.activeWindow = null; // 先にnullにしてからblurを呼ぶ\n\t\t\t\t\tactive.blur();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener(\"click\", () => this.hideContextMenu());\n\n\t\twindow.addEventListener(\"message\", (event) => {\n\t\t\t// メッセージの形式を検証\n\t\t\tif (event.data && event.data.type === \"winlet:createWindow\" && typeof event.data.options === \"object\") {\n\t\t\t\t// メッセージの送信元が管理下のiframeか検証（セキュリティ対策）\n\t\t\t\tlet isSourceValid = false;\n\t\t\t\tlet sourceWindow: WinLetWindow | null = null;\n\t\t\t\tfor (const win of this.windows.values()) {\n\t\t\t\t\tconst iframe = win.el.querySelector(\"iframe\");\n\t\t\t\t\tif (iframe && iframe.contentWindow === event.source) {\n\t\t\t\t\t\tisSourceValid = true;\n\t\t\t\t\t\t// メッセージの送信元ウィンドウを特定\n\t\t\t\t\t\tsourceWindow = win;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (isSourceValid) {\n\t\t\t\t\t// 送信元ウィンドウ(sourceWindow)が存在すれば、それは親ウィンドウであり、\n\t\t\t\t\t// その中に新しいウィンドウを作成する。\n\t\t\t\t\tif (sourceWindow) {\n\t\t\t\t\t\t// iframeの親ウィンドウのcreateWindowを呼び出す\n\t\t\t\t\t\tsourceWindow.createWindow(event.data.options);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 通常のトップレベルでのウィンドウ作成\n\t\t\t\t\t\tthis.createWindow(event.data.options);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"WinLet: Untrusted source attempted to create a window.\", event.origin);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._isInitialized = true;\n\t\tthis.setupShortcutListeners();\n\n\t\t// タブ分離機能のためのグローバルなD&Dリスナー\n\t\tthis.container!.addEventListener(\"dragover\", (e) => {\n\t\t\tif (e.dataTransfer?.types.includes(\"application/winlet-tab\")) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\tthis.container!.addEventListener(\"drop\", (e) => {\n\t\t\t// ドロップ先がウィンドウやタブバーの中なら何もしない\n\t\t\tconst targetEl = e.target as HTMLElement;\n\t\t\tif (targetEl.closest(`.${LIBRARY_NAME}-window`)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\n\t\t\tconst tabDataJSON = e.dataTransfer?.getData(\"application/winlet-tab\");\n\t\t\tconst sourceWindowId = e.dataTransfer?.getData(\"application/winlet-source-window-id\");\n\t\t\tconst sourceTabId = e.dataTransfer?.getData(\"text/plain\");\n\n\t\t\tif (tabDataJSON && sourceWindowId && sourceTabId) {\n\t\t\t\tconst sourceWindow = this.windows.get(sourceWindowId);\n\t\t\t\tif (!sourceWindow || !sourceWindow.options.tabOptions.detachable) return;\n\n\t\t\t\tconst tabData: TabItem = JSON.parse(tabDataJSON);\n\t\t\t\tconst newTab: TabItem = {\n\t\t\t\t\ttitle: tabData.title,\n\t\t\t\t\tcontent: tabData.content,\n\t\t\t\t};\n\n\t\t\t\tconst mergedWindowOptions = Utils.deepMerge(sourceWindow.options, {\n\t\t\t\t\ttabs: [newTab],\n\t\t\t\t\tx: e.clientX,\n\t\t\t\t\ty: e.clientY,\n\t\t\t\t\twidth: sourceWindow.getSize().width,\n\t\t\t\t\theight: sourceWindow.getSize().height,\n\t\t\t\t});\n\n\t\t\t\t// 新しいウィンドウを作成\n\t\t\t\tthis.createWindow(mergedWindowOptions);\n\n\t\t\t\t// 元のウィンドウからタブを削除\n\t\t\t\tsourceWindow.closeTab(parseInt(sourceTabId, 10));\n\t\t\t}\n\t\t});\n\t}\n\n\t// ショートカットキーのリスナーを統合\n\tprivate setupShortcutListeners() {\n\t\tdocument.addEventListener(\n\t\t\t\"keydown\",\n\t\t\t(e) => {\n\t\t\t\t// --- 1. グローバルショートカット (ウィンドウ切り替え) ---\n\t\t\t\tif (this.globalConfig.windowSwitchShortcut) {\n\t\t\t\t\tconst shortcut = this.parseShortcut(this.globalConfig.windowSwitchShortcut);\n\n\t\t\t\t\tif (e.key.toLowerCase() === shortcut.key.toLowerCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst windows = Array.from(this.windows.values());\n\n\t\t\t\t\t\tconst currentIndex = this.activeWindow ? windows.findIndex((w) => w === this.activeWindow) : -1;\n\t\t\t\t\t\tconst nextIndex = (currentIndex + 1) % windows.length;\n\n\t\t\t\t\t\tconst win = windows[nextIndex];\n\t\t\t\t\t\tif (win.state === \"minimized\") {\n\t\t\t\t\t\t\twin.restore();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// --- 2. ウィンドウ固有のショートカット ---\n\t\t\t\tconst targetWindow = this.activeWindow;\n\n\t\t\t\t// ターゲットウィンドウがなければ何もしない\n\t\t\t\tif (!targetWindow || !targetWindow.options.enableShortcuts) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// --- 3. タブ切り替えショートカット (Ctrl+Shift+[1-9]) ---\n\t\t\t\tif (e.ctrlKey && e.shiftKey && (targetWindow.options.tabs?.length ?? 0) > 0) {\n\t\t\t\t\t// Shiftキーの影響を受けない e.code で判定する\n\t\t\t\t\tif (e.code.startsWith(\"Digit\")) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\tconst keyNum = parseInt(e.code.replace(\"Digit\", \"\"), 10);\n\n\t\t\t\t\t\tconst tabs = targetWindow.getTabs();\n\t\t\t\t\t\tconst numTabs = tabs.length;\n\t\t\t\t\t\tlet tabIndex = -1;\n\n\t\t\t\t\t\tif (keyNum >= 1 && keyNum <= 8) {\n\t\t\t\t\t\t\ttabIndex = keyNum - 1;\n\t\t\t\t\t\t} else if (keyNum === 9) {\n\t\t\t\t\t\t\ttabIndex = numTabs - 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (tabIndex >= 0 && tabIndex < numTabs) {\n\t\t\t\t\t\t\ttargetWindow.activateTab(tabIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn; // 他のショートカットと重複しないようにreturn\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// --- 4. ショートカットキーを検索して実行 ---\n\t\t\t\tconst findAndExecShortcut = (menuItems: MenuItem[]) => {\n\t\t\t\t\tfor (const item of menuItems) {\n\t\t\t\t\t\tif (item.shortcut) {\n\t\t\t\t\t\t\tconst shortcut = this.parseShortcut(item.shortcut);\n\t\t\t\t\t\t\tif (e.key.toUpperCase() === shortcut.key.toUpperCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\titem.action?.(targetWindow!);\n\t\t\t\t\t\t\t\treturn true; // 実行したら探索終了\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (item.items && findAndExecShortcut(item.items)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\t\tfindAndExecShortcut(targetWindow.options.menu);\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\t}\n\n\t// 未初期化の場合に自動でinitを呼び出すヘルパー\n\tprivate ensureInitialized(): void {\n\t\tif (!this._isInitialized) {\n\t\t\tthis.init();\n\t\t}\n\t}\n\n\t/**\n\t * スタイルシートを取得\n\t */\n\tprivate getStyleData() {\n\t\treturn styleData.replace(/\\$\\[(\\w+)\\]/g, (a, p) => {\n\t\t\tswitch (p) {\n\t\t\t\tcase \"prefix\":\n\t\t\t\t\treturn LIBRARY_NAME;\n\t\t\t}\n\t\t\treturn p;\n\t\t});\n\t}\n\n\tpublic createWindow(options: WindowOptions): WinLetWindow {\n\t\tthis.ensureInitialized();\n\n\t\tconst ifExists = options.ifExists ?? \"focus\";\n\n\t\tif (options.id && ifExists !== \"create\") {\n\t\t\tconst existingWindow = this.getWindow(options.id);\n\t\t\tif (existingWindow) {\n\t\t\t\tif (ifExists === \"prevent\") {\n\t\t\t\t\treturn existingWindow; // 何もせず既存インスタンスを返す\n\t\t\t\t}\n\t\t\t\tif (ifExists === \"focus\") {\n\t\t\t\t\tif (existingWindow.state === \"minimized\") {\n\t\t\t\t\t\texistingWindow.restore();\n\t\t\t\t\t}\n\t\t\t\t\texistingWindow.focus();\n\t\t\t\t\treturn existingWindow; // フォーカスして既存インスタンスを返す\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst creationOptions: Required<WindowOptions> = Utils.deepMerge(defaultConfig, options);\n\t\tif (creationOptions.x === \"auto\" || creationOptions.y === \"auto\") {\n\t\t\tconst winWidth = creationOptions.width;\n\t\t\tconst winHeight = creationOptions.height;\n\t\t\tconst containerRect = this.container!.getBoundingClientRect();\n\n\t\t\tlet nextX: number;\n\t\t\tlet nextY: number;\n\n\t\t\tif (this.lastAutoPosition === null) {\n\t\t\t\tnextX = 0;\n\t\t\t\tnextY = 0;\n\t\t\t} else {\n\t\t\t\t// 右下へカスケード\n\t\t\t\tnextX = this.lastAutoPosition.x + this.CASCADE_OFFSET;\n\t\t\t\tnextY = this.lastAutoPosition.y + this.CASCADE_OFFSET;\n\t\t\t}\n\n\t\t\t// はみ出しチェックとリセット\n\t\t\tif (nextX + winWidth > containerRect.width) {\n\t\t\t\tnextX = 0;\n\t\t\t}\n\t\t\tif (nextY + winHeight > containerRect.height) {\n\t\t\t\tnextY = 0;\n\t\t\t}\n\n\t\t\t// 計算結果をオプションに反映\n\t\t\tcreationOptions.x = nextX;\n\t\t\tcreationOptions.y = nextY;\n\n\t\t\t// 次回のために位置を保存\n\t\t\tthis.lastAutoPosition = { x: nextX, y: nextY };\n\t\t}\n\n\t\tconst win = new WinLetWindow(creationOptions, this);\n\t\tthis.windows.set(win.id, win);\n\t\tWindowManager.allWindows.set(win.id, win);\n\t\tthis.container!.appendChild(win.el);\n\n\t\twin.setPosition(creationOptions.x, creationOptions.y);\n\t\tif (creationOptions.focus) {\n\t\t\tthis.focusWindow(win);\n\t\t\twin.focus();\n\t\t} else {\n\t\t\t// フォーカスしない場合でも、z-indexの管理は必要\n\t\t\twin.el.style.zIndex = `${++this.zIndexCounter}`;\n\t\t}\n\t\treturn win;\n\t}\n\n\tpublic popup(options: PopupOptions): WinLetWindow {\n\t\tthis.ensureInitialized();\n\t\tlet buttons: PopupButton[];\n\t\tconst buttonPresets: { [key in PopupButtonPreset]: PopupButton[] } = {\n\t\t\tOk: [{ text: \"OK\", value: 1 }],\n\t\t\tOkCancel: [\n\t\t\t\t{ text: \"OK\", value: 1 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tYes: [{ text: \"Yes\", value: 6 }],\n\t\t\tYesNo: [\n\t\t\t\t{ text: \"Yes\", value: 6 },\n\t\t\t\t{ text: \"No\", value: 7 },\n\t\t\t],\n\t\t\tYesNoCancel: [\n\t\t\t\t{ text: \"Yes\", value: 6 },\n\t\t\t\t{ text: \"No\", value: 7 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tRetry: [{ text: \"Retry\", value: 4 }],\n\t\t\tRetryCancel: [\n\t\t\t\t{ text: \"Retry\", value: 4 },\n\t\t\t\t{ text: \"Cancel\", value: 2 },\n\t\t\t],\n\t\t\tAbortRetryIgnore: [\n\t\t\t\t{ text: \"Abort\", value: 3 },\n\t\t\t\t{ text: \"Retry\", value: 4 },\n\t\t\t\t{ text: \"Ignore\", value: 5 },\n\t\t\t],\n\t\t};\n\t\tif (Array.isArray(options.buttons)) {\n\t\t\tbuttons = options.buttons;\n\t\t} else {\n\t\t\tbuttons = buttonPresets[options.buttons || \"Ok\"] || buttonPresets.Ok;\n\t\t}\n\n\t\tlet timeoutId: number | null = null;\n\t\tconst closeCallback = (result: PopupResult) => {\n\t\t\tif (timeoutId) clearTimeout(timeoutId);\n\t\t\ttimeoutId = null;\n\t\t\toptions.onClose?.(result);\n\t\t};\n\n\t\tconst messageHTML = `<div class=\"${LIBRARY_NAME}-popup-message\">${Utils.sanitizeHTML(options.message)}</div>`;\n\t\tconst buttonsHTML = buttons.map((btn, index) => `<input class=\"${LIBRARY_NAME}-popup-button\" data-index=\"${index}\" type=\"button\" value=\"${Utils.sanitizeHTML(btn.text)}\"/>`).join(\"\");\n\t\tconst contentHTML = `${messageHTML}<div class=\"${LIBRARY_NAME}-popup-buttons\">${buttonsHTML}</div>`;\n\n\t\tconst winOptions: WindowOptions = {\n\t\t\tid: `popup-${Utils.generateId()}`,\n\t\t\ttitle: options.title || \"\",\n\t\t\ticon: options.icon,\n\t\t\tresizableX: false,\n\t\t\tresizableY: false,\n\t\t\tmovable: true,\n\t\t\tclosable: true,\n\t\t\tminimizable: false,\n\t\t\tmaximizable: false,\n\t\t\tmaximizableOnDblClick: false,\n\t\t\tenableShortcuts: false,\n\t\t\tcontent: { html: contentHTML },\n\t\t\tfocus: options.focus,\n\t\t\t_isPopup: true,\n\t\t};\n\t\tif (options.onFocus) winOptions.onFocus = options.onFocus;\n\t\tif (options.onBlur) winOptions.onBlur = options.onBlur;\n\n\t\tif (options.autoWidth) {\n\t\t\tconst temp = document.createElement(\"span\");\n\t\t\ttemp.style.visibility = \"hidden\";\n\t\t\ttemp.style.position = \"absolute\";\n\t\t\ttemp.style.whiteSpace = \"pre\";\n\t\t\ttemp.className = `${LIBRARY_NAME}-popup-message`;\n\t\t\ttemp.innerHTML = Utils.sanitizeHTML(options.message);\n\t\t\tthis.container?.appendChild(temp);\n\t\t\twinOptions.width = temp.offsetWidth + 80; // メッセージ幅 + パディング\n\t\t\tthis.container?.removeChild(temp);\n\t\t} else {\n\t\t\twinOptions.width = 300;\n\t\t}\n\t\twinOptions.height = 150;\n\n\t\twinOptions.x = \"center\";\n\t\twinOptions.y = \"center\";\n\n\t\tconst win = this.createWindow(winOptions);\n\t\t// 計算が面倒なので前回1回分のみで判断\n\t\tlet winPosition = win.getPosition();\n\t\tif (this.lastPopupPosition && this.lastPopupPosition.x === winPosition.x && this.lastPopupPosition.y === winPosition.y) {\n\t\t\twin.setPosition(this.lastPopupPosition.x + this.CASCADE_OFFSET, this.lastPopupPosition.y + this.CASCADE_OFFSET);\n\t\t\twinPosition = win.getPosition();\n\t\t}\n\t\tthis.lastPopupPosition = winPosition;\n\t\twin.popupCloseCallback = closeCallback;\n\n\t\twin.el.querySelectorAll<HTMLButtonElement>(`.${LIBRARY_NAME}-popup-button`).forEach((button) => {\n\t\t\tbutton.addEventListener(\"click\", () => {\n\t\t\t\tconst index = parseInt(button.dataset.index!, 10);\n\t\t\t\tconst result = buttons[index].value;\n\t\t\t\tcloseCallback(result);\n\t\t\t\twin.close();\n\t\t\t});\n\t\t});\n\n\t\tif (options.timeout && options.timeout > 0) {\n\t\t\ttimeoutId = window.setTimeout(() => {\n\t\t\t\tif (this.windows.has(win.id)) {\n\t\t\t\t\tcloseCallback(TIMEOUT_RESULT);\n\t\t\t\t\twin.close();\n\t\t\t\t}\n\t\t\t}, options.timeout);\n\t\t}\n\t\treturn win;\n\t}\n\n\tpublic destroyWindow(id: string): void {\n\t\tthis.ensureInitialized();\n\t\tconst win = this.windows.get(id);\n\t\tif (win) {\n\t\t\twin.el.remove();\n\t\t\tthis.windows.delete(id);\n\t\t\tWindowManager.allWindows.delete(id);\n\t\t\tif (this.activeWindow === win) {\n\t\t\t\tthis.activeWindow = null;\n\t\t\t\tconst nextWin = Array.from(this.windows.values()).pop();\n\t\t\t\tif (nextWin) this.focusWindow(nextWin);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic focusWindow(win: WinLetWindow): void {\n\t\tthis.ensureInitialized();\n\t\tif (this.activeWindow === win) return;\n\n\t\t// 自身が管理する他のウィンドウをぼかす\n\t\tthis.activeWindow?.blur();\n\t\tthis.activeWindow = win;\n\t\twin.el.style.zIndex = `${++this.zIndexCounter}`;\n\t\t// focus()はWindowクラス側で呼ばれるので不要\n\t}\n\n\tpublic getWindow(id: string): WinLetWindow | undefined {\n\t\tthis.ensureInitialized();\n\t\treturn this.windows.get(id);\n\t}\n\n\tpublic getWindowFromElement(element: HTMLElement): WinLetWindow | undefined {\n\t\tthis.ensureInitialized();\n\t\tconst winEl = element.closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\tif (winEl?.id) {\n\t\t\treturn WindowManager.allWindows.get(winEl.id);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic getActiveWindow(): WinLetWindow | null {\n\t\tthis.ensureInitialized();\n\t\treturn this.activeWindow;\n\t}\n\n\tpublic onTabDragStart(sourceWindowId: string): void {\n\t\tthis.container?.classList.add(`${LIBRARY_NAME}-is-tab-dragging`);\n\t\tthis.draggingTabInfo = { sourceWindowId };\n\t}\n\n\tpublic onTabDragEnd(): void {\n\t\tthis.container?.classList.remove(`${LIBRARY_NAME}-is-tab-dragging`);\n\t\tthis.draggingTabInfo = null;\n\t}\n\n\tpublic showContextMenu(x: number, y: number, menuItems: ContextMenuItem[], contextWindow: IWindow): void {\n\t\tthis.ensureInitialized();\n\t\tthis.hideContextMenu();\n\n\t\tthis.contextMenuEl = document.createElement(\"ul\");\n\t\tthis.contextMenuEl.className = `${LIBRARY_NAME}-context-menu`;\n\n\t\tmenuItems.forEach((itemData) => {\n\t\t\tconst itemEl = document.createElement(\"li\");\n\t\t\tif (itemData.separator) {\n\t\t\t\titemEl.className = \"separator\";\n\t\t\t} else {\n\t\t\t\titemEl.textContent = itemData.name ?? \"\";\n\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\titemData.action?.(contextWindow);\n\t\t\t\t\tthis.hideContextMenu();\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.contextMenuEl!.appendChild(itemEl);\n\t\t});\n\n\t\tthis.container!.appendChild(this.contextMenuEl);\n\n\t\tconst { offsetWidth: menuWidth, offsetHeight: menuHeight } = this.contextMenuEl;\n\t\tconst { innerWidth: screenWidth, innerHeight: screenHeight } = window;\n\n\t\tthis.contextMenuEl.style.left = x + menuWidth > screenWidth ? `${screenWidth - menuWidth}px` : `${x}px`;\n\t\tthis.contextMenuEl.style.top = y + menuHeight > screenHeight ? `${screenHeight - menuHeight}px` : `${y}px`;\n\t}\n\n\tpublic hideContextMenu(): void {\n\t\tthis.contextMenuEl?.remove();\n\t\tthis.contextMenuEl = null;\n\t}\n\n\t/**\n\t * ショートカット文字列を解析し、修飾キーと主キーのオブジェクトを返す\n\t * @param shortcut - \"Ctrl+Shift+K\"のような文字列\n\t */\n\tprivate parseShortcut(shortcut: string): { ctrl: boolean; alt: boolean; shift: boolean; key: string } {\n\t\tconst keys = shortcut.split(\"+\");\n\t\tconst key = keys.pop() || \"\"; // 主キーを配列から取り出す\n\t\tconst ctrl = keys.includes(\"Ctrl\");\n\t\tconst alt = keys.includes(\"Alt\");\n\t\tconst shift = keys.includes(\"Shift\");\n\t\treturn { ctrl, alt, shift, key };\n\t}\n}\n","// src/index.ts\n\nimport { defaultConfig } from \"./const/config\";\nimport { CLOSE_BUTTON_RESULT, GlobalConfigOptions, IWindow, PopupOptions, TIMEOUT_RESULT, WindowOptions, WinLetApi } from \"./const/types\";\nimport WindowManager from \"./function/window_manager\";\nimport Utils from \"./libs/utils\";\nimport { LIB_VERSION } from \"./version\";\n\nconst selfUrl = (document?.currentScript as HTMLScriptElement)?.src || \"\";\n\nconst globalConfig: GlobalConfigOptions = {\n\twindowSwitchShortcut: \"Ctrl+`\", // デフォルトショートカット（バッククォート）\n\tlibraryPath: selfUrl,\n};\n\n// シングルトンインスタンス\nconst manager = new WindowManager(globalConfig);\n\n// 公開するAPI\nconst api: WinLetApi = {\n\t/**\n\t * ライブラリを初期化します。DOMの準備ができた後に呼び出してください。\n\t * (例: document.addEventListener('DOMContentLoaded', WinLet.init);)\n\t *\n\t * @param options - グローバル設定。コンテナ要素などを指定できます。\n\t */\n\tinit: (options: GlobalConfigOptions = {}): void => {\n\t\tapi.setGlobalConfig(options);\n\t\tmanager.init();\n\t},\n\n\t/**\n\t * 新しいウィンドウを作成\n\t */\n\tcreateWindow: (options: WindowOptions = {}): IWindow => {\n\t\treturn manager.createWindow(options);\n\t},\n\n\t/**\n\t * 新しいポップアップウィンドウを作成\n\t */\n\tcreatePopup: (options: PopupOptions): IWindow => {\n\t\treturn manager.popup(options);\n\t},\n\n\t/**\n\t * ウィンドウを取得\n\t */\n\tgetWindow: (id: string): IWindow | undefined => {\n\t\treturn manager.getWindow(id);\n\t},\n\n\t/**\n\t * 指定されたDOM要素を内包するウィンドウインスタンスを取得します。\n\t */\n\tgetWindowFromElement: (element: HTMLElement): IWindow | undefined => {\n\t\treturn manager.getWindowFromElement(element);\n\t},\n\n\t/**\n\t * アクティブなウィンドウを取得\n\t */\n\tgetActiveWindow: (): IWindow | null => {\n\t\treturn manager.getActiveWindow();\n\t},\n\n\t/**\n\t * デフォルトのウィンドウ設定を変更\n\t */\n\tsetDefaultConfig: (options: WindowOptions): void => {\n\t\tUtils.deepMerge(defaultConfig, options);\n\t},\n\n\t/**\n\t * グローバル設定を変更\n\t */\n\tsetGlobalConfig: (options: GlobalConfigOptions): void => {\n\t\t// 初期化後にコンテナを変更しようとした場合は警告を出す\n\t\tif (manager.isInitialized && options.container) {\n\t\t\tconsole.warn(\"WinLet: The container cannot be changed after initialization.\");\n\t\t\tdelete options.container;\n\t\t}\n\t\tObject.assign(globalConfig, options);\n\t\tmanager.applyGlobalConfig(globalConfig);\n\t},\n\n\t/**\n\t * ライブラリのバージョンを取得\n\t */\n\tget version() {\n\t\treturn LIB_VERSION;\n\t},\n\n\t/**\n\t * ポップアップウィンドウのタイムアウト結果\n\t */\n\tPOPUP_TIMEOUT_RESULT: TIMEOUT_RESULT,\n\t/**\n\t * ポップアップウィンドウの閉じるボタンの結果\n\t */\n\tPOPUP_CLOSE_BUTTON_RESULT: CLOSE_BUTTON_RESULT,\n};\n\n// グローバルスコープにAPIをアタッチ\nif (typeof window !== \"undefined\") {\n\twindow.WinLet = api;\n}\n\n// モジュールとしてエクスポートも可能\nexport default api;\n","export default class WinLetBaseClass {}\n","import WinLetBaseClass from \"./baseclass\";\n\nexport default class Utils extends WinLetBaseClass {\n\t/**\n\t * ユニークなIDを生成します。\n\t * @param prefix - IDのプレフィックス\n\t * @returns 生成されたID\n\t */\n\tpublic static generateId(prefix: string = \"win\"): string {\n\t\treturn `${prefix}-${Math.random().toString(36).substring(2, 9)}`;\n\t}\n\n\t/**\n\t * オブジェクトをディープマージします。\n\t */\n\tpublic static deepMerge<T extends object, U extends object>(target: T, source: U): T & U {\n\t\tconst output = { ...target } as T & U;\n\n\t\tfor (const key in source) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(source, key)) {\n\t\t\t\tconst sourceValue = source[key];\n\t\t\t\tconst targetValue = (target as any)[key];\n\n\t\t\t\tif (Array.isArray(sourceValue)) {\n\t\t\t\t\t// ソースの値が配列の場合は、そのまま上書きする\n\t\t\t\t\t(output as any)[key] = sourceValue;\n\t\t\t\t} else if (sourceValue instanceof Object && typeof sourceValue !== \"function\" && targetValue instanceof Object) {\n\t\t\t\t\t(output as any)[key] = this.deepMerge(targetValue, sourceValue);\n\t\t\t\t} else {\n\t\t\t\t\t(output as any)[key] = sourceValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\t/**\n\t * オブジェクトが空でないかとどうかを判定します。\n\t * @param obj - 判定するオブジェクト\n\t * @returns オブジェクトが空である場合はfalse、そうでない場合はtrue\n\t */\n\tpublic static isNonEmptyObject<T extends object>(obj: T | undefined): obj is T & Record<string | symbol, unknown> {\n\t\tif (!obj) return false;\n\t\tfor (const _ in obj) return true;\n\t\treturn false;\n\t}\n\n\t/**\n\t * HTML文字列をサニタイズします。\n\t * @param str - サニタイズする文字列\n\t * @returns サニタイズされたHTML文字列\n\t */\n\tpublic static sanitizeHTML(str: string): string {\n\t\tconst temp = document.createElement(\"div\");\n\t\ttemp.textContent = str;\n\t\treturn temp.innerHTML;\n\t}\n}\n","const styleData: string = `\n:root {\n    --$[prefix]-bg: #f0f0f0;\n    --$[prefix]-border: #a0a0a0;\n    --$[prefix]-title-bar-height: 32px;\n    --$[prefix]-title-bar-bg: #e0e0e0;\n    --$[prefix]-title-bar-active-bg: #0078d7;\n    --$[prefix]-title-text-color: #000;\n    --$[prefix]-title-text-active-color: #fff;\n    --$[prefix]-control-bg: #d0d0d0;\n    --$[prefix]-control-hover-bg: #e5e5e5;\n    --$[prefix]-control-close-hover-bg: #e81123;\n    --$[prefix]-control-close-hover-color: #fff;\n    --$[prefix]-menu-bg: #fff;\n    --$[prefix]-menu-border: #ccc;\n    --$[prefix]-menu-item-color: #000;\n    --$[prefix]-menu-item-hover-bg: #0078d7;\n    --$[prefix]-menu-item-hover-color: #fff;\n    --$[prefix]-tab-bg: #dcdcdc;\n    --$[prefix]-tab-active-bg: #f0f0f0;\n    --$[prefix]-tab-border: #b0b0b0;\n    --$[prefix]-resize-handle-size: 8px;\n    --$[prefix]-resize-handle-offset: -4px;\n}\n\n.$[prefix]-us-none {\n    user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n}\n\n.$[prefix]-us-auto {\n    user-select: auto;\n    -webkit-user-select: auto;\n    -ms-user-select: auto;\n}\n\n\n.$[prefix]-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    overflow: hidden;\n    z-index: 999;\n}\n\n.$[prefix]-container.$[prefix]-is-nested {\n    position: absolute;\n}\n\n.$[prefix]-container.$[prefix]-is-tab-dragging {\n    pointer-events: auto;\n}\n\n.$[prefix]-window {\n    position: absolute;\n    display: flex;\n    flex-direction: column;\n    min-width: 200px;\n    min-height: 150px;\n    border: 1px solid var(--$[prefix]-border);\n    background-color: var(--$[prefix]-bg);\n    box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n    border-radius: 5px;\n    overflow: hidden;\n    pointer-events: all;\n    transition: opacity 0.1s, transform 0.1s;\n    touch-action: none;\n}\n\n.$[prefix]-window.minimized {\n    display: none;\n}\n\n.$[prefix]-window.maximized {\n    border-radius: 0;\n    border: none;\n}\n\n.$[prefix]-window.maximized > .$[prefix]-resize-handle {\n    display: none;\n}\n\n/* Focus State */\n.$[prefix]-window.active .$[prefix]-title-bar {\n    background-color: var(--$[prefix]-title-bar-active-bg);\n    color: var(--$[prefix]-title-text-active-color);\n}\n.$[prefix]-window.active .$[prefix]-title-bar .$[prefix]-title {\n    color: var(--$[prefix]-title-text-active-color);\n}\n\n.$[prefix]-title-bar {\n    display: flex;\n    align-items: center;\n    height: var(--$[prefix]-title-bar-height);\n    background-color: var(--$[prefix]-title-bar-bg);\n    color: var(--$[prefix]-title-text-color);\n    cursor: move;\n    flex-shrink: 0;\n    touch-action: none;\n}\n\n.$[prefix]-title-bar.controls-left {\n    flex-direction: row-reverse;\n}\n\n.$[prefix]-icon {\n    min-width: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    height: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    margin: 0 4px;\n    pointer-events: none;\n    flex-shrink: 0;\n}\n\n.$[prefix]-icon:empty {\n    display: none;\n}\n\n.$[prefix]-icon i {\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\n    line-height: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    text-align: center;\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n.$[prefix]-icon img {\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n.$[prefix]-title {\n    flex-grow: 1;\n    padding: 0 8px;\n    font-family: sans-serif;\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.44);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    pointer-events: none;\n}\n\n.$[prefix]-title-bar.controls-left .$[prefix]-title {\n    text-align: right;\n}\n\n.$[prefix]-controls {\n    display: flex;\n    height: 100%;\n    margin-left: auto;\n    flex-shrink: 0;\n}\n\n.$[prefix]-title-bar.controls-left .$[prefix]-controls {\n    margin-left: 0;\n    margin-right: auto;\n    flex-direction: row-reverse;\n}\n\n.$[prefix]-control-btn {\n    width: calc(var(--$[prefix]-title-bar-height) * 1.3);\n    height: 100%;\n    border: none;\n    box-sizing: border-box;\n    background-color: transparent;\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\n    cursor: pointer;\n    text-align: center;\n    vertical-align: middle;\n    font-family: sans-serif;\n    transition: background-color 0.2s;\n    touch-action: auto;\n}\n\n.$[prefix]-control-btn:hover {\n    background-color: var(--$[prefix]-control-hover-bg);\n}\n\n.$[prefix]-control-btn.$[prefix]-close-btn:hover {\n    background-color: var(--$[prefix]-control-close-hover-bg);\n    color: var(--$[prefix]-control-close-hover-color);\n}\n\n.$[prefix]-main-content {\n    all: initial;\n    display:flex;\n    flex-direction:column;\n    flex-grow:1;\n    overflow:hidden;\n}\n\n.$[prefix]-menu-bar {\n    color: var(--$[prefix]-menu-item-color);\n    display: flex;\n    background-color: var(--$[prefix]-bg);\n    padding: 2px;\n    flex-shrink: 0;\n    border-bottom: 1px solid var(--$[prefix]-border);\n    touch-action: auto;\n}\n\n.$[prefix]-menu-item {\n    font-family: sans-serif;\n    font-size: 14px;\n    padding: 4px 8px;\n    cursor: default;\n    position: relative;\n}\n\n.$[prefix]-menu-item:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n\n.$[prefix]-menu-dropdown {\n    color: var(--$[prefix]-menu-item-color);\n    line-height: 1.6em;\n    display: none;\n    position: absolute;\n    top: 100%;\n    left: 0;\n    background-color: var(--$[prefix]-menu-bg);\n    border: 1px solid var(--$[prefix]-menu-border);\n    box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n    list-style: none;\n    margin: 0;\n    padding: 4px 0;\n    min-width: 150px;\n    z-index: 10;\n    touch-action: auto;\n}\n\n.$[prefix]-menu-dropdown li {\n    padding: 0 20px;\n    font-size: 14px;\n    cursor: pointer;\n}\n\n.$[prefix]-menu-dropdown li:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n\n.$[prefix]-menu-dropdown li.separator {\n    height: 1px;\n    background-color: var(--$[prefix]-menu-border);\n    margin: 4px 0;\n    padding: 0;\n}\n\n.$[prefix]-menu-dropdown-item {\n    display: flex;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    width: 100%;\n    white-space: nowrap;\n}\n\n/* --- メニュー --- */\n/* サブメニューを持つ項目のスタイル */\n.$[prefix]-menu-dropdown li.has-submenu {\n    position: relative;\n}\n.$[prefix]-menu-dropdown li.has-submenu::after {\n    content: '▶';\n    position: absolute;\n    top: 50%;\n    right: 10px;\n    margin-top: -0.65em;\n    font-size: 0.8em;\n    color: inherit;\n}\n\n/* ネストされたサブメニューの表示位置 */\n.$[prefix]-menu-dropdown li.has-submenu > .$[prefix]-menu-dropdown {\n    top: -5px; /* liのpaddingを考慮 */\n    left: 100%;\n}\n\n/* サブメニューはホバーで開く */\n.$[prefix]-menu-dropdown li.has-submenu:hover > .$[prefix]-menu-dropdown {\n    display: block;\n}\n\n/* ショートカットキーテキストのスタイル */\n.$[prefix]-shortcut-text {\n    color: #666;\n    margin-left: 1em;\n}\n.$[prefix]-menu-dropdown li:hover .$[prefix]-shortcut-text {\n    color: inherit;\n}\n\n/* --- タブ --- */\n.$[prefix]-tab-bar {\n    color: var(--$[prefix]-menu-item-color);\n    overflow-x: auto;\n    overflow-y: hidden;\n    -ms-overflow-style: -ms-autohiding-scrollbar;\n    scrollbar-width: thin;\n    display: flex;\n    background-color: #e1e1e1;\n    flex-shrink: 0;\n    align-items: flex-end;\n    touch-action: auto;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar{\n    width: 6px;\n    height: 6px;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar-thumb {\n    background-color: rgba(100, 100, 100, 0.5);\n    border-radius: 3px;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar-track {\n    background-color: transparent;\n}\n\n.$[prefix]-tab {\n    white-space: nowrap;\n    padding: 8px 16px;\n    font-family: sans-serif;\n    font-size: 14px;\n    cursor: pointer;\n    border-right: 1px solid var(--$[prefix]-tab-border);\n    background-color: var(--$[prefix]-tab-bg);\n}\n\n.$[prefix]-tab.active {\n    background-color: var(--$[prefix]-tab-active-bg);\n    border-bottom: 2px solid var(--$[prefix]-title-bar-active-bg);\n}\n\n.$[prefix]-tab.active .$[prefix]-tab-close-btn:hover {\n    background-color: #ddd;\n}\n\n/* ドラッグ中のタブのスタイル */\n.$[prefix]-tab.dragging {\n    opacity: 0.5;\n}\n/* タブの閉じるボタン */\n.$[prefix]-tab-close-btn {\n    margin-left: 8px;\n    padding: 0 4px;\n    border-radius: 50%;\n    cursor: pointer;\n    font-weight: bold;\n    font-size: 14px;\n    line-height: 1;\n}\n.$[prefix]-tab-close-btn:hover {\n    background-color: #ccc;\n}\n\n.$[prefix]-tab-content {\n    display: none;\n}\n\n.$[prefix]-tab-content.active {\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n/* タブ追加ボタン */\n.$[prefix]-tab-add-btn {\n    padding: 8px;\n    font-size: 14px;\n    cursor: pointer;\n    border-bottom: 1px solid var(--$[prefix]-tab-border);\n}\n.$[prefix]-tab-add-btn:hover {\n    background-color: #e0e0e0;\n}\n\n.$[prefix]-content {\n    flex-grow: 1;\n    position: relative;\n    overflow: auto;\n    touch-action: auto;\n}\n\n.$[prefix]-content iframe {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: none;\n}\n\n.$[prefix]-resize-handle {\n    position: absolute;\n    z-index: 5;\n    touch-action: none;\n}\n\n.$[prefix]-resize-handle.n { top: var(--$[prefix]-resize-handle-offset); left: 0; right: 0; height: var(--$[prefix]-resize-handle-size); cursor: n-resize; }\n.$[prefix]-resize-handle.s { bottom: var(--$[prefix]-resize-handle-offset); left: 0; right: 0; height: var(--$[prefix]-resize-handle-size); cursor: s-resize; }\n.$[prefix]-resize-handle.w { top: 0; bottom: 0; left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); cursor: w-resize; }\n.$[prefix]-resize-handle.e { top: 0; bottom: 0; right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); cursor: e-resize; }\n.$[prefix]-resize-handle.nw { top: var(--$[prefix]-resize-handle-offset); left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: nw-resize; }\n.$[prefix]-resize-handle.ne { top: var(--$[prefix]-resize-handle-offset); right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: ne-resize; }\n.$[prefix]-resize-handle.sw { bottom: var(--$[prefix]-resize-handle-offset); left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: sw-resize; }\n.$[prefix]-resize-handle.se { bottom: var(--$[prefix]-resize-handle-offset); right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: se-resize; }\n\n.$[prefix]-context-menu {\n    color: var(--$[prefix]-menu-item-color);\n    pointer-events: all;\n    position: fixed;\n    z-index: 10000;\n    background-color: var(--$[prefix]-menu-bg);\n    border: 1px solid var(--$[prefix]-menu-border);\n    box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n    list-style: none;\n    margin: 0;\n    padding: 4px 0;\n    min-width: 160px;\n}\n.$[prefix]-context-menu li {\n    padding: 6px 24px;\n    font-family: sans-serif;\n    font-size: 14px;\n    cursor: pointer;\n}\n.$[prefix]-context-menu li:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n.$[prefix]-context-menu li.separator {\n    height: 1px;\n    background-color: var(--$[prefix]-menu-border);\n    margin: 4px 0;\n    padding: 0;\n}\n\n/* --- Popup Styles --- */\n.$[prefix]-popup-window .$[prefix]-content {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding: 20px;\n    box-sizing: border-box;\n}\n.$[prefix]-popup-message {\n    font-family: sans-serif;\n    font-size: 14px;\n    line-height: 1.5;\n    flex-grow: 1;\n    word-wrap: break-word;\n}\n.$[prefix]-popup-buttons {\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n    margin-top: 20px;\n    flex-shrink: 0;\n    touch-action: auto;\n}\n.$[prefix]-popup-button {\n    min-width: 80px;\n    padding: 8px 12px;\n    margin: 0;\n    border: 1px solid #ccc;\n    border-radius: 3px;\n    background-color: #f0f0f0;\n    cursor: pointer;\n    font-size: 14px;\n    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);\n}\n.$[prefix]-popup-button:hover {\n    border-color: #bbb;\n    background-color: #e9e9e9;\n}\n.$[prefix]-popup-button:active {\n    background-color: #dcdcdc;\n}\n\n/* --- Merged Menu/Tab Styles --- */\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-title-bar,\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-title-bar {\n    height: auto;\n    align-items: flex-end;\n    padding: 0;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged.$[prefix]-window.active .$[prefix]-title-bar {\n    background-color: var(--$[prefix]-title-bar-bg);\n}\n\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-icon {\n    margin-block: auto;\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-title {\n    display: none;\n}\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-title {\n    flex-grow: 1;\n    margin-block: auto;\n}\n\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-menu-bar {\n    border-bottom: none;\n    background: transparent;\n    padding: 0 6px;\n    align-self: center;\n}\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-menu-item {\n    line-height: var(--$[prefix]-title-bar-height);\n    padding-top: 0;\n    padding-bottom: 0;\n}\n\n.$[prefix]-window.$[prefix]-menu-style-merged.active:not(.$[prefix]-tab-style-merged) .$[prefix]-menu-item {\n    color: var(--winlet-menu-item-hover-color);\n}\n.$[prefix]-window.$[prefix]-menu-style-merged.active:not(.$[prefix]-tab-style-merged) .$[prefix]-menu-item:hover {\n    background-color: var(--$[prefix]-title-bar-bg);\n    color: var(--$[prefix]-menu-item-color);\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar {\n    background-color: transparent;\n    flex-grow: 1;\n    flex-shrink: 1;\n    min-width: 0;\n    align-items: flex-end;\n    height: calc(var(--$[prefix]-title-bar-height) + 4px);\n    margin: 0;\n    order: 1; /* controlsより前に配置 */\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar {\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar::-webkit-scrollbar{\n    width: 0px;\n    height: 0px;\n}\n\n.$[prefix]-window.$[prefix]-title-bar.controls-left .$[prefix]-tab-bar {\n    order: -1;\n}\n\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab {\n    border: 1px solid var(--$[prefix]-border);\n    border-bottom: none;\n    border-radius: 6px 6px 0 0;\n    margin-top: 4px;\n    margin-left: -1px;\n    position: relative;\n    bottom: -1px;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab.active {\n    background-color: var(--$[prefix]-bg);\n    border-color: var(--$[prefix]-border);\n    border-bottom: 1px solid var(--$[prefix]-bg);\n    z-index: 2;\n}\n\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-add-btn {\n    border: none;\n    align-self: center;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-main-content {\n    border-top: none;\n}\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-controls,\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-controls {\n    align-self: flex-start;\n    order: 2;\n}\n\n/* --- Mobile / Touch Device Adjustments --- */\n@media (pointer: coarse), (max-width: 768px) {\n    :root {\n        --$[prefix]-resize-handle-size: 16px;\n        --$[prefix]-resize-handle-offset: -8px;\n    }\n    .$[prefix]-control-btn {\n        width: calc(var(--$[prefix]-title-bar-height) * 1.5);\n    }\n}\n`;\n\nexport default styleData;\n","// このファイルは自動生成されます\nexport const LIB_VERSION = \"v1.0.1.1\";\n"],"mappings":"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","ignoreList":[]}