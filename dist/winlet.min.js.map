{"version":3,"file":"winlet.min.js","names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","module","ReferenceError","__esModule","TypeError","isNativeReflectConstruct","setPrototypeOf","Reflect","construct","apply","arguments","push","bind","prototype","toPropertyKey","_defineProperties","enumerable","configurable","writable","Object","defineProperty","key","value","_getPrototypeOf","getPrototypeOf","__proto__","create","constructor","default","Function","toString","indexOf","_isNativeReflectConstruct","Boolean","valueOf","_typeof","assertThisInitialized","_setPrototypeOf","Symbol","toPrimitive","String","Number","iterator","isNativeFunction","_wrapNativeSuper","Map","has","get","set","Wrapper","this","defaultConfig","id","ifExists","title","icon","x","y","width","height","minWidth","minHeight","resizableX","resizableY","movable","closable","minimizable","maximizable","enableShortcuts","controlsPosition","content","html","iframe","template","menu","tabs","tabOptions","reorderable","addable","onAdd","undefined","contextMenu","onOpen","onClose","onFocus","onBlur","onResize","onMove","WinLetBaseError","_Error","message","_this","_classCallCheck2","_callSuper","name","BuiltInError","captureStackTrace","_inherits2","_createClass2","_wrapNativeSuper2","SimpleError","_WinLetBaseError","WinLetError","_SimpleError","LIBRARY_NAME","_config","_errors","_types","_baseclass","_interopRequireDefault","_utils","_WinLetBaseClass","WinLetWindow","options","manager","_getPrototypeOf2","_possibleConstructorReturn2","_defineProperty2","generateId","existingEl","document","getElementById","classList","contains","concat","deepMerge","el","createDOM","titleBarEl","querySelector","iconEl","titleEl","contentEl","applyOptions","setupEventListeners","windowEl","createElement","className","handles","resizableHandlesHTML","join","innerHTML","setTitle","setIcon","setSize","setPosition","style","add","createTabs","renderContent","createMenu","container","src","appendChild","tagName","cloneNode","_iframe","srcdoc","_this2","menuBar","forEach","menuItemData","_menuItemData$name","menuItemEl","textContent","items","dropdownEl","createDropdownMenu","addEventListener","stopPropagation","console","log","querySelectorAll","dd","display","isVisible","_this3","itemData","itemEl","separator","_itemData$name","text","shortcut","_itemData$action","action","subMenuEl","_this$options$tabOpti","_this4","tabBar","tabOpts","tabData","index","createTabElement","addTabBtn","_tabOpts$onAdd","newTabItem","newIndex","activateTab","_this$options$tabOpti2","_this5","tabEl","dataset","tabId","insertBefore","closeBtn","closeTab","tabContentEl","splice","makeTabReorderable","draggable","dataTransfer","setData","remove","preventDefault","draggingEl","rect","getBoundingClientRect","isAfter","clientX","left","parent","parentNode","nextSibling","passive","tab","newActiveIndex","Math","max","toggle","_this6","focus","close","maxBtn","toggleMaximize","minBtn","minimize","makeMovable","makeResizable","showContextMenu","clientY","_this7","target","closest","state","restoredWidth","lastState","clickRatio","offsetWidth","titleBarRect","offsetY","top","posX","posY","restore","pointerEvents","startX","startY","_this7$el","initialLeft","offsetLeft","initialTop","offsetTop","onMouseMove","moveE","newLeft","newTop","_onMouseUp","removeEventListener","_this8","handle","direction","replace","_this8$el","startWidth","startHeight","offsetHeight","startLeft","startTop","_this8$options","newWidth","newHeight","deltaX","deltaY","includes","_onMouseUp2","classStr","classes","trim","split","hasPrefix","some","test","hasIcon","destroyWindow","blur","maximize","focused","focusWindow","sanitizeHTML","isFontAwesome","img","alt","parentRect","min","warn","_styles","_window2","_createForOfIteratorHelper","Array","isArray","_arrayLikeToArray","slice","from","_unsupportedIterableToArray","_n","F","s","done","next","WindowManager","initialConfig","globalConfig","assign","isInitialized","body","styleTag","getStyleData","head","containerEl","window","requestAnimationFrame","activeEl","activeElement","winEl","win","windows","activeWindow","active","hideContextMenu","event","data","type","_typeof2","_step","isSourceValid","_iterator","values","contentWindow","source","err","createWindow","origin","setupShortcutListeners","windowSwitchShortcut","parseShortcut","toLowerCase","ctrlKey","ctrl","altKey","shiftKey","shift","currentIndex","findIndex","w","targetWindow","_findAndExecShortcut","menuItems","_step2","_iterator2","item","_item$action","_shortcut","toUpperCase","init","_options$ifExists","ensureInitialized","existingWindow","getWindow","nextWin","pop","_this$activeWindow","zIndex","zIndexCounter","contextWindow","contextMenuEl","onclick","_this$contextMenuEl","menuWidth","menuHeight","_window","screenWidth","innerWidth","screenHeight","innerHeight","_this$contextMenuEl2","keys","_window_manager","api","getActiveWindow","setDefaultConfig","setGlobalConfig","applyGlobalConfig","WinLet","WinLetBaseClass","ownKeys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","Utils","random","substring","output","getOwnPropertyDescriptors","defineProperties","_objectSpread","hasOwnProperty","sourceValue","targetValue","str","temp"],"sources":["node_modules/browser-pack/_prelude.js","node_modules/@babel/runtime/helpers/assertThisInitialized.js","node_modules/@babel/runtime/helpers/classCallCheck.js","node_modules/@babel/runtime/helpers/construct.js","node_modules/@babel/runtime/helpers/createClass.js","node_modules/@babel/runtime/helpers/defineProperty.js","node_modules/@babel/runtime/helpers/getPrototypeOf.js","node_modules/@babel/runtime/helpers/inherits.js","node_modules/@babel/runtime/helpers/interopRequireDefault.js","node_modules/@babel/runtime/helpers/isNativeFunction.js","node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js","node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","node_modules/@babel/runtime/helpers/setPrototypeOf.js","node_modules/@babel/runtime/helpers/toPrimitive.js","node_modules/@babel/runtime/helpers/toPropertyKey.js","node_modules/@babel/runtime/helpers/typeof.js","node_modules/@babel/runtime/helpers/wrapNativeSuper.js","src/const/config.ts","src/const/errors.ts","src/const/types.ts","src/function/window.ts","src/function/window_manager.ts","src/index.ts","src/libs/baseclass.ts","src/libs/utils.ts","src/style/styles.ts"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var isNativeReflectConstruct = require(\"./isNativeReflectConstruct.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _construct(t, e, r) {\n  if (isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments);\n  var o = [null];\n  o.push.apply(o, e);\n  var p = new (t.bind.apply(t, o))();\n  return r && setPrototypeOf(p, r.prototype), p;\n}\nmodule.exports = _construct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _getPrototypeOf(t) {\n  return module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _getPrototypeOf(t);\n}\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _interopRequireDefault(e) {\n  return e && e.__esModule ? e : {\n    \"default\": e\n  };\n}\nmodule.exports = _interopRequireDefault, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _isNativeFunction(t) {\n  try {\n    return -1 !== Function.toString.call(t).indexOf(\"[native code]\");\n  } catch (n) {\n    return \"function\" == typeof t;\n  }\n}\nmodule.exports = _isNativeFunction, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (module.exports = _isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _isNativeReflectConstruct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _setPrototypeOf(t, e) {\n  return module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _setPrototypeOf(t, e);\n}\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var getPrototypeOf = require(\"./getPrototypeOf.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nvar isNativeFunction = require(\"./isNativeFunction.js\");\nvar construct = require(\"./construct.js\");\nfunction _wrapNativeSuper(t) {\n  var r = \"function\" == typeof Map ? new Map() : void 0;\n  return module.exports = _wrapNativeSuper = function _wrapNativeSuper(t) {\n    if (null === t || !isNativeFunction(t)) return t;\n    if (\"function\" != typeof t) throw new TypeError(\"Super expression must either be null or a function\");\n    if (void 0 !== r) {\n      if (r.has(t)) return r.get(t);\n      r.set(t, Wrapper);\n    }\n    function Wrapper() {\n      return construct(t, arguments, getPrototypeOf(this).constructor);\n    }\n    return Wrapper.prototype = Object.create(t.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    }), setPrototypeOf(Wrapper, t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _wrapNativeSuper(t);\n}\nmodule.exports = _wrapNativeSuper, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","import { WindowOptions } from \"./types\";\n\n// Partial<WindowOptions>ではなく、全てのキーを定義して型安全にする\nexport const defaultConfig: Required<WindowOptions> = {\n\tid: null,\n\tifExists: \"focus\",\n\ttitle: \"New Window\",\n\ticon: null,\n\tx: \"center\",\n\ty: \"center\",\n\twidth: 500,\n\theight: 400,\n\tminWidth: 200,\n\tminHeight: 150,\n\tresizableX: true,\n\tresizableY: true,\n\tmovable: true,\n\tclosable: true,\n\tminimizable: true,\n\tmaximizable: true,\n\tenableShortcuts: true,\n\tcontrolsPosition: \"right\",\n\tcontent: {\n\t\thtml: \"\",\n\t\tiframe: \"\",\n\t\ttemplate: \"\",\n\t},\n\tmenu: [],\n\ttabs: [],\n\ttabOptions: {\n\t\treorderable: false,\n\t\tclosable: false,\n\t\taddable: false,\n\t\tonAdd: undefined,\n\t},\n\tcontextMenu: [],\n\tonOpen: () => {},\n\tonClose: () => {},\n\tonFocus: () => {},\n\tonBlur: () => {},\n\tonResize: () => {},\n\tonMove: () => {},\n};\n","interface ErrorConstructor {\n\tcaptureStackTrace?(targetObject: object, constructorOpt?: Function): void;\n}\n\n/**\n * すべてのカスタムエラーの基底クラス\n */\nexport class WinLetBaseError extends Error {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t\tthis.name = this.constructor.name;\n\n\t\tconst BuiltInError: ErrorConstructor = Error as ErrorConstructor;\n\t\tif (BuiltInError.captureStackTrace) {\n\t\t\tBuiltInError.captureStackTrace(this, this.constructor);\n\t\t}\n\t}\n}\n\n/**\n * 単純なメッセージのみのエラー\n */\nexport class SimpleError extends WinLetBaseError {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t}\n}\n\nexport class WinLetError extends SimpleError {}\n","export const LIBRARY_NAME = \"winlet\";\n\nexport type WindowState = \"normal\" | \"minimized\" | \"maximized\";\n\nexport interface WindowContentOptions {\n\thtml?: string;\n\tiframe?: string;\n\ttemplate?: string;\n}\n\n// IWindowインターフェースを先に定義することで循環参照を回避\nexport interface IWindow {\n\treadonly id: string;\n\toptions: Required<WindowOptions>;\n\tel: HTMLElement;\n\tstate: WindowState;\n\n\t// --- Public API ---\n\tclose(): void;\n\tminimize(): void;\n\ttoggleMaximize(): void;\n\tmaximize(): void;\n\trestore(): void;\n\tfocus(): void;\n\tblur(): void;\n\tsetTitle(title: string): void;\n\tsetIcon(icon: string | null): void;\n\tsetPosition(x: number | \"center\", y: number | \"center\"): void;\n\tsetSize(width: number | string, height: number | string): void;\n}\n\nexport interface MenuItem {\n\tname?: string;\n\taction?: (win: IWindow) => void;\n\titems?: MenuItem[];\n\tseparator?: boolean;\n\tshortcut?: string;\n}\n\nexport interface TabItem {\n\ttitle: string;\n\tcontent: WindowContentOptions;\n}\n\nexport interface ContextMenuItem {\n\tname?: string;\n\taction?: (win: IWindow) => void;\n\tseparator?: boolean;\n}\n\nexport interface WindowOptions {\n\t/**\n\t * ウィンドウのID\n\t */\n\tid?: string | null;\n\t/**\n\t * 既に同名のウィンドウが存在する場合の動作\n\t *\n\t * focus (デフォルト): 既存のウィンドウを復元し、フォーカスします。\n\t * prevent: 新しいウィンドウを作成せず、処理を中断します。\n\t * create: IDの重複を無視して、常に新しいウィンドウを作成します。\n\t */\n\tifExists?: \"focus\" | \"prevent\" | \"create\";\n\t/**\n\t * ウィンドウのタイトル\n\t */\n\ttitle?: string;\n\t/**\n\t * ウィンドウのアイコン\n\t *\n\t * url / font-awesomeのクラス名の指定可能\n\t */\n\ticon?: string | null;\n\t/**\n\t * ウィンドウのX座標\n\t */\n\tx?: number | \"center\";\n\t/**\n\t * ウィンドウのY座標\n\t */\n\ty?: number | \"center\";\n\t/**\n\t * ウィンドウのサイズX\n\t */\n\twidth?: number;\n\t/**\n\t * ウィンドウのサイズY\n\t */\n\theight?: number;\n\t/**\n\t * ウィンドウの最小サイズX\n\t */\n\tminWidth?: number;\n\t/**\n\t * ウィンドウの最小サイズY\n\t */\n\tminHeight?: number;\n\t/**\n\t * 水平方向のリサイズ\n\t */\n\tresizableX?: boolean;\n\t/**\n\t * 垂直方向のリサイズ\n\t */\n\tresizableY?: boolean;\n\t/**\n\t * ウィンドウの移動\n\t */\n\tmovable?: boolean;\n\t/**\n\t * ウィンドウを閉じるボタンの表示\n\t */\n\tclosable?: boolean;\n\t/**\n\t * ウィンドウを最小化するボタンの表示\n\t */\n\tminimizable?: boolean;\n\t/**\n\t * ウィンドウを最大化するボタンの表示\n\t */\n\tmaximizable?: boolean;\n\t/**\n\t * ショートカットキーを有効化\n\t */\n\tenableShortcuts?: boolean;\n\t/**\n\t * コントロールの位置\n\t */\n\tcontrolsPosition?: \"left\" | \"right\";\n\t/**\n\t * ウィンドウのコンテンツ\n\t */\n\tcontent?: WindowContentOptions;\n\t/**\n\t * メニュー\n\t */\n\tmenu?: MenuItem[];\n\t/**\n\t * タブ\n\t */\n\ttabs?: TabItem[];\n\ttabOptions?: {\n\t\t/**\n\t\t * タブの入れ替え\n\t\t */\n\t\treorderable?: boolean;\n\t\t/**\n\t\t * タブを閉じるボタン\n\t\t */\n\t\tclosable?: boolean;\n\t\t/**\n\t\t * タブ追加ボタン\n\t\t */\n\t\taddable?: boolean;\n\t\t/**\n\t\t * 追加ボタン押下時の処理\n\t\t */\n\t\tonAdd?: (win: IWindow) => TabItem;\n\t};\n\t/**\n\t * 右クリックメニュー\n\t */\n\tcontextMenu?: ContextMenuItem[];\n\t/**\n\t * ウィンドウオープン時\n\t */\n\tonOpen?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウクローズ時\n\t */\n\tonClose?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウフォーカス時\n\t */\n\tonFocus?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウブラー時\n\t */\n\tonBlur?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウリサイズ時\n\t */\n\tonResize?: (win: IWindow) => void;\n\t/**\n\t * ウィンドウ移動時\n\t */\n\tonMove?: (win: IWindow) => void;\n}\n\nexport interface GlobalConfigOptions {\n\twindowSwitchShortcut?: string | null; // 例: \"Ctrl+`\"\n}\n\n// WinLetの公開APIの型\nexport interface WinLetApi {\n\tinit: () => void;\n\tcreateWindow: (options?: WindowOptions) => IWindow;\n\tgetWindow: (id: string) => IWindow | undefined;\n\tgetActiveWindow: () => IWindow | null;\n\tsetDefaultConfig: (options: WindowOptions) => void;\n\tsetGlobalConfig: (options: GlobalConfigOptions) => void;\n}\n\n// グローバルスコープのWindowにWinLetプロパティを追加\ndeclare global {\n\tinterface Window {\n\t\tWinLet: WinLetApi;\n\t}\n}\n","import { defaultConfig } from \"../const/config\";\nimport { WinLetError } from \"../const/errors\";\nimport { IWindow, LIBRARY_NAME, MenuItem, TabItem, WindowContentOptions, WindowOptions, WindowState } from \"../const/types\";\nimport WinLetBaseClass from \"../libs/baseclass\";\nimport Utils from \"../libs/utils\";\nimport WindowManager from \"./window_manager\";\n\nexport default class WinLetWindow extends WinLetBaseClass implements IWindow {\n\tpublic readonly id: string;\n\tpublic options: Required<WindowOptions>;\n\tpublic el: HTMLElement;\n\tpublic state: WindowState = \"normal\";\n\n\tprivate manager: WindowManager;\n\tprivate lastState = { x: 0, y: 0, width: 0, height: 0 };\n\tprivate focused: boolean = false;\n\n\tprivate titleBarEl: HTMLElement;\n\tprivate iconEl: HTMLElement;\n\tprivate titleEl: HTMLElement;\n\tprivate contentEl: HTMLElement;\n\tprivate tabs: { tabEl: HTMLElement; contentEl: HTMLElement }[] = [];\n\tprivate addTabBtn: HTMLElement | null = null;\n\n\tconstructor(options: WindowOptions, manager: WindowManager) {\n\t\tsuper();\n\t\tthis.id = options.id || Utils.generateId(\"window\");\n\t\tif (options.id) {\n\t\t\tconst existingEl = document.getElementById(options.id);\n\t\t\tif (existingEl && existingEl.classList.contains(`${LIBRARY_NAME}-window`)) {\n\t\t\t\tthrow new WinLetError(`WinLet: Window with ID \"${options.id}\" already exists. New window will not be created.`);\n\t\t\t}\n\t\t}\n\t\tthis.manager = manager;\n\t\tthis.options = Utils.deepMerge(defaultConfig, options) as Required<WindowOptions>;\n\n\t\tthis.el = this.createDOM();\n\t\tthis.titleBarEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title-bar`)!;\n\t\tthis.iconEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-icon`)!;\n\t\tthis.titleEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title`)!;\n\t\tthis.contentEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-content`)!;\n\n\t\tthis.applyOptions();\n\t\tthis.setupEventListeners();\n\n\t\tthis.options.onOpen(this);\n\t}\n\n\tprivate createDOM(): HTMLElement {\n\t\tconst windowEl = document.createElement(\"div\");\n\t\twindowEl.className = `${LIBRARY_NAME}-window`;\n\t\twindowEl.id = this.id;\n\n\t\t// --- リサイズハンドルの生成ロジックを更新 ---\n\t\tconst handles: string[] = [];\n\t\tif (this.options.resizableY) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle n\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle s\"></div>`);\n\t\t}\n\t\tif (this.options.resizableX) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle w\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle e\"></div>`);\n\t\t}\n\t\tif (this.options.resizableX && this.options.resizableY) {\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle nw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ne\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle sw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle se\"></div>`);\n\t\t}\n\t\tconst resizableHandlesHTML = handles.join(\"\");\n\t\twindowEl.innerHTML = `\n            <div class=\"${LIBRARY_NAME}-title-bar\">\n                <div class=\"${LIBRARY_NAME}-icon\"></div>\n                <div class=\"${LIBRARY_NAME}-title\"></div>\n                <div class=\"${LIBRARY_NAME}-controls\">\n                    ${this.options.minimizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-minimize-btn\" type=\"button\" value=\"\\uff3f\" title=\"Minimize\" />` : \"\"}\n                    ${this.options.maximizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-maximize-btn\" type=\"button\" value=\"\\u25a1\" title=\"Maximize\" />` : \"\"}\n                    ${this.options.closable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-close-btn\" type=\"button\" value=\"\\u2573\" title=\"Close\">` : \"\"}\n                </div>\n            </div>\n            <div class=\"${LIBRARY_NAME}-main-content\">\n                ${this.options.menu.length > 0 ? `<div class=\"${LIBRARY_NAME}-menu-bar\"></div>` : \"\"}\n                ${this.options.tabs.length > 0 ? `<div class=\"${LIBRARY_NAME}-tab-bar\"></div>` : \"\"}\n                <div class=\"${LIBRARY_NAME}-content\"></div>\n            </div>\n            ${resizableHandlesHTML}\n        `;\n\t\treturn windowEl;\n\t}\n\n\tprivate applyOptions(): void {\n\t\tthis.setTitle(this.options.title);\n\t\tthis.setIcon(this.options.icon);\n\t\tthis.setSize(this.options.width, this.options.height);\n\t\tthis.setPosition(this.options.x, this.options.y);\n\t\tthis.el.style.minWidth = `${this.options.minWidth}px`;\n\t\tthis.el.style.minHeight = `${this.options.minHeight}px`;\n\n\t\tif (this.options.controlsPosition === \"left\") {\n\t\t\tthis.titleBarEl.classList.add(\"controls-left\");\n\t\t}\n\n\t\tif (this.options.tabs.length > 0) {\n\t\t\tthis.createTabs();\n\t\t} else {\n\t\t\tthis.renderContent(this.contentEl, this.options.content);\n\t\t}\n\n\t\tif (this.options.menu.length > 0) {\n\t\t\tthis.createMenu();\n\t\t}\n\t}\n\n\tprivate renderContent(container: HTMLElement, content: WindowContentOptions): void {\n\t\tcontainer.innerHTML = \"\";\n\t\tif (content.iframe) {\n\t\t\tconst iframe = document.createElement(\"iframe\");\n\t\t\tiframe.src = content.iframe;\n\t\t\tcontainer.appendChild(iframe);\n\t\t} else if (content.template) {\n\t\t\tconst template = document.querySelector<HTMLTemplateElement>(content.template);\n\t\t\tif (template?.tagName === \"TEMPLATE\") {\n\t\t\t\tcontainer.appendChild(template.content.cloneNode(true));\n\t\t\t} else {\n\t\t\t\tcontainer.innerHTML = \"Error: Template not found or invalid.\";\n\t\t\t}\n\t\t} else if (content.html) {\n\t\t\tconst iframe = document.createElement(\"iframe\");\n\t\t\tiframe.srcdoc = content.html;\n\t\t\tcontainer.appendChild(iframe);\n\t\t}\n\t}\n\n\tprivate createMenu(): void {\n\t\tconst menuBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-menu-bar`)!;\n\t\tmenuBar.innerHTML = \"\";\n\n\t\tthis.options.menu.forEach((menuItemData) => {\n\t\t\tconst menuItemEl = document.createElement(\"div\");\n\t\t\tmenuItemEl.className = `${LIBRARY_NAME}-menu-item`;\n\t\t\tmenuItemEl.textContent = menuItemData.name ?? \"\";\n\n\t\t\tif (menuItemData.items) {\n\t\t\t\tconst dropdownEl = this.createDropdownMenu(menuItemData.items);\n\n\t\t\t\tmenuItemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tconsole.log(\"close\");\n\t\t\t\t\t// 他に開いているメニューがあれば閉じる\n\t\t\t\t\tmenuBar.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-menu-dropdown`).forEach((dd) => {\n\t\t\t\t\t\tif (dd !== dropdownEl) dd.style.display = \"none\";\n\t\t\t\t\t});\n\t\t\t\t\t// 現在のメニューの表示をトグルする\n\t\t\t\t\tconst isVisible = dropdownEl.style.display === \"block\";\n\t\t\t\t\tdropdownEl.style.display = isVisible ? \"none\" : \"block\";\n\t\t\t\t});\n\n\t\t\t\tmenuItemEl.appendChild(dropdownEl);\n\t\t\t}\n\t\t\tmenuBar.appendChild(menuItemEl);\n\t\t});\n\n\t\tdocument.addEventListener(\"click\", () => {\n\t\t\tmenuBar.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-menu-dropdown`).forEach((dd) => {\n\t\t\t\tdd.style.display = \"none\";\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate createDropdownMenu(items: MenuItem[]): HTMLUListElement {\n\t\tconst dropdownEl = document.createElement(\"ul\");\n\t\tdropdownEl.className = `${LIBRARY_NAME}-menu-dropdown`;\n\n\t\titems.forEach((itemData) => {\n\t\t\tconst itemEl = document.createElement(\"li\");\n\t\t\tif (itemData.separator) {\n\t\t\t\titemEl.className = \"separator\";\n\t\t\t} else {\n\t\t\t\tlet text = itemData.name ?? \"\";\n\t\t\t\ttext = `<span>${text}</span>`;\n\t\t\t\tif (this.options.enableShortcuts && itemData.shortcut) {\n\t\t\t\t\ttext += ` <span class=\"${LIBRARY_NAME}-shortcut-text\">(${itemData.shortcut})</span>`;\n\t\t\t\t}\n\t\t\t\titemEl.innerHTML = `<div class=\"${LIBRARY_NAME}-menu-dropdown-item\">${text}</div>`;\n\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\titemData.action?.(this);\n\n\t\t\t\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-menu-dropdown`).forEach((dd) => {\n\t\t\t\t\t\tdd.style.display = \"none\";\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tif (itemData.items) {\n\t\t\t\t\titemEl.classList.add(\"has-submenu\"); // スタイル付けのためのクラス\n\t\t\t\t\tconst subMenuEl = this.createDropdownMenu(itemData.items);\n\t\t\t\t\titemEl.appendChild(subMenuEl);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdropdownEl.appendChild(itemEl);\n\t\t});\n\t\treturn dropdownEl;\n\t}\n\n\tprivate createTabs(): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\ttabBar.innerHTML = \"\";\n\t\tthis.tabs = [];\n\t\tconst tabOpts = this.options.tabOptions ?? {};\n\n\t\tthis.options.tabs.forEach((tabData, index) => {\n\t\t\tthis.createTabElement(tabData, index);\n\t\t});\n\n\t\tif (tabOpts.addable) {\n\t\t\tthis.addTabBtn = document.createElement(\"div\");\n\t\t\tthis.addTabBtn.className = `${LIBRARY_NAME}-tab-add-btn`;\n\t\t\tthis.addTabBtn.textContent = \"+\";\n\t\t\tthis.addTabBtn.addEventListener(\"click\", (e) => {\n\t\t\t\tconst newTabItem = tabOpts.onAdd?.(this);\n\t\t\t\tif (newTabItem) {\n\t\t\t\t\tthis.options.tabs.push(newTabItem);\n\t\t\t\t\tconst newIndex = this.options.tabs.length - 1;\n\t\t\t\t\tthis.createTabElement(newTabItem, newIndex);\n\t\t\t\t\tthis.activateTab(newIndex);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttabBar.appendChild(this.addTabBtn);\n\t\t}\n\n\t\tif (this.tabs.length > 0) this.activateTab(0);\n\t}\n\n\tprivate createTabElement(tabData: TabItem, index: number): void {\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\n\t\tconst tabOpts = this.options.tabOptions ?? {};\n\n\t\tconst tabEl = document.createElement(\"div\");\n\t\ttabEl.className = `${LIBRARY_NAME}-tab`;\n\t\ttabEl.dataset.tabId = index.toString(); // IDを紐付け\n\n\t\tconst titleEl = document.createElement(\"span\");\n\t\ttitleEl.textContent = tabData.title;\n\t\ttabEl.appendChild(titleEl);\n\n\t\t// +ボタンが存在すればその前に、なければ末尾に追加\n\t\ttabBar.insertBefore(tabEl, this.addTabBtn);\n\n\t\tif (tabOpts.closable) {\n\t\t\tconst closeBtn = document.createElement(\"span\");\n\t\t\tcloseBtn.className = `${LIBRARY_NAME}-tab-close-btn`;\n\t\t\tcloseBtn.innerHTML = \"&times;\";\n\t\t\tcloseBtn.addEventListener(\"click\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.closeTab(index);\n\t\t\t});\n\t\t\ttabEl.appendChild(closeBtn);\n\t\t}\n\n\t\t// タブコンテント生成ロジック\n\t\tconst tabContentEl = document.createElement(\"div\");\n\t\ttabContentEl.className = `${LIBRARY_NAME}-tab-content`;\n\t\tthis.contentEl.appendChild(tabContentEl);\n\t\tthis.renderContent(tabContentEl, tabData.content);\n\n\t\ttabEl.addEventListener(\"click\", (e) => {\n\t\t\tthis.activateTab(+tabEl.dataset.tabId!);\n\t\t});\n\t\tthis.tabs.splice(index, 0, { tabEl, contentEl: tabContentEl }); // 指定位置に挿入\n\n\t\tif (tabOpts.reorderable) {\n\t\t\tthis.makeTabReorderable(tabEl);\n\t\t}\n\t}\n\n\tprivate makeTabReorderable(tabEl: HTMLElement) {\n\t\ttabEl.draggable = true;\n\t\ttabEl.addEventListener(\"dragstart\", (e) => {\n\t\t\te.dataTransfer!.setData(\"text/plain\", tabEl.dataset.tabId!);\n\t\t\ttabEl.classList.add(\"dragging\");\n\t\t});\n\t\ttabEl.addEventListener(\"dragend\", () => tabEl.classList.remove(\"dragging\"));\n\n\t\ttabEl.addEventListener(\n\t\t\t\"dragover\",\n\t\t\t(e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst draggingEl = document.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.dragging`);\n\t\t\t\tif (draggingEl && draggingEl !== tabEl) {\n\t\t\t\t\tconst rect = tabEl.getBoundingClientRect();\n\t\t\t\t\t// カーソルの位置によって挿入位置を左右に決める\n\t\t\t\t\tconst isAfter = e.clientX > rect.left + rect.width / 2;\n\t\t\t\t\tconst parent = tabEl.parentNode!;\n\t\t\t\t\tif (isAfter) {\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl.nextSibling);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\n\t\ttabEl.addEventListener(\n\t\t\t\"drop\",\n\t\t\t(e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\t// ここでtabsとoptions.tabs配列の順序も実際に入れ替えるロジックを実装\n\t\t\t\t// (DOMの順序を元に配列を再構築するのが簡単)\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\t}\n\n\t// タブを閉じるロジック\n\tprivate closeTab(index: number) {\n\t\t// DOMから要素を削除\n\t\tthis.tabs[index].tabEl.remove();\n\t\tthis.tabs[index].contentEl.remove();\n\t\t// 配列から削除\n\t\tthis.tabs.splice(index, 1);\n\t\tthis.options.tabs.splice(index, 1);\n\n\t\t// IDの再割り当て\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\n\n\t\t// アクティブなタブを再設定\n\t\tif (this.tabs.length > 0) {\n\t\t\tconst newActiveIndex = Math.max(0, index - 1);\n\t\t\tthis.activateTab(newActiveIndex);\n\t\t}\n\t}\n\n\tprivate activateTab(index: number): void {\n\t\tthis.tabs.forEach((tab, i) => {\n\t\t\ttab.tabEl.classList.toggle(\"active\", i === index);\n\t\t\ttab.contentEl.classList.toggle(\"active\", i === index);\n\t\t});\n\t}\n\n\tprivate setupEventListeners(): void {\n\t\tthis.el.addEventListener(\"click\", () => this.focus(), true);\n\n\t\t// iframeなどにフォーカスが移った際にウィンドウ自体をアクティブにする\n\t\tthis.el.addEventListener(\"focusin\", () => this.focus());\n\n\t\tconst closeBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-close-btn`);\n\t\tcloseBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tthis.close();\n\t\t});\n\n\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\tmaxBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tthis.toggleMaximize();\n\t\t});\n\n\t\tconst minBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-minimize-btn`);\n\t\tminBtn?.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\tthis.minimize();\n\t\t});\n\n\t\tif (this.options.movable) this.makeMovable();\n\t\tif (this.options.resizableX || this.options.resizableY) this.makeResizable();\n\t\tif (this.options.contextMenu.length > 0) {\n\t\t\tthis.el.addEventListener(\n\t\t\t\t\"contextmenu\",\n\t\t\t\t(e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\n\t\t\t\t},\n\t\t\t\t{ passive: false }\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate makeMovable(): void {\n\t\tconst onMouseDown = (e: MouseEvent) => {\n\t\t\tif ((e.target as HTMLElement).closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-resize-handle, .${LIBRARY_NAME}-menu-bar, .${LIBRARY_NAME}-tab-bar`)) return;\n\t\t\te.preventDefault();\n\t\t\tthis.focus();\n\n\t\t\tif (this.state === \"maximized\") {\n\t\t\t\tconst restoredWidth = this.lastState.width;\n\t\t\t\t// マウスポインタがウィンドウのどのあたり（横方向の割合）にあるか計算\n\t\t\t\tconst clickRatio = e.clientX / this.el.offsetWidth;\n\n\t\t\t\t// タイトルバー内でのクリックY座標を維持して位置を設定\n\t\t\t\tconst titleBarRect = this.titleBarEl.getBoundingClientRect();\n\t\t\t\tconst offsetY = e.clientY - titleBarRect.top;\n\t\t\t\tconst posX = e.clientX - restoredWidth * clickRatio;\n\t\t\t\tconst posY = e.clientY - offsetY;\n\n\t\t\t\t// 状態を戻す\n\t\t\t\tthis.restore();\n\t\t\t\tthis.setPosition(posX, posY);\n\t\t\t}\n\n\t\t\tthis.contentEl.style.pointerEvents = \"none\";\n\n\t\t\t// ドラッグ開始時の情報を取得（最大化からの復元後、座標が変化しているため再取得する）\n\t\t\tconst { clientX: startX, clientY: startY } = e;\n\t\t\tconst { offsetLeft: initialLeft, offsetTop: initialTop } = this.el;\n\n\t\t\tconst onMouseMove = (moveE: MouseEvent) => {\n\t\t\t\tconst newLeft = initialLeft + moveE.clientX - startX;\n\t\t\t\tconst newTop = initialTop + moveE.clientY - startY;\n\t\t\t\tthis.setPosition(newLeft, newTop);\n\t\t\t};\n\t\t\tconst onMouseUp = () => {\n\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\n\n\t\t\t\tdocument.removeEventListener(\"mousemove\", onMouseMove);\n\t\t\t\tdocument.removeEventListener(\"mouseup\", onMouseUp);\n\t\t\t\tthis.options.onMove(this);\n\t\t\t};\n\t\t\tdocument.addEventListener(\"mousemove\", onMouseMove);\n\t\t\tdocument.addEventListener(\"mouseup\", onMouseUp);\n\t\t};\n\t\tthis.titleBarEl.addEventListener(\"mousedown\", onMouseDown, { passive: false });\n\t}\n\n\tprivate makeResizable(): void {\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-resize-handle`).forEach((handle) => {\n\t\t\thandle.addEventListener(\n\t\t\t\t\"mousedown\",\n\t\t\t\t(e: MouseEvent) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\n\n\t\t\t\t\tconst direction = handle.className.replace(`${LIBRARY_NAME}-resize-handle `, \"\");\n\t\t\t\t\tconst { clientX: startX, clientY: startY } = e;\n\t\t\t\t\tconst { offsetWidth: startWidth, offsetHeight: startHeight, offsetLeft: startLeft, offsetTop: startTop } = this.el;\n\t\t\t\t\tconst { minWidth, minHeight } = this.options;\n\n\t\t\t\t\tconst onMouseMove = (moveE: MouseEvent) => {\n\t\t\t\t\t\tlet newWidth = startWidth,\n\t\t\t\t\t\t\tnewHeight = startHeight,\n\t\t\t\t\t\t\tnewLeft = startLeft,\n\t\t\t\t\t\t\tnewTop = startTop;\n\t\t\t\t\t\tconst deltaX = moveE.clientX - startX;\n\t\t\t\t\t\tconst deltaY = moveE.clientY - startY;\n\n\t\t\t\t\t\tif (direction.includes(\"e\")) newWidth = Math.max(minWidth, startWidth + deltaX);\n\t\t\t\t\t\tif (direction.includes(\"w\")) {\n\t\t\t\t\t\t\tnewWidth = Math.max(minWidth, startWidth - deltaX);\n\t\t\t\t\t\t\tnewLeft = startLeft + deltaX;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (direction.includes(\"s\")) newHeight = Math.max(minHeight, startHeight + deltaY);\n\t\t\t\t\t\tif (direction.includes(\"n\")) {\n\t\t\t\t\t\t\tnewHeight = Math.max(minHeight, startHeight - deltaY);\n\t\t\t\t\t\t\tnewTop = startTop + deltaY;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setSize(newWidth, newHeight);\n\t\t\t\t\t\tthis.setPosition(newLeft, newTop);\n\t\t\t\t\t};\n\t\t\t\t\tconst onMouseUp = () => {\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\n\n\t\t\t\t\t\tdocument.removeEventListener(\"mousemove\", onMouseMove);\n\t\t\t\t\t\tdocument.removeEventListener(\"mouseup\", onMouseUp);\n\t\t\t\t\t\tthis.options.onResize(this);\n\t\t\t\t\t};\n\t\t\t\t\tdocument.addEventListener(\"mousemove\", onMouseMove);\n\t\t\t\t\tdocument.addEventListener(\"mouseup\", onMouseUp);\n\t\t\t\t},\n\t\t\t\t{ passive: false }\n\t\t\t);\n\t\t});\n\t}\n\n\tprivate isFontAwesome(classStr: string): boolean {\n\t\tconst classes = classStr.trim().split(/\\s+/);\n\t\tconst hasPrefix = classes.some((c) => /^fa[bslr]?$/.test(c));\n\t\tconst hasIcon = classes.some((c) => /^fa-[a-z0-9-]+$/.test(c));\n\t\treturn hasPrefix && hasIcon;\n\t}\n\n\t// --- Public API ---\n\n\tpublic close(): void {\n\t\tthis.options.onClose(this);\n\t\tthis.manager.destroyWindow(this.id);\n\t}\n\n\tpublic minimize(): void {\n\t\tif (this.state !== \"minimized\") {\n\t\t\tthis.state = \"minimized\";\n\t\t\tthis.el.classList.add(\"minimized\");\n\t\t\tthis.blur();\n\t\t}\n\t}\n\n\tpublic toggleMaximize(): void {\n\t\tthis.state === \"maximized\" ? this.restore() : this.maximize();\n\t}\n\n\tpublic maximize(): void {\n\t\tif (this.state !== \"maximized\") {\n\t\t\tthis.lastState = { x: this.el.offsetLeft, y: this.el.offsetTop, width: this.el.offsetWidth, height: this.el.offsetHeight };\n\t\t\tthis.state = \"maximized\";\n\t\t\tthis.el.classList.add(\"maximized\");\n\t\t\tthis.setPosition(0, 0);\n\t\t\tthis.setSize(\"100%\", \"100%\");\n\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\t\tif (maxBtn) {\n\t\t\t\tmaxBtn.title = \"Restore\";\n\t\t\t\tmaxBtn.value = \"\\u274f\";\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic restore(): void {\n\t\tif (this.state === \"minimized\") {\n\t\t\tthis.state = \"normal\";\n\t\t\tthis.el.classList.remove(\"minimized\");\n\t\t\tthis.focus();\n\t\t} else if (this.state === \"maximized\") {\n\t\t\tthis.state = \"normal\";\n\t\t\tthis.el.classList.remove(\"maximized\");\n\t\t\tthis.setSize(this.lastState.width, this.lastState.height);\n\t\t\tthis.setPosition(this.lastState.x, this.lastState.y);\n\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\n\t\t\tif (maxBtn) {\n\t\t\t\tmaxBtn.title = \"Maximize\";\n\t\t\t\tmaxBtn.value = \"\\u25a1\";\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic focus(): void {\n\t\tif (this.focused) return;\n\t\tthis.manager.focusWindow(this);\n\t\tthis.focused = true;\n\t\tthis.el.classList.add(\"active\");\n\t\tthis.options.onFocus(this);\n\t}\n\n\tpublic blur(): void {\n\t\tif (!this.focused) return;\n\t\tthis.focused = false;\n\t\tthis.el.classList.remove(\"active\");\n\t\tthis.options.onBlur(this);\n\t}\n\n\tpublic setTitle(title: string): void {\n\t\tthis.options.title = title;\n\t\tthis.titleEl.textContent = Utils.sanitizeHTML(title);\n\t}\n\n\tpublic setIcon(icon: string | null): void {\n\t\tthis.options.icon = icon;\n\t\tthis.iconEl.innerHTML = \"\";\n\t\tif (!icon) return;\n\n\t\tif (this.isFontAwesome(icon)) {\n\t\t\tconst i = document.createElement(\"i\");\n\t\t\ti.className = icon;\n\t\t\tthis.iconEl.appendChild(i);\n\t\t} else {\n\t\t\tconst img = document.createElement(\"img\");\n\t\t\timg.src = icon;\n\t\t\timg.alt = \"window icon\";\n\t\t\tthis.iconEl.appendChild(img);\n\t\t}\n\t}\n\n\tpublic setPosition(x: number | \"center\", y: number | \"center\"): void {\n\t\t// containerが存在しない（初期化前）場合は処理を中断\n\t\tif (!this.manager.container) {\n\t\t\tconsole.warn(\"WinLet Warning: setPosition called before manager is initialized.\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst parentRect = this.manager.container.getBoundingClientRect();\n\t\tif (x === \"center\") x = (parentRect.width - this.el.offsetWidth) / 2;\n\t\tif (y === \"center\") y = (parentRect.height - this.el.offsetHeight) / 2;\n\t\tthis.el.style.left = `${Math.min(Math.max(150 - this.el.offsetWidth, x), parentRect.width - 20)}px`;\n\t\tthis.el.style.top = `${Math.min(Math.max(0, y), parentRect.height - 50)}px`;\n\t}\n\n\tpublic setSize(width: number | string, height: number | string): void {\n\t\tthis.el.style.width = typeof width === \"number\" ? `${width}px` : width;\n\t\tthis.el.style.height = typeof height === \"number\" ? `${height}px` : height;\n\t}\n}\n","// src/WindowManager.ts\n\nimport { WinLetError } from \"../const/errors\";\nimport { ContextMenuItem, GlobalConfigOptions, IWindow, LIBRARY_NAME, MenuItem, WindowOptions } from \"../const/types\";\nimport WinLetBaseClass from \"../libs/baseclass\";\nimport styleData from \"../style/styles\";\nimport WinLetWindow from \"./window\";\n\nexport default class WindowManager extends WinLetBaseClass {\n\tpublic container: HTMLElement | null = null;\n\tprivate windows = new Map<string, WinLetWindow>();\n\tprivate zIndexCounter = 1000;\n\tprivate activeWindow: WinLetWindow | null = null;\n\tprivate contextMenuEl: HTMLElement | null = null;\n\tprivate isInitialized = false;\n\n\tprivate globalConfig: Required<GlobalConfigOptions>;\n\tprivate isSwitchListenerAttached = false;\n\n\tconstructor(initialConfig: Required<GlobalConfigOptions>) {\n\t\tsuper();\n\t\tthis.globalConfig = initialConfig;\n\t}\n\n\tpublic applyGlobalConfig(options: GlobalConfigOptions) {\n\t\tObject.assign(this.globalConfig, options);\n\t}\n\n\tpublic init(): void {\n\t\tif (this.isInitialized) {\n\t\t\treturn;\n\t\t}\n\t\tif (!document.body) {\n\t\t\tthrow new WinLetError(\"Cannot initialize before document.body is ready. Please call WinLet.init() after DOMContentLoaded.\");\n\t\t}\n\n\t\tif (!document.getElementById(`${LIBRARY_NAME}-styles`)) {\n\t\t\tconst styleTag = document.createElement(\"style\");\n\t\t\tstyleTag.id = `${LIBRARY_NAME}-styles`;\n\t\t\tstyleTag.innerHTML = this.getStyleData();\n\t\t\tdocument.head.appendChild(styleTag);\n\t\t}\n\t\tlet containerEl = document.querySelector<HTMLElement>(`.${LIBRARY_NAME}-container`);\n\t\tif (!containerEl) {\n\t\t\tcontainerEl = document.createElement(\"div\");\n\t\t\tcontainerEl.className = `${LIBRARY_NAME}-container`;\n\t\t\tdocument.body.appendChild(containerEl);\n\t\t}\n\t\tthis.container = containerEl;\n\n\t\twindow.addEventListener(\"blur\", () => {\n\t\t\t// 次のイベントサイクルでアクティブな要素を取得\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tconst activeEl = document.activeElement;\n\t\t\t\t// フォーカスがiframeに移った場合\n\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\n\t\t\t\t\t// そのiframeがWinLetのウィンドウ内にあるか探索\n\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\t\t\t\tif (winEl) {\n\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\n\t\t\t\t\t\t// 対象のウィンドウが存在し、まだアクティブでなければフォーカスする\n\t\t\t\t\t\tif (win && this.activeWindow !== win) {\n\t\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tdocument.addEventListener(\n\t\t\t\"mousedown\",\n\t\t\t() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tconst activeEl = document.activeElement;\n\t\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\n\t\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\n\t\t\t\t\t\tif (winEl) {\n\t\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\n\t\t\t\t\t\t\tif (win && this.activeWindow !== win) {\n\t\t\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\t// ウィンドウ外クリックでblurさせる処理を追加\n\t\tthis.container!.addEventListener(\"mousedown\", (e) => {\n\t\t\t// クリックされたのがコンテナ自身（ウィンドウやその中身ではない）の場合\n\t\t\tif (e.target === this.container) {\n\t\t\t\tif (this.activeWindow) {\n\t\t\t\t\tconst active = this.activeWindow;\n\t\t\t\t\tthis.activeWindow = null; // 先にnullにしてからblurを呼ぶ\n\t\t\t\t\tactive.blur();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener(\"click\", () => this.hideContextMenu());\n\n\t\twindow.addEventListener(\"message\", (event) => {\n\t\t\t// メッセージの形式を検証\n\t\t\tif (event.data && event.data.type === \"winlet:createWindow\" && typeof event.data.options === \"object\") {\n\t\t\t\t// メッセージの送信元が管理下のiframeか検証（セキュリティ対策）\n\t\t\t\tlet isSourceValid = false;\n\t\t\t\tfor (const win of this.windows.values()) {\n\t\t\t\t\tconst iframe = win.el.querySelector(\"iframe\");\n\t\t\t\t\tif (iframe && iframe.contentWindow === event.source) {\n\t\t\t\t\t\tisSourceValid = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (isSourceValid) {\n\t\t\t\t\tthis.createWindow(event.data.options);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"WinLet: Untrusted source attempted to create a window.\", event.origin);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.isInitialized = true;\n\t\tthis.setupShortcutListeners();\n\t}\n\n\t// ショートカットキーのリスナーを統合\n\tprivate setupShortcutListeners() {\n\t\tdocument.addEventListener(\n\t\t\t\"keydown\",\n\t\t\t(e) => {\n\t\t\t\t// --- 1. グローバルショートカット (ウィンドウ切り替え) ---\n\t\t\t\tif (this.globalConfig.windowSwitchShortcut) {\n\t\t\t\t\tconst shortcut = this.parseShortcut(this.globalConfig.windowSwitchShortcut);\n\n\t\t\t\t\tif (e.key.toLowerCase() === shortcut.key.toLowerCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst windows = Array.from(this.windows.values());\n\n\t\t\t\t\t\tconst currentIndex = this.activeWindow ? windows.findIndex((w) => w === this.activeWindow) : -1;\n\t\t\t\t\t\tconst nextIndex = (currentIndex + 1) % windows.length;\n\n\t\t\t\t\t\tconst win = windows[nextIndex];\n\t\t\t\t\t\tif (win.state === \"minimized\") {\n\t\t\t\t\t\t\twin.restore();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twin.focus();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// --- 2. ウィンドウ固有のショートカット ---\n\t\t\t\tconst targetWindow = this.activeWindow;\n\n\t\t\t\t// ターゲットウィンドウがなければ何もしない\n\t\t\t\tif (!targetWindow || !targetWindow.options.enableShortcuts) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// --- 3. ショートカットキーを検索して実行 ---\n\t\t\t\tconst findAndExecShortcut = (menuItems: MenuItem[]) => {\n\t\t\t\t\tfor (const item of menuItems) {\n\t\t\t\t\t\tif (item.shortcut) {\n\t\t\t\t\t\t\tconst shortcut = this.parseShortcut(item.shortcut);\n\t\t\t\t\t\t\tconsole.log(shortcut, e.key);\n\t\t\t\t\t\t\tif (e.key.toUpperCase() === shortcut.key.toUpperCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\titem.action?.(targetWindow!);\n\t\t\t\t\t\t\t\treturn true; // 実行したら探索終了\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (item.items && findAndExecShortcut(item.items)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\t\tfindAndExecShortcut(targetWindow.options.menu);\n\t\t\t},\n\t\t\t{ passive: false }\n\t\t);\n\t}\n\n\t// 未初期化の場合に自動でinitを呼び出すヘルパー\n\tprivate ensureInitialized(): void {\n\t\tif (!this.isInitialized) {\n\t\t\tthis.init();\n\t\t}\n\t}\n\n\t/**\n\t * スタイルシートを取得\n\t */\n\tprivate getStyleData() {\n\t\treturn styleData.replace(/\\$\\[(\\w+)\\]/g, (a, p) => {\n\t\t\tswitch (p) {\n\t\t\t\tcase \"prefix\":\n\t\t\t\t\treturn LIBRARY_NAME;\n\t\t\t}\n\t\t\treturn p;\n\t\t});\n\t}\n\n\tpublic createWindow(options: WindowOptions): WinLetWindow {\n\t\tthis.ensureInitialized();\n\n\t\tconst ifExists = options.ifExists ?? \"focus\";\n\n\t\tif (options.id && ifExists !== \"create\") {\n\t\t\tconst existingWindow = this.getWindow(options.id);\n\t\t\tif (existingWindow) {\n\t\t\t\tif (ifExists === \"prevent\") {\n\t\t\t\t\treturn existingWindow; // 何もせず既存インスタンスを返す\n\t\t\t\t}\n\t\t\t\tif (ifExists === \"focus\") {\n\t\t\t\t\tif (existingWindow.state === \"minimized\") {\n\t\t\t\t\t\texistingWindow.restore();\n\t\t\t\t\t}\n\t\t\t\t\texistingWindow.focus();\n\t\t\t\t\treturn existingWindow; // フォーカスして既存インスタンスを返す\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst win = new WinLetWindow(options, this);\n\t\tthis.windows.set(win.id, win);\n\t\tthis.container!.appendChild(win.el);\n\t\tthis.focusWindow(win);\n\t\treturn win;\n\t}\n\n\tpublic destroyWindow(id: string): void {\n\t\tthis.ensureInitialized();\n\t\tconst win = this.windows.get(id);\n\t\tif (win) {\n\t\t\twin.el.remove();\n\t\t\tthis.windows.delete(id);\n\t\t\tif (this.activeWindow === win) {\n\t\t\t\tthis.activeWindow = null;\n\t\t\t\tconst nextWin = Array.from(this.windows.values()).pop();\n\t\t\t\tif (nextWin) this.focusWindow(nextWin);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic focusWindow(win: WinLetWindow): void {\n\t\tthis.ensureInitialized();\n\t\tif (this.activeWindow === win) return;\n\n\t\tthis.activeWindow?.blur();\n\t\tthis.activeWindow = win;\n\t\twin.el.style.zIndex = `${++this.zIndexCounter}`;\n\t\t// focus()はWindowクラス側で呼ばれるので不要\n\t}\n\n\tpublic getWindow(id: string): WinLetWindow | undefined {\n\t\tthis.ensureInitialized();\n\t\treturn this.windows.get(id);\n\t}\n\n\tpublic getActiveWindow(): WinLetWindow | null {\n\t\tthis.ensureInitialized();\n\t\treturn this.activeWindow;\n\t}\n\n\tpublic showContextMenu(x: number, y: number, menuItems: ContextMenuItem[], contextWindow: IWindow): void {\n\t\tthis.ensureInitialized();\n\t\tthis.hideContextMenu();\n\n\t\tthis.contextMenuEl = document.createElement(\"ul\");\n\t\tthis.contextMenuEl.className = `${LIBRARY_NAME}-context-menu`;\n\n\t\tmenuItems.forEach((itemData) => {\n\t\t\tconst itemEl = document.createElement(\"li\");\n\t\t\tif (itemData.separator) {\n\t\t\t\titemEl.className = \"separator\";\n\t\t\t} else {\n\t\t\t\titemEl.textContent = itemData.name ?? \"\";\n\t\t\t\titemEl.onclick = (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\titemData.action?.(contextWindow);\n\t\t\t\t\tthis.hideContextMenu();\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis.contextMenuEl!.appendChild(itemEl);\n\t\t});\n\n\t\tthis.container!.appendChild(this.contextMenuEl);\n\n\t\tconst { offsetWidth: menuWidth, offsetHeight: menuHeight } = this.contextMenuEl;\n\t\tconst { innerWidth: screenWidth, innerHeight: screenHeight } = window;\n\n\t\tthis.contextMenuEl.style.left = x + menuWidth > screenWidth ? `${screenWidth - menuWidth}px` : `${x}px`;\n\t\tthis.contextMenuEl.style.top = y + menuHeight > screenHeight ? `${screenHeight - menuHeight}px` : `${y}px`;\n\t}\n\n\tpublic hideContextMenu(): void {\n\t\tthis.contextMenuEl?.remove();\n\t\tthis.contextMenuEl = null;\n\t}\n\n\t/**\n\t * ショートカット文字列を解析し、修飾キーと主キーのオブジェクトを返す\n\t * @param shortcut - \"Ctrl+Shift+K\"のような文字列\n\t */\n\tprivate parseShortcut(shortcut: string): { ctrl: boolean; alt: boolean; shift: boolean; key: string } {\n\t\tconst keys = shortcut.split(\"+\");\n\t\tconst key = keys.pop() || \"\"; // 主キーを配列から取り出す\n\t\tconst ctrl = keys.includes(\"Ctrl\");\n\t\tconst alt = keys.includes(\"Alt\");\n\t\tconst shift = keys.includes(\"Shift\");\n\t\treturn { ctrl, alt, shift, key };\n\t}\n}\n","// src/index.ts\n\nimport { defaultConfig } from \"./const/config\";\nimport { GlobalConfigOptions, IWindow, WindowOptions, WinLetApi } from \"./const/types\";\nimport WindowManager from \"./function/window_manager\";\nimport Utils from \"./libs/utils\";\n\nconst globalConfig: Required<GlobalConfigOptions> = {\n\twindowSwitchShortcut: \"Ctrl+`\", // デフォルトショートカット（バッククォート）\n};\n\n// シングルトンインスタンス\nconst manager = new WindowManager(globalConfig);\n\n// 公開するAPI\nconst api: WinLetApi = {\n\t/**\n\t * ライブラリを初期化します。DOMの準備ができた後に呼び出してください。\n\t * (例: document.addEventListener('DOMContentLoaded', WinLet.init);)\n\t */\n\tinit: (): void => {\n\t\tmanager.init();\n\t},\n\n\t/**\n\t * 新しいウィンドウを作成\n\t */\n\tcreateWindow: (options: WindowOptions = {}): IWindow => {\n\t\treturn manager.createWindow(options);\n\t},\n\n\t/**\n\t * ウィンドウを取得\n\t */\n\tgetWindow: (id: string): IWindow | undefined => {\n\t\treturn manager.getWindow(id);\n\t},\n\n\t/**\n\t * アクティブなウィンドウを取得\n\t */\n\tgetActiveWindow: (): IWindow | null => {\n\t\treturn manager.getActiveWindow();\n\t},\n\n\t/**\n\t * デフォルトのウィンドウ設定を変更\n\t */\n\tsetDefaultConfig: (options: WindowOptions): void => {\n\t\tUtils.deepMerge(defaultConfig, options);\n\t},\n\n\t/**\n\t * グローバル設定を変更\n\t */\n\tsetGlobalConfig: (options: GlobalConfigOptions): void => {\n\t\tObject.assign(globalConfig, options);\n\t\tmanager.applyGlobalConfig(globalConfig);\n\t},\n};\n\n// グローバルスコープにAPIをアタッチ\nwindow.WinLet = api;\n\n// モジュールとしてエクスポートも可能\nexport default api;\n","export default class WinLetBaseClass {}\n","import WinLetBaseClass from \"./baseclass\";\n\nexport default class Utils extends WinLetBaseClass {\n\t/**\n\t * ユニークなIDを生成します。\n\t * @param prefix - IDのプレフィックス\n\t * @returns 生成されたID\n\t */\n\tpublic static generateId(prefix: string = \"win\"): string {\n\t\treturn `${prefix}-${Math.random().toString(36).substring(2, 9)}`;\n\t}\n\n\t/**\n\t * オブジェクトをディープマージします。\n\t */\n\tpublic static deepMerge<T extends object, U extends object>(target: T, source: U): T & U {\n\t\tconst output = { ...target } as T & U;\n\n\t\tfor (const key in source) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(source, key)) {\n\t\t\t\tconst sourceValue = source[key];\n\t\t\t\tconst targetValue = (target as any)[key];\n\n\t\t\t\tif (Array.isArray(sourceValue)) {\n\t\t\t\t\t// ソースの値が配列の場合は、そのまま上書きする\n\t\t\t\t\t(output as any)[key] = sourceValue;\n\t\t\t\t} else if (sourceValue instanceof Object && typeof sourceValue !== \"function\" && targetValue instanceof Object) {\n\t\t\t\t\t(output as any)[key] = this.deepMerge(targetValue, sourceValue);\n\t\t\t\t} else {\n\t\t\t\t\t(output as any)[key] = sourceValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\t/**\n\t * HTML文字列をサニタイズします。\n\t * @param str - サニタイズする文字列\n\t * @returns サニタイズされたHTML文字列\n\t */\n\tpublic static sanitizeHTML(str: string): string {\n\t\tconst temp = document.createElement(\"div\");\n\t\ttemp.textContent = str;\n\t\treturn temp.innerHTML;\n\t}\n}\n","const styleData: string = `\n:root {\n    --$[prefix]-bg: #f0f0f0;\n    --$[prefix]-border: #a0a0a0;\n    --$[prefix]-title-bar-height: 32px;\n    --$[prefix]-title-bar-bg: #e0e0e0;\n    --$[prefix]-title-bar-active-bg: #0078d7;\n    --$[prefix]-title-text-color: #000;\n    --$[prefix]-title-text-active-color: #fff;\n    --$[prefix]-control-bg: #d0d0d0;\n    --$[prefix]-control-hover-bg: #e5e5e5;\n    --$[prefix]-control-close-hover-bg: #e81123;\n    --$[prefix]-control-close-hover-color: #fff;\n    --$[prefix]-menu-bg: #fff;\n    --$[prefix]-menu-border: #ccc;\n    --$[prefix]-menu-item-color: #000;\n    --$[prefix]-menu-item-hover-bg: #0078d7;\n    --$[prefix]-menu-item-hover-color: #fff;\n    --$[prefix]-tab-bg: #dcdcdc;\n    --$[prefix]-tab-active-bg: #f0f0f0;\n    --$[prefix]-tab-border: #b0b0b0;\n}\n\n.$[prefix]-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    overflow: hidden;\n    z-index: 999;\n}\n\n.$[prefix]-window {\n    position: absolute;\n    display: flex;\n    flex-direction: column;\n    min-width: 200px;\n    min-height: 150px;\n    border: 1px solid var(--$[prefix]-border);\n    background-color: var(--$[prefix]-bg);\n    box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n    border-radius: 5px;\n    overflow: hidden;\n    pointer-events: all;\n    transition: opacity 0.1s, transform 0.1s;\n}\n\n.$[prefix]-window.minimized {\n    display: none; /* Simple hide, could be enhanced with a taskbar */\n}\n\n.$[prefix]-window.maximized {\n    border-radius: 0;\n    border: none;\n}\n\n/* Focus State */\n.$[prefix]-window.active .$[prefix]-title-bar {\n    background-color: var(--$[prefix]-title-bar-active-bg);\n    color: var(--$[prefix]-title-text-active-color);\n}\n.$[prefix]-window.active .$[prefix]-title-bar .$[prefix]-title {\n    color: var(--$[prefix]-title-text-active-color);\n}\n\n.$[prefix]-title-bar {\n    display: flex;\n    align-items: center;\n    height: var(--$[prefix]-title-bar-height);\n    background-color: var(--$[prefix]-title-bar-bg);\n    color: var(--$[prefix]-title-text-color);\n    user-select: none;\n    cursor: move;\n    flex-shrink: 0;\n}\n\n.$[prefix]-title-bar.controls-left {\n    flex-direction: row-reverse;\n}\n\n.$[prefix]-icon {\n    min-width: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    height: calc(var(--$[prefix]-title-bar-height) * 0.75);\n    margin: 0 4px;\n    pointer-events: none;\n}\n\n.$[prefix]-icon i {\n        font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\n        line-height: calc(var(--$[prefix]-title-bar-height) * 0.75);\n        text-align: center;\n        display: block;\n        width: 100%;\n        height: 100%;\n}\n\n.$[prefix]-icon img {\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n.$[prefix]-title {\n    flex-grow: 1;\n    padding: 0 8px;\n    font-family: sans-serif;\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.44);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    pointer-events: none;\n}\n\n.$[prefix]-title-bar.controls-left .$[prefix]-title {\n    text-align: right;\n}\n\n.$[prefix]-controls {\n    display: flex;\n    height: 100%;\n    margin-left: auto;\n}\n\n.$[prefix]-title-bar.controls-left .$[prefix]-controls {\n    margin-left: 0;\n    margin-right: auto;\n    flex-direction: row-reverse;\n}\n\n.$[prefix]-control-btn {\n    width: calc(var(--$[prefix]-title-bar-height) * 1.3);\n    height: 100%;\n    border: none;\n    box-sizing: border-box;\n    background-color: transparent;\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\n    cursor: pointer;\n    text-align: center;\n    vertical-align: middle;\n    font-family: sans-serif;\n    transition: background-color 0.2s;\n}\n\n.$[prefix]-control-btn:hover {\n    background-color: var(--$[prefix]-control-hover-bg);\n}\n\n.$[prefix]-control-btn.$[prefix]-close-btn:hover {\n    background-color: var(--$[prefix]-control-close-hover-bg);\n    color: var(--$[prefix]-control-close-hover-color);\n}\n\n.$[prefix]-main-content {\n    all: initial;\n    display:flex;\n    flex-direction:column;\n    flex-grow:1;\n    overflow:hidden;\n}\n\n.$[prefix]-menu-bar {\n    display: flex;\n    background-color: var(--$[prefix]-bg);\n    padding: 2px;\n    flex-shrink: 0;\n    border-bottom: 1px solid var(--$[prefix]-border);\n}\n\n.$[prefix]-menu-item {\n    font-family: sans-serif;\n    font-size: 14px;\n    padding: 4px 8px;\n    cursor: default;\n    position: relative;\n}\n\n.$[prefix]-menu-item:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n\n.$[prefix]-menu-dropdown {\n    color: var(--$[prefix]-menu-item-color);\n    display: none;\n    position: absolute;\n    top: 100%;\n    left: 0;\n    background-color: var(--$[prefix]-menu-bg);\n    border: 1px solid var(--$[prefix]-menu-border);\n    box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n    list-style: none;\n    margin: 0;\n    padding: 4px 0;\n    min-width: 150px;\n    z-index: 10;\n}\n\n.$[prefix]-menu-dropdown li {\n    padding: 5px 20px;\n    font-size: 14px;\n    cursor: pointer;\n}\n\n.$[prefix]-menu-dropdown li:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n\n.$[prefix]-menu-dropdown li.separator {\n    height: 1px;\n    background-color: var(--$[prefix]-menu-border);\n    margin: 4px 0;\n    padding: 0;\n}\n\n.$[prefix]-menu-dropdown-item {\n    display: flex;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    width: 100%;\n    white-space: nowrap;\n}\n\n/* --- メニュー --- */\n/* サブメニューを持つ項目のスタイル */\n.$[prefix]-menu-dropdown li.has-submenu {\n    position: relative;\n}\n.$[prefix]-menu-dropdown li.has-submenu::after {\n    content: '▶';\n    position: absolute;\n    right: 10px;\n    font-size: 0.8em;\n    color: inherit;\n}\n\n/* ネストされたサブメニューの表示位置 */\n.$[prefix]-menu-dropdown li.has-submenu > .$[prefix]-menu-dropdown {\n    top: -5px; /* liのpaddingを考慮 */\n    left: 100%;\n}\n\n/* サブメニューはホバーで開く */\n.$[prefix]-menu-dropdown li.has-submenu:hover > .$[prefix]-menu-dropdown {\n    display: block;\n}\n\n/* ショートカットキーテキストのスタイル */\n.$[prefix]-shortcut-text {\n    color: #666;\n    margin-left: 1em;\n}\n.$[prefix]-menu-dropdown li:hover .$[prefix]-shortcut-text {\n    color: inherit;\n}\n\n/* --- タブ --- */\n.$[prefix]-tab-bar {\n    overflow-x: auto;\n    overflow-y: hidden;\n    -ms-overflow-style: -ms-autohiding-scrollbar;\n    scrollbar-width: thin;\n    display: flex;\n    background-color: #e1e1e1;\n    flex-shrink: 0;\n    align-items: flex-end;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar{\n    width: 6px;\n    height: 6px;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar-thumb {\n    background-color: rgba(100, 100, 100, 0.5);\n    border-radius: 3px;\n}\n\n.$[prefix]-tab-bar::-webkit-scrollbar-track {\n    background-color: transparent;\n}\n\n.$[prefix]-tab {\n    white-space: nowrap;\n    padding: 8px 16px;\n    font-family: sans-serif;\n    font-size: 14px;\n    cursor: pointer;\n    border-right: 1px solid var(--$[prefix]-tab-border);\n    background-color: var(--$[prefix]-tab-bg);\n}\n\n.$[prefix]-tab.active {\n    background-color: var(--$[prefix]-tab-active-bg);\n    border-bottom: 2px solid var(--$[prefix]-title-bar-active-bg);\n}\n\n.$[prefix]-tab.active .$[prefix]-tab-close-btn:hover {\n    background-color: #ddd;\n}\n\n/* ドラッグ中のタブのスタイル */\n.$[prefix]-tab.dragging {\n    opacity: 0.5;\n}\n/* タブの閉じるボタン */\n.$[prefix]-tab-close-btn {\n    margin-left: 8px;\n    padding: 0 4px;\n    border-radius: 50%;\n    cursor: pointer;\n    font-weight: bold;\n    font-size: 14px;\n    line-height: 1;\n}\n.$[prefix]-tab-close-btn:hover {\n    background-color: #ccc;\n}\n\n.$[prefix]-tab-content {\n    display: none;\n}\n\n.$[prefix]-tab-content.active {\n    display: block;\n    width: 100%;\n    height: 100%;\n}\n\n/* タブ追加ボタン */\n.$[prefix]-tab-add-btn {\n    padding: 4px 8px;\n    font-size: 16px;\n    line-height: 1;\n    cursor: pointer;\n    border-bottom: 1px solid var(--$[prefix]-tab-border);\n}\n.$[prefix]-tab-add-btn:hover {\n    background-color: #e0e0e0;\n}\n\n.$[prefix]-content {\n    flex-grow: 1;\n    position: relative;\n    overflow: auto;\n}\n\n.$[prefix]-content iframe {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: none;\n}\n\n.$[prefix]-resize-handle {\n    position: absolute;\n    z-index: 5;\n}\n\n.$[prefix]-resize-handle.n { top: -4px; left: 0; right: 0; height: 8px; cursor: n-resize; }\n.$[prefix]-resize-handle.s { bottom: -4px; left: 0; right: 0; height: 8px; cursor: s-resize; }\n.$[prefix]-resize-handle.w { top: 0; bottom: 0; left: -4px; width: 8px; cursor: w-resize; }\n.$[prefix]-resize-handle.e { top: 0; bottom: 0; right: -4px; width: 8px; cursor: e-resize; }\n.$[prefix]-resize-handle.nw { top: -4px; left: -4px; width: 8px; height: 8px; cursor: nw-resize; }\n.$[prefix]-resize-handle.ne { top: -4px; right: -4px; width: 8px; height: 8px; cursor: ne-resize; }\n.$[prefix]-resize-handle.sw { bottom: -4px; left: -4px; width: 8px; height: 8px; cursor: sw-resize; }\n.$[prefix]-resize-handle.se { bottom: -4px; right: -4px; width: 8px; height: 8px; cursor: se-resize; }\n\n.$[prefix]-context-menu {\n    color: var(--$[prefix]-menu-item-color);\n    pointer-events: all;\n    position: fixed;\n    z-index: 10000;\n    background-color: var(--$[prefix]-menu-bg);\n    border: 1px solid var(--$[prefix]-menu-border);\n    box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n    list-style: none;\n    margin: 0;\n    padding: 4px 0;\n    min-width: 160px;\n}\n.$[prefix]-context-menu li {\n    padding: 6px 24px;\n    font-family: sans-serif;\n    font-size: 14px;\n    cursor: pointer;\n}\n.$[prefix]-context-menu li:hover {\n    background-color: var(--$[prefix]-menu-item-hover-bg);\n    color: var(--$[prefix]-menu-item-hover-color);\n}\n.$[prefix]-context-menu li.separator {\n    height: 1px;\n    background-color: var(--$[prefix]-menu-border);\n    margin: 4px 0;\n    padding: 0;\n}\n`;\n\nexport default styleData;\n"],"mappings":"CAAA,SAAAA,EAAAC,EAAAC,EAAAC,GAAA,SAAAC,EAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,KAAAJ,EAAAI,GAAA,KAAAE,EAAA,mBAAAC,iBAAA,IAAAF,GAAAC,EAAA,OAAAA,EAAAF,GAAA,MAAAI,EAAA,OAAAA,EAAAJ,GAAA,OAAAK,EAAA,IAAAC,MAAA,uBAAAN,EAAA,WAAAK,EAAAE,KAAA,mBAAAF,CAAA,KAAAG,EAAAX,EAAAG,GAAA,CAAAS,QAAA,IAAAb,EAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,OAAAI,EAAAH,EAAAI,GAAA,GAAAL,MAAA,EAAAa,IAAAC,QAAAd,EAAAC,EAAAC,EAAAC,EAAA,QAAAD,EAAAG,GAAAS,OAAA,SAAAL,EAAA,mBAAAD,iBAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,IAAA,OAAAD,CAAA,eAAAI,EAAAS,EAAAH,GCIAG,EAAAH,QAJA,SAAAb,GACA,YAAAA,EAAA,UAAAiB,eAAA,6DACA,OAAAjB,CACA,EACAgB,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,yBCDAG,EAAAH,QAHA,SAAAJ,EAAAR,GACA,KAAAQ,aAAAR,GAAA,UAAAkB,UAAA,oCACA,EACAH,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,yBCHA,IAAAO,EAAAb,EAAA,iCACAc,EAAAd,EAAA,uBAQAS,EAAAH,QAPA,SAAAX,EAAAF,EAAAD,GACA,GAAAqB,IAAA,OAAAE,QAAAC,UAAAC,MAAA,KAAAC,WACA,IAAAtB,EAAA,OACAA,EAAAuB,KAAAF,MAAArB,EAAAH,GACA,IAAAY,EAAA,IAAAV,EAAAyB,KAAAH,MAAAtB,EAAAC,IACA,OAAAJ,GAAAsB,EAAAT,EAAAb,EAAA6B,WAAAhB,CACA,EACAI,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,oFCTA,IAAAgB,EAAAtB,EAAA,sBACA,SAAAuB,EAAA9B,EAAAD,GACA,QAAAG,EAAA,EAAAA,EAAAH,EAAAgB,OAAAb,IAAA,CACA,IAAAC,EAAAJ,EAAAG,GACAC,EAAA4B,WAAA5B,EAAA4B,aAAA,EAAA5B,EAAA6B,cAAA,YAAA7B,MAAA8B,UAAA,GAAAC,OAAAC,eAAAnC,EAAA6B,EAAA1B,EAAAiC,KAAAjC,EACA,CACA,CAMAa,EAAAH,QALA,SAAAb,EAAAD,EAAAG,GACA,OAAAH,GAAA+B,EAAA9B,EAAA4B,UAAA7B,GAAAG,GAAA4B,EAAA9B,EAAAE,GAAAgC,OAAAC,eAAAnC,EAAA,aACAiC,UAAA,IACAjC,CACA,EACAgB,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,gDCZA,IAAAgB,EAAAtB,EAAA,sBASAS,EAAAH,QARA,SAAAb,EAAAD,EAAAG,GACA,OAAAH,EAAA8B,EAAA9B,MAAAC,EAAAkC,OAAAC,eAAAnC,EAAAD,EAAA,CACAsC,MAAAnC,EACA6B,YAAA,EACAC,cAAA,EACAC,UAAA,IACAjC,EAAAD,GAAAG,EAAAF,CACA,EACAgB,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,gDCTA,SAAAyB,EAAApC,GACA,OAAAc,EAAAH,QAAAyB,EAAAJ,OAAAb,eAAAa,OAAAK,eAAAZ,OAAA,SAAAzB,GACA,OAAAA,EAAAsC,WAAAN,OAAAK,eAAArC,EACA,EAAAc,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,QAAAyB,EAAApC,EACA,CACAc,EAAAH,QAAAyB,EAAAtB,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,yBCLA,IAAAQ,EAAAd,EAAA,uBAaAS,EAAAH,QAZA,SAAAX,EAAAF,GACA,sBAAAA,GAAA,OAAAA,EAAA,UAAAmB,UAAA,sDACAjB,EAAA0B,UAAAM,OAAAO,OAAAzC,KAAA4B,UAAA,CACAc,YAAA,CACAL,MAAAnC,EACA+B,UAAA,EACAD,cAAA,KAEAE,OAAAC,eAAAjC,EAAA,aACA+B,UAAA,IACAjC,GAAAqB,EAAAnB,EAAAF,EACA,EACAgB,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,iDCRAG,EAAAH,QALA,SAAAb,GACA,OAAAA,KAAAkB,WAAAlB,EAAA,CACA2C,QAAA3C,EAEA,EACAgB,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,yBCEAG,EAAAH,QAPA,SAAAX,GACA,IACA,WAAA0C,SAAAC,SAAA/B,KAAAZ,GAAA4C,QAAA,gBACA,OAAA7C,GACA,yBAAAC,CACA,CACA,EACAc,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,0BCPA,SAAAkC,IACA,IACA,IAAA7C,GAAA8C,QAAApB,UAAAqB,QAAAnC,KAAAQ,QAAAC,UAAAyB,QAAA,iBACA,OAAA9C,GAAA,CACA,OAAAc,EAAAH,QAAAkC,EAAA,WACA,QAAA7C,CACA,EAAAc,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,UACA,CACAG,EAAAH,QAAAkC,EAAA/B,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,0BCRA,IAAAqC,EAAA3C,EAAA,uBACA4C,EAAA5C,EAAA,8BAMAS,EAAAH,QALA,SAAAX,EAAAF,GACA,GAAAA,IAAA,UAAAkD,EAAAlD,IAAA,mBAAAA,GAAA,OAAAA,EACA,YAAAA,EAAA,UAAAmB,UAAA,4DACA,OAAAgC,EAAAjD,EACA,EACAc,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,yECPA,SAAAuC,EAAAlD,EAAAF,GACA,OAAAgB,EAAAH,QAAAuC,EAAAlB,OAAAb,eAAAa,OAAAb,eAAAM,OAAA,SAAAzB,EAAAF,GACA,OAAAE,EAAAsC,UAAAxC,EAAAE,CACA,EAAAc,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,QAAAuC,EAAAlD,EAAAF,EACA,CACAgB,EAAAH,QAAAuC,EAAApC,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,0BCLA,IAAAqC,EAAA3C,EAAA,uBAWAS,EAAAH,QAVA,SAAAX,EAAAH,GACA,aAAAmD,EAAAhD,OAAA,OAAAA,EACA,IAAAF,EAAAE,EAAAmD,OAAAC,aACA,YAAAtD,EAAA,CACA,IAAAI,EAAAJ,EAAAc,KAAAZ,EAAAH,GAAA,WACA,aAAAmD,EAAA9C,GAAA,OAAAA,EACA,UAAAe,UAAA,+CACA,CACA,kBAAApB,EAAAwD,OAAAC,QAAAtD,EACA,EACAc,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,0CCXA,IAAAqC,EAAA3C,EAAA,uBACA+C,EAAA/C,EAAA,oBAKAS,EAAAH,QAJA,SAAAX,GACA,IAAAE,EAAAkD,EAAApD,EAAA,UACA,gBAAAgD,EAAA9C,OAAA,EACA,EACAY,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,gECNA,SAAAqC,EAAA/C,GAGA,OAAAa,EAAAH,QAAAqC,EAAA,mBAAAG,QAAA,iBAAAA,OAAAI,SAAA,SAAAtD,GACA,cAAAA,CACA,WAAAA,GACA,OAAAA,GAAA,mBAAAkD,QAAAlD,EAAAuC,cAAAW,QAAAlD,IAAAkD,OAAAzB,UAAA,gBAAAzB,CACA,EAAAa,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,QAAAqC,EAAA/C,EACA,CACAa,EAAAH,QAAAqC,EAAAlC,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,0BCTA,IAAA0B,EAAAhC,EAAA,uBACAc,EAAAd,EAAA,uBACAmD,EAAAnD,EAAA,yBACAgB,EAAAhB,EAAA,kBACA,SAAAoD,EAAAzD,GACA,IAAAH,EAAA,mBAAA6D,IAAA,IAAAA,SAAA,EACA,OAAA5C,EAAAH,QAAA8C,EAAA,SAAAzD,GACA,UAAAA,IAAAwD,EAAAxD,GAAA,OAAAA,EACA,sBAAAA,EAAA,UAAAiB,UAAA,sDACA,YAAApB,EAAA,CACA,GAAAA,EAAA8D,IAAA3D,GAAA,OAAAH,EAAA+D,IAAA5D,GACAH,EAAAgE,IAAA7D,EAAA8D,EACA,CACA,SAAAA,IACA,OAAAzC,EAAArB,EAAAuB,UAAAc,EAAA0B,MAAAvB,YACA,CACA,OAAAsB,EAAApC,UAAAM,OAAAO,OAAAvC,EAAA0B,UAAA,CACAc,YAAA,CACAL,MAAA2B,EACAjC,YAAA,EACAE,UAAA,EACAD,cAAA,KAEAX,EAAA2C,EAAA9D,EACA,EAAAc,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,QAAA8C,EAAAzD,EACA,CACAc,EAAAH,QAAA8C,EAAA3C,EAAAH,QAAAK,YAAA,EAAAF,EAAAH,QAAA,QAAAG,EAAAH,O,4MCvB0BA,EAAAqD,cAA4B,CACrDC,GAAI,KACJC,SAAU,QACVC,MAAO,aACPC,KAAM,KACNC,EAAG,SACHC,EAAG,SACHC,MAAO,IACPC,OAAQ,IACRC,SAAU,IACVC,UAAW,IACXC,YAAY,EACZC,YAAY,EACZC,SAAS,EACTC,UAAU,EACVC,aAAa,EACbC,aAAa,EACbC,iBAAiB,EACjBC,iBAAkB,QAClBC,QAAS,CACRC,KAAM,GACNC,OAAQ,GACRC,SAAU,IAEXC,KAAM,GACNC,KAAM,GACNC,WAAY,CACXC,aAAa,EACbZ,UAAU,EACVa,SAAS,EACTC,WAAOC,GAERC,YAAa,GACbC,OAAQ,WAAO,EACfC,QAAS,WAAO,EAChBC,QAAS,WAAO,EAChBC,OAAQ,WAAO,EACfC,SAAU,WAAO,EACjBC,OAAQ,WAAO,E,qwBClCHC,EAAgB1F,EAAA0F,gBAAA,SAAAC,GAC5B,SAAAD,EAAYE,GAAe,IAAAC,GAAA,EAAAC,EAAA,SAAA1C,KAAAsC,IAC1BG,EAAAE,EAAA3C,KAAAsC,EAAA,CAAME,KACDI,KAAOH,EAAKhE,YAAYmE,KAE7B,IAAMC,EAAiCpG,MAGtC,OAFGoG,EAAaC,mBAChBD,EAAaC,kBAAiBL,EAAOA,EAAKhE,aAC1CgE,CACF,CAAC,SAAAM,EAAA,SAAAT,EAAAC,IAAA,EAAAS,EAAA,SAAAV,EAAA,CAT2B,EAS3B,EAAAW,EAAA,SATmCxG,QAexByG,EAAYtG,EAAAsG,YAAA,SAAAC,GACxB,SAAAD,EAAYV,GAAe,SAAAE,EAAA,SAAA1C,KAAAkD,GAAAP,EAAA3C,KAAAkD,EAAA,CACpBV,GACP,CAAC,SAAAO,EAAA,SAAAG,EAAAC,IAAA,EAAAH,EAAA,SAAAE,EAAA,CAHuB,CAAQZ,GAMR1F,EAAAwG,YAAA,SAAAC,GAAA,SAAAD,IAAA,SAAAV,EAAA,SAAA1C,KAAAoD,GAAAT,EAAA3C,KAAAoD,EAAA5F,UAAA,UAAAuF,EAAA,SAAAK,EAAAC,IAAA,EAAAL,EAAA,SAAAI,EAAA,EAAQF,E,+ZC5BRtG,EAAA0G,aAAG,Q,ucCA5BC,EAAAjH,EAAA,mBACAkH,EAAAlH,EAAA,mBACAmH,EAAAnH,EAAA,kBACAoH,EAAAC,EAAArH,EAAA,sBACAsH,EAAAD,EAAArH,EAAA,kBAAkC,SAAAwC,IAAA,QAAA7C,GAAA8C,QAAApB,UAAAqB,QAAAnC,KAAAQ,QAAAC,UAAAyB,QAAA,wBAAA9C,GAAA,QAAA6C,EAAA,mBAAA7C,CAAA,KAGAW,EAAA,iBAAAiH,GAiBjC,SAAAC,EAAYC,EAAwBC,GAAsB,IAAAvB,EApBzBxG,EAAAC,EAAAH,EAuBhC,IAHyD,EAAA2G,EAAA,SAAA1C,KAAA8D,GApBzB7H,EAqBhC+D,KArBgC9D,EAqBhC4H,EArBgC5H,GAAA,EAAA+H,EAAA,SAAA/H,GAqBhCuG,GArBgC,EAAAyB,EAAA,SAAAjI,EAAA6C,IAAAzB,QAAAC,UAAApB,EAAAH,GAAA,MAAAkI,EAAA,SAAAhI,GAAAwC,aAAAvC,EAAAqB,MAAAtB,EAAAF,KAqBxB,EAAAoI,EAAA,SAAA1B,EAAA,QAdmB,WAAQ,EAAA0B,EAAA,SAAA1B,EAAA,YAGhB,CAAEnC,EAAG,EAAGC,EAAG,EAAGC,MAAO,EAAGC,OAAQ,KAAG,EAAA0D,EAAA,SAAA1B,EAAA,WAC5B,IAAK,EAAA0B,EAAA,SAAA1B,EAAA,OAMiC,KAAE,EAAA0B,EAAA,SAAA1B,EAAA,YAC3B,MAIvCA,EAAKvC,GAAK6D,EAAQ7D,IAAM0D,EAAA,QAAMQ,WAAW,UACrCL,EAAQ7D,GAAI,CACf,IAAMmE,EAAaC,SAASC,eAAeR,EAAQ7D,IACnD,GAAImE,GAAcA,EAAWG,UAAUC,SAAQ,GAAAC,OAAIjB,EAAAH,aAAY,YAC9D,MAAM,IAAIE,EAAAJ,YAAW,2BAAAsB,OAA4BX,EAAQ7D,GAAE,qDAE7D,CAa0B,OAZ1BuC,EAAKuB,QAAUA,EACfvB,EAAKsB,QAAUH,EAAA,QAAMe,UAAUpB,EAAAtD,cAAe8D,GAE9CtB,EAAKmC,GAAKnC,EAAKoC,YACfpC,EAAKqC,WAAarC,EAAKmC,GAAGG,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,eACrEb,EAAKuC,OAASvC,EAAKmC,GAAGG,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,UACjEb,EAAKwC,QAAUxC,EAAKmC,GAAGG,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,WAClEb,EAAKyC,UAAYzC,EAAKmC,GAAGG,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,aAEpEb,EAAK0C,eACL1C,EAAK2C,sBAEL3C,EAAKsB,QAAQ/B,OAAMS,GAAOA,CAC3B,CAAC,SAAAM,EAAA,SAAAe,EAAAD,IAAA,EAAAb,EAAA,SAAAc,EAAA,EAAA3F,IAAA,YAAAC,MAEO,WACP,IAAMiH,EAAWf,SAASgB,cAAc,OACxCD,EAASE,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,WACpC+B,EAASnF,GAAKF,KAAKE,GAGnB,IAAMsF,EAAoB,GACtBxF,KAAK+D,QAAQlD,YAChB2E,EAAQ/H,KAAI,eAAAiH,OAAgBjB,EAAAH,aAAY,2CAAAoB,OAA2CjB,EAAAH,aAAY,6BAE5FtD,KAAK+D,QAAQnD,YAChB4E,EAAQ/H,KAAI,eAAAiH,OAAgBjB,EAAAH,aAAY,2CAAAoB,OAA2CjB,EAAAH,aAAY,6BAE5FtD,KAAK+D,QAAQnD,YAAcZ,KAAK+D,QAAQlD,YAC3C2E,EAAQ/H,KAAI,eAAAiH,OAAgBjB,EAAAH,aAAY,4CAAAoB,OAA4CjB,EAAAH,aAAY,4CAAAoB,OAA4CjB,EAAAH,aAAY,4CAAAoB,OAA4CjB,EAAAH,aAAY,8BAEjN,IAAMmC,EAAuBD,EAAQE,KAAK,IAkB1C,OAjBAL,EAASM,UAAS,6BAAAjB,OACMjB,EAAAH,aAAY,8CAAAoB,OACRjB,EAAAH,aAAY,+CAAAoB,OACZjB,EAAAH,aAAY,gDAAAoB,OACZjB,EAAAH,aAAY,qCAAAoB,OACpB1E,KAAK+D,QAAQ/C,YAAW,iBAAA0D,OAAoBjB,EAAAH,aAAY,iBAAAoB,OAAgBjB,EAAAH,aAAY,8DAAoE,GAAE,0BAAAoB,OAC1J1E,KAAK+D,QAAQ9C,YAAW,iBAAAyD,OAAoBjB,EAAAH,aAAY,iBAAAoB,OAAgBjB,EAAAH,aAAY,8DAAoE,GAAE,0BAAAoB,OAC1J1E,KAAK+D,QAAQhD,SAAQ,iBAAA2D,OAAoBjB,EAAAH,aAAY,iBAAAoB,OAAgBjB,EAAAH,aAAY,sDAA4D,GAAE,0EAAAoB,OAG3IjB,EAAAH,aAAY,qCAAAoB,OACpB1E,KAAK+D,QAAQvC,KAAK1E,OAAS,EAAC,eAAA4H,OAAkBjB,EAAAH,aAAY,qBAAsB,GAAE,sBAAAoB,OAClF1E,KAAK+D,QAAQtC,KAAK3E,OAAS,EAAC,eAAA4H,OAAkBjB,EAAAH,aAAY,oBAAqB,GAAE,kCAAAoB,OACrEjB,EAAAH,aAAY,sDAAAoB,OAE5Be,EAAoB,cAEzBJ,CACR,GAAC,CAAAlH,IAAA,eAAAC,MAEO,WACP4B,KAAK4F,SAAS5F,KAAK+D,QAAQ3D,OAC3BJ,KAAK6F,QAAQ7F,KAAK+D,QAAQ1D,MAC1BL,KAAK8F,QAAQ9F,KAAK+D,QAAQvD,MAAOR,KAAK+D,QAAQtD,QAC9CT,KAAK+F,YAAY/F,KAAK+D,QAAQzD,EAAGN,KAAK+D,QAAQxD,GAC9CP,KAAK4E,GAAGoB,MAAMtF,SAAQ,GAAAgE,OAAM1E,KAAK+D,QAAQrD,SAAQ,MACjDV,KAAK4E,GAAGoB,MAAMrF,UAAS,GAAA+D,OAAM1E,KAAK+D,QAAQpD,UAAS,MAEb,SAAlCX,KAAK+D,QAAQ5C,kBAChBnB,KAAK8E,WAAWN,UAAUyB,IAAI,iBAG3BjG,KAAK+D,QAAQtC,KAAK3E,OAAS,EAC9BkD,KAAKkG,aAELlG,KAAKmG,cAAcnG,KAAKkF,UAAWlF,KAAK+D,QAAQ3C,SAG7CpB,KAAK+D,QAAQvC,KAAK1E,OAAS,GAC9BkD,KAAKoG,YAEP,GAAC,CAAAjI,IAAA,gBAAAC,MAEO,SAAciI,EAAwBjF,GAE7C,GADAiF,EAAUV,UAAY,GAClBvE,EAAQE,OAAQ,CACnB,IAAMA,EAASgD,SAASgB,cAAc,UACtChE,EAAOgF,IAAMlF,EAAQE,OACrB+E,EAAUE,YAAYjF,EACvB,MAAO,GAAIF,EAAQG,SAAU,CAC5B,IAAMA,EAAW+C,SAASS,cAAmC3D,EAAQG,UAC3C,cAAtBA,aAAQ,EAARA,EAAUiF,SACbH,EAAUE,YAAYhF,EAASH,QAAQqF,WAAU,IAEjDJ,EAAUV,UAAY,uCAExB,MAAO,GAAIvE,EAAQC,KAAM,CACxB,IAAMqF,EAASpC,SAASgB,cAAc,UACtCoB,EAAOC,OAASvF,EAAQC,KACxBgF,EAAUE,YAAYG,EACvB,CACD,GAAC,CAAAvI,IAAA,aAAAC,MAEO,WAAU,IAAAwI,EAAA5G,KACX6G,EAAU7G,KAAK4E,GAAGG,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,cACnEuD,EAAQlB,UAAY,GAEpB3F,KAAK+D,QAAQvC,KAAKsF,QAAQ,SAACC,GAAgB,IAAAC,EACpCC,EAAa3C,SAASgB,cAAc,OAI1C,GAHA2B,EAAW1B,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,cACtC2D,EAAWC,YAA+B,QAApBF,EAAGD,EAAanE,YAAI,IAAAoE,IAAI,GAE1CD,EAAaI,MAAO,CACvB,IAAMC,EAAaR,EAAKS,mBAAmBN,EAAaI,OAExDF,EAAWK,iBAAiB,QAAS,SAACvL,GACrCA,EAAEwL,kBACFC,QAAQC,IAAI,SAEZZ,EAAQa,iBAAgB,IAAAhD,OAAkBjB,EAAAH,aAAY,mBAAkBwD,QAAQ,SAACa,GAC5EA,IAAOP,IAAYO,EAAG3B,MAAM4B,QAAU,OAC3C,GAEA,IAAMC,EAAyC,UAA7BT,EAAWpB,MAAM4B,QACnCR,EAAWpB,MAAM4B,QAAUC,EAAY,OAAS,OACjD,GAEAZ,EAAWV,YAAYa,EACxB,CACAP,EAAQN,YAAYU,EACrB,GAEA3C,SAASgD,iBAAiB,QAAS,WAClCT,EAAQa,iBAAgB,IAAAhD,OAAkBjB,EAAAH,aAAY,mBAAkBwD,QAAQ,SAACa,GAChFA,EAAG3B,MAAM4B,QAAU,MACpB,EACD,EACD,GAAC,CAAAzJ,IAAA,qBAAAC,MAEO,SAAmB+I,GAAiB,IAAAW,EAAA9H,KACrCoH,EAAa9C,SAASgB,cAAc,MA8B1C,OA7BA8B,EAAW7B,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,kBAEtC6D,EAAML,QAAQ,SAACiB,GACd,IAAMC,EAAS1D,SAASgB,cAAc,MACtC,GAAIyC,EAASE,UACZD,EAAOzC,UAAY,gBACb,KAAA2C,EACFC,EAAoB,QAAhBD,EAAGH,EAASnF,YAAI,IAAAsF,IAAI,GAc5B,GAbAC,EAAI,SAAAzD,OAAYyD,EAAI,WAChBL,EAAK/D,QAAQ7C,iBAAmB6G,EAASK,WAC5CD,GAAI,iBAAAzD,OAAqBjB,EAAAH,aAAY,qBAAAoB,OAAoBqD,EAASK,SAAQ,aAE3EJ,EAAOrC,UAAS,eAAAjB,OAAkBjB,EAAAH,aAAY,yBAAAoB,OAAwByD,EAAI,UAC1EH,EAAOV,iBAAiB,QAAS,SAACvL,GAAK,IAAAsM,EACtCtM,EAAEwL,kBACa,QAAfc,EAAAN,EAASO,cAAM,IAAAD,GAAfA,EAAAxL,KAAAkL,EAAkBD,GAElBA,EAAKlD,GAAG8C,iBAAgB,IAAAhD,OAAkBjB,EAAAH,aAAY,mBAAkBwD,QAAQ,SAACa,GAChFA,EAAG3B,MAAM4B,QAAU,MACpB,EACD,GACIG,EAASZ,MAAO,CACnBa,EAAOxD,UAAUyB,IAAI,eACrB,IAAMsC,EAAYT,EAAKT,mBAAmBU,EAASZ,OACnDa,EAAOzB,YAAYgC,EACpB,CACD,CACAnB,EAAWb,YAAYyB,EACxB,GACOZ,CACR,GAAC,CAAAjJ,IAAA,aAAAC,MAEO,WAAU,IAAAoK,EAAAC,EAAAzI,KACX0I,EAAS1I,KAAK4E,GAAGG,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,aAClEoF,EAAO/C,UAAY,GACnB3F,KAAKyB,KAAO,GACZ,IAAMkH,EAAiC,QAA1BH,EAAGxI,KAAK+D,QAAQrC,kBAAU,IAAA8G,IAAI,GAE3CxI,KAAK+D,QAAQtC,KAAKqF,QAAQ,SAAC8B,EAASC,GACnCJ,EAAKK,iBAAiBF,EAASC,EAChC,GAEIF,EAAQ/G,UACX5B,KAAK+I,UAAYzE,SAASgB,cAAc,OACxCtF,KAAK+I,UAAUxD,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,gBAC1CtD,KAAK+I,UAAU7B,YAAc,IAC7BlH,KAAK+I,UAAUzB,iBAAiB,QAAS,SAACvL,GAAK,IAAAiN,EACxCC,EAA0B,QAAhBD,EAAGL,EAAQ9G,aAAK,IAAAmH,OAAA,EAAbA,EAAAnM,KAAA8L,EAAgBF,GACnC,GAAIQ,EAAY,CACfR,EAAK1E,QAAQtC,KAAKhE,KAAKwL,GACvB,IAAMC,EAAWT,EAAK1E,QAAQtC,KAAK3E,OAAS,EAC5C2L,EAAKK,iBAAiBG,EAAYC,GAClCT,EAAKU,YAAYD,EAClB,CACD,GACAR,EAAOnC,YAAYvG,KAAK+I,YAGrB/I,KAAKyB,KAAK3E,OAAS,GAAGkD,KAAKmJ,YAAY,EAC5C,GAAC,CAAAhL,IAAA,mBAAAC,MAEO,SAAiBwK,EAAkBC,GAAa,IAAAO,EAAAC,EAAArJ,KACjD0I,EAAS1I,KAAK4E,GAAGG,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,aAC5DqF,EAAiC,QAA1BS,EAAGpJ,KAAK+D,QAAQrC,kBAAU,IAAA0H,IAAI,GAErCE,EAAQhF,SAASgB,cAAc,OACrCgE,EAAM/D,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,QACjCgG,EAAMC,QAAQC,MAAQX,EAAMjK,WAE5B,IAAMqG,EAAUX,SAASgB,cAAc,QAOvC,GANAL,EAAQiC,YAAc0B,EAAQxI,MAC9BkJ,EAAM/C,YAAYtB,GAGlByD,EAAOe,aAAaH,EAAOtJ,KAAK+I,WAE5BJ,EAAQ5H,SAAU,CACrB,IAAM2I,EAAWpF,SAASgB,cAAc,QACxCoE,EAASnE,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,kBACpCoG,EAAS/D,UAAY,UACrB+D,EAASpC,iBAAiB,QAAS,SAACvL,GACnCA,EAAEwL,kBACF8B,EAAKM,SAASd,EACf,GACAS,EAAM/C,YAAYmD,EACnB,CAGA,IAAME,EAAetF,SAASgB,cAAc,OAC5CsE,EAAarE,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,gBACxCtD,KAAKkF,UAAUqB,YAAYqD,GAC3B5J,KAAKmG,cAAcyD,EAAchB,EAAQxH,SAEzCkI,EAAMhC,iBAAiB,QAAS,SAACvL,GAChCsN,EAAKF,aAAaG,EAAMC,QAAQC,MACjC,GACAxJ,KAAKyB,KAAKoI,OAAOhB,EAAO,EAAG,CAAES,QAAOpE,UAAW0E,IAE3CjB,EAAQhH,aACX3B,KAAK8J,mBAAmBR,EAE1B,GAAC,CAAAnL,IAAA,qBAAAC,MAEO,SAAmBkL,GAC1BA,EAAMS,WAAY,EAClBT,EAAMhC,iBAAiB,YAAa,SAACvL,GACpCA,EAAEiO,aAAcC,QAAQ,aAAcX,EAAMC,QAAQC,OACpDF,EAAM9E,UAAUyB,IAAI,WACrB,GACAqD,EAAMhC,iBAAiB,UAAW,kBAAMgC,EAAM9E,UAAU0F,OAAO,WAAW,GAE1EZ,EAAMhC,iBACL,WACA,SAACvL,GACAA,EAAEoO,iBACF,IAAMC,EAAa9F,SAASS,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,kBACvE,GAAI8G,GAAcA,IAAed,EAAO,CACvC,IAAMe,EAAOf,EAAMgB,wBAEbC,EAAUxO,EAAEyO,QAAUH,EAAKI,KAAOJ,EAAK7J,MAAQ,EAC/CkK,EAASpB,EAAMqB,WACjBJ,EACHG,EAAOjB,aAAaW,EAAYd,EAAMsB,aAEtCF,EAAOjB,aAAaW,EAAYd,EAElC,CACD,EACA,CAAEuB,SAAS,IAGZvB,EAAMhC,iBACL,OACA,SAACvL,GACAA,EAAEoO,gBAGH,EACA,CAAEU,SAAS,GAEb,GAAC,CAAA1M,IAAA,WAAAC,MAGO,SAASyK,GAYhB,GAVA7I,KAAKyB,KAAKoH,GAAOS,MAAMY,SACvBlK,KAAKyB,KAAKoH,GAAO3D,UAAUgF,SAE3BlK,KAAKyB,KAAKoI,OAAOhB,EAAO,GACxB7I,KAAK+D,QAAQtC,KAAKoI,OAAOhB,EAAO,GAGhC7I,KAAKyB,KAAKqF,QAAQ,SAACgE,EAAK3O,GAAC,OAAM2O,EAAIxB,MAAMC,QAAQC,MAAQrN,EAAEyC,UAAU,GAGjEoB,KAAKyB,KAAK3E,OAAS,EAAG,CACzB,IAAMiO,EAAiBC,KAAKC,IAAI,EAAGpC,EAAQ,GAC3C7I,KAAKmJ,YAAY4B,EAClB,CACD,GAAC,CAAA5M,IAAA,cAAAC,MAEO,SAAYyK,GACnB7I,KAAKyB,KAAKqF,QAAQ,SAACgE,EAAK3O,GACvB2O,EAAIxB,MAAM9E,UAAU0G,OAAO,SAAU/O,IAAM0M,GAC3CiC,EAAI5F,UAAUV,UAAU0G,OAAO,SAAU/O,IAAM0M,EAChD,EACD,GAAC,CAAA1K,IAAA,sBAAAC,MAEO,WAAmB,IAAA+M,EAAAnL,KAC1BA,KAAK4E,GAAG0C,iBAAiB,QAAS,kBAAM6D,EAAKC,OAAO,GAAE,GAGtDpL,KAAK4E,GAAG0C,iBAAiB,UAAW,kBAAM6D,EAAKC,OAAO,GAEtD,IAAM1B,EAAW1J,KAAK4E,GAAGG,cAAa,IAAAL,OAAwBjB,EAAAH,aAAY,eAC1EoG,WAAUpC,iBAAiB,QAAS,SAACvL,GACpCA,EAAEwL,kBACF4D,EAAKE,OACN,GAEA,IAAMC,EAAStL,KAAK4E,GAAGG,cAAa,IAAAL,OAAwBjB,EAAAH,aAAY,kBACxEgI,WAAQhE,iBAAiB,QAAS,SAACvL,GAClCA,EAAEwL,kBACF4D,EAAKI,gBACN,GAEA,IAAMC,EAASxL,KAAK4E,GAAGG,cAAa,IAAAL,OAAwBjB,EAAAH,aAAY,kBACxEkI,WAAQlE,iBAAiB,QAAS,SAACvL,GAClCA,EAAEwL,kBACF4D,EAAKM,UACN,GAEIzL,KAAK+D,QAAQjD,SAASd,KAAK0L,eAC3B1L,KAAK+D,QAAQnD,YAAcZ,KAAK+D,QAAQlD,aAAYb,KAAK2L,gBACzD3L,KAAK+D,QAAQhC,YAAYjF,OAAS,GACrCkD,KAAK4E,GAAG0C,iBACP,cACA,SAACvL,GACAA,EAAEoO,iBACFgB,EAAKnH,QAAQ4H,gBAAgB7P,EAAEyO,QAASzO,EAAE8P,QAASV,EAAKpH,QAAQhC,YAAaoJ,EAC9E,EACA,CAAEN,SAAS,GAGd,GAAC,CAAA1M,IAAA,cAAAC,MAEO,WAAW,IAAA0N,EAAA9L,KA2ClBA,KAAK8E,WAAWwC,iBAAiB,YA1Cb,SAACvL,GACpB,IAAKA,EAAEgQ,OAAuBC,QAAO,IAAAtH,OAAKjB,EAAAH,aAAY,mBAAAoB,OAAkBjB,EAAAH,aAAY,qBAAAoB,OAAoBjB,EAAAH,aAAY,gBAAAoB,OAAejB,EAAAH,aAAY,aAA/I,CAIA,GAHAvH,EAAEoO,iBACF2B,EAAKV,QAEc,cAAfU,EAAKG,MAAuB,CAC/B,IAAMC,EAAgBJ,EAAKK,UAAU3L,MAE/B4L,EAAarQ,EAAEyO,QAAUsB,EAAKlH,GAAGyH,YAGjCC,EAAeR,EAAKhH,WAAWwF,wBAC/BiC,EAAUxQ,EAAE8P,QAAUS,EAAaE,IACnCC,EAAO1Q,EAAEyO,QAAU0B,EAAgBE,EACnCM,EAAO3Q,EAAE8P,QAAUU,EAGzBT,EAAKa,UACLb,EAAK/F,YAAY0G,EAAMC,EACxB,CAEAZ,EAAK5G,UAAUc,MAAM4G,cAAgB,OAGrC,IAAiBC,EAA4B9Q,EAArCyO,QAA0BsC,EAAW/Q,EAApB8P,QACzBkB,EAA2DjB,EAAKlH,GAA5CoI,EAAWD,EAAvBE,WAAoCC,EAAUH,EAArBI,UAE3BC,EAAc,SAACC,GACpB,IAAMC,EAAUN,EAAcK,EAAM7C,QAAUqC,EACxCU,EAASL,EAAaG,EAAMxB,QAAUiB,EAC5ChB,EAAK/F,YAAYuH,EAASC,EAC3B,EACMC,EAAY,WACjB1B,EAAK5G,UAAUc,MAAM4G,cAAgB,OAErCtI,SAASmJ,oBAAoB,YAAaL,GAC1C9I,SAASmJ,oBAAoB,UAAWD,GACxC1B,EAAK/H,QAAQ1B,OAAOyJ,EACrB,EACAxH,SAASgD,iBAAiB,YAAa8F,GACvC9I,SAASgD,iBAAiB,UAAWkG,EAvCuH,CAwC7J,EAC2D,CAAE3C,SAAS,GACvE,GAAC,CAAA1M,IAAA,gBAAAC,MAEO,WAAa,IAAAsP,EAAA1N,KACpBA,KAAK4E,GAAG8C,iBAAgB,IAAAhD,OAAkBjB,EAAAH,aAAY,mBAAkBwD,QAAQ,SAAC6G,GAChFA,EAAOrG,iBACN,YACA,SAACvL,GACAA,EAAEoO,iBACFuD,EAAKtC,QACLsC,EAAKxI,UAAUc,MAAM4G,cAAgB,OAErC,IAAMgB,EAAYD,EAAOpI,UAAUsI,QAAO,GAAAnJ,OAAIjB,EAAAH,aAAY,mBAAmB,IAC5DuJ,EAA4B9Q,EAArCyO,QAA0BsC,EAAW/Q,EAApB8P,QACzBiC,EAA2GJ,EAAK9I,GAA3FmJ,EAAUD,EAAvBzB,YAAuC2B,EAAWF,EAAzBG,aAAuCC,EAASJ,EAArBb,WAAkCkB,EAAQL,EAAnBX,UACnFiB,EAAgCV,EAAK3J,QAA7BrD,EAAQ0N,EAAR1N,SAAUC,EAASyN,EAATzN,UAEZyM,EAAc,SAACC,GACpB,IAAIgB,EAAWN,EACdO,EAAYN,EACZV,EAAUY,EACVX,EAASY,EACJI,EAASlB,EAAM7C,QAAUqC,EACzB2B,EAASnB,EAAMxB,QAAUiB,EAE3Bc,EAAUa,SAAS,OAAMJ,EAAWrD,KAAKC,IAAIvK,EAAUqN,EAAaQ,IACpEX,EAAUa,SAAS,OACtBJ,EAAWrD,KAAKC,IAAIvK,EAAUqN,EAAaQ,GAC3CjB,EAAUY,EAAYK,GAEnBX,EAAUa,SAAS,OAAMH,EAAYtD,KAAKC,IAAItK,EAAWqN,EAAcQ,IACvEZ,EAAUa,SAAS,OACtBH,EAAYtD,KAAKC,IAAItK,EAAWqN,EAAcQ,GAC9CjB,EAASY,EAAWK,GAErBd,EAAK5H,QAAQuI,EAAUC,GACvBZ,EAAK3H,YAAYuH,EAASC,EAC3B,EACMmB,EAAY,WACjBhB,EAAKxI,UAAUc,MAAM4G,cAAgB,OAErCtI,SAASmJ,oBAAoB,YAAaL,GAC1C9I,SAASmJ,oBAAoB,UAAWiB,GACxChB,EAAK3J,QAAQ3B,SAASsL,EACvB,EACApJ,SAASgD,iBAAiB,YAAa8F,GACvC9I,SAASgD,iBAAiB,UAAWoH,EACtC,EACA,CAAE7D,SAAS,GAEb,EACD,GAAC,CAAA1M,IAAA,gBAAAC,MAEO,SAAcuQ,GACrB,IAAMC,EAAUD,EAASE,OAAOC,MAAM,OAChCC,EAAYH,EAAQI,KAAK,SAAC3S,GAAC,MAAK,cAAc4S,KAAK5S,EAAE,GACrD6S,EAAUN,EAAQI,KAAK,SAAC3S,GAAC,MAAK,kBAAkB4S,KAAK5S,EAAE,GAC7D,OAAO0S,GAAaG,CACrB,GAAC,CAAA/Q,IAAA,QAAAC,MAIM,WACN4B,KAAK+D,QAAQ9B,QAAQjC,MACrBA,KAAKgE,QAAQmL,cAAcnP,KAAKE,GACjC,GAAC,CAAA/B,IAAA,WAAAC,MAEM,WACa,cAAf4B,KAAKiM,QACRjM,KAAKiM,MAAQ,YACbjM,KAAK4E,GAAGJ,UAAUyB,IAAI,aACtBjG,KAAKoP,OAEP,GAAC,CAAAjR,IAAA,iBAAAC,MAEM,WACS,cAAf4B,KAAKiM,MAAwBjM,KAAK2M,UAAY3M,KAAKqP,UACpD,GAAC,CAAAlR,IAAA,WAAAC,MAEM,WACN,GAAmB,cAAf4B,KAAKiM,MAAuB,CAC/BjM,KAAKmM,UAAY,CAAE7L,EAAGN,KAAK4E,GAAGqI,WAAY1M,EAAGP,KAAK4E,GAAGuI,UAAW3M,MAAOR,KAAK4E,GAAGyH,YAAa5L,OAAQT,KAAK4E,GAAGqJ,cAC5GjO,KAAKiM,MAAQ,YACbjM,KAAK4E,GAAGJ,UAAUyB,IAAI,aACtBjG,KAAK+F,YAAY,EAAG,GACpB/F,KAAK8F,QAAQ,OAAQ,QACrB,IAAMwF,EAAStL,KAAK4E,GAAGG,cAAa,IAAAL,OAAwBjB,EAAAH,aAAY,kBACpEgI,IACHA,EAAOlL,MAAQ,UACfkL,EAAOlN,MAAQ,IAEjB,CACD,GAAC,CAAAD,IAAA,UAAAC,MAEM,WACN,GAAmB,cAAf4B,KAAKiM,MACRjM,KAAKiM,MAAQ,SACbjM,KAAK4E,GAAGJ,UAAU0F,OAAO,aACzBlK,KAAKoL,aACC,GAAmB,cAAfpL,KAAKiM,MAAuB,CACtCjM,KAAKiM,MAAQ,SACbjM,KAAK4E,GAAGJ,UAAU0F,OAAO,aACzBlK,KAAK8F,QAAQ9F,KAAKmM,UAAU3L,MAAOR,KAAKmM,UAAU1L,QAClDT,KAAK+F,YAAY/F,KAAKmM,UAAU7L,EAAGN,KAAKmM,UAAU5L,GAClD,IAAM+K,EAAStL,KAAK4E,GAAGG,cAAa,IAAAL,OAAwBjB,EAAAH,aAAY,kBACpEgI,IACHA,EAAOlL,MAAQ,WACfkL,EAAOlN,MAAQ,IAEjB,CACD,GAAC,CAAAD,IAAA,QAAAC,MAEM,WACF4B,KAAKsP,UACTtP,KAAKgE,QAAQuL,YAAYvP,MACzBA,KAAKsP,SAAU,EACftP,KAAK4E,GAAGJ,UAAUyB,IAAI,UACtBjG,KAAK+D,QAAQ7B,QAAQlC,MACtB,GAAC,CAAA7B,IAAA,OAAAC,MAEM,WACD4B,KAAKsP,UACVtP,KAAKsP,SAAU,EACftP,KAAK4E,GAAGJ,UAAU0F,OAAO,UACzBlK,KAAK+D,QAAQ5B,OAAOnC,MACrB,GAAC,CAAA7B,IAAA,WAAAC,MAEM,SAASgC,GACfJ,KAAK+D,QAAQ3D,MAAQA,EACrBJ,KAAKiF,QAAQiC,YAActD,EAAA,QAAM4L,aAAapP,EAC/C,GAAC,CAAAjC,IAAA,UAAAC,MAEM,SAAQiC,GAGd,GAFAL,KAAK+D,QAAQ1D,KAAOA,EACpBL,KAAKgF,OAAOW,UAAY,GACnBtF,EAEL,GAAIL,KAAKyP,cAAcpP,GAAO,CAC7B,IAAMlE,EAAImI,SAASgB,cAAc,KACjCnJ,EAAEoJ,UAAYlF,EACdL,KAAKgF,OAAOuB,YAAYpK,EACzB,KAAO,CACN,IAAMuT,EAAMpL,SAASgB,cAAc,OACnCoK,EAAIpJ,IAAMjG,EACVqP,EAAIC,IAAM,cACV3P,KAAKgF,OAAOuB,YAAYmJ,EACzB,CACD,GAAC,CAAAvR,IAAA,cAAAC,MAEM,SAAYkC,EAAsBC,GAExC,GAAKP,KAAKgE,QAAQqC,UAAlB,CAKA,IAAMuJ,EAAa5P,KAAKgE,QAAQqC,UAAUiE,wBAChC,WAANhK,IAAgBA,GAAKsP,EAAWpP,MAAQR,KAAK4E,GAAGyH,aAAe,GACzD,WAAN9L,IAAgBA,GAAKqP,EAAWnP,OAAST,KAAK4E,GAAGqJ,cAAgB,GACrEjO,KAAK4E,GAAGoB,MAAMyE,KAAI,GAAA/F,OAAMsG,KAAK6E,IAAI7E,KAAKC,IAAI,IAAMjL,KAAK4E,GAAGyH,YAAa/L,GAAIsP,EAAWpP,MAAQ,IAAG,MAC/FR,KAAK4E,GAAGoB,MAAMwG,IAAG,GAAA9H,OAAMsG,KAAK6E,IAAI7E,KAAKC,IAAI,EAAG1K,GAAIqP,EAAWnP,OAAS,IAAG,KANvE,MAFC+G,QAAQsI,KAAK,oEASf,GAAC,CAAA3R,IAAA,UAAAC,MAEM,SAAQoC,EAAwBC,GACtCT,KAAK4E,GAAGoB,MAAMxF,MAAyB,iBAAVA,EAAkB,GAAAkE,OAAMlE,EAAK,MAAOA,EACjER,KAAK4E,GAAGoB,MAAMvF,OAA2B,iBAAXA,EAAmB,GAAAiE,OAAMjE,EAAM,MAAOA,CACrE,IAAC,CA9jBgC,CAAQiD,EAAA,Q,s4BCL1CF,EAAAlH,EAAA,mBACAmH,EAAAnH,EAAA,kBACAoH,EAAAC,EAAArH,EAAA,sBACAyT,EAAApM,EAAArH,EAAA,oBACA0T,EAAArM,EAAArH,EAAA,aAAoC,SAAA2T,EAAAnU,EAAAC,GAAA,IAAAE,EAAA,oBAAAmD,QAAAtD,EAAAsD,OAAAI,WAAA1D,EAAA,kBAAAG,EAAA,IAAAiU,MAAAC,QAAArU,KAAAG,EAAA,SAAAH,EAAAU,GAAA,GAAAV,EAAA,qBAAAA,EAAA,OAAAsU,EAAAtU,EAAAU,GAAA,IAAAP,EAAA,GAAA2C,SAAA/B,KAAAf,GAAAuU,MAAA,uBAAApU,GAAAH,EAAA2C,cAAAxC,EAAAH,EAAA2C,YAAAmE,MAAA,QAAA3G,GAAA,QAAAA,EAAAiU,MAAAI,KAAAxU,GAAA,cAAAG,GAAA,2CAAAgT,KAAAhT,GAAAmU,EAAAtU,EAAAU,QAAA,GAAA+T,CAAAzU,KAAAC,GAAAD,GAAA,iBAAAA,EAAAgB,OAAA,CAAAb,IAAAH,EAAAG,GAAA,IAAAuU,EAAA,EAAAC,EAAA,oBAAAC,EAAAD,EAAAzU,EAAA,kBAAAwU,GAAA1U,EAAAgB,OAAA,CAAA6T,MAAA,IAAAA,MAAA,EAAAvS,MAAAtC,EAAA0U,KAAA,EAAAzU,EAAA,SAAAD,GAAA,MAAAA,CAAA,EAAAM,EAAAqU,EAAA,WAAAvT,UAAA,6IAAAhB,EAAAM,GAAA,EAAAD,GAAA,SAAAmU,EAAA,WAAAzU,IAAAY,KAAAf,EAAA,EAAAE,EAAA,eAAAF,EAAAG,EAAA2U,OAAA,OAAApU,EAAAV,EAAA6U,KAAA7U,CAAA,EAAAC,EAAA,SAAAD,GAAAS,GAAA,EAAAL,EAAAJ,CAAA,EAAAM,EAAA,eAAAI,GAAA,MAAAP,EAAA,QAAAA,EAAA,oBAAAM,EAAA,MAAAL,CAAA,aAAAkU,EAAAtU,EAAAU,IAAA,MAAAA,KAAAV,EAAAgB,UAAAN,EAAAV,EAAAgB,QAAA,QAAAf,EAAA,EAAAC,EAAAkU,MAAA1T,GAAAT,EAAAS,EAAAT,IAAAC,EAAAD,GAAAD,EAAAC,GAAA,OAAAC,CAAA,UAAA8C,IAAA,QAAA7C,GAAA8C,QAAApB,UAAAqB,QAAAnC,KAAAQ,QAAAC,UAAAyB,QAAA,wBAAA9C,GAAA,QAAA6C,EAAA,mBAAA7C,CAAA,KAEDW,EAAA,iBAAAiH,GAWlC,SAAAgN,EAAYC,GAA4C,IAAArO,EAbrBxG,EAAAC,EAAAH,EAeA,OAFqB,EAAA2G,EAAA,SAAA1C,KAAA6Q,GAbrB5U,EAclC+D,KAdkC9D,EAclC2U,EAdkC3U,GAAA,EAAA+H,EAAA,SAAA/H,GAclCuG,GAdkC,EAAAyB,EAAA,SAAAjI,EAAA6C,IAAAzB,QAAAC,UAAApB,EAAAH,GAAA,MAAAkI,EAAA,SAAAhI,GAAAwC,aAAAvC,EAAAqB,MAAAtB,EAAAF,KAc1B,EAAAoI,EAAA,SAAA1B,EAAA,YAX8B,OAAI,EAAA0B,EAAA,SAAA1B,EAAA,UACzB,IAAI9C,MAA2B,EAAAwE,EAAA,SAAA1B,EAAA,gBACzB,MAAI,EAAA0B,EAAA,SAAA1B,EAAA,eACgB,OAAI,EAAA0B,EAAA,SAAA1B,EAAA,gBACJ,OAAI,EAAA0B,EAAA,SAAA1B,EAAA,iBACxB,IAAK,EAAA0B,EAAA,SAAA1B,EAAA,4BAGM,GAIlCA,EAAKsO,aAAeD,EAAcrO,CACnC,CAAC,SAAAM,EAAA,SAAA8N,EAAAhN,IAAA,EAAAb,EAAA,SAAA6N,EAAA,EAAA1S,IAAA,oBAAAC,MAEM,SAAkB2F,GACxB9F,OAAO+S,OAAOhR,KAAK+Q,aAAchN,EAClC,GAAC,CAAA5F,IAAA,OAAAC,MAEM,WAAI,IAAAwI,EAAA5G,KACV,IAAIA,KAAKiR,cAAT,CAGA,IAAK3M,SAAS4M,KACb,MAAM,IAAI1N,EAAAJ,YAAY,sGAGvB,IAAKkB,SAASC,eAAc,GAAAG,OAAIjB,EAAAH,aAAY,YAAY,CACvD,IAAM6N,EAAW7M,SAASgB,cAAc,SACxC6L,EAASjR,GAAE,GAAAwE,OAAMjB,EAAAH,aAAY,WAC7B6N,EAASxL,UAAY3F,KAAKoR,eAC1B9M,SAAS+M,KAAK9K,YAAY4K,EAC3B,CACA,IAAIG,EAAchN,SAASS,cAAa,IAAAL,OAAkBjB,EAAAH,aAAY,eACjEgO,KACJA,EAAchN,SAASgB,cAAc,QACzBC,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,cACvCgB,SAAS4M,KAAK3K,YAAY+K,IAE3BtR,KAAKqG,UAAYiL,EAEjBC,OAAOjK,iBAAiB,OAAQ,WAE/BkK,sBAAsB,WACrB,IAAMC,EAAWnN,SAASoN,cAE1B,GAA0B,YAAtBD,aAAQ,EAARA,EAAUjL,SAAsB,CAEnC,IAAMmL,EAASF,EAAyBzF,QAAO,IAAAtH,OAAkBjB,EAAAH,aAAY,YAC7E,GAAIqO,EAAO,CACV,IAAMC,EAAMhL,EAAKiL,QAAQhS,IAAI8R,EAAMzR,IAE/B0R,GAAOhL,EAAKkL,eAAiBF,GAChCA,EAAIxG,OAEN,CACD,CACD,EACD,GACA9G,SAASgD,iBACR,YACA,WACCkK,sBAAsB,WACrB,IAAMC,EAAWnN,SAASoN,cAC1B,GAA0B,YAAtBD,aAAQ,EAARA,EAAUjL,SAAsB,CACnC,IAAMmL,EAASF,EAAyBzF,QAAO,IAAAtH,OAAkBjB,EAAAH,aAAY,YAC7E,GAAIqO,EAAO,CACV,IAAMC,EAAMhL,EAAKiL,QAAQhS,IAAI8R,EAAMzR,IAC/B0R,GAAOhL,EAAKkL,eAAiBF,GAChCA,EAAIxG,OAEN,CACD,CACD,EACD,GACA,GAIDpL,KAAKqG,UAAWiB,iBAAiB,YAAa,SAACvL,GAE9C,GAAIA,EAAEgQ,SAAWnF,EAAKP,WACjBO,EAAKkL,aAAc,CACtB,IAAMC,EAASnL,EAAKkL,aACpBlL,EAAKkL,aAAe,KACpBC,EAAO3C,MACR,CAEF,GAEA9K,SAASgD,iBAAiB,QAAS,kBAAMV,EAAKoL,iBAAiB,GAE/DT,OAAOjK,iBAAiB,UAAW,SAAC2K,GAEnC,GAAIA,EAAMC,MAA4B,wBAApBD,EAAMC,KAAKC,MAAgE,YAA9B,EAAAC,EAAA,SAAOH,EAAMC,KAAKnO,SAAsB,CAEtG,IACuCsO,EADnCC,GAAgB,EAAMC,EAAAtC,EACRrJ,EAAKiL,QAAQW,UAAQ,IAAvC,IAAAD,EAAA7B,MAAA2B,EAAAE,EAAAvW,KAAA2U,MAAyC,KAClCrP,EADO+Q,EAAAjU,MACMwG,GAAGG,cAAc,UACpC,GAAIzD,GAAUA,EAAOmR,gBAAkBR,EAAMS,OAAQ,CACpDJ,GAAgB,EAChB,KACD,CACD,CAAC,OAAAK,GAAAJ,EAAAxW,EAAA4W,EAAA,SAAAJ,EAAAnW,GAAA,CAEGkW,EACH1L,EAAKgM,aAAaX,EAAMC,KAAKnO,SAE7ByD,QAAQsI,KAAK,yDAA0DmC,EAAMY,OAE/E,CACD,GAEA7S,KAAKiR,eAAgB,EACrBjR,KAAK8S,wBA5FL,CA6FD,GAAC,CAAA3U,IAAA,yBAAAC,MAGO,WAAsB,IAAA0J,EAAA9H,KAC7BsE,SAASgD,iBACR,UACA,SAACvL,GAEA,GAAI+L,EAAKiJ,aAAagC,qBAAsB,CAC3C,IAAM3K,EAAWN,EAAKkL,cAAclL,EAAKiJ,aAAagC,sBAEtD,GAAIhX,EAAEoC,IAAI8U,gBAAkB7K,EAASjK,IAAI8U,eAAiBlX,EAAEmX,UAAY9K,EAAS+K,MAAQpX,EAAEqX,SAAWhL,EAASuH,KAAO5T,EAAEsX,WAAajL,EAASkL,MAAO,CACpJvX,EAAEoO,iBACF,IAAM0H,EAAU3B,MAAMI,KAAKxI,EAAK+J,QAAQW,UAElCe,EAAezL,EAAKgK,aAAeD,EAAQ2B,UAAU,SAACC,GAAC,OAAKA,IAAM3L,EAAKgK,YAAY,IAAK,EAGxFF,EAAMC,GAFO0B,EAAe,GAAK1B,EAAQ/U,QAO/C,MAJkB,cAAd8U,EAAI3F,OACP2F,EAAIjF,eAELiF,EAAIxG,OAEL,CACD,CAGA,IAAMsI,EAAe5L,EAAKgK,aAG1B,GAAK4B,GAAiBA,EAAa3P,QAAQ7C,gBAA3C,CAKA,IAAMyS,EAAsB,SAACC,GAAyB,IACzBC,EADyBC,EAAA7D,EAClC2D,GAAS,IAA5B,IAAAE,EAAApD,MAAAmD,EAAAC,EAAA9X,KAAA2U,MAA8B,KAAnBoD,EAAIF,EAAAzV,MACd,GAAI2V,EAAK3L,SAAU,CAClB,IAEqJ4L,EAF/IC,EAAWnM,EAAKkL,cAAce,EAAK3L,UAEzC,GADAZ,QAAQC,IAAIwM,EAAUlY,EAAEoC,KACpBpC,EAAEoC,IAAI+V,gBAAkBD,EAAS9V,IAAI+V,eAAiBnY,EAAEmX,UAAYe,EAASd,MAAQpX,EAAEqX,SAAWa,EAAStE,KAAO5T,EAAEsX,WAAaY,EAASX,MAI7I,OAHAvX,EAAEoO,iBACFpO,EAAEwL,kBACS,QAAXyM,EAAAD,EAAKzL,cAAM,IAAA0L,GAAXA,EAAAnX,KAAAkX,EAAcL,IACP,CAET,CACA,GAAIK,EAAK5M,OAASwM,EAAoBI,EAAK5M,OAC1C,OAAO,CAET,CAAC,OAAAwL,GAAAmB,EAAA/X,EAAA4W,EAAA,SAAAmB,EAAA1X,GAAA,CACD,OAAO,CACR,EAEAuX,EAAoBD,EAAa3P,QAAQvC,KAtBzC,CAuBD,EACA,CAAEqJ,SAAS,GAEb,GAAC,CAAA1M,IAAA,oBAAAC,MAGO,WACF4B,KAAKiR,eACTjR,KAAKmU,MAEP,GAAC,CAAAhW,IAAA,eAAAC,MAKO,WACP,OAAO2R,EAAA,QAAUlC,QAAQ,eAAgB,SAACrR,EAAGG,GAC5C,MACM,WADEA,EAEC8G,EAAAH,aAEF3G,CACR,EACD,GAAC,CAAAwB,IAAA,eAAAC,MAEM,SAAa2F,GAAsB,IAAAqQ,EACzCpU,KAAKqU,oBAEL,IAAMlU,EAA2B,QAAnBiU,EAAGrQ,EAAQ5D,gBAAQ,IAAAiU,IAAI,QAErC,GAAIrQ,EAAQ7D,IAAmB,WAAbC,EAAuB,CACxC,IAAMmU,EAAiBtU,KAAKuU,UAAUxQ,EAAQ7D,IAC9C,GAAIoU,EAAgB,CACnB,GAAiB,YAAbnU,EACH,OAAOmU,EAER,GAAiB,UAAbnU,EAKH,MAJ6B,cAAzBmU,EAAerI,OAClBqI,EAAe3H,UAEhB2H,EAAelJ,QACRkJ,CAET,CACD,CAEA,IAAM1C,EAAM,IAAI5B,EAAA,QAAajM,EAAS/D,MAItC,OAHAA,KAAK6R,QAAQ/R,IAAI8R,EAAI1R,GAAI0R,GACzB5R,KAAKqG,UAAWE,YAAYqL,EAAIhN,IAChC5E,KAAKuP,YAAYqC,GACVA,CACR,GAAC,CAAAzT,IAAA,gBAAAC,MAEM,SAAc8B,GACpBF,KAAKqU,oBACL,IAAMzC,EAAM5R,KAAK6R,QAAQhS,IAAIK,GAC7B,GAAI0R,IACHA,EAAIhN,GAAGsF,SACPlK,KAAK6R,QAAO,OAAQ3R,GAChBF,KAAK8R,eAAiBF,GAAK,CAC9B5R,KAAK8R,aAAe,KACpB,IAAM0C,EAAUtE,MAAMI,KAAKtQ,KAAK6R,QAAQW,UAAUiC,MAC9CD,GAASxU,KAAKuP,YAAYiF,EAC/B,CAEF,GAAC,CAAArW,IAAA,cAAAC,MAEM,SAAYwT,GAAiB,IAAA8C,EACnC1U,KAAKqU,oBACDrU,KAAK8R,eAAiBF,IAET,QAAjB8C,EAAA1U,KAAK8R,oBAAY,IAAA4C,GAAjBA,EAAmBtF,OACnBpP,KAAK8R,aAAeF,EACpBA,EAAIhN,GAAGoB,MAAM2O,OAAM,GAAAjQ,SAAQ1E,KAAK4U,eAEjC,GAAC,CAAAzW,IAAA,YAAAC,MAEM,SAAU8B,GAEhB,OADAF,KAAKqU,oBACErU,KAAK6R,QAAQhS,IAAIK,EACzB,GAAC,CAAA/B,IAAA,kBAAAC,MAEM,WAEN,OADA4B,KAAKqU,oBACErU,KAAK8R,YACb,GAAC,CAAA3T,IAAA,kBAAAC,MAEM,SAAgBkC,EAAWC,EAAWqT,EAA8BiB,GAAsB,IAAApM,EAAAzI,KAChGA,KAAKqU,oBACLrU,KAAKgS,kBAELhS,KAAK8U,cAAgBxQ,SAASgB,cAAc,MAC5CtF,KAAK8U,cAAcvP,UAAS,GAAAb,OAAMjB,EAAAH,aAAY,iBAE9CsQ,EAAU9M,QAAQ,SAACiB,GAClB,IAGOG,EAHDF,EAAS1D,SAASgB,cAAc,MAClCyC,EAASE,UACZD,EAAOzC,UAAY,aAEnByC,EAAOd,YAA2B,QAAhBgB,EAAGH,EAASnF,YAAI,IAAAsF,IAAI,GACtCF,EAAO+M,QAAU,SAAChZ,GAAK,IAAAsM,EACtBtM,EAAEwL,kBACa,QAAfc,EAAAN,EAASO,cAAM,IAAAD,GAAfA,EAAAxL,KAAAkL,EAAkB8M,GAClBpM,EAAKuJ,iBACN,GAEDvJ,EAAKqM,cAAevO,YAAYyB,EACjC,GAEAhI,KAAKqG,UAAWE,YAAYvG,KAAK8U,eAEjC,IAAAE,EAA6DhV,KAAK8U,cAA7CG,EAASD,EAAtB3I,YAAsC6I,EAAUF,EAAxB/G,aAChCkH,EAA+D5D,OAA3C6D,EAAWD,EAAvBE,WAAsCC,EAAYH,EAAzBI,YAEjCvV,KAAK8U,cAAc9O,MAAMyE,KAAkC,GAAA/F,OAA3BpE,EAAI2U,EAAYG,EAAiBA,EAAcH,EAAmB3U,EAAV,MACxFN,KAAK8U,cAAc9O,MAAMwG,IAAmC,GAAA9H,OAA7BnE,EAAI2U,EAAaI,EAAkBA,EAAeJ,EAAoB3U,EAAV,KAC5F,GAAC,CAAApC,IAAA,kBAAAC,MAEM,WAAe,IAAAoX,EACH,QAAlBA,EAAAxV,KAAK8U,qBAAa,IAAAU,GAAlBA,EAAoBtL,SACpBlK,KAAK8U,cAAgB,IACtB,GAAC,CAAA3W,IAAA,gBAAAC,MAMO,SAAcgK,GACrB,IAAMqN,EAAOrN,EAAS0G,MAAM,KACtB3Q,EAAMsX,EAAKhB,OAAS,GAI1B,MAAO,CAAEtB,KAHIsC,EAAKhH,SAAS,QAGZkB,IAFH8F,EAAKhH,SAAS,OAEN6E,MADNmC,EAAKhH,SAAS,SACDtQ,MAC5B,IAAC,CAlTiC,CAAQuF,EAAA,Q,slBCN3C,IAAAH,EAAAjH,EAAA,kBAEAoZ,EAAA/R,EAAArH,EAAA,8BACAsH,EAAAD,EAAArH,EAAA,iBAEMyU,EAA8C,CACnDgC,qBAAsB,UAIjB/O,EAAU,IAAI0R,EAAA,QAAc3E,GAG5B4E,EAAiB,CAKtBxB,KAAM,WACLnQ,EAAQmQ,MACT,EAKAvB,aAAc,WAAyC,IAAxC7O,EAAAvG,UAAAV,OAAA,QAAAgF,IAAAtE,UAAA,GAAAA,UAAA,GAAyB,GACvC,OAAOwG,EAAQ4O,aAAa7O,EAC7B,EAKAwQ,UAAW,SAACrU,GACX,OAAO8D,EAAQuQ,UAAUrU,EAC1B,EAKA0V,gBAAiB,WAChB,OAAO5R,EAAQ4R,iBAChB,EAKAC,iBAAkB,SAAC9R,GAClBH,EAAA,QAAMe,UAAUpB,EAAAtD,cAAe8D,EAChC,EAKA+R,gBAAiB,SAAC/R,GACjB9F,OAAO+S,OAAOD,EAAchN,GAC5BC,EAAQ+R,kBAAkBhF,EAC3B,GAIDQ,OAAOyE,OAASL,EAAI/Y,EAAA,QAGL+Y,C,uXCjEqB/Y,EAAA,WAAAoG,EAAA,kBAAAiT,KAAA,EAAAvT,EAAA,SAAA1C,KAAAiW,EAAA,E,wkBCApCvS,EAAAC,EAAArH,EAAA,gBAA0C,SAAA4Z,EAAAna,EAAAD,GAAA,IAAAG,EAAAgC,OAAAwX,KAAA1Z,GAAA,GAAAkC,OAAAkY,sBAAA,KAAAja,EAAA+B,OAAAkY,sBAAApa,GAAAD,IAAAI,IAAAka,OAAA,SAAAta,GAAA,OAAAmC,OAAAoY,yBAAAta,EAAAD,GAAAgC,UAAA,IAAA7B,EAAAwB,KAAAF,MAAAtB,EAAAC,EAAA,QAAAD,CAAA,UAAA6C,IAAA,QAAA7C,GAAA8C,QAAApB,UAAAqB,QAAAnC,KAAAQ,QAAAC,UAAAyB,QAAA,wBAAA9C,GAAA,QAAA6C,EAAA,mBAAA7C,CAAA,KAEfW,EAAA,iBAAAiH,GAAA,SAAAyS,IAAA,SAAA5T,EAAA,SAAA1C,KAAAsW,GAFera,EAEf+D,KAFe9D,EAEfoa,EAFeva,EAEfyB,UAFetB,GAAA,EAAA+H,EAAA,SAAA/H,IAAA,EAAAgI,EAAA,SAAAjI,EAAA6C,IAAAzB,QAAAC,UAAApB,EAAAH,GAAA,MAAAkI,EAAA,SAAAhI,GAAAwC,aAAAvC,EAAAqB,MAAAtB,EAAAF,IAAA,IAAAE,EAAAC,EAAAH,CAEf,UAAAgH,EAAA,SAAAuT,EAAAzS,IAAA,EAAAb,EAAA,SAAAsT,EAAA,OAAAnY,IAAA,aAAAC,MAMnB,WACN,SAAAsG,OADwBlH,UAAAV,OAAA,QAAAgF,IAAAtE,UAAA,GAAAA,UAAA,GAAiB,MACzB,KAAAkH,OAAIsG,KAAKuL,SAAS3X,SAAS,IAAI4X,UAAU,EAAG,GAC7D,GAAC,CAAArY,IAAA,YAAAC,MAKM,SAAqD2N,EAAW2G,GACtE,IAAM+D,EAhBkC,SAAA1a,GAAA,QAAAD,EAAA,EAAAA,EAAA0B,UAAAV,OAAAhB,IAAA,KAAAG,EAAA,MAAAuB,UAAA1B,GAAA0B,UAAA1B,GAAA,GAAAA,EAAA,EAAAoa,EAAAjY,OAAAhC,IAAA,GAAA6K,QAAA,SAAAhL,IAAA,EAAAqI,EAAA,SAAApI,EAAAD,EAAAG,EAAAH,GAAA,GAAAmC,OAAAyY,0BAAAzY,OAAA0Y,iBAAA5a,EAAAkC,OAAAyY,0BAAAza,IAAAia,EAAAjY,OAAAhC,IAAA6K,QAAA,SAAAhL,GAAAmC,OAAAC,eAAAnC,EAAAD,EAAAmC,OAAAoY,yBAAApa,EAAAH,GAAA,UAAAC,CAAA,CAgB5B6a,CAAA,GAAQ7K,GAEpB,IAAK,IAAM5N,KAAOuU,EACjB,GAAIzU,OAAON,UAAUkZ,eAAeha,KAAK6V,EAAQvU,GAAM,CACtD,IAAM2Y,EAAcpE,EAAOvU,GACrB4Y,EAAehL,EAAe5N,GAEhC+R,MAAMC,QAAQ2G,GAEhBL,EAAetY,GAAO2Y,EAEtBL,EAAetY,GADN2Y,aAAuB7Y,QAAiC,mBAAhB6Y,GAA8BC,aAAuB9Y,OAChF+B,KAAK2E,UAAUoS,EAAaD,GAE5BA,CAEzB,CAGD,OAAOL,CACR,GAAC,CAAAtY,IAAA,eAAAC,MAOM,SAAoB4Y,GAC1B,IAAMC,EAAO3S,SAASgB,cAAc,OAEpC,OADA2R,EAAK/P,YAAc8P,EACZC,EAAKtR,SACb,IAAC,CA5CyB,CAAQjC,EAAA,Q,yaC+YjC9G,EAAA,QAjZa,q3T","ignoreList":[]}