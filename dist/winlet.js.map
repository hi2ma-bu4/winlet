{
  "version": 3,
  "sources": [
    "node_modules/browser-pack/_prelude.js",
    "node_modules/@babel/runtime/helpers/OverloadYield.js",
    "node_modules/@babel/runtime/helpers/arrayLikeToArray.js",
    "node_modules/@babel/runtime/helpers/arrayWithHoles.js",
    "node_modules/@babel/runtime/helpers/arrayWithoutHoles.js",
    "node_modules/@babel/runtime/helpers/assertThisInitialized.js",
    "node_modules/@babel/runtime/helpers/asyncToGenerator.js",
    "node_modules/@babel/runtime/helpers/classCallCheck.js",
    "node_modules/@babel/runtime/helpers/construct.js",
    "node_modules/@babel/runtime/helpers/createClass.js",
    "node_modules/@babel/runtime/helpers/defineProperty.js",
    "node_modules/@babel/runtime/helpers/getPrototypeOf.js",
    "node_modules/@babel/runtime/helpers/inherits.js",
    "node_modules/@babel/runtime/helpers/interopRequireDefault.js",
    "node_modules/@babel/runtime/helpers/isNativeFunction.js",
    "node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js",
    "node_modules/@babel/runtime/helpers/iterableToArray.js",
    "node_modules/@babel/runtime/helpers/iterableToArrayLimit.js",
    "node_modules/@babel/runtime/helpers/nonIterableRest.js",
    "node_modules/@babel/runtime/helpers/nonIterableSpread.js",
    "node_modules/@babel/runtime/helpers/possibleConstructorReturn.js",
    "node_modules/@babel/runtime/helpers/regenerator.js",
    "node_modules/@babel/runtime/helpers/regeneratorAsync.js",
    "node_modules/@babel/runtime/helpers/regeneratorAsyncGen.js",
    "node_modules/@babel/runtime/helpers/regeneratorAsyncIterator.js",
    "node_modules/@babel/runtime/helpers/regeneratorDefine.js",
    "node_modules/@babel/runtime/helpers/regeneratorKeys.js",
    "node_modules/@babel/runtime/helpers/regeneratorRuntime.js",
    "node_modules/@babel/runtime/helpers/regeneratorValues.js",
    "node_modules/@babel/runtime/helpers/setPrototypeOf.js",
    "node_modules/@babel/runtime/helpers/slicedToArray.js",
    "node_modules/@babel/runtime/helpers/toConsumableArray.js",
    "node_modules/@babel/runtime/helpers/toPrimitive.js",
    "node_modules/@babel/runtime/helpers/toPropertyKey.js",
    "node_modules/@babel/runtime/helpers/typeof.js",
    "node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js",
    "node_modules/@babel/runtime/helpers/wrapNativeSuper.js",
    "node_modules/@babel/runtime/regenerator/index.js",
    "src/const/config.ts",
    "src/const/errors.ts",
    "src/const/types.ts",
    "src/function/window.ts",
    "src/function/window_manager.ts",
    "src/index.ts",
    "src/libs/baseclass.ts",
    "src/libs/utils.ts",
    "src/style/styles.ts",
    "src/style/themes/dark.ts",
    "src/style/themes/default.ts",
    "src/style/themes/high-contrast.ts",
    "src/version.ts"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZO,IAAM,aAAa,GAAA,OAAA,CAAA,aAAA,GAA4B;EACrD,EAAE,EAAE,IAAI;EACR,QAAQ,EAAE,OAAO;EACjB,KAAK,EAAE,YAAY;EACnB,IAAI,EAAE,IAAI;EACV,CAAC,EAAE,MAAM;EACT,CAAC,EAAE,MAAM;EACT,KAAK,EAAE,GAAG;EACV,MAAM,EAAE,GAAG;EACX,QAAQ,EAAE,GAAG;EACb,SAAS,EAAE,GAAG;EACd,aAAa,EAAE,IAAI;EACnB,eAAe,EAAE,IAAI;EACrB,aAAa,EAAE;IACd,UAAU,EAAE,IAAI;IAChB,UAAU,EAAE,IAAI;IAChB,OAAO,EAAE,IAAI;IACb,QAAQ,EAAE,IAAI;IACd,WAAW,EAAE,IAAI;IACjB,WAAW,EAAE,IAAI;IACjB,qBAAqB,EAAE,IAAI;IAC3B,KAAK,EAAE,IAAI;IACX,WAAW,EAAE,KAAK;IAClB,cAAc,EAAE,KAAK;IACrB,OAAO,EAAE,GAAG;IACZ,KAAK,EAAE;GACP;EACD,OAAO,EAAE;IACR,IAAI,EAAE,EAAE;IACR,MAAM,EAAE;MACP,GAAG,EAAE,EAAE;MACP,MAAM,EAAE,EAAE;MACV,KAAK,EAAE,EAAE;MACT,cAAc,EAAE,EAAE;MAClB,OAAO,EAAE,MAAM;MACf,OAAO,EAAE,EAAE;MACX,UAAU,EAAE;KACZ;IACD,QAAQ,EAAE;GACV;EACD,SAAS,EAAE;IACV,SAAS,EAAE,YAAY;IACvB,KAAK,EAAE;GACP;EACD,SAAS,EAAE;IACV,OAAO,EAAE,KAAK;IACd,IAAI,EAAE,EAAE;IACR,SAAS,EAAE;GACX;EACD,MAAM,EAAE;IACP,OAAO,EAAE,KAAK;IACd,aAAa,EAAE,KAAK;IACpB,uBAAuB,EAAE,IAAI;IAC7B,eAAe,EAAE,IAAI;IACrB,mBAAmB,EAAE,IAAI;IACzB,cAAc,EAAE;GAChB;EACD,IAAI,EAAE,EAAE;EACR,SAAS,EAAE,SAAS;EACpB,IAAI,EAAE,EAAE;EACR,QAAQ,EAAE,SAAS;EACnB,UAAU,EAAE;IACX,WAAW,EAAE,KAAK;IAClB,QAAQ,EAAE,KAAK;IACf,OAAO,EAAE,KAAK;IACd,UAAU,EAAE,KAAK;IACjB,SAAS,EAAE,KAAK;IAChB,kBAAkB,EAAE,KAAK;IACzB,KAAK,EAAE,SAAS;IAChB,cAAc,EAAE;GAChB;EACD,cAAc,EAAE;IACf,YAAY,EAAE;GACd;EACD,WAAW,EAAE,EAAE;EACf,cAAc,EAAE,EAAE;EAClB,eAAe,EAAE,IAAI;EACrB,gBAAgB,EAAE,OAAO;EACzB,oBAAoB,EAAE,IAAI;EAC1B,QAAQ,EAAE,KAAK;EACf,gBAAgB,EAAE,KAAK;EACvB,kBAAkB,EAAE,KAAK;EACzB,sBAAsB,EAAE,IAAI;EAC5B,yBAAyB,EAAE,MAAM;EACjC,+BAA+B,EAAE,IAAI;EACrC,MAAM,EAAE,SAAR,MAAM,CAAA,EAAO,CAAE,CAAC;EAChB,OAAO,EAAE,SAAT,OAAO,CAAA,EAAO,CAAE,CAAC;EACjB,OAAO,EAAE,SAAT,OAAO,CAAA,EAAO,CAAE,CAAC;EACjB,MAAM,EAAE,SAAR,MAAM,CAAA,EAAO,CAAE,CAAC;EAChB,QAAQ,EAAE,SAAV,QAAQ,CAAA,EAAO,CAAE,CAAC;EAClB,MAAM,EAAE,SAAR,MAAM,CAAA,EAAO,CAAE,CAAC;EAChB,QAAQ,EAAE,SAAV,QAAQ,CAAA,EAAO,CAAE,CAAC;EAClB,aAAa,EAAE,SAAf,aAAa,CAAA,EAAO,CAAE,CAAC;EACvB,WAAW,EAAE,SAAb,WAAW,CAAA,EAAO,CAAE,CAAC;EACrB,SAAS,EAAE,SAAX,SAAS,CAAA,EAAO,CAAE,CAAC;EACnB,aAAa,EAAE,SAAf,aAAa,CAAA,EAAO,CAAE,CAAC;EACvB,WAAW,EAAE,SAAb,WAAW,CAAA,EAAO,CAAE,CAAC;EAErB,QAAQ,EAAE,KAAK;EACf,OAAO,EAAE,IAAI;EACb,YAAY,EAAE;CACd;;;;;;;;;;;;;;;;;;ICjGY,eAAgB,GAAA,OAAA,CAAA,eAAA,aAAA,MAAA;EAC5B,SAAA,gBAAY,OAAe;IAAA,IAAA,KAAA;IAAA,IAAA,gBAAA,mBAAA,eAAA;IAC1B,KAAA,GAAA,UAAA,OAAA,eAAA,GAAM,OAAO;IACb,KAAA,CAAK,IAAI,GAAG,KAAA,CAAK,WAAW,CAAC,IAAI;IAEjC,IAAM,YAAY,GAAqB,KAAyB;IAChE,IAAI,YAAY,CAAC,iBAAiB,EAAE;MACnC,YAAY,CAAC,iBAAiB,CAAA,KAAA,EAAO,KAAA,CAAK,WAAW,CAAC;IACvD;IAAC,OAAA,KAAA;EACF;EAAC,IAAA,UAAA,aAAA,eAAA,EAAA,MAAA;EAAA,WAAA,aAAA,aAAA,eAAA;AAAA,MAAA,iBAAA,aATmC,KAAK;AAAA,IAe7B,WAAY,GAAA,OAAA,CAAA,WAAA,aAAA,gBAAA;EACxB,SAAA,YAAY,OAAe;IAAA,IAAA,gBAAA,mBAAA,WAAA;IAAA,OAAA,UAAA,OAAA,WAAA,GACpB,OAAO;EACd;EAAC,IAAA,UAAA,aAAA,WAAA,EAAA,gBAAA;EAAA,WAAA,aAAA,aAAA,WAAA;AAAA,EAH+B,eAAe;AAAA,IAMnC,WAAY,GAAA,OAAA,CAAA,WAAA,aAAA,YAAA;EAAA,SAAA,YAAA;IAAA,IAAA,gBAAA,mBAAA,WAAA;IAAA,OAAA,UAAA,OAAA,WAAA,EAAA,SAAA;EAAA;EAAA,IAAA,UAAA,aAAA,WAAA,EAAA,YAAA;EAAA,WAAA,aAAA,aAAA,WAAA;AAAA,EAAQ,WAAW;;;;;;;;;AC5BrC,IAAM,YAAY,GAAA,OAAA,CAAA,YAAA,GAAG,QAAQ;AA0nB7B,IAAM,cAAc,GAAA,OAAA,CAAA,cAAA,GAAG,MAAM,CAAC,SAAS,CAAC;AACxC,IAAM,mBAAmB,GAAA,OAAA,CAAA,mBAAA,GAAG,MAAM,CAAC,OAAO,CAAC;;;;;;;;;;;;;;;;;;;;AC3nBlD,IAAA,OAAA,GAAA,OAAA;AACA,IAAA,OAAA,GAAA,OAAA;AACA,IAAA,MAAA,GAAA,OAAA;AACA,IAAA,UAAA,GAAA,sBAAA,CAAA,OAAA;AACA,IAAA,MAAA,GAAA,sBAAA,CAAA,OAAA;AACA,IAAA,eAAA,GAAA,sBAAA,CAAA,OAAA;AAA6C,SAAA,QAAA,CAAA,EAAA,CAAA,QAAA,CAAA,GAAA,MAAA,CAAA,IAAA,CAAA,CAAA,OAAA,MAAA,CAAA,qBAAA,QAAA,CAAA,GAAA,MAAA,CAAA,qBAAA,CAAA,CAAA,GAAA,CAAA,KAAA,CAAA,GAAA,CAAA,CAAA,MAAA,WAAA,CAAA,WAAA,MAAA,CAAA,wBAAA,CAAA,CAAA,EAAA,CAAA,EAAA,UAAA,OAAA,CAAA,CAAA,IAAA,CAAA,KAAA,CAAA,CAAA,EAAA,CAAA,YAAA,CAAA;AAAA,SAAA,cAAA,CAAA,aAAA,CAAA,MAAA,CAAA,GAAA,SAAA,CAAA,MAAA,EAAA,CAAA,UAAA,CAAA,WAAA,SAAA,CAAA,CAAA,IAAA,SAAA,CAAA,CAAA,QAAA,CAAA,OAAA,OAAA,CAAA,MAAA,CAAA,CAAA,OAAA,OAAA,WAAA,CAAA,QAAA,gBAAA,aAAA,CAAA,EAAA,CAAA,EAAA,CAAA,CAAA,CAAA,SAAA,MAAA,CAAA,yBAAA,GAAA,MAAA,CAAA,gBAAA,CAAA,CAAA,EAAA,MAAA,CAAA,yBAAA,CAAA,CAAA,KAAA,OAAA,CAAA,MAAA,CAAA,CAAA,GAAA,OAAA,WAAA,CAAA,IAAA,MAAA,CAAA,cAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,CAAA,wBAAA,CAAA,CAAA,EAAA,CAAA,iBAAA,CAAA;AAAA,SAAA,WAAA,CAAA,EAAA,CAAA,EAAA,CAAA,WAAA,CAAA,OAAA,gBAAA,aAAA,CAAA,OAAA,2BAAA,aAAA,CAAA,EAAA,yBAAA,KAAA,OAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,YAAA,gBAAA,aAAA,CAAA,EAAA,WAAA,IAAA,CAAA,CAAA,KAAA,CAAA,CAAA,EAAA,CAAA;AAAA,SAAA,0BAAA,cAAA,CAAA,IAAA,OAAA,CAAA,SAAA,CAAA,OAAA,CAAA,IAAA,CAAA,OAAA,CAAA,SAAA,CAAA,OAAA,iCAAA,CAAA,aAAA,yBAAA,YAAA,0BAAA,aAAA,CAAA;AAAA,IAExB,YAAa,GAAA,OAAA,wBAAA,gBAAA;EAsDjC,SAAA,aAAY,OAAsB,EAAE,OAAsB;IAAA,IAAA,KAAA;IAAA,IAAA,gBAAA,mBAAA,YAAA;IACzD,KAAA,GAAA,UAAA,OAAA,YAAA;IAAQ,IAAA,gBAAA,aAAA,KAAA,WAnDmB,QAAQ;IAAA,IAAA,gBAAA,aAAA,KAAA,eAGhB;MAAE,CAAC,EAAE,CAAC;MAAE,CAAC,EAAE,CAAC;MAAE,KAAK,EAAE,CAAC;MAAE,MAAM,EAAE;IAAC,CAAE;IAAA,IAAA,gBAAA,aAAA,KAAA,aAC5B,KAAK;IAAA,IAAA,gBAAA,aAAA,KAAA,oBACE,CAAC;IAAA,IAAA,gBAAA,aAAA,KAAA,UAQ8B,EAAE;IAAA,IAAA,gBAAA,aAAA,KAAA,eAC3B,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,gBACvB,KAAK;IAAA,IAAA,gBAAA,aAAA,KAAA,6BAC8C,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,iBAElC,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,iBACJ,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,mBACP,EAAE;IAAA,IAAA,gBAAA,aAAA,KAAA,wBACZ,CAAC,CAAC;IAAA,IAAA,gBAAA,aAAA,KAAA,wBAGF;MAC5B,aAAa,EAAE,KAAK;MACpB,KAAK,EAAE,KAAK;MACZ,SAAS,EAAE;KACX;IAAA,IAAA,gBAAA,aAAA,KAAA,iCAG8C,GAAG;IAAA,IAAA,gBAAA,aAAA,KAAA,sBACR,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,wBAGsB,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,kBAE3B,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,oBAGJ,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,qBACvB,KAAK;IAAA,IAAA,gBAAA,aAAA,KAAA,uBACkB,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,yBACF,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,oBACf,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,qBACE,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,yBACA,MAAM;IAAA,IAAA,gBAAA,aAAA,KAAA,6BACP,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,6BACsB,CAAC,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,UAAU,CAAC;IAIrH,KAAA,CAAK,EAAE,GAAG,OAAO,CAAC,EAAE,IAAI,iBAAK,CAAC,UAAU,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;IAClE,IAAI,OAAO,CAAC,EAAE,EAAE;MACf,IAAM,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE,CAAC;MACtD,IAAI,UAAU,IAAI,UAAU,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC,EAAE;QAC1E,MAAM,IAAI,mBAAW,6BAAA,MAAA,CAA4B,OAAO,CAAC,EAAE,uDAAmD,CAAC;MAChH;IACD;IACA,KAAA,CAAK,OAAO,GAAG,OAAO;IACtB,KAAA,CAAK,OAAO,GAAG,iBAAK,CAAC,SAAS,CAAC,iBAAK,CAAC,QAAQ,CAAC,qBAAa,CAAC,EAAE,OAAO,CAA4B;IACjG,KAAA,CAAK,YAAY,GAAG,OAAO,CAAC,OAAO,IAAI,IAAI;IAG3C,KAAA,CAAK,kBAAkB,CAAC,aAAa,GAAG,CAAC,CAAC,KAAA,CAAK,OAAO,CAAC,MAAM,CAAC,aAAa;IAG3E,IAAM,iBAAiB,GAAG,KAAA,CAAK,OAAO,CAAC,eAAe,EAAE,CAAC,eAAe;IACxE,IAAI,CAAC,KAAA,CAAK,OAAO,CAAC,gBAAgB,EAAE;MACnC,IAAM,KAAK,GAAG,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,SAAS;MAC1C,IAAM,QAAQ,GAAG,SAAX,QAAQ,CAAA;QAAA,OAAS,KAAA,CAAK,IAAI,CAAC,MAAM,EAAA,KAAM,CAAC;MAAA;MAC9C,KAAA,CAAK,iBAAiB,GAAG,KAAK,IAAI,KAAK,GAAG,CAAC,GAAG,iBAAK,CAAC,QAAQ,CAAC,QAAQ,EAAE,KAAK,CAAC,GAAG,QAAQ;IACzF;IACA,IAAI,CAAC,KAAA,CAAK,OAAO,CAAC,kBAAkB,EAAE;MACrC,IAAM,MAAK,GAAG,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,WAAW;MAC5C,IAAM,UAAU,GAAG,SAAb,UAAU,CAAA;QAAA,OAAS,KAAA,CAAK,IAAI,CAAC,QAAQ,EAAA,KAAM,CAAC;MAAA;MAClD,KAAA,CAAK,mBAAmB,GAAG,MAAK,IAAI,MAAK,GAAG,CAAC,GAAG,iBAAK,CAAC,QAAQ,CAAC,UAAU,EAAE,MAAK,CAAC,GAAG,UAAU;IAC/F;IAEA,KAAA,CAAK,EAAE,GAAG,KAAA,CAAK,SAAS,EAAE;IAG1B,IAAI,KAAA,CAAK,OAAO,CAAC,QAAQ,EAAE;MAC1B,KAAA,CAAK,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,kBAAe,CAAC;IACtD;IAEA,IAAI,KAAA,CAAK,OAAO,CAAC,QAAQ,KAAK,QAAQ,EAAE;MACvC,KAAA,CAAK,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,sBAAmB,CAAC;IAC1D;IACA,IAAI,KAAA,CAAK,OAAO,CAAC,SAAS,KAAK,QAAQ,EAAE;MACxC,KAAA,CAAK,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,uBAAoB,CAAC;IAC3D;IAEA,IAAI,KAAA,CAAK,OAAO,CAAC,aAAa,CAAC,WAAW,EAAE;MAC3C,KAAA,CAAK,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,mBAAgB,CAAC;IACvD;IACA,IAAI,KAAA,CAAK,OAAO,CAAC,aAAa,CAAC,KAAK,EAAE;MACrC,KAAA,CAAK,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,WAAQ,CAAC;MAC9C,KAAA,CAAK,EAAE,CAAC,YAAY,CAAC,YAAY,EAAE,MAAM,CAAC;IAC3C;IAEA,KAAA,CAAK,UAAU,GAAG,KAAA,CAAK,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,eAAY,CAAE;IACnF,KAAA,CAAK,MAAM,GAAG,KAAA,CAAK,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,UAAO,CAAE;IAC1E,KAAA,CAAK,OAAO,GAAG,KAAA,CAAK,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,WAAQ,CAAE;IAC5E,KAAA,CAAK,aAAa,GAAG,KAAA,CAAK,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,kBAAe,CAAE;IACzF,KAAA,CAAK,SAAS,GAAG,KAAA,CAAK,aAAa,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,aAAU,CAAE;IAC3F,KAAA,CAAK,QAAQ,GAAG,KAAA,CAAK,aAAa,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,oBAAiB,CAAE;IACjG,KAAA,CAAK,eAAe,GAAG,KAAA,CAAK,aAAa,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,oBAAiB,CAAE;IACxG,KAAA,CAAK,cAAc,GAAG,KAAA,CAAK,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,mBAAgB,CAAC;IAC1F,KAAA,CAAK,WAAW,GAAG,KAAA,CAAK,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,eAAY,CAAC;IAEnF,KAAA,CAAK,YAAY,EAAE;IACnB,KAAA,CAAK,mBAAmB,EAAE;IAC1B,KAAA,CAAK,kBAAkB,EAAE;IAGzB,IAAI,KAAA,CAAK,OAAO,CAAC,MAAM,EAAE,KAAA,CAAK,EAAE,CAAC,MAAM,EAAE,KAAA,CAAK,OAAO,CAAC,MAAM,CAAC;IAC7D,IAAI,KAAA,CAAK,OAAO,CAAC,OAAO,EAAE,KAAA,CAAK,EAAE,CAAC,OAAO,EAAE,KAAA,CAAK,OAAO,CAAC,OAAO,CAAC;IAChE,IAAI,KAAA,CAAK,OAAO,CAAC,aAAa,EAAE,KAAA,CAAK,EAAE,CAAC,cAAc,EAAE,KAAA,CAAK,OAAO,CAAC,aAAa,CAAC;IACnF,IAAI,KAAA,CAAK,OAAO,CAAC,OAAO,EAAE,KAAA,CAAK,EAAE,CAAC,OAAO,EAAE,KAAA,CAAK,OAAO,CAAC,OAAO,CAAC;IAChE,IAAI,KAAA,CAAK,OAAO,CAAC,MAAM,EAAE,KAAA,CAAK,EAAE,CAAC,MAAM,EAAE,KAAA,CAAK,OAAO,CAAC,MAAM,CAAC;IAC7D,IAAI,KAAA,CAAK,OAAO,CAAC,MAAM,EAAE,KAAA,CAAK,EAAE,CAAC,MAAM,EAAE,KAAA,CAAK,OAAO,CAAC,MAAM,CAAC;IAC7D,IAAI,KAAA,CAAK,OAAO,CAAC,WAAW,EAAE,KAAA,CAAK,EAAE,CAAC,YAAY,EAAE,KAAA,CAAK,OAAO,CAAC,WAAW,CAAC;IAC7E,IAAI,KAAA,CAAK,OAAO,CAAC,SAAS,EAAE,KAAA,CAAK,EAAE,CAAC,UAAU,EAAE,KAAA,CAAK,OAAO,CAAC,SAAS,CAAC;IACvE,IAAI,KAAA,CAAK,OAAO,CAAC,QAAQ,EAAE,KAAA,CAAK,EAAE,CAAC,QAAQ,EAAE,KAAA,CAAK,OAAO,CAAC,QAAQ,CAAC;IACnE,IAAI,KAAA,CAAK,OAAO,CAAC,aAAa,EAAE,KAAA,CAAK,EAAE,CAAC,cAAc,EAAE,KAAA,CAAK,OAAO,CAAC,aAAa,CAAC;IACnF,IAAI,KAAA,CAAK,OAAO,CAAC,WAAW,EAAE,KAAA,CAAK,EAAE,CAAC,YAAY,EAAE,KAAA,CAAK,OAAO,CAAC,WAAW,CAAC;IAC7E,IAAI,KAAA,CAAK,OAAO,CAAC,QAAQ,EAAE,KAAA,CAAK,EAAE,CAAC,QAAQ,EAAE,KAAA,CAAK,OAAO,CAAC,QAAQ,CAAC;IAEnE,KAAA,CAAK,IAAI,CAAC,MAAM,EAAA,KAAM,CAAC;IAAC,OAAA,KAAA;EACzB;EAAC,IAAA,UAAA,aAAA,YAAA,EAAA,gBAAA;EAAA,WAAA,aAAA,aAAA,YAAA;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,yBAAyB,CAAC,MAA+B;MAChE,IAAI,OAAO,GAAG,CAAC;MACf,IAAI,OAAO,GAAG,CAAC;MAEf,IAAM,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,qBAAqB,EAAE;MAG/C,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,kBAAkB,IAAI,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;QAC9F,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY;MACnC;MAEA,IAAI,MAAM,YAAY,WAAW,EAAE;QAClC,IAAM,IAAI,GAAG,MAAM,CAAC,qBAAqB,EAAE;QAC3C,OAAO,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC;QACpC,OAAO,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC;MACrC,CAAC,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;QACtC,IAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC;QACzC,IAAI,EAAE,EAAE;UACP,IAAM,KAAI,GAAG,EAAE,CAAC,qBAAqB,EAAE;UACvC,OAAO,GAAG,KAAI,CAAC,IAAI,GAAG,KAAI,CAAC,KAAK,GAAG,CAAC;UACpC,OAAO,GAAG,KAAI,CAAC,GAAG,GAAG,KAAI,CAAC,MAAM,GAAG,CAAC;QACrC;MACD,CAAC,MAAM,IAAI,MAAM,YAAY,UAAU,EAAE;QACxC,OAAO,GAAG,MAAM,CAAC,OAAO;QACxB,OAAO,GAAG,MAAM,CAAC,OAAO;MACzB,CAAC,MAAM,IAAI,MAAM,IAAI,IAAA,QAAA,aAAO,MAAM,MAAK,QAAQ,IAAI,GAAG,IAAI,MAAM,IAAI,GAAG,IAAI,MAAM,EAAE;QAClF,OAAO,GAAG,MAAM,CAAC,CAAC;QAClB,OAAO,GAAG,MAAM,CAAC,CAAC;MACnB,CAAC,MAAM;QAEN;MACD;MAGA,IAAM,SAAS,GAAG,OAAO,GAAG,OAAO,CAAC,IAAI;MACxC,IAAM,SAAS,GAAG,OAAO,GAAG,OAAO,CAAC,GAAG;MAEvC,UAAA,MAAA,CAAU,SAAS,SAAA,MAAA,CAAM,SAAS;IACnC;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,SAAS,CAAA;MAAA,IAAA,qBAAA;MAChB,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MAC9C,QAAQ,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,YAAS;MAC7C,QAAQ,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE;MAGrB,QAAQ,CAAC,YAAY,CAAC,MAAM,EAAE,aAAa,CAAC;MAC5C,QAAQ,CAAC,YAAY,CAAC,iBAAiB,KAAA,MAAA,CAAK,IAAI,CAAC,EAAE,WAAQ,CAAC;MAC5D,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;QAC/B,QAAQ,CAAC,YAAY,CAAC,OAAO,EAAE,EAAE,CAAC;QAClC,QAAQ,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC;MAC7C;MAEA,IAAM,OAAO,GAAa,EAAE;MAC5B,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,EAAE;QAC1C,OAAO,CAAC,IAAI,iBAAA,MAAA,CAAgB,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,kCAAA,MAAA,CAA6B,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,gBAAY,CAAC;MAC3J;MACA,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,EAAE;QAC1C,OAAO,CAAC,IAAI,iBAAA,MAAA,CAAgB,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,kCAAA,MAAA,CAA6B,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,gBAAY,CAAC;MAC3J;MACA,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,EAAE;QACnF,OAAO,CAAC,IAAI,iBAAA,MAAA,CAAgB,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,mCAAA,MAAA,CAA8B,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,mCAAA,MAAA,CAA8B,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,mCAAA,MAAA,CAA8B,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,iBAAa,CAAC;MAC7S;MACA,IAAM,oBAAoB,GAAG,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC;MAE7C,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC;MAC5C,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC;MAC5C,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,KAAK,QAAQ,IAAI,OAAO;MACnE,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,QAAQ,IAAI,OAAO;MAElE,IAAM,kBAAkB,GAAG,EAAA,qBAAA,GAAC,IAAI,CAAC,OAAO,CAAC,cAAc,cAAA,qBAAA,cAAA,qBAAA,GAAI,EAAE,EAAE,GAAG,CAAC,UAAC,CAAC;QAAA,0BAAA,MAAA,CAAuB,mBAAY,mBAAA,MAAA,CAAgB,mBAAY,wCAAA,MAAA,CAAmC,CAAC,CAAC,IAAI,iBAAA,MAAA,CAAY,CAAC,CAAC,KAAK,IAAI,EAAE,sBAAA,MAAA,CAAiB,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,IAAI,SAAA,MAAA,CAAK,CAAC,CAAC,IAAI;MAAA,CAAW,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC;MAExQ,IAAM,cAAc,sBAAA,MAAA,CAAqB,mBAAY,mBAAA,MAAA,CAAgB,mBAAY,uHAA6G;MAC9L,IAAM,YAAY,iCAAA,MAAA,CACM,mBAAY,4BAAA,MAAA,CAChC,kBAAkB,gBAAA,MAAA,CAClB,cAAc,wBAAA,MAAA,CACF,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,qBAAA,MAAA,CAAoB,mBAAY,mBAAA,MAAA,CAAgB,mBAAY,qGAAyF,EAAE,wBAAA,MAAA,CAC7L,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,qBAAA,MAAA,CAAoB,mBAAY,mBAAA,MAAA,CAAgB,mBAAY,qGAAyF,EAAE,wBAAA,MAAA,CAC7L,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,QAAQ,qBAAA,MAAA,CAAoB,mBAAY,mBAAA,MAAA,CAAgB,mBAAY,4FAAgF,EAAE,yBAChL;MAEjB,IAAM,mBAAmB,iCAAA,MAAA,CACD,mBAAY,kCAAA,MAAA,CACxB,YAAY,mBAAA,MAAA,CAAkB,mBAAY,0BAAsB,EAAE,8BAAA,MAAA,CACzD,IAAI,CAAC,EAAE,uBAAA,MAAA,CAAkB,mBAAY,mCAAA,MAAA,CAC9C,YAAY,mBAAA,MAAA,CAAkB,mBAAY,yBAAqB,EAAE,oBAAA,MAAA,CACjE,YAAY,eACjB;MAEP,IAAM,UAAU,iCAAA,MAAA,CACQ,mBAAY,gFAAA,MAAA,CACR,mBAAY,2DAEjC;MAEP,IAAM,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,OAAO,mBAAA,MAAA,CAAkB,mBAAY,2BAAuB,EAAE;MAC3G,IAAM,SAAS,mBAAA,MAAA,CAAkB,mBAAY,4BAAwB;MACrE,IAAM,iBAAiB,mBAAA,MAAA,CAAkB,mBAAY,6BAAyB;MAE9E,QAAQ,CAAC,SAAS,cAAA,MAAA,CACf,SAAS,iCAAA,MAAA,CACY,mBAAY,iBAAA,MAAA,CAAc,mBAAY,mCAAA,MAAA,CAC9C,mBAAmB,qDAAA,MAAA,CAEX,mBAAY,wCAAA,MAAA,CACpB,CAAC,YAAY,IAAI,OAAO,mBAAA,MAAA,CAAkB,mBAAY,2CAAqC,EAAE,wBAAA,MAAA,CAC7F,CAAC,YAAY,IAAI,OAAO,mBAAA,MAAA,CAAkB,mBAAY,0CAAoC,EAAE,qCAAA,MAAA,CAChF,mBAAY,iCAAA,MAAA,CACpC,UAAU,gBAAA,MAAA,CACV,iBAAiB,kCAAA,MAAA,CAElB,aAAa,oBAAA,MAAA,CACJ,oBAAoB,eACzB;MACP,OAAO,QAAQ;IAChB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,qBAAqB,CAAA;MAC5B,IAAI,IAAI,CAAC,eAAe,EAAE;MAG1B,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;QACtE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;MAC7D,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;QACxC,IAAI,CAAC,UAAU,EAAE;MAClB,CAAC,MAAM;QACN,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;MACzD;MACA,IAAI,CAAC,eAAe,GAAG,IAAI;IAC5B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,YAAY,CAAA;MACnB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC;MACjC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;MAC/B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;MACrD,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,MAAA,MAAA,CAAM,IAAI,CAAC,OAAO,CAAC,QAAQ,OAAI;MACrD,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,SAAS,MAAA,MAAA,CAAM,IAAI,CAAC,OAAO,CAAC,SAAS,OAAI;MAEvD,IAAI,IAAI,CAAC,OAAO,CAAC,gBAAgB,KAAK,MAAM,EAAE;QAC7C,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,mBAAgB,CAAC;MAC/D;MAEA,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;QAC3B,IAAI,CAAC,qBAAqB,EAAE;MAC7B,CAAC,MAAM;QACN,IAAI,CAAC,UAAU,EAAE;MAClB;MAEA,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;QACjC,IAAI,CAAC,UAAU,EAAE;MAClB;MACA,IAAI,IAAI,CAAC,WAAW,EAAE;QACrB,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,IAAI,EAAE,CAAC;MACzD;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,UAAU,CAAA;MACjB,IAAI,IAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE;QACtC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM;MACrC;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,UAAU,CAAA;MACjB,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM;IACrC;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,aAAa,CAAC,SAAsB,EAAE,OAA6B;MAAA,IAAA,MAAA;MAC1E,SAAS,CAAC,SAAS,GAAG,EAAE;MACxB,IAAI,CAAC,UAAU,EAAE;MAEjB,IAAI,IAAI,CAAC,mBAAmB,KAAK,UAAU,EAAE;QAC5C;MACD;MAEA,IAAI,OAAO,CAAC,QAAQ,EAAE;QACrB,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAsB,OAAO,CAAC,QAAQ,CAAC;QAC9E,IAAI,CAAA,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,OAAO,MAAK,UAAU,EAAE;UACrC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACxD,CAAC,MAAM;UACN,SAAS,CAAC,SAAS,GAAG,uCAAuC;UAC7D,OAAO,CAAC,IAAI,CAAC,gDAAgD,CAAC;QAC/D;MACD,CAAC,MAAM,IAAI,OAAO,CAAC,IAAI,EAAE;QACxB,SAAS,CAAC,SAAS,GAAG,OAAO,CAAC,IAAI;MACnC,CAAC,MAAM,IAAI,iBAAK,CAAC,gBAAgB,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,OAAO,CAAC,MAAM,CAAC,GAAG,IAAI,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE;QACnG,IAAI,CAAC,UAAU,EAAE;QACjB,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC;QAC/C,IAAM,YAAY,GAAG,OAAO,CAAC,MAAM;QACnC,IAAI,YAAY,CAAC,GAAG,EAAE;UACrB,MAAM,CAAC,GAAG,GAAG,YAAY,CAAC,GAAG;QAC9B;QACA,IAAI,YAAY,CAAC,MAAM,EAAE;UACxB,IAAI,WAAW,GAAG,YAAY,CAAC,MAAM;UACrC,IAAI,YAAY,CAAC,UAAU,EAAE;YAC5B,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE;YACnD,IAAI,YAAY,CAAC,WAAW,EAAE;cAC7B,IAAM,SAAS,oBAAA,MAAA,CAAmB,YAAY,CAAC,WAAW,iBAAc;cACxE,IAAM,UAAU,4HAA6H;cAC7I,WAAW,yDAAA,MAAA,CAAuD,SAAS,EAAA,MAAA,CAAG,UAAU,mBAAA,MAAA,CAAgB,YAAY,CAAC,MAAM,mBAAgB;YAC5I,CAAC,MAAM;cACN,OAAO,CAAC,IAAI,CAAC,sFAAsF,CAAC;YACrG;UACD;UACA,MAAM,CAAC,MAAM,GAAG,WAAW;QAC5B;QACA,IAAI,YAAY,CAAC,KAAK,EAAE;UACvB,MAAM,CAAC,KAAK,GAAG,YAAY,CAAC,KAAK;QAClC;QACA,IAAI,YAAY,CAAC,cAAc,EAAE;UAChC,MAAM,CAAC,cAAc,GAAG,YAAY,CAAC,cAAc;QACpD;QACA,IAAI,YAAY,CAAC,OAAO,EAAE;UACzB,MAAM,CAAC,OAAO,GAAG,YAAY,CAAC,OAAO;QACtC;QACA,IAAI,YAAY,CAAC,OAAO,EAAE;UACzB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE;YACzC,YAAY,CAAC,OAAO,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC;UAC9C;UACA,IAAI,YAAY,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YACpC,MAAM,CAAC,YAAY,CAAC,SAAS,EAAE,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;UAC/D;QACD;QACA,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE;UAAA,OAAM,MAAI,CAAC,UAAU,EAAE;QAAA,EAAC;QACxD,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE;UAAA,OAAM,MAAI,CAAC,UAAU,EAAE;QAAA,EAAC;QACzD,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC;MAC9B,CAAC,MAAM;QACN,SAAS,CAAC,SAAS,GAAG,EAAE;MACzB;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,aAAa,CAAA;MACpB,IAAI,CAAC,EAAE,CAAC,gBAAgB,KAAA,MAAA,CAAkB,mBAAY,oBAAA,MAAA,CAAiB,mBAAY,mBAAgB,CAAC,CAAC,OAAO,CAAC,UAAC,EAAE,EAAI;QACnH,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM;MAC1B,CAAC,CAAC;MACF,IAAI,CAAC,UAAU,GAAG,KAAK;IACxB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,UAAU,CAAA;MAAA,IAAA,MAAA;MACjB,IAAM,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,cAAW,CAAE;MAChF,OAAO,CAAC,SAAS,GAAG,EAAE;MAEtB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,UAAC,YAAY,EAAI;QAAA,IAAA,kBAAA;QAC1C,IAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;QAChD,UAAU,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,iBAAA,MAAA,CAAc,mBAAY,aAAU;QAC1E,UAAU,CAAC,WAAW,IAAA,kBAAA,GAAG,YAAY,CAAC,IAAI,cAAA,kBAAA,cAAA,kBAAA,GAAI,EAAE;QAChD,UAAU,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC;QAEvC,IAAI,YAAY,CAAC,KAAK,EAAE;UACvB,IAAM,UAAU,GAAG,MAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,KAAK,CAAC;UAE9D,UAAU,CAAC,gBAAgB,CAC1B,OAAO,EACP,UAAC,CAAC,EAAI;YACL,CAAC,CAAC,eAAe,EAAE;YACnB,IAAM,SAAS,GAAG,UAAU,CAAC,KAAK,CAAC,OAAO,KAAK,OAAO;YACtD,MAAI,CAAC,aAAa,EAAE;YACpB,IAAI,CAAC,SAAS,EAAE;cACf,UAAU,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO;cAClC,MAAI,CAAC,UAAU,GAAG,IAAI;YACvB;UACD,CAAC,EACD;YAAE,OAAO,EAAE;UAAK,CAAE,CAClB;UAED,UAAU,CAAC,gBAAgB,CAC1B,YAAY,EACZ,YAAK;YACJ,IAAI,MAAI,CAAC,UAAU,EAAE;cACpB,MAAI,CAAC,aAAa,EAAE;cACpB,UAAU,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO;cAClC,MAAI,CAAC,UAAU,GAAG,IAAI;YACvB;UACD,CAAC,EACD;YAAE,OAAO,EAAE;UAAI,CAAE,CACjB;UAED,UAAU,CAAC,WAAW,CAAC,UAAU,CAAC;QACnC;QACA,OAAO,CAAC,WAAW,CAAC,UAAU,CAAC;MAChC,CAAC,CAAC;IACH;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,kBAAkB,CAAC,KAAiB;MAAA,IAAA,MAAA;MAC3C,IAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC;MAC/C,UAAU,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,mBAAgB;MAEtD,KAAK,CAAC,OAAO,CAAC,UAAC,QAAQ,EAAI;QAC1B,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC;QAC3C,IAAI,QAAQ,CAAC,SAAS,EAAE;UACvB,MAAM,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,eAAY;QAC/C,CAAC,MAAM;UAAA,IAAA,cAAA;UACN,IAAI,IAAI,IAAA,cAAA,GAAG,QAAQ,CAAC,IAAI,cAAA,cAAA,cAAA,cAAA,GAAI,EAAE;UAC9B,IAAI,YAAA,MAAA,CAAY,IAAI,YAAS;UAC7B,IAAI,MAAI,CAAC,OAAO,CAAC,eAAe,IAAI,QAAQ,CAAC,QAAQ,EAAE;YACtD,IAAI,qBAAA,MAAA,CAAoB,mBAAY,wBAAA,MAAA,CAAoB,QAAQ,CAAC,QAAQ,aAAU;UACpF;UACA,MAAM,CAAC,SAAS,mBAAA,MAAA,CAAkB,mBAAY,8CAAA,MAAA,CAAwC,IAAI,WAAQ;UAClG,MAAM,CAAC,gBAAgB,CACtB,OAAO,EACP,UAAC,CAAC,EAAI;YAAA,IAAA,gBAAA;YACL,CAAC,CAAC,eAAe,EAAE;YACnB,MAAI,CAAC,aAAa,EAAE;YACpB,CAAA,gBAAA,GAAA,QAAQ,CAAC,MAAM,cAAA,gBAAA,eAAf,gBAAA,CAAA,IAAA,CAAA,QAAQ,EAAU,MAAI,CAAC;UACxB,CAAC,EACD;YAAE,OAAO,EAAE;UAAK,CAAE,CAClB;UACD,IAAI,QAAQ,CAAC,KAAK,EAAE;YACnB,MAAM,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC;YACnD,IAAM,SAAS,GAAG,MAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,KAAK,CAAC;YACzD,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC;UAC9B;QACD;QACA,UAAU,CAAC,WAAW,CAAC,MAAM,CAAC;MAC/B,CAAC,CAAC;MACF,OAAO,UAAU;IAClB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,UAAU,CAAA;MAAA,IAAA,qBAAA;QAAA,MAAA;MACjB,IAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,aAAU,CAAE;MAC9E,MAAM,CAAC,SAAS,GAAG,EAAE;MACrB,IAAI,CAAC,IAAI,GAAG,EAAE;MACd,IAAM,OAAO,IAAA,qBAAA,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,cAAA,qBAAA,cAAA,qBAAA,GAAI,EAAE;MAE7C,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,UAAC,OAAO,EAAE,KAAK,EAAI;QAC5C,MAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAK,CAAC;MACtC,CAAC,CAAC;MAEF,IAAI,OAAO,CAAC,OAAO,EAAE;QACpB,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;QAC9C,IAAI,CAAC,SAAS,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,iBAAc;QACxD,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,GAAG;QAChC,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAC9B,OAAO,EACP,UAAC,CAAC,EAAI;UAAA,IAAA,cAAA;UACL,IAAM,UAAU,IAAA,cAAA,GAAG,OAAO,CAAC,KAAK,cAAA,cAAA,uBAAb,cAAA,CAAA,IAAA,CAAA,OAAO,EAAS,MAAI,CAAC;UACxC,IAAI,UAAU,EAAE;YACf,MAAI,CAAC,MAAM,CAAC,UAAU,CAAC;UACxB;QACD,CAAC,EACD;UAAE,OAAO,EAAE;QAAI,CAAE,CACjB;QACD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;MACnC;MAEA,IAAI,CAAC,mBAAmB,EAAE;MAE1B,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;IAC9C;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,mBAAmB,CAAA;MAAA,IAAA,MAAA;MAC1B,IAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,aAAU,CAAE;MAC9E,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,WAAW,EAAE;MAErD,MAAM,CAAC,gBAAgB,CACtB,UAAU,EACV,UAAC,CAAC,EAAI;QAAA,IAAA,eAAA;QACL,KAAA,eAAA,GAAI,CAAC,CAAC,YAAY,cAAA,eAAA,eAAd,eAAA,CAAgB,KAAK,CAAC,QAAQ,CAAC,wBAAwB,CAAC,EAAE;UAC7D,CAAC,CAAC,cAAc,EAAE;UAClB,IAAI,CAAC,CAAC,YAAY,EAAE,CAAC,CAAC,YAAY,CAAC,UAAU,GAAG,MAAM;UACtD,MAAM,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;QAClD;MACD,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;MACD,MAAM,CAAC,gBAAgB,CACtB,WAAW,EACX,YAAK;QACJ,MAAM,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;MACrD,CAAC,EACD;QAAE,OAAO,EAAE;MAAI,CAAE,CACjB;MACD,MAAM,CAAC,gBAAgB,CACtB,MAAM,EACN,UAAC,CAAC,EAAI;QAAA,IAAA,gBAAA,EAAA,gBAAA,EAAA,gBAAA,EAAA,qBAAA;QACL,CAAC,CAAC,cAAc,EAAE;QAClB,MAAM,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;QAEpD,IAAM,WAAW,IAAA,gBAAA,GAAG,CAAC,CAAC,YAAY,cAAA,gBAAA,uBAAd,gBAAA,CAAgB,OAAO,CAAC,wBAAwB,CAAC;QACrE,IAAM,cAAc,IAAA,gBAAA,GAAG,CAAC,CAAC,YAAY,cAAA,gBAAA,uBAAd,gBAAA,CAAgB,OAAO,CAAC,qCAAqC,CAAC;QACrF,IAAM,WAAW,IAAA,gBAAA,GAAG,CAAC,CAAC,YAAY,cAAA,gBAAA,uBAAd,gBAAA,CAAgB,OAAO,CAAC,YAAY,CAAC;QACzD,IAAI,CAAC,WAAW,IAAI,CAAC,cAAc,IAAI,CAAC,WAAW,EAAE;QAErD,IAAM,UAAU,IAAA,qBAAA,GAAG,MAAI,CAAC,OAAO,CAAC,SAAS,cAAA,qBAAA,uBAAtB,qBAAA,CAAwB,aAAa,KAAA,MAAA,CAAkB,mBAAY,WAAA,MAAA,CAAQ,mBAAY,cAAW,CAAC;QAGtH,IAAI,cAAc,KAAK,MAAI,CAAC,EAAE,EAAE;UAC/B,IAAI,UAAU,EAAE;YAEf,MAAI,CAAC,qBAAqB,EAAE;UAC7B;UACA;QACD;QAGA,IAAM,YAAY,GAAG,MAAI,CAAC,OAAO,CAAC,SAAS,CAAC,cAAc,CAAC;QAC3D,IAAI,YAAY,EAAE;UAAA,IAAA,qBAAA,EAAA,qBAAA;UACjB,IAAM,UAAU,GAAG,YAAY,CAAC,OAAO,CAAC,UAAU;UAClD,IAAM,UAAU,GAAG,MAAI,CAAC,OAAO,CAAC,UAAU;UAE1C,IAAM,WAAW,IAAA,qBAAA,GAAG,UAAU,CAAC,SAAS,cAAA,qBAAA,cAAA,qBAAA,GAAI,UAAU,CAAC,UAAU;UACjE,IAAM,cAAc,IAAA,qBAAA,GAAG,UAAU,CAAC,kBAAkB,cAAA,qBAAA,cAAA,qBAAA,GAAI,IAAI;UAC5D,IAAM,kBAAkB,GAAG,CAAC,UAAU,CAAC,cAAc,IAAI,UAAU,CAAC,cAAc,CAAC,YAAY,EAAE,MAAI,CAAC;UAEtG,IAAI,CAAC,WAAW,IAAI,CAAC,cAAc,IAAI,CAAC,kBAAkB,EAAE;YAC3D;UACD;UAEA,IAAM,OAAO,GAAY,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;UAChD,MAAI,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC;UAE1B,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QACjD;MACD,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;IACF;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,gBAAgB,CAAC,OAAgB,EAAE,KAAa;MAAA,IAAA,sBAAA;QAAA,MAAA;MACvD,IAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,aAAU,CAAE;MAC9E,IAAM,OAAO,IAAA,sBAAA,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,cAAA,sBAAA,cAAA,sBAAA,GAAI,EAAE;MAE7C,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MAC3C,KAAK,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,SAAM;MACvC,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,KAAK,CAAC;MACjC,KAAK,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC,QAAQ,EAAE;MAEtC,IAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC;MAC9C,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC,KAAK;MACnC,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC;MAG1B,MAAM,CAAC,YAAY,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC;MAE1C,IAAI,OAAO,CAAC,QAAQ,EAAE;QACrB,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC;QAC/C,QAAQ,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,mBAAgB;QACpD,QAAQ,CAAC,SAAS,GAAG,SAAS;QAC9B,QAAQ,CAAC,gBAAgB,CACxB,OAAO,EACP,UAAC,CAAC,EAAI;UACL,CAAC,CAAC,eAAe,EAAE;UAEnB,IAAM,YAAY,GAAG,MAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAC,CAAC;YAAA,OAAK,CAAC,CAAC,KAAK,KAAK,KAAK;UAAA,EAAC;UAClE,IAAI,YAAY,KAAK,CAAC,CAAC,EAAE;YACxB,MAAI,CAAC,QAAQ,CAAC,YAAY,CAAC;UAC5B;QACD,CAAC,EACD;UAAE,OAAO,EAAE;QAAK,CAAE,CAClB;QACD,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC;MAC5B;MAGA,IAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MAClD,YAAY,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,iBAAc;MACtD,YAAY,CAAC,YAAY,CAAC,MAAM,EAAE,UAAU,CAAC;MAC7C,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,YAAY,CAAC;MACxC,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,OAAO,CAAC,OAAO,CAAC;MAEjD,KAAK,CAAC,gBAAgB,CACrB,OAAO,EACP,UAAC,CAAC,EAAI;QACL,MAAI,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,KAAM,CAAC;MACxC,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;MACD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;QAAE,KAAK,EAAL,KAAK;QAAE,SAAS,EAAE;MAAY,CAAE,CAAC;MAE9D,IAAI,OAAO,CAAC,WAAW,EAAE;QACxB,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC;MAC/B;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,kBAAkB,CAAC,KAAkB;MAAA,IAAA,MAAA;MAC5C,KAAK,CAAC,SAAS,GAAG,IAAI;MACtB,KAAK,CAAC,gBAAgB,CACrB,WAAW,EACX,UAAC,CAAC,EAAI;QACL,CAAC,CAAC,YAAa,CAAC,OAAO,CAAC,YAAY,EAAE,KAAK,CAAC,OAAO,CAAC,KAAM,CAAC;QAC3D,KAAK,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,cAAW,CAAC;QAG/C,IAAI,MAAI,CAAC,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE;UACvC,IAAM,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,KAAM,EAAE,EAAE,CAAC;UACnD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,MAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACpD,IAAM,OAAO,GAAG,MAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC;YAC3C,CAAC,CAAC,YAAa,CAAC,OAAO,CAAC,wBAAwB,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;YAC1E,CAAC,CAAC,YAAa,CAAC,OAAO,CAAC,qCAAqC,EAAE,MAAI,CAAC,EAAE,CAAC;YAEvE,MAAI,CAAC,OAAO,CAAC,cAAc,CAAC,MAAI,CAAC,EAAE,CAAC;UACrC;QACD;MACD,CAAC,EACD;QAAE,OAAO,EAAE;MAAI,CAAE,CACjB;MACD,KAAK,CAAC,gBAAgB,CACrB,SAAS,EACT,YAAK;QACJ,KAAK,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,cAAW,CAAC;QAClD,MAAI,CAAC,OAAO,CAAC,YAAY,EAAE;MAC5B,CAAC,EACD;QAAE,OAAO,EAAE;MAAI,CAAE,CACjB;MAED,KAAK,CAAC,gBAAgB,CACrB,UAAU,EACV,UAAC,CAAC,EAAI;QAAA,IAAA,qBAAA;QACL,IAAI,EAAA,qBAAA,GAAA,MAAI,CAAC,OAAO,CAAC,eAAe,cAAA,qBAAA,uBAA5B,qBAAA,CAA8B,cAAc,MAAK,MAAI,CAAC,EAAE,EAAE;UAC7D;QACD;QAEA,CAAC,CAAC,cAAc,EAAE;QAClB,IAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,WAAA,MAAA,CAAQ,mBAAY,cAAW,CAAC;QACvG,IAAI,UAAU,IAAI,UAAU,KAAK,KAAK,EAAE;UACvC,IAAM,IAAI,GAAG,KAAK,CAAC,qBAAqB,EAAE;UAE1C,IAAM,OAAO,GAAG,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC;UACtD,IAAM,MAAM,GAAG,KAAK,CAAC,UAAW;UAChC,IAAI,OAAO,EAAE;YACZ,MAAM,CAAC,YAAY,CAAC,UAAU,EAAE,KAAK,CAAC,WAAW,CAAC;UACnD,CAAC,MAAM;YACN,MAAM,CAAC,YAAY,CAAC,UAAU,EAAE,KAAK,CAAC;UACvC;QACD;MACD,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;MAED,KAAK,CAAC,gBAAgB,CACrB,MAAM,EACN,UAAC,CAAC,EAAI;QACL,CAAC,CAAC,cAAc,EAAE;MACnB,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;IACF;EAAC;IAAA,GAAA;IAAA,KAAA,EAGM,SAAA,QAAQ,CAAC,KAAa;MAAA,IAAA,gBAAA;MAE5B,IAAM,SAAS,IAAA,gBAAA,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,cAAA,gBAAA,uBAAhB,gBAAA,CAAkB,KAAK,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;MAGtF,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE;MAC/B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,MAAM,EAAE;MAEnC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;MAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;MAGlC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAC,GAAG,EAAE,CAAC;QAAA,OAAM,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC,QAAQ,EAAE;MAAA,CAAC,CAAC;MAGvE,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;QACzB,IAAI,SAAS,EAAE;UACd,IAAM,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC;UAC7C,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC;QACjC;MACD,CAAC,MAAM;QAEN,IAAI,CAAC,KAAK,EAAE;MACb;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAMM,SAAA,WAAW,CAAC,KAAa;MAC/B,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;MAE5C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAC,GAAG,EAAE,CAAC,EAAI;QAC5B,IAAM,QAAQ,GAAG,CAAC,KAAK,KAAK;QAC5B,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,cAAW,QAAQ,CAAC;QAC9D,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC,eAAe,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC;QACzD,GAAG,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,cAAW,QAAQ,CAAC;MACnE,CAAC,CAAC;MAGF,IAAI,IAAI,CAAC,WAAW,EAAE;QACrB,IAAI,CAAC,cAAc,EAAE;MACtB;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,MAAM,CAAC,OAAgB,EAA2B;MAAA,IAAzB,SAAA,GAAA,SAAA,CAAA,MAAA,QAAA,SAAA,QAAA,SAAA,GAAA,SAAA,MAAqB,IAAI;MACxD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;MAC/B,IAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC;MAC7C,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,QAAQ,CAAC;MACxC,IAAI,SAAS,EAAE;QACd,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC;QAE1B,IAAI,CAAC,KAAK,EAAE;MACb;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,OAAO,CAAA;MACb,OAAO,IAAI,CAAC,IAAI;IACjB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,qBAAqB,CAAA;MAC5B,IAAM,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,KAAA,MAAA,CAAkB,mBAAY,kBAAA,MAAA,CAAe,mBAAY,SAAM,CAAC,CAAC;MAExH,IAAM,OAAO,GAAqB,EAAE;MACpC,IAAM,cAAc,GAAc,EAAE;MAEpC,IAAM,OAAO,OAAA,mBAAA,aAAO,IAAI,CAAC,IAAI,CAAC;MAC9B,IAAM,cAAc,OAAA,mBAAA,aAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;MAE7C,WAAW,CAAC,OAAO,CAAC,UAAC,KAAK,EAAI;QAE7B,IAAM,QAAQ,GAAG,OAAO,CAAC,SAAS,CAAC,UAAC,CAAC;UAAA,OAAK,CAAC,CAAC,KAAK,KAAK,KAAK;QAAA,EAAC;QAC5D,IAAI,QAAQ,KAAK,CAAC,CAAC,EAAE;UACpB,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;UAC/B,cAAc,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QAC9C;MACD,CAAC,CAAC;MAEF,IAAI,CAAC,IAAI,GAAG,OAAO;MACnB,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,cAAc;MAGlC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAC,GAAG,EAAE,CAAC;QAAA,OAAM,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC,QAAQ,EAAE;MAAA,CAAC,CAAC;IACxE;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,eAAe,CAAC,SAAsB,EAAE,OAAyB;MAAA,IAAA,MAAA;MACxE,SAAS,CAAC,SAAS,GAAG,EAAE;MACxB,IAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MACjD,WAAW,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,kBAAA,MAAA,CAAe,mBAAY,kBAAA,MAAA,CAAe,OAAO,CAAC,SAAS,CAAE;MACpG,SAAS,CAAC,WAAW,CAAC,WAAW,CAAC;MAElC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,WAAW,EAAE,KAAK,EAAI;QAC5C,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;QAC5C,MAAM,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,gBAAa;QAC/C,MAAM,CAAC,EAAE,GAAG,WAAW,CAAC,EAAE;QAE1B,IAAI,WAAW,CAAC,IAAI,EAAE;UACrB,MAAM,CAAC,KAAK,CAAC,IAAI,UAAA,MAAA,CAAU,WAAW,CAAC,IAAI,CAAE;QAC9C,CAAC,MAAM;UACN,MAAM,CAAC,KAAK,CAAC,IAAI,GAAG,OAAO;QAC5B;QACA,IAAI,WAAW,CAAC,OAAO,EAAE;UACxB,IAAI,OAAO,CAAC,SAAS,KAAK,YAAY,EAAE;YACvC,MAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,WAAW,CAAC,OAAO;UAC5C,CAAC,MAAM;YACN,MAAM,CAAC,KAAK,CAAC,SAAS,GAAG,WAAW,CAAC,OAAO;UAC7C;QACD;QAGA,MAAI,CAAC,aAAa,CAAC,MAAM,EAAE,WAAW,CAAC,OAAO,CAAC;QAC/C,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC;QAG/B,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;UACrC,IAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;UAC/C,SAAS,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,mBAAgB;UACrD,IAAI,WAAW,CAAC,SAAS,KAAK,KAAK,EAAE;YACpC,MAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,OAAO,CAAC,SAAS,CAAC;UAC7D,CAAC,MAAM;YACN,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,MAAM;UACvC;UACA,WAAW,CAAC,WAAW,CAAC,SAAS,CAAC;QACnC;MACD,CAAC,CAAC;IACH;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,iBAAiB,CAAC,OAAoB,EAAE,QAAqB,EAAE,SAAoC;MAC1G,OAAO,CAAC,gBAAgB,CACvB,aAAa,EACb,UAAC,CAAe,EAAI;QACnB,CAAC,CAAC,cAAc,EAAE;QAClB,IAAM,MAAM,GAAG,CAAC,CAAC,OAAO;QACxB,IAAM,MAAM,GAAG,CAAC,CAAC,OAAO;QACxB,IAAM,UAAU,GAAG,QAAQ,CAAC,WAAW;QACvC,IAAM,WAAW,GAAG,QAAQ,CAAC,YAAY;QAEzC,IAAM,aAAa,GAAG,SAAhB,aAAa,CAAI,KAAmB,EAAI;UAC7C,IAAI,SAAS,KAAK,YAAY,EAAE;YAC/B,IAAM,QAAQ,GAAG,UAAU,IAAI,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YACtD,QAAQ,CAAC,KAAK,CAAC,SAAS,MAAA,MAAA,CAAM,QAAQ,OAAI;UAC3C,CAAC,MAAM;YACN,IAAM,SAAS,GAAG,WAAW,IAAI,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YACxD,QAAQ,CAAC,KAAK,CAAC,SAAS,MAAA,MAAA,CAAM,SAAS,OAAI;UAC5C;QACD,CAAC;QAED,IAAM,YAAW,GAAG,SAAd,WAAW,CAAA,EAAQ;UACxB,QAAQ,CAAC,mBAAmB,CAAC,aAAa,EAAE,aAAa,CAAC;UAC1D,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,YAAW,CAAC;QACvD,CAAC;QAED,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,aAAa,EAAE;UAAE,OAAO,EAAE;QAAI,CAAE,CAAC;QAC1E,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,YAAW,EAAE;UAAE,OAAO,EAAE;QAAI,CAAE,CAAC;MACvE,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;IACF;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,mBAAmB,CAAA;MAAA,IAAA,MAAA;MAC1B,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,OAAO,EAAE;QAAA,OAAM,MAAI,CAAC,KAAK,EAAE;MAAA,GAAE,IAAI,CAAC;MAG3D,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,SAAS,EAAE;QAAA,OAAM,MAAI,CAAC,KAAK,EAAE;MAAA,GAAE;QAAE,OAAO,EAAE;MAAI,CAAE,CAAC;MAG1E,IAAI,CAAC,uBAAuB,GAAG,YAAK;QACnC,IAAI,MAAI,CAAC,UAAU,EAAE;UACpB,MAAI,CAAC,aAAa,EAAE;QACrB;MACD,CAAC;MACD,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,uBAAuB,EAAE;QAAE,OAAO,EAAE;MAAI,CAAE,CAAC;MAEnF,IAAM,UAAU,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,cAAW,CAAC;MAClF,UAAU,aAAV,UAAU,eAAV,UAAU,CAAE,gBAAgB,CAC3B,OAAO,EACP,UAAC,CAAC,EAAI;QACL,IAAM,MAAM,GAAG,CAAC,CAAC,MAAqB;QACtC,IAAM,MAAM,GAAG,MAAM,CAAC,OAAO,KAAA,MAAA,CAAkB,mBAAY,iBAAc,CAAC;QAC1E,IAAI,CAAC,MAAM,EAAE;QAGb,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC,EAAE;UAC3D,CAAC,CAAC,eAAe,EAAE;UACnB,IAAI,MAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;YAAA,IAAA,qBAAA;YAC1B,CAAA,qBAAA,GAAA,MAAI,CAAC,kBAAkB,cAAA,qBAAA,eAAvB,qBAAA,CAAA,IAAA,CAAA,MAAI,EAAsB,0BAAmB,CAAC;UAC/C;UACA,MAAI,CAAC,KAAK,EAAE;QACb,CAAC,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,kBAAe,CAAC,EAAE;UACrE,CAAC,CAAC,eAAe,EAAE;UACnB,MAAI,CAAC,cAAc,EAAE;QACtB,CAAC,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,kBAAe,CAAC,EAAE;UACrE,CAAC,CAAC,eAAe,EAAE;UACnB,MAAI,CAAC,QAAQ,EAAE;QAChB,CAAC,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC,EAAE;UACpE,CAAC,CAAC,eAAe,EAAE;UACnB,MAAI,CAAC,YAAY,EAAE;QACpB,CAAC,MAEI,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,wBAAqB,CAAC,EAAE;UACzE,CAAC,CAAC,eAAe,EAAE;UACnB,IAAM,IAAI,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI;UAChC,IAAM,OAAO,GAAG,MAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,UAAC,CAAC;YAAA,OAAK,CAAC,CAAC,IAAI,KAAK,IAAI;UAAA,EAAC;UACxE,OAAO,aAAP,OAAO,eAAP,OAAO,CAAE,MAAM,CAAC,MAAI,CAAC;QACtB;MACD,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;MAED,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,EAAE;MAC1D,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,EAAE,IAAI,CAAC,aAAa,EAAE;MACxG,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;QAExC,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAC/B,aAAa,EACb,UAAC,CAAC,EAAI;UACL,IAAM,MAAM,GAAG,CAAC,CAAC,MAAqB;UAEtC,IAAI,MAAM,CAAC,OAAO,KAAA,MAAA,CAAK,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,mBAAA,MAAA,CAAgB,mBAAY,SAAM,CAAC,EAAE;YACrG;UACD;UACA,CAAC,CAAC,cAAc,EAAE;UAClB,MAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC,OAAO,EAAE,MAAI,CAAC,OAAO,CAAC,WAAW,EAAE,MAAI,CAAC;QACnF,CAAC,EACD;UAAE,OAAO,EAAE;QAAK,CAAE,CAClB;QAED,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAC/B,aAAa,EACb,UAAC,CAAC,EAAI;UACL,IAAI,CAAC,CAAC,WAAW,KAAK,OAAO,EAAE;UAC/B,MAAI,CAAC,gBAAgB,GAAG,MAAM,CAAC,UAAU,CAAC,YAAK;YAC9C,MAAI,CAAC,gBAAgB,GAAG,IAAI;YAC5B,MAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC,OAAO,EAAE,MAAI,CAAC,OAAO,CAAC,WAAW,EAAE,MAAI,CAAC;UACnF,CAAC,EAAE,MAAI,CAAC,2BAA2B,CAAC;QACrC,CAAC,EACD;UAAE,OAAO,EAAE;QAAI,CAAE,CACjB;QACD,IAAM,qBAAqB,GAAG,SAAxB,qBAAqB,CAAA,EAAQ;UAClC,IAAI,MAAI,CAAC,gBAAgB,EAAE;YAC1B,YAAY,CAAC,MAAI,CAAC,gBAAgB,CAAC;YACnC,MAAI,CAAC,gBAAgB,GAAG,IAAI;UAC7B;QACD,CAAC;QACD,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,EAAE,qBAAqB,EAAE;UAAE,OAAO,EAAE;QAAI,CAAE,CAAC;QACzF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,WAAW,EAAE,qBAAqB,EAAE;UAAE,OAAO,EAAE;QAAI,CAAE,CAAC;QACvF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,eAAe,EAAE,qBAAqB,EAAE;UAAE,OAAO,EAAE;QAAI,CAAE,CAAC;MAC5F;MAGA,QAAQ,CAAC,gBAAgB,CACxB,SAAS,EACT,UAAC,CAAC,EAAI;QACL,IAAI,CAAC,MAAI,CAAC,OAAO,EAAE;QACnB,IAAI,MAAI,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,IAAI,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,GAAG,KAAK,GAAG,EAAE;UAC9D,CAAC,CAAC,cAAc,EAAE;UAClB,MAAI,CAAC,UAAU,EAAE;QAClB;QACA,IAAI,CAAC,CAAC,GAAG,KAAK,QAAQ,IAAI,MAAI,CAAC,WAAW,EAAE;UAC3C,MAAI,CAAC,WAAW,EAAE;QACnB;MACD,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;IACF;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,WAAW,CAAA;MAAA,IAAA,MAAA;MAClB,IAAM,aAAa,GAAG,SAAhB,aAAa,CAAI,CAAe,EAAI;QACzC,IAAM,MAAM,GAAG,CAAC,CAAC,MAAqB;QAEtC,IAAI,MAAM,CAAC,OAAO,KAAA,MAAA,CAAK,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,uBAAA,MAAA,CAAoB,mBAAY,mBAAA,MAAA,CAAgB,mBAAY,aAAA,MAAA,CAAU,mBAAY,iBAAc,CAAC,EAAE;UACnK;QACD;QAGA,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;QAEpB,CAAC,CAAC,cAAc,EAAE;QAClB,MAAI,CAAC,KAAK,EAAE;QAEZ,IAAiB,MAAM,GAAsB,CAAC,CAAtC,OAAO;UAAmB,MAAM,GAAK,CAAC,CAArB,OAAO;QAChC,IAAI,UAAU,GAAG,KAAK;QAGtB,IAAI,WAAmB;QACvB,IAAI,UAAkB;QAGtB,IAAI,OAAO,GAAuB,IAAI;QACtC,IAAI,MAAI,CAAC,OAAO,CAAC,aAAa,CAAC,cAAc,EAAE;UAAA,IAAA,qBAAA;UAC9C,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;UACvC,OAAO,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,kBAAe;UAClD,CAAA,qBAAA,GAAA,MAAI,CAAC,OAAO,CAAC,SAAS,cAAA,qBAAA,eAAtB,qBAAA,CAAwB,WAAW,CAAC,OAAO,CAAC;UAC5C,OAAO,CAAC,KAAK,CAAC,IAAI,MAAA,MAAA,CAAM,MAAI,CAAC,EAAE,CAAC,UAAU,OAAI;UAC9C,OAAO,CAAC,KAAK,CAAC,GAAG,MAAA,MAAA,CAAM,MAAI,CAAC,EAAE,CAAC,SAAS,OAAI;UAC5C,OAAO,CAAC,KAAK,CAAC,KAAK,MAAA,MAAA,CAAM,MAAI,CAAC,EAAE,CAAC,WAAW,OAAI;UAChD,OAAO,CAAC,KAAK,CAAC,MAAM,MAAA,MAAA,CAAM,MAAI,CAAC,EAAE,CAAC,YAAY,OAAI;QACnD;QAEA,MAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC;QAEpD,IAAM,aAAa,GAAG,SAAhB,aAAa,CAAI,KAAmB,EAAI;UAAA,IAAA,SAAA,EAAA,qBAAA;UAC7C,IAAI,GAAA,SAAA,GAAC,MAAI,CAAC,EAAE,cAAA,SAAA,eAAP,SAAA,CAAS,WAAW,GAAE;UAC3B,IAAI,CAAC,UAAU,EAAE;YAChB,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YAC/C,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YAG/C,IAAI,MAAM,GAAG,MAAI,CAAC,cAAc,IAAI,MAAM,GAAG,MAAI,CAAC,cAAc,EAAE;cACjE,UAAU,GAAG,IAAI;cACjB,MAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,CAAC,CAAC,SAAS,CAAC;cACtC,MAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,MAAM;cAE3C,MAAI,CAAC,IAAI,CAAC,YAAY,EAAE,MAAI,CAAC;cAG7B,IAAI,MAAI,CAAC,KAAK,KAAK,WAAW,EAAE;gBAC/B,IAAM,aAAa,GAAG,MAAI,CAAC,SAAS,CAAC,KAAK;gBAC1C,IAAM,UAAU,GAAG,CAAC,CAAC,OAAO,GAAG,MAAI,CAAC,EAAE,CAAC,WAAW;gBAClD,IAAM,YAAY,GAAG,MAAI,CAAC,UAAU,CAAC,qBAAqB,EAAE;gBAC5D,IAAM,OAAO,GAAG,CAAC,CAAC,OAAO,GAAG,YAAY,CAAC,GAAG;gBAC5C,IAAM,IAAI,GAAG,CAAC,CAAC,OAAO,GAAG,aAAa,GAAG,UAAU;gBACnD,IAAM,IAAI,GAAG,CAAC,CAAC,OAAO,GAAG,OAAO;gBAEhC,MAAI,CAAC,OAAO,EAAE;gBACd,MAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC;cAC7B;cAGA,WAAW,GAAG,MAAI,CAAC,EAAE,CAAC,UAAU;cAChC,UAAU,GAAG,MAAI,CAAC,EAAE,CAAC,SAAS;YAC/B,CAAC,MAAM;cAEN;YACD;UACD;UAGA,IAAM,OAAO,GAAG,WAAW,GAAG,KAAK,CAAC,OAAO,GAAG,MAAM;UACpD,IAAM,MAAM,GAAG,UAAU,GAAG,KAAK,CAAC,OAAO,GAAG,MAAM;UAClD,IAAI,OAAO,EAAE;YACZ,OAAO,CAAC,KAAK,CAAC,IAAI,MAAA,MAAA,CAAM,OAAO,OAAI;YACnC,OAAO,CAAC,KAAK,CAAC,GAAG,MAAA,MAAA,CAAM,MAAM,OAAI;UAClC,CAAC,MAAM;YACN,MAAI,CAAC,WAAW,CAAC,OAAO,EAAE,MAAM,CAAC;UAClC;UACA,CAAA,qBAAA,GAAA,MAAI,CAAC,iBAAiB,cAAA,qBAAA,eAAtB,qBAAA,CAAA,IAAA,CAAA,MAAwB,CAAE;QAC3B,CAAC;QAED,IAAM,aAAW,GAAG,SAAd,WAAW,CAAA,EAAQ;UACxB,QAAQ,CAAC,mBAAmB,CAAC,aAAa,EAAE,aAAa,CAAC;UAC1D,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,aAAW,CAAC;UAEtD,IAAI,OAAO,EAAE;YACZ,MAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,EAAE,OAAO,CAAC,SAAS,CAAC;YACvD,OAAO,CAAC,MAAM,EAAE;UACjB;UAEA,IAAI,UAAU,EAAE;YACf,MAAI,CAAC,EAAE,CAAC,qBAAqB,CAAC,CAAC,CAAC,SAAS,CAAC;YAC1C,MAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,MAAM;YAC3C,MAAI,CAAC,IAAI,CAAC,UAAU,EAAE,MAAI,CAAC;YAC3B,IAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAAC,SAAA,QAAA;cAAA,OAAA,YAAA,YAAA,IAAA,WAAA,QAAA;gBAAA,kBAAA,QAAA,CAAA,IAAA,GAAA,QAAA,CAAA,IAAA;kBAAA;oBAAA,QAAA,CAAA,IAAA;oBAAA,OAAkB,MAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE;kBAAA;oBAAA,OAAA,QAAA,CAAA,MAAA,WAAA,QAAA,CAAA,IAAA;kBAAA;kBAAA;oBAAA,OAAA,QAAA,CAAA,IAAA;gBAAA;cAAA,GAAA,OAAA;YAAA,IAAC,CAAE;UAC1D;UAEA,MAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC;QACxD,CAAC;QAED,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,aAAa,EAAE;UAAE,OAAO,EAAE;QAAI,CAAE,CAAC;QAC1E,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,aAAW,EAAE;UAAE,OAAO,EAAE;QAAI,CAAE,CAAC;MACvE,CAAC;MAED,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,aAAa,EAAE,aAAa,EAAE;QAAE,OAAO,EAAE;MAAK,CAAE,CAAC;MAElF,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,EAAE;QAC3C,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,UAAU,EAAE,UAAC,CAAa,EAAI;UAC9D,IAAI,MAAI,CAAC,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE;YACrD,IAAM,MAAM,GAAG,CAAC,CAAC,MAAqB;YAEtC,IAAI,MAAM,CAAC,OAAO,KAAA,MAAA,CAAK,mBAAY,qBAAA,MAAA,CAAkB,mBAAY,mBAAA,MAAA,CAAgB,mBAAY,SAAM,CAAC,EAAE;cACrG;YACD;YACA,MAAI,CAAC,cAAc,EAAE;UACtB;QACD,CAAC,CAAC;MACH;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,aAAa,CAAA;MAAA,IAAA,OAAA;MACpB,IAAI,CAAC,EAAE,CAAC,gBAAgB,KAAA,MAAA,CAAkB,mBAAY,mBAAgB,CAAC,CAAC,OAAO,CAAC,UAAC,MAAM,EAAI;QAC1F,MAAM,CAAC,gBAAgB,CACtB,aAAa,EACb,UAAC,CAAe,EAAI;UACnB,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,IAAI,EAAC,MAAM,aAAN,MAAM,eAAN,MAAM,CAAE,WAAW,GAAE;UAC5C,CAAC,CAAC,cAAc,EAAE;UAClB,CAAC,CAAC,eAAe,EAAE;UACnB,OAAI,CAAC,KAAK,EAAE;UACZ,OAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,MAAM;UAC3C,MAAM,CAAC,iBAAiB,CAAC,CAAC,CAAC,SAAS,CAAC;UAErC,OAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC;UACpD,OAAI,CAAC,IAAI,CAAC,cAAc,EAAE,OAAI,CAAC;UAG/B,IAAI,OAAO,GAAuB,IAAI;UACtC,IAAI,OAAI,CAAC,OAAO,CAAC,aAAa,CAAC,cAAc,EAAE;YAAA,IAAA,qBAAA;YAC9C,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;YACvC,OAAO,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,kBAAe;YAClD,CAAA,qBAAA,GAAA,OAAI,CAAC,OAAO,CAAC,SAAS,cAAA,qBAAA,eAAtB,qBAAA,CAAwB,WAAW,CAAC,OAAO,CAAC;UAC7C;UAEA,IAAM,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC,OAAO,IAAA,MAAA,CAAI,mBAAY,sBAAmB,EAAE,CAAC;UAChF,IAAiB,MAAM,GAAsB,CAAC,CAAtC,OAAO;YAAmB,MAAM,GAAK,CAAC,CAArB,OAAO;UAChC,IAAA,UAAA,GAA2G,OAAI,CAAC,EAAE;YAA7F,UAAU,GAAA,UAAA,CAAvB,WAAW;YAA4B,WAAW,GAAA,UAAA,CAAzB,YAAY;YAA2B,SAAS,GAAA,UAAA,CAArB,UAAU;YAAwB,QAAQ,GAAA,UAAA,CAAnB,SAAS;UAC5F,IAAA,eAAA,GAAgC,OAAI,CAAC,OAAO;YAApC,QAAQ,GAAA,eAAA,CAAR,QAAQ;YAAE,SAAS,GAAA,eAAA,CAAT,SAAS;UAE3B,IAAM,aAAa,GAAG,SAAhB,aAAa,CAAI,KAAmB,EAAI;YAAA,IAAA,qBAAA;YAC7C,IAAI,QAAQ,GAAG,UAAU;cACxB,SAAS,GAAG,WAAW;cACvB,OAAO,GAAG,SAAS;cACnB,MAAM,GAAG,QAAQ;YAClB,IAAM,MAAM,GAAG,KAAK,CAAC,OAAO,GAAG,MAAM;YACrC,IAAM,MAAM,GAAG,KAAK,CAAC,OAAO,GAAG,MAAM;YAErC,IAAI,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,OAAI,CAAC,EAAE,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAU,GAAG,MAAM,CAAC;YAC/F,IAAI,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,OAAI,CAAC,EAAE;cAC5C,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAU,GAAG,MAAM,CAAC;cAClD,OAAO,GAAG,SAAS,GAAG,MAAM;YAC7B;YACA,IAAI,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,OAAI,CAAC,EAAE,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE,WAAW,GAAG,MAAM,CAAC;YAClG,IAAI,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,OAAI,CAAC,EAAE;cAC5C,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE,WAAW,GAAG,MAAM,CAAC;cACrD,MAAM,GAAG,QAAQ,GAAG,MAAM;YAC3B;YACA,IAAI,OAAO,EAAE;cACZ,OAAO,CAAC,KAAK,CAAC,IAAI,MAAA,MAAA,CAAM,OAAO,OAAI;cACnC,OAAO,CAAC,KAAK,CAAC,GAAG,MAAA,MAAA,CAAM,MAAM,OAAI;cACjC,OAAO,CAAC,KAAK,CAAC,KAAK,MAAA,MAAA,CAAM,QAAQ,OAAI;cACrC,OAAO,CAAC,KAAK,CAAC,MAAM,MAAA,MAAA,CAAM,SAAS,OAAI;YACxC,CAAC,MAAM;cACN,OAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,SAAS,CAAC;cACjC,OAAI,CAAC,WAAW,CAAC,OAAO,EAAE,MAAM,CAAC;YAClC;YACA,CAAA,qBAAA,GAAA,OAAI,CAAC,mBAAmB,cAAA,qBAAA,eAAxB,qBAAA,CAAA,IAAA,CAAA,OAA0B,CAAE;UAC7B,CAAC;UACD,IAAM,aAAW,GAAG,SAAd,WAAW,CAAA,EAAQ;YACxB,MAAM,CAAC,qBAAqB,CAAC,CAAC,CAAC,SAAS,CAAC;YACzC,OAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,MAAM;YAE3C,IAAI,OAAO,EAAE;cACZ,OAAI,CAAC,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE,OAAO,CAAC,YAAY,CAAC;cACvD,OAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,EAAE,OAAO,CAAC,SAAS,CAAC;cACvD,OAAO,CAAC,MAAM,EAAE;YACjB;YAEA,QAAQ,CAAC,mBAAmB,CAAC,aAAa,EAAE,aAAa,CAAC;YAC1D,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,aAAW,CAAC;YACtD,OAAI,CAAC,IAAI,CAAC,YAAY,EAAE,OAAI,CAAC;YAC7B,OAAI,CAAC,kBAAkB,EAAE;YACzB,IAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAAC,SAAA,SAAA;cAAA,OAAA,YAAA,YAAA,IAAA,WAAA,SAAA;gBAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;kBAAA;oBAAA,SAAA,CAAA,IAAA;oBAAA,OAAkB,OAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE;kBAAA;oBAAA,OAAA,SAAA,CAAA,MAAA,WAAA,SAAA,CAAA,IAAA;kBAAA;kBAAA;oBAAA,OAAA,SAAA,CAAA,IAAA;gBAAA;cAAA,GAAA,QAAA;YAAA,IAAC,CAAE;YAEzD,OAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC;UACxD,CAAC;UACD,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,aAAa,EAAE;YAAE,OAAO,EAAE;UAAI,CAAE,CAAC;UAC1E,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,aAAW,EAAE;YAAE,OAAO,EAAE;UAAI,CAAE,CAAC;QACvE,CAAC,EACD;UAAE,OAAO,EAAE;QAAK,CAAE,CAClB;MACF,CAAC,CAAC;IACH;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,aAAa,CAAC,QAAgB;MACpC,IAAM,OAAO,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;MAC5C,IAAM,SAAS,GAAG,OAAO,CAAC,IAAI,CAAC,UAAC,CAAC;QAAA,OAAK,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC;MAAA,EAAC;MAC5D,IAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,UAAC,CAAC;QAAA,OAAK,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC;MAAA,EAAC;MAC9D,OAAO,SAAS,IAAI,OAAO;IAC5B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,kBAAkB,CAAA;MACxB,IAAI,IAAI,CAAC,cAAc,EAAE;QACxB,IAAM,GAAG,GAAG,IAAI,CAAC,WAAW,EAAE;QAC9B,IAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE;QAC3B,IAAI,CAAC,cAAc,CAAC,WAAW,GAAG,UAAA,MAAA,CAAU,IAAI,CAAC,EAAE,eAAA,MAAA,CAC7C,IAAI,CAAC,KAAK,iBAAA,MAAA,CACR,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,UAAA,MAAA,CAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,iBAAA,MAAA,CACzC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,UAAA,MAAA,CAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,eAAA,MAAA,CACtD,IAAI,CAAC,OAAO,eAAA,MAAA,CACZ,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,eAAA,MAAA,CACpB,IAAI,CAAC,mBAAmB,EAAG,IAAI,EAAE;MACxC;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAKM,SAAA,qBAAqB,CAAA;MAC3B,IAAI,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,oDAAoD,CAAC,EAAE;QAC3F,OAAO,QAAQ;MAChB;MACA,IAAI,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,8DAA8D,CAAC,EAAE;QACrG,OAAO,WAAW;MACnB;MACA,OAAO,UAAU;IAClB;EAAC;IAAA,GAAA;IAAA,KAAA;MAAA,IAAA,WAAA,OAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAMM,SAAA,SAAiB,KAA4D;QAAA,IAAA,YAAA,EAAA,WAAA,EAAA,WAAA,EAAA,QAAA,EAAA,GAAA,EAAA,EAAA,EAAA,GAAA;QAAA,OAAA,YAAA,YAAA,IAAA,WAAA,SAAA;UAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;YAAA;cACnF,IAAI,KAAK,KAAK,MAAM,EAAE;gBACrB,KAAK,GAAG,IAAI,CAAC,qBAAqB,EAAE;cACrC;cAAC,MACG,KAAK,KAAK,MAAM;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAAA,OAAA,SAAA,CAAA,MAAA;YAAA;cAId,YAAY,GAAG,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,CAAC;cAC7E,WAAW,GAAG,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,KAAK,CAAC;cAAA,MAE3D,WAAW,IAAI,YAAY;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAAA,OAAA,SAAA,CAAA,MAAA;YAAA;cAI/B,IAAI,CAAC,2BAA2B,EAAE;cAGlC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,yBAAsB,CAAC;cAEtD,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,yBAAyB,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,yBAAyB,IAAI,MAAM;cAChI,IAAI,WAAW,KAAK,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,+BAA+B,EAAE;gBAC7E,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,2BAAwB,CAAC;cAC/D;cAEM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,sBAAsB,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,sBAAsB;cAAA,MAEzG,QAAQ,KAAK,QAAQ,IAAI,KAAK,KAAK,UAAU;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAChD,IAAI,CAAC,UAAU,EAAE;cAAC,SAAA,CAAA,IAAA;cAAA,SAAA,CAAA,IAAA;cAAA,OAEW,IAAI,CAAC,OAAO,EAAE;YAAA;cAA1C,IAAI,CAAC,cAAc,GAAA,SAAA,CAAA,IAAA;cACnB,IAAI,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,cAAc,EAAE;gBAC1C,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;gBACzC,GAAG,CAAC,GAAG,GAAG,IAAI,CAAC,cAAc;gBAC7B,IAAI,CAAC,eAAe,CAAC,SAAS,GAAG,EAAE;gBACnC,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,GAAG,CAAC;gBACrC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO;cAC7C;cAAC,SAAA,CAAA,IAAA;cAAA;YAAA;cAAA,SAAA,CAAA,IAAA;cAAA,EAAA,GAAA,SAAA;cAED,OAAO,CAAC,KAAK,CAAC,iEAAiE,EAAA,EAAG,CAAC;cACnF,IAAI,CAAC,cAAc,GAAG,IAAI;YAAC;cAAA,SAAA,CAAA,IAAA;cAE3B,IAAI,CAAC,UAAU,EAAE;cAAC,OAAA,SAAA,CAAA,MAAA;YAAA;cAIpB,IAAI,CAAC,mBAAmB,GAAG,KAAK;cAEhC,IAAI,YAAY,KAAK,CAAC,IAAI,WAAW,GAAG,CAAC,EAAE;gBAC1C,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,aAAa,CAAC;cACpD;cAAC,GAAA,GAEO,KAAK;cAAA,SAAA,CAAA,IAAA,GAAA,GAAA,KACP,QAAQ,OAAA,GAAA,KAGR,WAAW,OAAA,GAAA,KAGX,UAAU;cAAA;YAAA;cALd,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;cAAC,OAAA,SAAA,CAAA,MAAA;YAAA;cAGnD,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,kBAAe,CAAC;cAAC,OAAA,SAAA,CAAA,MAAA;YAAA;cAGtD,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,oBAAiB,CAAC;cACvD,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACzB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAC,GAAG,EAAI;kBACzB,GAAG,CAAC,SAAS,CAAC,SAAS,GAAG,EAAE;gBAC7B,CAAC,CAAC;cACH,CAAC,MAAM;gBACN,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,EAAE;cAC9B;cAAC,OAAA,SAAA,CAAA,MAAA;YAAA;cAIH,IAAI,CAAC,kBAAkB,EAAE;YAAC;YAAA;cAAA,OAAA,SAAA,CAAA,IAAA;UAAA;QAAA,GAAA,QAAA;MAAA,CAC1B;MAAA,SAxEY,UAAU,CAAA,EAAA;QAAA,OAAA,WAAA,CAAA,KAAA,OAAA,SAAA;MAAA;MAAA,OAAV,UAAU;IAAA;EAAA;IAAA,GAAA;IAAA,KAAA,EA4EhB,SAAA,YAAY,CAAA;MAAA,IAAA,OAAA;MAClB,IAAI,IAAI,CAAC,mBAAmB,KAAK,MAAM,EAAE;MAEzC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,8BAAA,MAAA,CAA2B,mBAAY,2BAAwB,CAAC;MAExG,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,eAAe,EAAE;QAChD,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM;QAC3C,IAAI,CAAC,eAAe,CAAC,SAAS,GAAG,EAAE;QACnC,IAAI,CAAC,cAAc,GAAG,IAAI;MAC3B;MAEA,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,eAAe,CAAC;MAErD,IAAM,aAAa,GAAG,IAAI,CAAC,mBAAmB;MAC9C,IAAI,CAAC,mBAAmB,GAAG,MAAM;MACjC,IAAI,CAAC,2BAA2B,EAAE;MAElC,IAAI,aAAa,KAAK,UAAU,EAAE;QACjC,IAAI,CAAC,UAAU,EAAE;QACjB,qBAAqB,CAAC,YAAK;UAC1B,OAAI,CAAC,eAAe,GAAG,KAAK;UAC5B,OAAI,CAAC,qBAAqB,EAAE;UAC5B,OAAI,CAAC,UAAU,EAAE;QAClB,CAAC,CAAC;MACH;MACA,IAAI,CAAC,kBAAkB,EAAE;IAC1B;EAAC;IAAA,GAAA;IAAA,KAAA,EAKO,SAAA,2BAA2B,CAAA;MAClC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,oBAAA,MAAA,CAAiB,mBAAY,uBAAA,MAAA,CAAoB,mBAAY,oBAAiB,CAAC;MACvH,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE;IAClC;EAAC;IAAA,GAAA;IAAA,KAAA,EAIM,SAAA,KAAK,CAAA;MAEX,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC;MAC/C,IAAI,OAAO,aAAP,OAAO,eAAP,OAAO,CAAE,QAAQ,CAAC,KAAK,CAAC,EAAE;QAC7B;MACD;MAGA,IAAI,IAAI,CAAC,uBAAuB,EAAE;QACjC,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,uBAAuB,CAAC;MACpE;MACA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC;MACxB,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC;IACpC;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,QAAQ,CAAC,OAA0B;MAAA,IAAA,OAAA;MACzC,IAAI,IAAI,CAAC,mBAAmB,KAAK,MAAM,EAAE;QACxC,IAAI,CAAC,YAAY,EAAE;MACpB;MACA,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;MAEhC,IAAI,IAAI,CAAC,KAAK,KAAK,QAAQ,EAAE;QAC5B,IAAI,CAAC,OAAO,EAAE;MACf;MAEA,IAAM,UAAU,GAAG,SAAb,UAAU,CAAA,EAAQ;QACvB,OAAI,CAAC,KAAK,GAAG,WAAW;QACxB,OAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;QAClD,OAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,mBAAgB,CAAC;QACzD,OAAI,CAAC,EAAE,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC;QAC3C,OAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,OAAI,EAAE,WAAW,CAAC;QACjD,OAAI,CAAC,IAAI,EAAE;QAGX,IAAM,YAAY,GAAG,OAAI,CAAC,OAAO,CAAC,eAAe,EAAE;QACnD,IAAI,YAAY,CAAC,oBAAoB,IAAI,OAAI,CAAC,OAAO,CAAC,aAAa,EAAE;UAAA,IAAA,qBAAA;UACpE,IAAI,OAAI,CAAC,uBAAuB,EAAE;YACjC,YAAY,CAAC,OAAI,CAAC,uBAAuB,CAAC;UAC3C;UACA,OAAI,CAAC,uBAAuB,GAAG,MAAM,CAAC,UAAU,CAAC,YAAK;YACrD,OAAI,CAAC,UAAU,CAAC,MAAM,CAAC;UACxB,CAAC,GAAA,qBAAA,GAAE,YAAY,CAAC,mBAAmB,cAAA,qBAAA,cAAA,qBAAA,GAAI,IAAI,CAAC;QAC7C;QACA,OAAI,CAAC,kBAAkB,EAAE;QACzB,OAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE;MACpC,CAAC;MAED,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,EAAE,EAAE,CAAC;MACjC,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,gBAAgB,EAAE;QACpD,IAAM,cAAc,GAAG,CAAC,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,kBAAkB,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC;QAC5J,IAAM,MAAM,GAAG,cAAc,CAAC,IAAI,CAAC,UAAC,CAAC;UAAA,OAAK,CAAC,IAAI,IAAI;QAAA,EAAC;QACpD,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC,yBAAyB,CAAC,MAAM,CAAC;QAEtE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,mBAAgB,CAAC;QACtD,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,eAAe,EAAE,UAAU,EAAE;UAAE,IAAI,EAAE;QAAI,CAAE,CAAC;MACtE,CAAC,MAAM;QACN,UAAU,EAAE;MACb;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,cAAc,CAAA;MACpB,IAAI,CAAC,KAAK,KAAK,WAAW,GAAG,IAAI,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE;IAC9D;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,QAAQ,CAAA;MAAA,IAAA,OAAA;MACd,IAAI,IAAI,CAAC,mBAAmB,KAAK,MAAM,EAAE;QACxC,IAAI,CAAC,YAAY,EAAE;MACpB;MACA,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;QAC/B,IAAI,IAAI,CAAC,KAAK,KAAK,QAAQ,EAAE,IAAI,CAAC,OAAO,EAAE;QAC3C,IAAI,CAAC,SAAS,GAAG;UAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,UAAU;UAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,SAAS;UAAE,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW;UAAE,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC;QAAY,CAAE;QAC1H,IAAI,CAAC,KAAK,GAAG,WAAW;QACxB,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;QAElD,IAAM,UAAU,GAAG,SAAb,UAAU,CAAA,EAAQ;UACvB,OAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,mBAAgB,CAAC;UACzD,OAAI,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC;UACtB,OAAI,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC;UAC5B,OAAI,CAAC,kBAAkB,EAAE;QAC1B,CAAC;QAED,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,gBAAgB,EAAE;UACpD,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,mBAAgB,CAAC;UAEtD,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK;UACzB,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK;UAC1B,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM;UAC5B,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM;UAC7B,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,eAAe,EAAE,UAAU,EAAE;YAAE,IAAI,EAAE,IAAI;YAAE,OAAO,EAAE;UAAI,CAAE,CAAC;QACrF,CAAC,MAAM;UACN,UAAU,EAAE;QACb;QAEA,IAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,KAAA,MAAA,CAAwB,mBAAY,kBAAe,CAAC;QACxF,IAAI,MAAM,EAAE;UACX,MAAM,CAAC,KAAK,GAAG,SAAS;UACxB,MAAM,CAAC,KAAK,GAAG,QAAQ;UACvB,MAAM,CAAC,YAAY,CAAC,YAAY,EAAE,SAAS,CAAC;QAC7C;MACD;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,OAAO,CAAC,OAA0B;MAAA,IAAA,OAAA;MAExC,IAAI,IAAI,CAAC,uBAAuB,EAAE;QACjC,YAAY,CAAC,IAAI,CAAC,uBAAuB,CAAC;QAC1C,IAAI,CAAC,uBAAuB,GAAG,IAAI;MACpC;MAEA,IAAI,IAAI,CAAC,mBAAmB,KAAK,MAAM,EAAE;QACxC,IAAI,CAAC,YAAY,EAAE;MACpB;MAEA,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;QAC/B,IAAM,SAAS,GAAG,SAAZ,SAAS,CAAA,EAAQ;UACtB,OAAI,CAAC,KAAK,GAAG,QAAQ;UACrB,OAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,iCAA8B,CAAC;UAEvE,OAAI,CAAC,EAAE,CAAC,KAAK,CAAC,eAAe,GAAG,EAAE;UAClC,OAAI,CAAC,kBAAkB,EAAE;UACzB,OAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE;QACpC,CAAC;QAED,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,aAAa,CAAC;QACtC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,OAAO,CAAC;QAChC,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE;QAE7B,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,gBAAgB,EAAE;UACpD,IAAM,cAAc,GAAG,CAAC,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,kBAAkB,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC;UAC5J,IAAM,MAAM,GAAG,cAAc,CAAC,IAAI,CAAC,UAAC,CAAC;YAAA,OAAK,CAAC,IAAI,IAAI;UAAA,EAAC;UACpD,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC,yBAAyB,CAAC,MAAM,CAAC;UAGtE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;UACrD,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,iCAA8B,CAAC;UACpE,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,eAAe,EAAE,SAAS,EAAE;YAAE,IAAI,EAAE;UAAI,CAAE,CAAC;QACrE,CAAC,MAAM;UACN,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;UACrD,SAAS,EAAE;QACZ;QAEA,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,UAAU,CAAC;QAChD,IAAI,CAAC,KAAK,EAAE;MACb,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;QACtC,IAAM,UAAS,GAAG,SAAZ,UAAS,CAAA,EAAQ;UACtB,OAAI,CAAC,KAAK,GAAG,QAAQ;UACrB,OAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,oBAAA,MAAA,CAAiB,mBAAY,kBAAe,CAAC;UACrF,OAAI,CAAC,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE;UAC7B,IAAM,MAAM,GAAG,OAAI,CAAC,EAAE,CAAC,aAAa,KAAA,MAAA,CAAwB,mBAAY,kBAAe,CAAC;UACxF,IAAI,MAAM,EAAE;YACX,MAAM,CAAC,KAAK,GAAG,UAAU;YACzB,MAAM,CAAC,KAAK,GAAG,QAAQ;YACvB,MAAM,CAAC,YAAY,CAAC,YAAY,EAAE,UAAU,CAAC;UAC9C;UACA,OAAI,CAAC,kBAAkB,EAAE;QAC1B,CAAC;QAED,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,gBAAgB,EAAE;UACpD,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,kGAAkG;UAC7H,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,kBAAe,CAAC;UACrD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;UACzD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;UACpD,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,eAAe,EAAE,UAAS,EAAE;YAAE,IAAI,EAAE;UAAI,CAAE,CAAC;QACrE,CAAC,MAAM;UACN,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;UACzD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;UACpD,UAAS,EAAE;QACZ;MACD;MACA,IAAI,CAAC,kBAAkB,EAAE;MACzB,IAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAAC,SAAA,SAAA;QAAA,OAAA,YAAA,YAAA,IAAA,WAAA,SAAA;UAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;YAAA;cAAA,SAAA,CAAA,IAAA;cAAA,OAAkB,OAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE;YAAA;cAAA,OAAA,SAAA,CAAA,MAAA,WAAA,SAAA,CAAA,IAAA;YAAA;YAAA;cAAA,OAAA,SAAA,CAAA,IAAA;UAAA;QAAA,GAAA,QAAA;MAAA,IAAC,CAAE;IAC1D;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,KAAK,CAAA;MACX,IAAI,IAAI,CAAC,OAAO,EAAE;MAElB,IAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,yBAAyB,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,yBAAyB,IAAI,MAAM;MAChI,IAAI,IAAI,CAAC,mBAAmB,KAAK,MAAM,IAAI,WAAW,KAAK,QAAQ,EAAE;QACpE,IAAI,CAAC,YAAY,EAAE;MACpB;MAEA,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;QACnD,IAAI,CAAC,qBAAqB,EAAE;MAC7B;MAGA,IAAI,IAAI,CAAC,YAAY,EAAE;QACtB,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE;MAC1B;MAEA,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC;MAC9B,IAAI,CAAC,OAAO,GAAG,IAAI;MACnB,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;MAC/C,IAAI,CAAC,kBAAkB,EAAE;MACzB,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC;IACzB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,IAAI,CAAA;MACV,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;MACnB,IAAI,CAAC,OAAO,GAAG,KAAK;MACpB,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;MAClD,IAAI,CAAC,kBAAkB,EAAE;MACzB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC;IACxB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,KAAK,CAAA;MAAA,IAAA,OAAA;MACX,IAAM,SAAS,MAAA,MAAA,CAAM,mBAAY,gBAAa;MAC9C,IAAI,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;QAC1C;MACD;MACA,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC;MAChC,IAAI,CAAC,EAAE,CAAC,gBAAgB,CACvB,cAAc,EACd,YAAK;QACJ,OAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC;MACpC,CAAC,EACD;QAAE,IAAI,EAAE,IAAI;QAAE,OAAO,EAAE;MAAI,CAAE,CAC7B;IACF;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,MAAM,CAAA;MAAA,IAAA,OAAA;MAEZ,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC;MACzC,IAAI,OAAO,aAAP,OAAO,eAAP,OAAO,CAAE,QAAQ,CAAC,KAAK,CAAC,EAAE;QAC7B;MACD;MAEA,IAAM,aAAa,GAAG,SAAhB,aAAa,CAAI,SAAsB,EAAE,OAA6B,EAAI;QAC/E,IAAI,iBAAK,CAAC,gBAAgB,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,OAAO,CAAC,MAAM,CAAC,GAAG,IAAI,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE;UAC5F,IAAM,MAAM,GAAG,SAAS,CAAC,aAAa,CAAC,QAAQ,CAAC;UAEhD,IAAI,MAAM,IAAI,MAAM,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE;YACnD,IAAI;cAAA,IAAA,qBAAA;cAEH,CAAA,qBAAA,GAAA,MAAM,CAAC,aAAa,cAAA,qBAAA,eAApB,qBAAA,CAAsB,QAAQ,CAAC,MAAM,EAAE;YACxC,CAAC,CAAC,OAAO,CAAC,EAAE;cAEX,OAAO,CAAC,IAAI,CAAC,wFAAwF,EAAE,CAAC,CAAC;cACzG,OAAI,CAAC,aAAa,CAAC,SAAS,EAAE,OAAO,CAAC;YACvC;UACD,CAAC,MAAM;YAEN,OAAI,CAAC,aAAa,CAAC,SAAS,EAAE,OAAO,CAAC;UACvC;QACD,CAAC,MAAM;UAEN,OAAI,CAAC,aAAa,CAAC,SAAS,EAAE,OAAO,CAAC;QACvC;MACD,CAAC;MAED,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;QACjC,IAAM,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAC,GAAG;UAAA,OAAK,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;QAAA,EAAC;QAC3G,IAAI,cAAc,GAAG,CAAC,CAAC,EAAE;UACxB,IAAM,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC;UAC3C,IAAM,iBAAiB,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,OAAO;UACnE,aAAa,CAAC,SAAS,CAAC,SAAS,EAAE,iBAAiB,CAAC;QACtD;MACD,CAAC,MAAM;QACN,aAAa,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;MACpD;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,UAAU,CAAA;MAChB,IAAI,gBAA6B;MACjC,IAAM,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAC,GAAG;QAAA,OAAK,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;MAAA,EAAC;MAE3G,IAAI,cAAc,GAAG,CAAC,CAAC,EAAE;QAExB,gBAAgB,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,SAAS;MACvD,CAAC,MAAM;QAEN,gBAAgB,GAAG,IAAI,CAAC,SAAS;MAClC;MAEA,IAAM,MAAM,GAAG,gBAAgB,CAAC,aAAa,CAAC,QAAQ,CAAC;MACvD,OAAO,MAAM,IAAI,gBAAgB;IAClC;EAAC;IAAA,GAAA;IAAA,KAAA,EAKO,SAAA,eAAe,CAAA;MACtB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;QAGvB,IAAM,WAAW,GAAG,EAAE;QACtB,IAAI,CAAC,YAAY,GAAG,IAAI,0BAAa,CAAC,WAAW,CAAC;QAGlD,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC;UAAE,SAAS,EAAE,IAAI,CAAC;QAAS,CAAE,CAAC;QAClE,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE;MACzB;MACA,OAAO,IAAI,CAAC,YAAY;IACzB;EAAC;IAAA,GAAA;IAAA,KAAA,EAKM,SAAA,gBAAgB,CAAC,IAAY;MACnC,IAAI,IAAI,CAAC,WAAW,EAAE;QACrB,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,SAAS,EAAE;UACrC,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,IAAI;QAClC,CAAC,MAAM;UACN,IAAI,CAAC,WAAW,CAAC,WAAW,GAAG,IAAI;QACpC;MACD;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAKM,SAAA,UAAU,CAAA;MAAA,IAAA,OAAA;MAChB,IAAI,IAAI,CAAC,WAAW,EAAE;QACrB,IAAM,MAAK,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,KAAA,MAAA,CAAuB,mBAAY,kBAAe,CAAC;QAC/F,MAAK,aAAL,MAAK,eAAL,MAAK,CAAE,KAAK,EAAE;QACd,MAAK,aAAL,MAAK,eAAL,MAAK,CAAE,MAAM,EAAE;QACf;MACD;MAEA,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MAChD,IAAI,CAAC,WAAW,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,gBAAa;MAEzD,IAAM,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM;MAC7B,IAAM,OAAO,GAAG,CAAC,CAAC,uBAAuB,sBAAA,MAAA,CAAqB,mBAAY,yFAAiF,EAAE;MAC7J,IAAM,QAAQ,GAAG,CAAC,CAAC,eAAe,sBAAA,MAAA,CAAqB,mBAAY,wFAAgF,EAAE;MACrJ,IAAM,OAAO,GAAG,CAAC,CAAC,mBAAmB,sBAAA,MAAA,CAAqB,mBAAY,uFAA+E,EAAE;MAEvJ,IAAI,CAAC,WAAW,CAAC,SAAS,2CAAA,MAAA,CACG,mBAAY,sEAAA,MAAA,CACzB,mBAAY,0CAAA,MAAA,CACzB,OAAO,cAAA,MAAA,CACP,QAAQ,cAAA,MAAA,CACR,OAAO,8BAAA,MAAA,CACQ,mBAAY,yGAAA,MAAA,CACZ,mBAAY,qGAAA,MAAA,CACZ,mBAAY,+EAC7B;MAED,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC;MAGxE,IAAI,CAAC,uBAAuB,EAAE;MAE9B,IAAM,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,KAAA,MAAA,CAAuB,mBAAY,kBAAe,CAAE;MAChG,KAAK,CAAC,KAAK,EAAE;MAEb,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE;QAAA,OAAM,OAAI,CAAC,cAAc,EAAE;MAAA,GAAE;QAAE,OAAO,EAAE;MAAI,CAAE,CAAC;MAC/E,KAAK,CAAC,gBAAgB,CACrB,SAAS,EACT,UAAC,CAAC,EAAI;QACL,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,EAAE;UACtB,CAAC,CAAC,cAAc,EAAE;UAClB,IAAI,CAAC,CAAC,QAAQ,EAAE;YACf,OAAI,CAAC,cAAc,CAAC,MAAM,CAAC;UAC5B,CAAC,MAAM;YACN,OAAI,CAAC,cAAc,CAAC,MAAM,CAAC;UAC5B;QACD;MACD,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;MAED,IAAI,CAAC,WAAW,CAAC,gBAAgB,CAChC,OAAO,EACP,UAAC,CAAC,EAAI;QACL,IAAM,MAAM,GAAG,CAAC,CAAC,MAAqB;QACtC,IAAM,MAAM,GAAG,MAAM,CAAC,OAAO,CAAc,eAAe,CAAC;QAC3D,IAAI,CAAC,MAAM,EAAE;QACb,IAAM,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM;QAEpC,QAAQ,MAAM;UACb,KAAK,OAAO;YACX,OAAI,CAAC,WAAW,EAAE;YAClB;UACD,KAAK,MAAM;YACV,OAAI,CAAC,cAAc,CAAC,MAAM,CAAC;YAC3B;UACD,KAAK,MAAM;YACV,OAAI,CAAC,cAAc,CAAC,MAAM,CAAC;YAC3B;UACD,KAAK,gBAAgB;YACpB,OAAI,CAAC,kBAAkB,CAAC,aAAa,GAAG,CAAC,OAAI,CAAC,kBAAkB,CAAC,aAAa;YAC9E,OAAI,CAAC,uBAAuB,CAAC,MAAM,EAAE,OAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC;YAC3E,OAAI,CAAC,cAAc,EAAE;YACrB;UACD,KAAK,OAAO;YACX,OAAI,CAAC,kBAAkB,CAAC,KAAK,GAAG,CAAC,OAAI,CAAC,kBAAkB,CAAC,KAAK;YAC9D,OAAI,CAAC,uBAAuB,CAAC,MAAM,EAAE,OAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC;YACnE,OAAI,CAAC,cAAc,EAAE;YACrB;UACD,KAAK,YAAY;YAChB,OAAI,CAAC,kBAAkB,CAAC,SAAS,GAAG,CAAC,OAAI,CAAC,kBAAkB,CAAC,SAAS;YACtE,OAAI,CAAC,uBAAuB,CAAC,MAAM,EAAE,OAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC;YACvE,OAAI,CAAC,cAAc,EAAE;YACrB;QACF;MACD,CAAC,EACD;QAAE,OAAO,EAAE;MAAI,CAAE,CACjB;IACF;EAAC;IAAA,GAAA;IAAA,KAAA,EAKM,SAAA,WAAW,CAAA;MACjB,IAAI,IAAI,CAAC,WAAW,EAAE;QACrB,IAAI,CAAC,qBAAqB,EAAE;QAC5B,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE;QACzB,IAAI,CAAC,WAAW,GAAG,IAAI;MACxB;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,cAAc,CAAC,SAA0B;MAChD,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,KAAK,CAAC,EAAE;MAErC,IAAI,SAAS,KAAK,MAAM,EAAE;QACzB,IAAI,CAAC,kBAAkB,GAAG,CAAC,IAAI,CAAC,kBAAkB,GAAG,CAAC,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM;MACpF,CAAC,MAAM;QACN,IAAI,CAAC,kBAAkB,GAAG,CAAC,IAAI,CAAC,kBAAkB,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM;MAChH;MACA,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,kBAAkB,GAAG,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;MAChF,IAAI,CAAC,sBAAsB,EAAE;IAC9B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,sBAAsB,CAAA;MAAA,IAAA,OAAA;MAC7B,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAC,EAAE,EAAE,KAAK,EAAI;QACxC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,+BAA4B,KAAK,KAAK,OAAI,CAAC,kBAAkB,CAAC;MAClG,CAAC,CAAC;MACF,IAAI,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC,EAAE;QACjC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,cAAc,CAAC;UAC1D,QAAQ,EAAE,SAAS;UACnB,KAAK,EAAE;SACP,CAAC;MACH;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,qBAAqB,CAAA;MAE5B,IAAM,eAAe,GAAG,IAAI,CAAC,EAAE,CAAC,gBAAgB,KAAA,MAAA,CAAK,mBAAY,iBAAA,MAAA,CAAc,mBAAY,gBAAa,CAAC;MACzG,eAAe,CAAC,OAAO,CAAC,UAAC,IAAI,EAAI;QAChC,IAAM,UAAU,GAAG,IAAI,CAAC,gBAAgB,KAAA,MAAA,CAAkB,mBAAY,sBAAmB,CAAC;QAC1F,UAAU,CAAC,OAAO,CAAC,UAAC,EAAE,EAAI;UACzB,IAAM,MAAM,GAAG,EAAE,CAAC,UAAU;UAC5B,IAAI,MAAM,EAAE;YACX,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,WAAW,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC;YACtE,MAAM,CAAC,SAAS,EAAE;UACnB;QACD,CAAC,CAAC;MACH,CAAC,CAAC;MAEF,IAAI,CAAC,aAAa,GAAG,EAAE;MACvB,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC;IAC7B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,mBAAmB,CAAC,OAAe,EAAE,KAAa;MACzD,IAAI,IAAI,CAAC,WAAW,EAAE;QACrB,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,oBAAiB,CAAE;QACjG,SAAS,CAAC,WAAW,MAAA,MAAA,CAAM,KAAK,GAAG,CAAC,GAAG,OAAO,GAAG,CAAC,OAAA,MAAA,CAAI,KAAK,CAAE;MAC9D;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,cAAc,CAAA;MACrB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;MACvB,IAAI,CAAC,qBAAqB,EAAE;MAE5B,IAAM,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,KAAA,MAAA,CAAuB,mBAAY,kBAAe,CAAE;MAChG,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK;MAEvB,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;QACrB,IAAI,CAAC,mBAAmB,CAAC,CAAC,EAAE,CAAC,CAAC;QAC9B;MACD;MAEA,IAAI,UAAU,GAAmB,IAAI,CAAC,SAAS;MAC/C,IAAM,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAC,GAAG;QAAA,OAAK,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;MAAA,EAAC;MAC3G,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,cAAc,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE;QACvF,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,SAAS;MACjD;MACA,IAAI,CAAC,UAAU,EAAE;MAEjB,IAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,cAAc,GAAG,UAAU,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,cAAc,CAAC,GAAG,UAAU;MAClI,IAAI,CAAC,WAAW,EAAE;MAElB,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE;QACnC,KAAK,GAAG,iBAAK,CAAC,WAAW,CAAC,KAAK,CAAC;MACjC;MACA,IAAI,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE;QACtC,KAAK,SAAA,MAAA,CAAS,KAAK,QAAK;MACzB;MAEA,IAAI,KAAa;MACjB,IAAI;QACH,KAAK,GAAG,IAAI,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,kBAAkB,CAAC,aAAa,GAAG,GAAG,GAAG,IAAI,CAAC;QAC7E,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,EAAE;MAC7B,CAAC,CAAC,OAAO,CAAC,EAAE;QAEX,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK;QAC/B;MACD;MAEA,IAAM,aAAa,GAAkB,EAAE;MACvC,IAAM,aAAa,GAAgD,EAAE;MAErE,IAAM,MAAM,GAAG,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,UAAU,CAAC,SAAS,EAAE,UAAC,IAAI,EAAI;QAAA,IAAA,mBAAA,EAAA,oBAAA,EAAA,oBAAA;QAEpF,OAAO,EAAA,mBAAA,GAAA,IAAI,CAAC,aAAa,cAAA,mBAAA,uBAAlB,mBAAA,CAAoB,OAAO,MAAK,QAAQ,IAAI,EAAA,oBAAA,GAAA,IAAI,CAAC,aAAa,cAAA,oBAAA,uBAAlB,oBAAA,CAAoB,OAAO,MAAK,OAAO,KAAA,oBAAA,GAAI,IAAI,CAAC,aAAa,cAAA,oBAAA,eAAlB,oBAAA,CAAoB,SAAS,CAAC,QAAQ,IAAA,MAAA,CAAI,mBAAY,sBAAmB,CAAC,GAAG,UAAU,CAAC,aAAa,GAAG,UAAU,CAAC,aAAa;MAC/N,CAAC,CAAC;MAEF,IAAI,WAAwB;MAC5B,OAAQ,WAAW,GAAG,MAAM,CAAC,QAAQ,EAAE,EAAG;QAAA,IAAA,qBAAA;QACzC,IAAM,QAAQ,GAAG,WAAmB;QAEpC,IAAI,GAAA,qBAAA,GAAC,QAAQ,CAAC,WAAW,cAAA,qBAAA,eAApB,qBAAA,CAAsB,IAAI,EAAE,GAAE;QACnC,IAAM,OAAO,GAAG,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC;QACjD,IAAI,OAAO,EAAE;UACZ,aAAa,CAAC,IAAI,CAAC;YAAE,IAAI,EAAE,QAAQ;YAAE,OAAO,EAAP;UAAO,CAAE,CAAC;QAChD;MACD;MAAC,IAAA,KAAA,YAAA,MAAA,EAG8C;QAA1C,IAAA,iBAAA,GAAA,cAAA,CAAA,EAAA;UAAQ,IAAI,GAAA,iBAAA,CAAJ,IAAI;UAAE,OAAO,GAAA,iBAAA,CAAP,OAAO;QACzB,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU;QAC9B,IAAI,CAAC,MAAM;QAEX,IAAM,KAAK,GAAG,IAAI,CAAC,WAAY,CAAC,KAAK,CAAC,KAAK,CAAC;QAE5C,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,CAAC,EAAI;UACzB,IAAI,IAAI,EAAE;YACT,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC;UACzD;UACA,IAAI,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE;YACvB,IAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC;YAChD,SAAS,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,sBAAmB;YACxD,SAAS,CAAC,WAAW,GAAG,OAAO,CAAC,CAAC,CAAC;YAClC,MAAM,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,CAAC;YACpC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC;UAC9B;QACD,CAAC,CAAC;QAEF,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC;MACzB,CAAC;MApBD,SAAA,EAAA,MAAA,cAAA,GAAgC,aAAa,EAAA,EAAA,GAAA,cAAA,CAAA,MAAA,EAAA,EAAA;QAAA,IAAA,KAAA,IAE/B;MAAS;MAoBvB,IAAI,CAAC,aAAa,GAAG,aAAa;MAClC,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;MAChE,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,kBAAkB,GAAG,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;MAChF,IAAI,CAAC,sBAAsB,EAAE;IAC9B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,uBAAuB,CAAC,MAAoB,EAAE,QAAkB;MACvE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;MACvB,IAAI,MAAM,IAAI,OAAO,QAAQ,KAAK,SAAS,EAAE;QAC5C,MAAM,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,yBAAsB,QAAQ,CAAC;MACvE,CAAC,MAAM;QAEN,IAAM,CAAC,GAAG,IAAI,CAAC,kBAAkB;QACjC,IAAM,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,mCAAiC,CAAC;QAChF,IAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,0BAAwB,CAAC;QACxE,IAAM,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,+BAA6B,CAAC;QAC5E,OAAO,aAAP,OAAO,eAAP,OAAO,CAAE,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,yBAAsB,CAAC,CAAC,aAAa,CAAC;QAC/E,QAAQ,aAAR,QAAQ,eAAR,QAAQ,CAAE,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,yBAAsB,CAAC,CAAC,KAAK,CAAC;QACxE,OAAO,aAAP,OAAO,eAAP,OAAO,CAAE,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,yBAAsB,CAAC,CAAC,SAAS,CAAC;MAC5E;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAKM,SAAA,YAAY,CAAA,EAA4B;MAAA,IAA3B,OAAA,GAAA,SAAA,CAAA,MAAA,QAAA,SAAA,QAAA,SAAA,GAAA,SAAA,MAAyB,EAAE;MAE9C,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,QAAQ,CAAC;MACrD,IAAI,MAAM,IAAI,MAAM,CAAC,aAAa,EAAE;QACnC,IAAM,OAAO,GAAG;UACf,IAAI,EAAE,qBAAqB;UAC3B,OAAO,EAAE;SACT;QAED,MAAM,CAAC,aAAa,CAAC,WAAW,CAAC,OAAO,EAAE,GAAG,CAAC;QAG9C,OAAO,CAAC,IAAI,CAAC,oGAAoG,CAAC;QAElH,OAAO,IAAW;MACnB;MAGA,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,EAAE;MAEtC,OAAO,CAAC,OAAO,GAAG,IAAI;MACtB,OAAO,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC;IACrC;EAAC;IAAA,GAAA;IAAA,KAAA,EAKM,SAAA,WAAW,CAAC,OAAqB;MACvC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,EAAE;MAEtC,IAAM,UAAU,GAAkB;QAAE,OAAO,EAAE;MAAI,CAAE;MACnD,OAAO,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;IACzD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,gBAAgB,CAAC,OAAqB;MAC5C,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,EAAE;MACtC,IAAM,sBAAsB,GAAA,aAAA,CAAA,aAAA,KAAQ,OAAO;QAAE,OAAO,EAAE;MAAI,EAAE;MAC5D,OAAO,OAAO,CAAC,UAAU,CAAC,sBAAsB,CAAC;IAClD;EAAC;IAAA,GAAA;IAAA,KAAA;MAAA,IAAA,QAAA,OAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAEM,SAAA,SAAA;QAAA,IAAA,OAAA;QAAA,IAAA,CAAA,EAAA,MAAA,EAAA,EAAA,EAAA,GAAA;QAAA,OAAA,YAAA,YAAA,IAAA,WAAA,SAAA;UAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;YAAA;cAAA,MAEF,OAAO,MAAM,CAAC,WAAW,KAAK,UAAU;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cACrC,CAAC,GAAG,IAAI,mBAAW,CAAC,8IAA8I,CAAC;cACzK,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;cAAC,OAAA,SAAA,CAAA,MAAA,WACT,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;YAAA;cAAA,SAAA,CAAA,IAAA;cAAA,SAAA,CAAA,IAAA;cAAA,OAIH,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,EAAE;gBAChD,UAAU,EAAE,IAAI;gBAChB,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,KAAK;gBACd,OAAO,EAAE,SAAT,OAAO,CAAG,SAAmB,EAAI;kBAAA,IAAA,qBAAA;kBAEhC,CAAA,qBAAA,GAAA,SAAS,CAAC,aAAa,KAAA,MAAA,CAAK,OAAI,CAAC,EAAE,CAAE,CAAC,cAAA,qBAAA,eAAtC,qBAAA,CAAwC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,sBAAA,MAAA,CAAmB,mBAAY,iBAAc,CAAC;gBACvH;eACA,CAAC;YAAA;cARI,MAAM,GAAA,SAAA,CAAA,IAAA;cAAA,OAAA,SAAA,CAAA,MAAA,WASL,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC;YAAA;cAAA,SAAA,CAAA,IAAA;cAAA,GAAA,GAAA,SAAA;cAE9B,EAAC,GAAG,IAAI,mBAAW,qDAAA,MAAA,CAAqD,GAAA,CAAM,OAAO,CAAE,CAAC;cAC9F,EAAC,CAAC,KAAK,IAAI,yBAAyB,GAAG,GAAA,CAAM,KAAK;cAClD,OAAO,CAAC,KAAK,CAAC,EAAC,CAAC;cAAC,OAAA,SAAA,CAAA,MAAA,WACV,OAAO,CAAC,MAAM,CAAC,EAAC,CAAC;YAAA;YAAA;cAAA,OAAA,SAAA,CAAA,IAAA;UAAA;QAAA,GAAA,QAAA;MAAA,CAEzB;MAAA,SAzBY,OAAO,CAAA;QAAA,OAAA,QAAA,CAAA,KAAA,OAAA,SAAA;MAAA;MAAA,OAAP,OAAO;IAAA;EAAA;IAAA,GAAA;IAAA,KAAA,EA2Bb,SAAA,KAAK,CAAA;MAAA,IAAA,qBAAA,EAAA,sBAAA;MACX,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,EAAE;MAGvC,IAAI,aAAa,CAAC,OAAO,KAAK,QAAQ,EAAE;QACvC,IAAM,MAAM,GAAG,aAAkC;QACjD,IAAI;UAEH,IAAI,QAAQ,CAAC,UAAU,KAAK,UAAU,EAAE;YAAA,IAAA,sBAAA;YACvC,CAAA,sBAAA,GAAA,MAAM,CAAC,aAAa,cAAA,sBAAA,eAApB,sBAAA,CAAsB,KAAK,EAAE;UAC9B,CAAC,MAAM;YACN,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE,YAAK;cAAA,IAAA,sBAAA;cACpC,CAAA,sBAAA,GAAA,MAAM,CAAC,aAAa,cAAA,sBAAA,eAApB,sBAAA,CAAsB,KAAK,EAAE;YAC9B,CAAC,CAAC;UACH;QACD,CAAC,CAAC,OAAO,CAAC,EAAE;UACX,OAAO,CAAC,KAAK,CAAC,oFAAoF,EAAE,CAAC,CAAC;QACvG;QACA;MACD;MAEA,IAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE;MAG3B,IAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC;MACnD,UAAU,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU;MACtC,UAAU,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM;MACjC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG;MAC7B,UAAU,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG;MAC1B,UAAU,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG;MAC3B,UAAU,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI;MAC1C,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI;MAC5C,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG;MAC7B,UAAU,CAAC,KAAK,CAAC,SAAS,GAAG,YAAY;MACzC,UAAU,CAAC,KAAK,CAAC,aAAa,GAAG,MAAM;MACvC,UAAU,CAAC,YAAY,CAAC,OAAO,EAAE,EAAE,CAAC;MACpC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;MAErC,IAAM,QAAQ,IAAA,qBAAA,GAAG,UAAU,CAAC,aAAa,cAAA,qBAAA,uBAAxB,qBAAA,CAA0B,QAAQ;MACnD,IAAI,CAAC,QAAQ,EAAE;QACd,OAAO,CAAC,KAAK,CAAC,mDAAmD,CAAC;QAClE,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;QACrC;MACD;MACA,QAAQ,CAAC,IAAI,EAAE;MACf,QAAQ,CAAC,KAAK,CAAC,6BAA6B,CAAC;MAC7C,QAAQ,CAAC,KAAK,WAAA,MAAA,CAAW,IAAI,CAAC,QAAQ,EAAE,aAAU,CAAC;MAGnD,IAAM,MAAM,GAAG,QAAQ,CAAC,gBAAgB,CAAC,+BAA+B,CAAC;MACzE,MAAM,CAAC,OAAO,CAAC,UAAC,KAAK,EAAI;QACxB,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC;MAChC,CAAC,CAAC;MAEF,QAAQ,CAAC,KAAK,CAAC,eAAe,CAAC;MAC/B,QAAQ,CAAC,KAAK,CAAC,aAAa,CAAC,SAAS,CAAC;MACvC,QAAQ,CAAC,KAAK,CAAC,gBAAgB,CAAC;MAChC,QAAQ,CAAC,KAAK,EAAE;MAEhB,IAAM,OAAO;QAAA,IAAA,KAAA,OAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAAG,SAAA,SAAA;UAAA,IAAA,sBAAA,EAAA,sBAAA;UAAA,OAAA,YAAA,YAAA,IAAA,WAAA,SAAA;YAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;cAAA;gBAAA,SAAA,CAAA,IAAA;gBAAA,OACT,IAAI,OAAO,CAAC,UAAC,OAAO;kBAAA,OAAK,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC;gBAAA,EAAC;cAAA;gBACxD,IAAI;kBACH,CAAA,sBAAA,GAAA,UAAU,CAAC,aAAa,cAAA,sBAAA,eAAxB,sBAAA,CAA0B,KAAK,EAAE;kBACjC,CAAA,sBAAA,GAAA,UAAU,CAAC,aAAa,cAAA,sBAAA,eAAxB,sBAAA,CAA0B,KAAK,EAAE;gBAClC,CAAC,CAAC,OAAO,CAAC,EAAE;kBACX,OAAO,CAAC,KAAK,CAAC,0BAA0B,EAAE,CAAC,CAAC;gBAC7C,CAAC,SAAS;kBAGT,UAAU,CAAC,YAAK;oBACf,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;kBACtC,CAAC,EAAE,GAAG,CAAC;gBACR;cAAC;cAAA;gBAAA,OAAA,SAAA,CAAA,IAAA;YAAA;UAAA,GAAA,QAAA;QAAA,CACD;QAAA,gBAdK,OAAO,CAAA;UAAA,OAAA,KAAA,CAAA,KAAA,OAAA,SAAA;QAAA;MAAA,GAcZ;MAED,IAAI,EAAA,sBAAA,GAAA,UAAU,CAAC,aAAa,cAAA,sBAAA,uBAAxB,sBAAA,CAA0B,QAAQ,CAAC,UAAU,MAAK,UAAU,EAAE;QACjE,OAAO,EAAE;MACV,CAAC,MAAM;QAAA,IAAA,sBAAA;QACN,CAAA,sBAAA,GAAA,UAAU,CAAC,aAAa,cAAA,sBAAA,eAAxB,sBAAA,CAA0B,gBAAgB,CAAC,MAAM,EAAE,OAAO,CAAC;MAC5D;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,QAAQ,CAAA;MACd,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK;IAC1B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,QAAQ,CAAC,KAAa;MAC5B,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK;MAC1B,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,iBAAK,CAAC,YAAY,CAAC,KAAK,CAAC;MACpD,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,YAAY,EAAE,iBAAK,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;MAClE,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,cAAc,CAAC;IACrD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,OAAO,CAAC,IAAmB;MACjC,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI;MACxB,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,EAAE;MAC1B,IAAI,CAAC,IAAI,EAAE;QACV,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,aAAa,CAAC;QACnD;MACD;MAEA,IAAI,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;QAC7B,IAAM,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC;QACrC,CAAC,CAAC,SAAS,GAAG,IAAI;QAClB,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC;MAC3B,CAAC,MAAM;QACN,IAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;QACzC,GAAG,CAAC,GAAG,GAAG,IAAI;QACd,GAAG,CAAC,GAAG,GAAG,aAAa;QACvB,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC;MAC7B;MACA,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,aAAa,CAAC;IACpD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,WAAW,CAAA;MACjB,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;QAC/B,OAAO;UAAE,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;UAAE,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC;QAAC,CAAE;MACpD;MACA,OAAO;QAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,UAAU;QAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC;MAAS,CAAE;IACvD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,WAAW,CAAC,CAAuC,EAAE,CAAuC;MAElG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;QAC5B,OAAO,CAAC,IAAI,CAAC,mEAAmE,CAAC;QACjF;MACD;MACA,IAAM,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,qBAAqB,EAAE;MACjE,IAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,WAAW;MACpC,IAAM,SAAS,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY;MAEtC,IAAI,MAAc;MAClB,IAAI,MAAc;MAGlB,QAAQ,CAAC;QACR,KAAK,MAAM;UACV,MAAM,GAAG,CAAC;UACV;QACD,KAAK,QAAQ;UACZ,MAAM,GAAG,CAAC,UAAU,CAAC,KAAK,GAAG,QAAQ,IAAI,CAAC;UAC1C;QACD,KAAK,OAAO;UACX,MAAM,GAAG,UAAU,CAAC,KAAK,GAAG,QAAQ;UACpC;QACD;UACC,MAAM,GAAG,CAAW;UACpB;MACF;MAGA,QAAQ,CAAC;QACR,KAAK,KAAK;UACT,MAAM,GAAG,CAAC;UACV;QACD,KAAK,QAAQ;UACZ,MAAM,GAAG,CAAC,UAAU,CAAC,MAAM,GAAG,SAAS,IAAI,CAAC;UAC5C;QACD,KAAK,QAAQ;UACZ,MAAM,GAAG,UAAU,CAAC,MAAM,GAAG,SAAS;UACtC;QACD;UACC,MAAM,GAAG,CAAW;UACpB;MACF;MAGA,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,MAAA,MAAA,CAAM,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,QAAQ,EAAE,MAAM,CAAC,EAAE,UAAU,CAAC,KAAK,GAAG,GAAG,CAAC,OAAI;MAC9F,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,MAAA,MAAA,CAAM,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,EAAE,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC,OAAI;MAChF,IAAI,CAAC,kBAAkB,EAAE;IAC1B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,OAAO,CAAA;MACb,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;QAC/B,OAAO;UAAE,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK;UAAE,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC;QAAM,CAAE;MACtE;MACA,OAAO;QAAE,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW;QAAE,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC;MAAY,CAAE;IACpE;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,OAAO,CAAC,KAAsB,EAAE,MAAuB;MAC7D,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,OAAO,KAAK,KAAK,QAAQ,MAAA,MAAA,CAAM,KAAK,UAAO,KAAK;MACtE,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,OAAO,MAAM,KAAK,QAAQ,MAAA,MAAA,CAAM,MAAM,UAAO,MAAM;MAC1E,IAAI,CAAC,kBAAkB,EAAE;IAC1B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,UAAU,CAAC,OAAe;MAChC,IAAM,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;MACxD,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,OAAO,GAAG,cAAc;MACnD,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,cAAc,CAAC,QAAQ,EAAE;IAClD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,UAAU,CAAA;MAChB,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,OAAQ;IAC3C;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,UAAU,CAAC,OAA+B;MAEhD,IAAI,OAAO,OAAO,CAAC,QAAQ,KAAK,SAAS,EAAE;QAC1C,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ;MACzC;MAEA,IAAI,OAAO,OAAO,CAAC,KAAK,KAAK,QAAQ,EAAE;QACtC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC;MAC7B;MAEA,IAAI,OAAO,OAAO,CAAC,IAAI,KAAK,QAAQ,IAAI,OAAO,CAAC,IAAI,KAAK,IAAI,EAAE;QAC9D,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC;MAC3B;MAEA,IAAI,CAAC,GAAgD,IAAI;MACzD,IAAI,OAAO,OAAO,CAAC,CAAC,KAAK,QAAQ,IAAI,OAAO,CAAC,CAAC,KAAK,QAAQ,IAAI,OAAO,CAAC,CAAC,KAAK,MAAM,IAAI,OAAO,CAAC,CAAC,KAAK,OAAO,EAAE;QAC7G,CAAC,GAAG,OAAO,CAAC,CAAC;MACd;MACA,IAAI,CAAC,GAAgD,IAAI;MACzD,IAAI,OAAO,OAAO,CAAC,CAAC,KAAK,QAAQ,IAAI,OAAO,CAAC,CAAC,KAAK,QAAQ,IAAI,OAAO,CAAC,CAAC,KAAK,KAAK,IAAI,OAAO,CAAC,CAAC,KAAK,QAAQ,EAAE;QAC7G,CAAC,GAAG,OAAO,CAAC,CAAC;MACd;MACA,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,IAAI,EAAE;QAC7B,IAAI,CAAC,KAAK,IAAI,EAAE;UACf,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;QACzB;QACA,IAAI,CAAC,KAAK,IAAI,EAAE;UACf,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;QACzB;QACA,IAAI,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC;MACvB;MAEA,IAAI,KAAK,GAA2B,IAAI;MACxC,IAAI,OAAO,OAAO,CAAC,KAAK,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,KAAK,KAAK,QAAQ,EAAE;QAC3E,KAAK,GAAG,OAAO,CAAC,KAAK;MACtB;MACA,IAAI,MAAM,GAA2B,IAAI;MACzC,IAAI,OAAO,OAAO,CAAC,MAAM,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,MAAM,KAAK,QAAQ,EAAE;QAC7E,MAAM,GAAG,OAAO,CAAC,MAAM;MACxB;MACA,IAAI,KAAK,KAAK,IAAI,IAAI,MAAM,KAAK,IAAI,EAAE;QACtC,IAAI,KAAK,KAAK,IAAI,EAAE;UACnB,KAAK,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,KAAK;QAC7B;QACA,IAAI,MAAM,KAAK,IAAI,EAAE;UACpB,MAAM,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,MAAM;QAC/B;QACA,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC;MAC5B;MAEA,IAAM,aAAa,GAAG,OAAO,CAAC,aAAa,IAAI,EAAE;MAGjD,IAAI,OAAO,aAAa,CAAC,OAAO,KAAK,QAAQ,EAAE;QAC9C,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,OAAO,CAAC;MACvC;MAEA,IAAI,OAAO,aAAa,CAAC,WAAW,KAAK,SAAS,EAAE;QACnD,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,GAAG,aAAa,CAAC,WAAW;QAClE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,qBAAkB,aAAa,CAAC,WAAW,CAAC;QAEpF,IAAI,CAAC,KAAK,EAAE;MACb;MAEA,IAAI,OAAO,aAAa,CAAC,cAAc,KAAK,SAAS,EAAE;QACtD,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,cAAc,GAAG,aAAa,CAAC,cAAc;MACzE;IACD;EAAC;AAAA,EAnpEwC,qBAA+B;;;;;;;;;;;;;;;;;;;;ACLzE,IAAA,OAAA,GAAA,OAAA;AACA,IAAA,OAAA,GAAA,OAAA;AACA,IAAA,MAAA,GAAA,OAAA;AACA,IAAA,UAAA,GAAA,sBAAA,CAAA,OAAA;AACA,IAAA,MAAA,GAAA,sBAAA,CAAA,OAAA;AACA,IAAA,OAAA,GAAA,sBAAA,CAAA,OAAA;AACA,IAAA,KAAA,GAAA,OAAA;AACA,IAAA,QAAA,GAAA,OAAA;AACA,IAAA,aAAA,GAAA,OAAA;AACA,IAAA,QAAA,GAAA,sBAAA,CAAA,OAAA;AAAoC,SAAA,2BAAA,CAAA,EAAA,CAAA,QAAA,CAAA,yBAAA,MAAA,IAAA,CAAA,CAAA,MAAA,CAAA,QAAA,KAAA,CAAA,qBAAA,CAAA,QAAA,KAAA,CAAA,OAAA,CAAA,CAAA,MAAA,CAAA,GAAA,2BAAA,CAAA,CAAA,MAAA,CAAA,IAAA,CAAA,uBAAA,CAAA,CAAA,MAAA,IAAA,CAAA,KAAA,CAAA,GAAA,CAAA,OAAA,EAAA,MAAA,CAAA,YAAA,EAAA,eAAA,CAAA,EAAA,CAAA,EAAA,CAAA,WAAA,EAAA,WAAA,EAAA,IAAA,CAAA,CAAA,MAAA,KAAA,IAAA,WAAA,IAAA,MAAA,KAAA,EAAA,CAAA,CAAA,EAAA,UAAA,CAAA,WAAA,EAAA,CAAA,UAAA,CAAA,KAAA,CAAA,EAAA,CAAA,gBAAA,SAAA,iJAAA,CAAA,EAAA,CAAA,OAAA,CAAA,gBAAA,CAAA,WAAA,EAAA,IAAA,CAAA,GAAA,CAAA,CAAA,IAAA,CAAA,CAAA,MAAA,CAAA,WAAA,EAAA,QAAA,CAAA,GAAA,CAAA,CAAA,IAAA,WAAA,CAAA,GAAA,CAAA,CAAA,IAAA,EAAA,CAAA,KAAA,CAAA,WAAA,EAAA,CAAA,IAAA,CAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA,WAAA,EAAA,UAAA,CAAA,YAAA,CAAA,cAAA,CAAA,8BAAA,CAAA,QAAA,CAAA;AAAA,SAAA,4BAAA,CAAA,EAAA,CAAA,QAAA,CAAA,2BAAA,CAAA,SAAA,iBAAA,CAAA,CAAA,EAAA,CAAA,OAAA,CAAA,MAAA,QAAA,CAAA,IAAA,CAAA,CAAA,EAAA,KAAA,6BAAA,CAAA,IAAA,CAAA,CAAA,WAAA,KAAA,CAAA,GAAA,CAAA,CAAA,WAAA,CAAA,IAAA,aAAA,CAAA,cAAA,CAAA,GAAA,KAAA,CAAA,IAAA,CAAA,CAAA,oBAAA,CAAA,+CAAA,IAAA,CAAA,CAAA,IAAA,iBAAA,CAAA,CAAA,EAAA,CAAA;AAAA,SAAA,kBAAA,CAAA,EAAA,CAAA,aAAA,CAAA,IAAA,CAAA,GAAA,CAAA,CAAA,MAAA,MAAA,CAAA,GAAA,CAAA,CAAA,MAAA,YAAA,CAAA,MAAA,CAAA,GAAA,KAAA,CAAA,CAAA,GAAA,CAAA,GAAA,CAAA,EAAA,CAAA,IAAA,CAAA,CAAA,CAAA,IAAA,CAAA,CAAA,CAAA,UAAA,CAAA;AAAA,SAAA,WAAA,CAAA,EAAA,CAAA,EAAA,CAAA,WAAA,CAAA,OAAA,gBAAA,aAAA,CAAA,OAAA,2BAAA,aAAA,CAAA,EAAA,yBAAA,KAAA,OAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,YAAA,gBAAA,aAAA,CAAA,EAAA,WAAA,IAAA,CAAA,CAAA,KAAA,CAAA,CAAA,EAAA,CAAA;AAAA,SAAA,0BAAA,cAAA,CAAA,IAAA,OAAA,CAAA,SAAA,CAAA,OAAA,CAAA,IAAA,CAAA,OAAA,CAAA,SAAA,CAAA,OAAA,iCAAA,CAAA,aAAA,yBAAA,YAAA,0BAAA,aAAA,CAAA;AAAA,IAEf,aAAc,GAAA,OAAA,wBAAA,gBAAA;EAgClC,SAAA,cAAY,aAAkC;IAAA,IAAA,KAAA;IAAA,IAAA,gBAAA,mBAAA,aAAA;IAC7C,KAAA,GAAA,UAAA,OAAA,aAAA;IAAQ,IAAA,gBAAA,aAAA,KAAA,eAhC8B,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,iBACD,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,aAE5B,IAAI,GAAG,EAAwB;IAAA,IAAA,gBAAA,aAAA,KAAA,mBAEzB,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,wBACC,KAAK;IAAA,IAAA,gBAAA,aAAA,KAAA,kBACU,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,mBACJ,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,oBACvB,KAAK;IAAA,IAAA,gBAAA,aAAA,KAAA,sBAI8B,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,uBACH,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,oBAC/B,EAAE;IAAA,IAAA,gBAAA,aAAA,KAAA,qBAEwB,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,eAExB,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,YAC3B,IAAI,GAAG,EAAiB;IAAA,IAAA,gBAAA,aAAA,KAAA,iBACL,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,0BAC4B,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,4BAEd,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,wBACV,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,gCACwB,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,yBAE/B,IAAI;IAAA,IAAA,gBAAA,aAAA,KAAA,0BACiB,IAAI;IAI7E,KAAA,CAAK,YAAY,GAAG,aAAa;IACjC,KAAA,CAAK,aAAa,CAAC,qBAAY,CAAC;IAChC,KAAA,CAAK,aAAa,CAAC,eAAS,CAAC;IAC7B,KAAA,CAAK,aAAa,CAAC,+BAAiB,CAAC;IAAC,OAAA,KAAA;EACvC;EAAC,IAAA,UAAA,aAAA,aAAA,EAAA,gBAAA;EAAA,WAAA,aAAA,aAAA,aAAA;IAAA,GAAA;IAAA,GAAA,EAKD,SAAA,IAAA,EAAwB;MACvB,OAAO,IAAI,CAAC,cAAc;IAC3B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,iBAAiB,CAAC,OAA4B;MACpD,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,OAAO,CAAC;MAEzC,IAAI,IAAI,CAAC,SAAS,EAAE;QACnB,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,2BAAwB,CAAC,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC;QAC3G,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,0BAAuB,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC;QAG1G,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE;UACpC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YAEpB,IAAI,CAAC,aAAa,EAAE;UACrB;UACA,IAAI,CAAC,mBAAmB,EAAE;QAC3B,CAAC,MAAM,IAAI,IAAI,CAAC,SAAS,EAAE;UAE1B,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;UACvB,IAAI,CAAC,SAAS,GAAG,IAAI;UAErB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,EAAE;QACxC;MACD;MAGA,IAAI,IAAI,CAAC,YAAY,CAAC,wBAAwB,EAAE;QAC/C,IAAI,CAAC,2BAA2B,EAAE;MACnC,CAAC,MAAM;QACN,IAAI,CAAC,0BAA0B,EAAE;MAClC;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,eAAe,CAAA;MACrB,OAAO,IAAI,CAAC,YAAY;IACzB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,IAAI,CAAA;MAAA,IAAA,MAAA;MACV,IAAI,IAAI,CAAC,cAAc,EAAE;QACxB;MACD;MAEA,IAAI,QAAQ,GAAuB,IAAI;MACvC,IAAI,OAAO,IAAI,CAAC,YAAY,CAAC,SAAS,KAAK,QAAQ,EAAE;QACpD,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAc,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;QAC3E,IAAI,CAAC,QAAQ,EAAE;UACd,MAAM,IAAI,mBAAW,sCAAA,MAAA,CAAqC,IAAI,CAAC,YAAY,CAAC,SAAS,sBAAkB,CAAC;QACzG;MACD,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,SAAS,YAAY,WAAW,EAAE;QAC9D,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS;MACvC;MAGA,IAAI,CAAC,QAAQ,EAAE;QACd,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE;UACnB,MAAM,IAAI,mBAAW,CAAC,oGAAoG,CAAC;QAC5H;QACA,QAAQ,GAAG,QAAQ,CAAC,IAAI;MACzB;MAEA,IAAI,CAAC,QAAQ,CAAC,cAAc,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC,EAAE;QACvD,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC;QAChD,QAAQ,CAAC,EAAE,MAAA,MAAA,CAAM,mBAAY,YAAS;QACtC,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE;QACxC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC;MACpC;MACA,IAAI,WAAW,GAAG,QAAQ,CAAC,aAAa,KAAA,MAAA,CAAkB,mBAAY,eAAY,CAAC;MACnF,IAAI,CAAC,WAAW,EAAE;QACjB,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;QAC3C,WAAW,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,eAAY;QACnD,QAAQ,CAAC,WAAW,CAAC,WAAW,CAAC;MAClC;MACA,IAAI,CAAC,SAAS,GAAG,WAAW;MAE5B,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MAChD,IAAI,CAAC,WAAW,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,eAAY;MACxD,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC;MAG5C,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,YAAY,CAAC;MAEzC,IAAI,QAAQ,KAAK,QAAQ,CAAC,IAAI,EAAE;QAC/B,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;QAGzD,IAAM,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,QAAQ,CAAC;QACvD,IAAI,aAAa,CAAC,QAAQ,KAAK,QAAQ,EAAE;UACxC,QAAQ,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU;QACrC;MACD;MAEA,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE;QACpC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;UAEpB,IAAI,CAAC,aAAa,EAAE;QACrB;MACD;MAEA,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE;QAC5B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;MACvC,CAAC,MAAM;QACN,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;MACzB;MAEA,IAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAAC,SAAA,QAAA;QAAA,OAAA,YAAA,YAAA,IAAA,WAAA,QAAA;UAAA,kBAAA,QAAA,CAAA,IAAA,GAAA,QAAA,CAAA,IAAA;YAAA;cAAA,QAAA,CAAA,IAAA;cAAA,OAAkB,MAAI,CAAC,oBAAoB,EAAE;YAAA;cAAA,OAAA,QAAA,CAAA,MAAA,WAAA,QAAA,CAAA,IAAA;YAAA;YAAA;cAAA,OAAA,QAAA,CAAA,IAAA;UAAA;QAAA,GAAA,OAAA;MAAA,IAAC,CAAE;MAEjD,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE;QAAA,QAE/B,qBAAqB,CAAC,YAAK;YAC1B,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa;YAEvC,IAAI,CAAA,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,OAAO,MAAK,QAAQ,EAAE;cAEnC,IAAM,KAAK,GAAI,QAAwB,CAAC,OAAO,KAAA,MAAA,CAAkB,mBAAY,YAAS,CAAC;cACvF,IAAI,KAAK,EAAE;gBACV,IAAM,GAAG,GAAG,MAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC;gBAEtC,IAAI,GAAG,IAAI,MAAI,CAAC,YAAY,KAAK,GAAG,EAAE;kBACrC,GAAG,CAAC,KAAK,EAAE;gBACZ;cACD;YACD;UACD,CAAC;QAAC;MAAA,EACF;MACD,QAAQ,CAAC,gBAAgB,CACxB,aAAa,EACb;QAAA,OACC,qBAAqB,CAAC,YAAK;UAC1B,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa;UACvC,IAAI,CAAA,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,OAAO,MAAK,QAAQ,EAAE;YACnC,IAAM,KAAK,GAAI,QAAwB,CAAC,OAAO,KAAA,MAAA,CAAkB,mBAAY,YAAS,CAAC;YACvF,IAAI,KAAK,EAAE;cACV,IAAM,GAAG,GAAG,MAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC;cACtC,IAAI,GAAG,IAAI,MAAI,CAAC,YAAY,KAAK,GAAG,EAAE;gBACrC,GAAG,CAAC,KAAK,EAAE;cACZ;YACD;UACD;QACD,CAAC,CAAC;MAAA,GACH,IAAI,CACJ;MAGD,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,UAAC,CAAe,EAAI;QAC5D,IAAI,EAAE,CAAC,CAAC,MAAM,YAAY,WAAW,CAAC,EAAE;QAExC,IAAM,kBAAkB,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,KAAA,MAAA,CAAK,mBAAY,kBAAe,CAAC;QAG5E,IAAI,CAAC,kBAAkB,EAAE;UACxB,MAAI,CAAC,eAAe,EAAE;QACvB;QAGA,IAAI,CAAC,MAAI,CAAC,YAAY,IAAI,MAAI,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,EAAE;UACxE;QACD;QAGA,IAAM,aAAa,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,KAAA,MAAA,CAAK,mBAAY,YAAS,CAAC;QACjE,IAAM,cAAc,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,KAAA,MAAA,CAAK,mBAAY,aAAU,CAAC;QAGnE,IAAI,CAAC,aAAa,IAAI,CAAC,kBAAkB,IAAI,CAAC,cAAc,EAAE;UAE7D,IAAM,MAAM,GAAG,MAAI,CAAC,YAAY;UAChC,MAAI,CAAC,YAAY,GAAG,IAAI;UACxB,MAAM,CAAC,IAAI,EAAE;QACd;MACD,CAAC,CAAC;MAEF,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,UAAC,KAAK,EAAI;QAE5C,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,KAAK,qBAAqB,IAAI,IAAA,QAAA,aAAO,KAAK,CAAC,IAAI,CAAC,OAAO,MAAK,QAAQ,EAAE;UAEtG,IAAI,aAAa,GAAG,KAAK;UACzB,IAAI,YAAY,GAAwB,IAAI;UAAC,IAAA,SAAA,GAAA,0BAAA,CAC3B,MAAI,CAAC,OAAO,CAAC,MAAM,EAAE;YAAA,KAAA;UAAA;YAAvC,KAAA,SAAA,CAAA,CAAA,MAAA,KAAA,GAAA,SAAA,CAAA,CAAA,IAAA,IAAA,GAAyC;cAAA,IAA9B,GAAG,GAAA,KAAA,CAAA,KAAA;cACb,IAAM,MAAM,GAAG,GAAG,CAAC,EAAE,CAAC,aAAa,CAAC,QAAQ,CAAC;cAC7C,IAAI,MAAM,IAAI,MAAM,CAAC,aAAa,KAAK,KAAK,CAAC,MAAM,EAAE;gBACpD,aAAa,GAAG,IAAI;gBAEpB,YAAY,GAAG,GAAG;gBAClB;cACD;YACD;UAAC,SAAA,GAAA;YAAA,SAAA,CAAA,CAAA,CAAA,GAAA;UAAA;YAAA,SAAA,CAAA,CAAA;UAAA;UAED,IAAI,aAAa,EAAE;YAGlB,IAAI,YAAY,EAAE;cAEjB,YAAY,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC;YAC9C,CAAC,MAAM;cAEN,MAAI,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC;YACtC;UACD,CAAC,MAAM;YACN,OAAO,CAAC,IAAI,CAAC,wDAAwD,EAAE,KAAK,CAAC,MAAM,CAAC;UACrF;QACD;MACD,CAAC,CAAC;MAEF,IAAI,CAAC,cAAc,GAAG,IAAI;MAC1B,IAAI,CAAC,sBAAsB,EAAE;MAG7B,IAAI,CAAC,WAAY,CAAC,gBAAgB,CAAC,UAAU,EAAE,UAAC,CAAC,EAAI;QAAA,IAAA,eAAA;QACpD,KAAA,eAAA,GAAI,CAAC,CAAC,YAAY,cAAA,eAAA,eAAd,eAAA,CAAgB,KAAK,CAAC,QAAQ,CAAC,wBAAwB,CAAC,EAAE;UAC7D,CAAC,CAAC,cAAc,EAAE;QACnB;MACD,CAAC,CAAC;MAEF,IAAI,CAAC,WAAY,CAAC,gBAAgB,CAAC,MAAM,EAAE,UAAC,CAAC,EAAI;QAAA,IAAA,gBAAA,EAAA,gBAAA,EAAA,gBAAA;QAEhD,IAAM,QAAQ,GAAG,CAAC,CAAC,MAAqB;QACxC,IAAI,QAAQ,CAAC,OAAO,KAAA,MAAA,CAAK,mBAAY,YAAS,CAAC,EAAE;UAChD;QACD;QACA,CAAC,CAAC,cAAc,EAAE;QAElB,IAAM,WAAW,IAAA,gBAAA,GAAG,CAAC,CAAC,YAAY,cAAA,gBAAA,uBAAd,gBAAA,CAAgB,OAAO,CAAC,wBAAwB,CAAC;QACrE,IAAM,cAAc,IAAA,gBAAA,GAAG,CAAC,CAAC,YAAY,cAAA,gBAAA,uBAAd,gBAAA,CAAgB,OAAO,CAAC,qCAAqC,CAAC;QACrF,IAAM,WAAW,IAAA,gBAAA,GAAG,CAAC,CAAC,YAAY,cAAA,gBAAA,uBAAd,gBAAA,CAAgB,OAAO,CAAC,YAAY,CAAC;QAEzD,IAAI,WAAW,IAAI,cAAc,IAAI,WAAW,EAAE;UACjD,IAAM,YAAY,GAAG,MAAI,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC;UACrD,IAAI,CAAC,YAAY,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE;UAElE,IAAM,OAAO,GAAY,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;UAChD,IAAM,MAAM,GAAY;YACvB,KAAK,EAAE,OAAO,CAAC,KAAK;YACpB,OAAO,EAAE,OAAO,CAAC;WACjB;UAGD,IAAM,kBAAkB,GAA2B,iBAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,OAAO,CAAC;UACvF,OAAO,kBAAkB,CAAC,EAAE;UAC5B,OAAO,kBAAkB,CAAC,eAAe;UACzC,OAAO,kBAAkB,CAAC,OAAO;UACjC,OAAO,kBAAkB,CAAC,IAAI;UAC9B,OAAO,kBAAkB,CAAC,SAAS;UAEnC,IAAM,mBAAmB,GAAG,iBAAK,CAAC,SAAS,CAAC,kBAAkB,EAAE;YAC/D,IAAI,EAAE,CAAC,MAAM,CAAC;YACd,CAAC,EAAE,CAAC,CAAC,OAAO;YACZ,CAAC,EAAE,CAAC,CAAC,OAAO;YACZ,KAAK,EAAE,YAAY,CAAC,OAAO,EAAE,CAAC,KAAK;YACnC,MAAM,EAAE,YAAY,CAAC,OAAO,EAAE,CAAC;WAC/B,CAAC;UAGF,MAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC;UAGtC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QACjD;MACD,CAAC,CAAC;IACH;EAAC;IAAA,GAAA;IAAA,KAAA,EAGO,SAAA,sBAAsB,CAAA;MAAA,IAAA,MAAA;MAC7B,QAAQ,CAAC,gBAAgB,CACxB,SAAS,EACT,UAAC,CAAC,EAAI;QAAA,IAAA,qBAAA,EAAA,sBAAA;QAEL,IAAI,MAAI,CAAC,YAAY,CAAC,oBAAoB,EAAE;UAC3C,IAAM,QAAQ,GAAG,MAAI,CAAC,aAAa,CAAC,MAAI,CAAC,YAAY,CAAC,oBAAoB,CAAC;UAE3E,IAAI,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,QAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,OAAO,KAAK,QAAQ,CAAC,IAAI,IAAI,CAAC,CAAC,MAAM,KAAK,QAAQ,CAAC,GAAG,IAAI,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,KAAK,EAAE;YACpJ,CAAC,CAAC,cAAc,EAAE;YAClB,IAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,MAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;YAEjD,IAAM,YAAY,GAAG,MAAI,CAAC,YAAY,GAAG,OAAO,CAAC,SAAS,CAAC,UAAC,CAAC;cAAA,OAAK,CAAC,KAAK,MAAI,CAAC,YAAY;YAAA,EAAC,GAAG,CAAC,CAAC;YAC/F,IAAM,SAAS,GAAG,CAAC,YAAY,GAAG,CAAC,IAAI,OAAO,CAAC,MAAM;YAErD,IAAM,GAAG,GAAG,OAAO,CAAC,SAAS,CAAC;YAC9B,IAAI,GAAG,CAAC,KAAK,KAAK,WAAW,EAAE;cAC9B,GAAG,CAAC,OAAO,EAAE;YACd;YACA,GAAG,CAAC,KAAK,EAAE;YACX;UACD;QACD;QAGA,IAAM,YAAY,GAAG,MAAI,CAAC,YAAY;QAGtC,IAAI,CAAC,YAAY,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,eAAe,EAAE;UAC3D;QACD;QAGA,IAAI,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,QAAQ,IAAI,EAAA,qBAAA,IAAA,sBAAA,GAAC,YAAY,CAAC,OAAO,CAAC,IAAI,cAAA,sBAAA,uBAAzB,sBAAA,CAA2B,MAAM,cAAA,qBAAA,cAAA,qBAAA,GAAI,CAAC,IAAI,CAAC,EAAE;UAE5E,IAAI,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;YAC/B,CAAC,CAAC,cAAc,EAAE;YAClB,CAAC,CAAC,eAAe,EAAE;YAEnB,IAAM,MAAM,GAAG,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;YAExD,IAAM,IAAI,GAAG,YAAY,CAAC,OAAO,EAAE;YACnC,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM;YAC3B,IAAI,QAAQ,GAAG,CAAC,CAAC;YAEjB,IAAI,MAAM,IAAI,CAAC,IAAI,MAAM,IAAI,CAAC,EAAE;cAC/B,QAAQ,GAAG,MAAM,GAAG,CAAC;YACtB,CAAC,MAAM,IAAI,MAAM,KAAK,CAAC,EAAE;cACxB,QAAQ,GAAG,OAAO,GAAG,CAAC;YACvB;YAEA,IAAI,QAAQ,IAAI,CAAC,IAAI,QAAQ,GAAG,OAAO,EAAE;cACxC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC;YACnC;YACA;UACD;QACD;QAGA,IAAM,oBAAmB,GAAG,SAAtB,mBAAmB,CAAI,SAAqB,EAAI;UAAA,IAAA,UAAA,GAAA,0BAAA,CAClC,SAAS;YAAA,MAAA;UAAA;YAA5B,KAAA,UAAA,CAAA,CAAA,MAAA,MAAA,GAAA,UAAA,CAAA,CAAA,IAAA,IAAA,GAA8B;cAAA,IAAnB,IAAI,GAAA,MAAA,CAAA,KAAA;cACd,IAAI,IAAI,CAAC,QAAQ,EAAE;gBAClB,IAAM,SAAQ,GAAG,MAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC;gBAClD,IAAI,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,SAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,OAAO,KAAK,SAAQ,CAAC,IAAI,IAAI,CAAC,CAAC,MAAM,KAAK,SAAQ,CAAC,GAAG,IAAI,CAAC,CAAC,QAAQ,KAAK,SAAQ,CAAC,KAAK,EAAE;kBAAA,IAAA,YAAA;kBACpJ,CAAC,CAAC,cAAc,EAAE;kBAClB,CAAC,CAAC,eAAe,EAAE;kBACnB,CAAA,YAAA,GAAA,IAAI,CAAC,MAAM,cAAA,YAAA,eAAX,YAAA,CAAA,IAAA,CAAA,IAAI,EAAU,YAAa,CAAC;kBAC5B,OAAO,IAAI;gBACZ;cACD;cACA,IAAI,IAAI,CAAC,KAAK,IAAI,oBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;gBAClD,OAAO,IAAI;cACZ;YACD;UAAC,SAAA,GAAA;YAAA,UAAA,CAAA,CAAA,CAAA,GAAA;UAAA;YAAA,UAAA,CAAA,CAAA;UAAA;UACD,OAAO,KAAK;QACb,CAAC;QAED,oBAAmB,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC;MAC/C,CAAC,EACD;QAAE,OAAO,EAAE;MAAK,CAAE,CAClB;IACF;EAAC;IAAA,GAAA;IAAA,KAAA,EAGO,SAAA,iBAAiB,CAAA;MACxB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;QACzB,IAAI,CAAC,IAAI,EAAE;MACZ;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAKO,SAAA,YAAY,CAAA;MACnB,OAAO,IAAI,CAAC,qBAAqB,CAAC,kBAAS,CAAC;IAC7C;EAAC;IAAA,GAAA;IAAA,KAAA,EAKO,SAAA,qBAAqB,CAAC,GAAW;MACxC,OAAO,GAAG,CAAC,OAAO,CAAC,cAAc,EAAE,UAAC,CAAC,EAAE,CAAC,EAAI;QAC3C,QAAQ,CAAC;UACR,KAAK,QAAQ;YACZ,OAAO,mBAAY;QACrB;QACA,OAAO,CAAC;MACT,CAAC,CAAC;IACH;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,YAAY,CAAC,OAAsB;MAAA,IAAA,iBAAA;MACzC,IAAI,CAAC,iBAAiB,EAAE;MAExB,IAAM,QAAQ,IAAA,iBAAA,GAAG,OAAO,CAAC,QAAQ,cAAA,iBAAA,cAAA,iBAAA,GAAI,OAAO;MAE5C,IAAI,OAAO,CAAC,EAAE,IAAI,QAAQ,KAAK,QAAQ,EAAE;QACxC,IAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,CAAC;QACjD,IAAI,cAAc,EAAE;UACnB,IAAI,QAAQ,KAAK,SAAS,EAAE;YAC3B,OAAO,cAAc;UACtB;UACA,IAAI,QAAQ,KAAK,OAAO,EAAE;YACzB,IAAI,cAAc,CAAC,KAAK,KAAK,WAAW,EAAE;cACzC,cAAc,CAAC,OAAO,EAAE;YACzB;YACA,cAAc,CAAC,KAAK,EAAE;YACtB,OAAO,cAAc;UACtB;QACD;MACD;MAEA,IAAM,eAAe,GAA4B,iBAAK,CAAC,SAAS,CAAC,iBAAK,CAAC,QAAQ,CAAC,qBAAa,CAAC,EAAE,OAAO,CAAC;MACxG,IAAI,eAAe,CAAC,CAAC,KAAK,MAAM,IAAI,eAAe,CAAC,CAAC,KAAK,MAAM,EAAE;QACjE,IAAM,QAAQ,GAAG,eAAe,CAAC,KAAK;QACtC,IAAM,SAAS,GAAG,eAAe,CAAC,MAAM;QACxC,IAAM,aAAa,GAAG,IAAI,CAAC,WAAY,CAAC,qBAAqB,EAAE;QAC/D,IAAM,SAAS,GAAG;UACjB,CAAC,EAAE,CAAC,aAAa,CAAC,KAAK,GAAG,QAAQ,IAAI,CAAC;UACvC,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,GAAG,SAAS,IAAI;SACxC;QAGD,IAAI,YAAY,GAAG,IAAI;QACvB,IAAI,IAAI,CAAC,gBAAgB,EAAE;UAC1B,IAAI,kBAAkB,GAAG,KAAK;UAAC,IAAA,UAAA,GAAA,0BAAA,CACb,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;YAAA,MAAA;UAAA;YAAvC,KAAA,UAAA,CAAA,CAAA,MAAA,MAAA,GAAA,UAAA,CAAA,CAAA,IAAA,IAAA,GAAyC;cAAA,IAA9B,IAAG,GAAA,MAAA,CAAA,KAAA;cACb,IAAI,IAAG,CAAC,KAAK,KAAK,QAAQ,IAAI,CAAC,IAAG,CAAC,OAAO,CAAC,QAAQ,EAAE;gBACpD,IAAM,GAAG,GAAG,IAAG,CAAC,WAAW,EAAE;gBAE7B,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;kBACnG,kBAAkB,GAAG,IAAI;kBACzB;gBACD;cACD;YACD;UAAC,SAAA,GAAA;YAAA,UAAA,CAAA,CAAA,CAAA,GAAA;UAAA;YAAA,UAAA,CAAA,CAAA;UAAA;UACD,IAAI,kBAAkB,EAAE;YACvB,YAAY,GAAG,KAAK;UACrB;QACD;QAEA,IAAI,OAAiC;QAErC,IAAI,YAAY,EAAE;UACjB,OAAO,GAAG,SAAS;QACpB,CAAC,MAAM;UACN,OAAO,GAAG;YACT,CAAC,EAAE,IAAI,CAAC,gBAAiB,CAAC,CAAC,GAAG,IAAI,CAAC,cAAc;YACjD,CAAC,EAAE,IAAI,CAAC,gBAAiB,CAAC,CAAC,GAAG,IAAI,CAAC;WACnC;QACF;QAGA,IAAI,OAAO,CAAC,CAAC,GAAG,QAAQ,GAAG,aAAa,CAAC,KAAK,IAAI,OAAO,CAAC,CAAC,GAAG,SAAS,GAAG,aAAa,CAAC,MAAM,EAAE;UAC/F,OAAO,GAAG,SAAS;QACpB;QAGA,eAAe,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC;QAC7B,eAAe,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC;QAG7B,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE;UAC9B,IAAI,CAAC,gBAAgB,GAAG;YAAE,CAAC,EAAE,OAAO,CAAC,CAAC;YAAE,CAAC,EAAE,OAAO,CAAC;UAAC,CAAE;QACvD;MACD;MAEA,IAAM,GAAG,GAAG,IAAI,mBAAY,CAAC,eAAe,EAAE,IAAI,CAAC;MACnD,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC;MAC7B,aAAa,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC;MACzC,IAAI,CAAC,WAAY,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAC;MAErC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,GAAG,CAAC;MAEhC,IAAI,IAAI,CAAC,SAAS,EAAE;QACnB,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC;MAC5B;MAEA,GAAG,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,EAAE,eAAe,CAAC,CAAC,CAAC;MACrD,IAAI,eAAe,CAAC,aAAa,CAAC,KAAK,EAAE;QACxC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC;QACrB,GAAG,CAAC,KAAK,EAAE;MACZ,CAAC,MAAM;QACN,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,MAAA,MAAA,CAAM,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,GAAG,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,aAAa,IAAI,CAAC,CAAE;QACrH,IAAI,CAAC,oBAAoB,EAAE;QAC3B,GAAG,CAAC,kBAAkB,EAAE;MACzB;MACA,OAAO,GAAG;IACX;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,KAAK,CAAC,OAAqB;MAAA,IAAA,cAAA;QAAA,oBAAA;QAAA,cAAA;QAAA,MAAA;MACjC,IAAI,CAAC,iBAAiB,EAAE;MACxB,IAAI,OAAsB;MAC1B,IAAM,aAAa,GAAkD;QACpE,EAAE,EAAE,CAAC;UAAE,IAAI,EAAE,IAAI;UAAE,KAAK,EAAE;QAAC,CAAE,CAAC;QAC9B,QAAQ,EAAE,CACT;UAAE,IAAI,EAAE,IAAI;UAAE,KAAK,EAAE;QAAC,CAAE,EACxB;UAAE,IAAI,EAAE,QAAQ;UAAE,KAAK,EAAE;QAAC,CAAE,CAC5B;QACD,GAAG,EAAE,CAAC;UAAE,IAAI,EAAE,KAAK;UAAE,KAAK,EAAE;QAAC,CAAE,CAAC;QAChC,KAAK,EAAE,CACN;UAAE,IAAI,EAAE,KAAK;UAAE,KAAK,EAAE;QAAC,CAAE,EACzB;UAAE,IAAI,EAAE,IAAI;UAAE,KAAK,EAAE;QAAC,CAAE,CACxB;QACD,WAAW,EAAE,CACZ;UAAE,IAAI,EAAE,KAAK;UAAE,KAAK,EAAE;QAAC,CAAE,EACzB;UAAE,IAAI,EAAE,IAAI;UAAE,KAAK,EAAE;QAAC,CAAE,EACxB;UAAE,IAAI,EAAE,QAAQ;UAAE,KAAK,EAAE;QAAC,CAAE,CAC5B;QACD,KAAK,EAAE,CAAC;UAAE,IAAI,EAAE,OAAO;UAAE,KAAK,EAAE;QAAC,CAAE,CAAC;QACpC,WAAW,EAAE,CACZ;UAAE,IAAI,EAAE,OAAO;UAAE,KAAK,EAAE;QAAC,CAAE,EAC3B;UAAE,IAAI,EAAE,QAAQ;UAAE,KAAK,EAAE;QAAC,CAAE,CAC5B;QACD,gBAAgB,EAAE,CACjB;UAAE,IAAI,EAAE,OAAO;UAAE,KAAK,EAAE;QAAC,CAAE,EAC3B;UAAE,IAAI,EAAE,OAAO;UAAE,KAAK,EAAE;QAAC,CAAE,EAC3B;UAAE,IAAI,EAAE,QAAQ;UAAE,KAAK,EAAE;QAAC,CAAE;OAE7B;MACD,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;QACnC,OAAO,GAAG,OAAO,CAAC,OAAO;MAC1B,CAAC,MAAM;QACN,OAAO,GAAG,aAAa,CAAC,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC,IAAI,aAAa,CAAC,EAAE;MACrE;MAEA,IAAI,SAAS,GAAkB,IAAI;MACnC,IAAM,aAAa,GAAG,SAAhB,aAAa,CAAI,MAAmB,EAAI;QAC7C,IAAI,SAAS,EAAE,YAAY,CAAC,SAAS,CAAC;QACtC,SAAS,GAAG,IAAI;QAChB,IAAI;UAAA,IAAA,gBAAA;UACH,CAAA,gBAAA,GAAA,OAAO,CAAC,OAAO,cAAA,gBAAA,eAAf,gBAAA,CAAA,IAAA,CAAA,OAAO,EAAW,MAAM,CAAC;QAC1B,CAAC,CAAC,OAAO,CAAC,EAAE;UACX,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;QACjB;MACD,CAAC;MAED,IAAM,WAAW,mBAAA,MAAA,CAAkB,mBAAY,uBAAA,MAAA,CAAmB,iBAAK,CAAC,YAAY,CAAC,OAAO,CAAC,OAAO,CAAC,WAAQ;MAC7G,IAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,UAAC,GAAG,EAAE,KAAK;QAAA,yBAAA,MAAA,CAAsB,mBAAY,mCAAA,MAAA,CAA8B,KAAK,iCAAA,MAAA,CAA0B,iBAAK,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC;MAAA,CAAmB,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC;MACnM,IAAM,WAAW,MAAA,MAAA,CAAM,WAAW,mBAAA,MAAA,CAAe,mBAAY,2CAAA,MAAA,CAAqC,WAAW,WAAQ;MAErH,IAAM,UAAU,GAAkB;QACjC,EAAE,EAAE,iBAAK,CAAC,UAAU,IAAA,MAAA,CAAI,mBAAY,WAAQ,CAAC;QAC7C,KAAK,EAAE,OAAO,CAAC,KAAK,IAAI,EAAE;QAC1B,IAAI,EAAE,OAAO,CAAC,IAAI;QAClB,aAAa,EAAE,KAAK;QACpB,aAAa,EAAE;UACd,UAAU,EAAE,KAAK;UACjB,UAAU,EAAE,KAAK;UACjB,OAAO,EAAE,IAAI;UACb,QAAQ,EAAE,IAAI;UACd,WAAW,EAAE,KAAK;UAClB,WAAW,EAAE,KAAK;UAClB,qBAAqB,EAAE,KAAK;UAC5B,KAAK,GAAA,cAAA,GAAE,OAAO,CAAC,KAAK,cAAA,cAAA,cAAA,cAAA,GAAI,IAAI;UAC5B,WAAW,GAAA,oBAAA,GAAE,OAAO,CAAC,WAAW,cAAA,oBAAA,cAAA,oBAAA,GAAI,KAAK;UACzC,KAAK,GAAA,cAAA,GAAE,OAAO,CAAC,KAAK,cAAA,cAAA,cAAA,cAAA,GAAI;SACxB;QACD,eAAe,EAAE,KAAK;QACtB,OAAO,EAAE;UAAE,IAAI,EAAE;QAAW,CAAE;QAC9B,QAAQ,EAAE;OACV;MACD,IAAI,OAAO,CAAC,OAAO,EAAE,UAAU,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO;MACzD,IAAI,OAAO,CAAC,MAAM,EAAE,UAAU,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM;MAEtD,IAAI,OAAO,CAAC,SAAS,EAAE;QAAA,IAAA,iBAAA,EAAA,kBAAA;QACtB,IAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC;QAC3C,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,QAAQ;QAChC,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU;QAChC,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,KAAK;QAC7B,IAAI,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,mBAAgB;QAChD,IAAI,CAAC,SAAS,GAAG,iBAAK,CAAC,YAAY,CAAC,OAAO,CAAC,OAAO,CAAC;QACpD,CAAA,iBAAA,OAAI,CAAC,WAAW,cAAA,iBAAA,eAAhB,iBAAA,CAAkB,WAAW,CAAC,IAAI,CAAC;QACnC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,GAAG,EAAE;QACxC,CAAA,kBAAA,OAAI,CAAC,WAAW,cAAA,kBAAA,eAAhB,kBAAA,CAAkB,WAAW,CAAC,IAAI,CAAC;MACpC,CAAC,MAAM;QACN,UAAU,CAAC,KAAK,GAAG,GAAG;MACvB;MACA,UAAU,CAAC,MAAM,GAAG,GAAG;MAEvB,IAAM,QAAQ,GAAG,UAAU,CAAC,KAAM;MAClC,IAAM,SAAS,GAAG,UAAU,CAAC,MAAO;MACpC,IAAM,aAAa,GAAG,IAAI,CAAC,WAAY,CAAC,qBAAqB,EAAE;MAC/D,IAAM,SAAS,GAAG;QACjB,CAAC,EAAE,CAAC,aAAa,CAAC,KAAK,GAAG,QAAQ,IAAI,CAAC;QACvC,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,GAAG,SAAS,IAAI;OACxC;MAED,IAAI,YAAY,GAAG,IAAI;MACvB,IAAI,IAAI,CAAC,iBAAiB,EAAE;QAC3B,IAAI,kBAAkB,GAAG,KAAK;QAAC,IAAA,UAAA,GAAA,0BAAA,CACb,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;UAAA,MAAA;QAAA;UAAvC,KAAA,UAAA,CAAA,CAAA,MAAA,MAAA,GAAA,UAAA,CAAA,CAAA,IAAA,IAAA,GAAyC;YAAA,IAA9B,KAAG,GAAA,MAAA,CAAA,KAAA;YACb,IAAI,KAAG,CAAC,OAAO,CAAC,QAAQ,IAAI,KAAG,CAAC,KAAK,KAAK,QAAQ,EAAE;cACnD,IAAM,GAAG,GAAG,KAAG,CAAC,WAAW,EAAE;cAC7B,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;gBACrG,kBAAkB,GAAG,IAAI;gBACzB;cACD;YACD;UACD;QAAC,SAAA,GAAA;UAAA,UAAA,CAAA,CAAA,CAAA,GAAA;QAAA;UAAA,UAAA,CAAA,CAAA;QAAA;QACD,IAAI,kBAAkB,EAAE;UACvB,YAAY,GAAG,KAAK;QACrB;MACD;MAEA,IAAI,OAAiC;MACrC,IAAI,YAAY,EAAE;QACjB,OAAO,GAAG,SAAS;MACpB,CAAC,MAAM;QACN,OAAO,GAAG;UACT,CAAC,EAAE,IAAI,CAAC,iBAAkB,CAAC,CAAC,GAAG,IAAI,CAAC,cAAc;UAClD,CAAC,EAAE,IAAI,CAAC,iBAAkB,CAAC,CAAC,GAAG,IAAI,CAAC;SACpC;MACF;MAEA,IAAI,OAAO,CAAC,CAAC,GAAG,QAAQ,GAAG,aAAa,CAAC,KAAK,IAAI,OAAO,CAAC,CAAC,GAAG,SAAS,GAAG,aAAa,CAAC,MAAM,EAAE;QAC/F,OAAO,GAAG,SAAS;MACpB;MAEA,UAAU,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC;MACxB,UAAU,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC;MAExB,IAAM,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC;MACzC,IAAI,CAAC,iBAAiB,GAAG,OAAO;MAChC,GAAG,CAAC,kBAAkB,GAAG,aAAa;MAEtC,GAAG,CAAC,EAAE,CAAC,gBAAgB,KAAA,MAAA,CAAwB,mBAAY,kBAAe,CAAC,CAAC,OAAO,CAAC,UAAC,MAAM,EAAI;QAC9F,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,YAAK;UACrC,IAAM,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,KAAM,EAAE,EAAE,CAAC;UACjD,IAAM,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,KAAK;UACnC,aAAa,CAAC,MAAM,CAAC;UACrB,GAAG,CAAC,KAAK,EAAE;QACZ,CAAC,CAAC;MACH,CAAC,CAAC;MAEF,IAAI,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,OAAO,GAAG,CAAC,EAAE;QAC3C,SAAS,GAAG,MAAM,CAAC,UAAU,CAAC,YAAK;UAClC,IAAI,MAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;YAC7B,aAAa,CAAC,qBAAc,CAAC;YAC7B,GAAG,CAAC,KAAK,EAAE;UACZ;QACD,CAAC,EAAE,OAAO,CAAC,OAAO,CAAC;MACpB;MACA,OAAO,GAAG;IACX;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,UAAU,CAAC,OAAqB;MAAA,IAAA,MAAA;MACtC,IAAM,GAAG,GAAG,iBAAK,CAAC,QAAQ,CAAC,OAAO,CAAC;MACnC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAI;QAC9B,IAAM,UAAU,GAAG,GAAG,CAAC,OAAO;QAC9B,GAAG,CAAC,OAAO,GAAG,UAAC,MAAM,EAAI;UACxB,UAAU,aAAV,UAAU,eAAV,UAAU,CAAG,MAAM,CAAC;UACpB,OAAO,CAAC,MAAM,CAAC;QAChB,CAAC;QACD,MAAI,CAAC,KAAK,CAAC,GAAG,CAAC;MAChB,CAAC,CAAC;IACH;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,aAAa,CAAC,EAAU;MAAA,IAAA,MAAA;MAC9B,IAAI,CAAC,iBAAiB,EAAE;MACxB,IAAM,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC;MAChC,IAAI,GAAG,EAAE;QACR,IAAI,GAAG,CAAC,OAAO,CAAC,YAAY,EAAE;UAC7B,GAAG,CAAC,OAAO,CAAC,YAAY,CAAC,MAAM,EAAE;QAClC;QACA,IAAI,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,EAAE;UACpC,IAAI,CAAC,mBAAmB,EAAE;QAC3B;QAEA,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,GAAG,CAAC;QAClC,GAAG,CAAC,EAAE,CAAC,MAAM,EAAE;QACf,IAAI,CAAC,OAAO,UAAO,CAAC,EAAE,CAAC;QACvB,aAAa,CAAC,UAAU,UAAO,CAAC,EAAE,CAAC;QACnC,IAAI,IAAI,CAAC,YAAY,KAAK,GAAG,EAAE;UAC9B,IAAI,CAAC,YAAY,GAAG,IAAI;UACxB,IAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,EAAE;UACvD,IAAI,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC;QACvC;QAEA,IAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAAC,SAAA,SAAA;UAAA,OAAA,YAAA,YAAA,IAAA,WAAA,SAAA;YAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;cAAA;gBAAA,SAAA,CAAA,IAAA;gBAAA,OAAkB,MAAI,CAAC,oBAAoB,EAAE;cAAA;gBAAA,OAAA,SAAA,CAAA,MAAA,WAAA,SAAA,CAAA,IAAA;cAAA;cAAA;gBAAA,OAAA,SAAA,CAAA,IAAA;YAAA;UAAA,GAAA,QAAA;QAAA,IAAC,CAAE;MAClD;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,WAAW,CAAC,GAAiB;MAAA,IAAA,kBAAA;QAAA,qBAAA;QAAA,MAAA;MACnC,IAAI,CAAC,iBAAiB,EAAE;MACxB,IAAI,IAAI,CAAC,YAAY,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,EAAE;MAGnE,CAAA,kBAAA,OAAI,CAAC,YAAY,cAAA,kBAAA,eAAjB,kBAAA,CAAmB,IAAI,EAAE;MAGzB,IAAI,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,mBAAmB,EAAE;QAC7E,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC;MAC5B,CAAC,MAAM;QAEN,IAAI,CAAC,mBAAmB,EAAE;MAC3B;MAEA,IAAI,CAAC,YAAY,GAAG,GAAG;MACvB,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,MAAA,MAAA,CAAM,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,GAAG,EAAE,IAAI,CAAC,kBAAkB,GAAG,EAAE,IAAI,CAAC,aAAa,CAAE;MAEnH,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAC,CAAC;QAAA,IAAA,qBAAA;QAAA,QAAA,qBAAA,GAAK,CAAC,CAAC,OAAO,CAAC,YAAY,cAAA,qBAAA,uBAAtB,qBAAA,CAAwB,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;MAAA,EAAC;MAC/F,CAAA,qBAAA,GAAA,GAAG,CAAC,OAAO,CAAC,YAAY,cAAA,qBAAA,eAAxB,qBAAA,CAA0B,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,YAAS,CAAC;MAEjE,IAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAAC,SAAA,SAAA;QAAA,OAAA,YAAA,YAAA,IAAA,WAAA,SAAA;UAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;YAAA;cAAA,SAAA,CAAA,IAAA;cAAA,OAAkB,MAAI,CAAC,oBAAoB,EAAE;YAAA;cAAA,OAAA,SAAA,CAAA,MAAA,WAAA,SAAA,CAAA,IAAA;YAAA;YAAA;cAAA,OAAA,SAAA,CAAA,IAAA;UAAA;QAAA,GAAA,QAAA;MAAA,IAAC,CAAE;IAGlD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,SAAS,CAAC,EAAU;MAC1B,IAAI,CAAC,iBAAiB,EAAE;MACxB,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC;IAC5B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,oBAAoB,CAAC,OAAoB;MAC/C,IAAI,CAAC,iBAAiB,EAAE;MACxB,IAAM,KAAK,GAAG,OAAO,CAAC,OAAO,KAAA,MAAA,CAAkB,mBAAY,YAAS,CAAC;MACrE,IAAI,KAAK,aAAL,KAAK,eAAL,KAAK,CAAE,EAAE,EAAE;QACd,OAAO,aAAa,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC;MAC9C;MACA,OAAO,SAAS;IACjB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,eAAe,CAAA;MACrB,IAAI,CAAC,iBAAiB,EAAE;MACxB,OAAO,IAAI,CAAC,YAAY;IACzB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,cAAc,CAAC,cAAsB;MAAA,IAAA,kBAAA;MAC3C,CAAA,kBAAA,OAAI,CAAC,WAAW,cAAA,kBAAA,eAAhB,kBAAA,CAAkB,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,qBAAkB,CAAC;MAClE,IAAI,CAAC,eAAe,GAAG;QAAE,cAAc,EAAd;MAAc,CAAE;IAC1C;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,YAAY,CAAA;MAAA,IAAA,kBAAA;MAClB,CAAA,kBAAA,OAAI,CAAC,WAAW,cAAA,kBAAA,eAAhB,kBAAA,CAAkB,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,qBAAkB,CAAC;MACrE,IAAI,CAAC,eAAe,GAAG,IAAI;IAC5B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,eAAe,CAAC,CAAS,EAAE,CAAS,EAAE,SAA4B,EAAE,aAAsB;MAAA,IAAA,MAAA;MAChG,IAAI,CAAC,iBAAiB,EAAE;MACxB,IAAI,CAAC,eAAe,EAAE;MAEtB,IAAI,CAAC,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC;MACjD,IAAI,CAAC,aAAa,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,kBAAe;MAE7D,SAAS,CAAC,OAAO,CAAC,UAAC,QAAQ,EAAI;QAC9B,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC;QAC3C,IAAI,QAAQ,CAAC,SAAS,EAAE;UACvB,MAAM,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,eAAY;QAC/C,CAAC,MAAM;UAAA,IAAA,cAAA;UACN,MAAM,CAAC,WAAW,IAAA,cAAA,GAAG,QAAQ,CAAC,IAAI,cAAA,cAAA,cAAA,cAAA,GAAI,EAAE;UACxC,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAC,CAAC,EAAI;YAAA,IAAA,gBAAA;YACtC,CAAC,CAAC,eAAe,EAAE;YACnB,CAAA,gBAAA,GAAA,QAAQ,CAAC,MAAM,cAAA,gBAAA,eAAf,gBAAA,CAAA,IAAA,CAAA,QAAQ,EAAU,aAAa,CAAC;YAChC,MAAI,CAAC,eAAe,EAAE;UACvB,CAAC,CAAC;QACH;QACA,MAAI,CAAC,aAAc,CAAC,WAAW,CAAC,MAAM,CAAC;MACxC,CAAC,CAAC;MAEF,IAAI,CAAC,WAAY,CAAC,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC;MAEjD,IAAA,mBAAA,GAA6D,IAAI,CAAC,aAAa;QAA1D,SAAS,GAAA,mBAAA,CAAtB,WAAW;QAA2B,UAAU,GAAA,mBAAA,CAAxB,YAAY;MAC5C,IAAA,OAAA,GAA+D,MAAM;QAAjD,WAAW,GAAA,OAAA,CAAvB,UAAU;QAA4B,YAAY,GAAA,OAAA,CAAzB,WAAW;MAE5C,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,GAAG,SAAS,GAAG,WAAW,MAAA,MAAA,CAAM,WAAW,GAAG,SAAS,aAAA,MAAA,CAAU,CAAC,OAAI;MACvG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,UAAU,GAAG,YAAY,MAAA,MAAA,CAAM,YAAY,GAAG,UAAU,aAAA,MAAA,CAAU,CAAC,OAAI;IAC3G;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,eAAe,CAAA;MAAA,IAAA,oBAAA;MACrB,CAAA,oBAAA,OAAI,CAAC,aAAa,cAAA,oBAAA,eAAlB,oBAAA,CAAoB,MAAM,EAAE;MAC5B,IAAI,CAAC,aAAa,GAAG,IAAI;IAC1B;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,aAAa,CAAC,KAAY;MAChC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC;IACnC;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,mBAAmB,CAAA;MACzB,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;IACtC;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,QAAQ,CAAC,KAAqB;MACpC,IAAM,QAAQ,GAAG,OAAO,KAAK,KAAK,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,GAAG,KAAK;MACzF,IAAI,CAAC,QAAQ,EAAE;QACd,OAAO,CAAC,IAAI,oBAAA,MAAA,CAAmB,KAAK,kBAAc,CAAC;QACnD;MACD;MACA,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;QACpB,OAAO,CAAC,IAAI,CAAC,8BAA8B,CAAC;QAC5C;MACD;MAEA,IAAI,IAAI,CAAC,WAAW,EAAE;QACrB,SAAA,EAAA,MAAA,eAAA,GAA2B,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,EAAA,EAAA,GAAA,eAAA,CAAA,MAAA,EAAA,EAAA,IAAE;UAAlE,IAAA,kBAAA,OAAA,eAAA,aAAA,eAAA,CAAA,EAAA;YAAO,GAAG,GAAA,kBAAA;YAAE,KAAK,GAAA,kBAAA;UACrB,IAAI,EAAE,GAAG,IAAI,QAAQ,CAAC,SAAS,CAAC,EAAE;YACjC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC;UACrE;QACD;MACD;MAEA,IAAI,CAAC,WAAW,GAAG,QAAQ;MAC3B,SAAA,GAAA,MAAA,gBAAA,GAA2B,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAA,GAAA,GAAA,gBAAA,CAAA,MAAA,EAAA,GAAA,IAAE;QAA1D,IAAA,mBAAA,OAAA,eAAA,aAAA,gBAAA,CAAA,GAAA;UAAO,IAAG,GAAA,mBAAA;UAAE,MAAK,GAAA,mBAAA;QACrB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAG,CAAC,EAAE,IAAI,CAAC,qBAAqB,CAAC,MAAK,CAAC,CAAC;MACrG;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,QAAQ,CAAA;MACd,OAAO,IAAI,CAAC,WAAW;IACxB;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,aAAa,CAAA;MACpB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;MACrB,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MAC9C,IAAI,CAAC,SAAS,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,eAAA,MAAA,CAAY,mBAAY,aAAU;MAC5E,IAAI,CAAC,mBAAmB,EAAE;MAC1B,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;IAC3C;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,mBAAmB,CAAA;MAC1B,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;MAExC,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,IAAI,EAAE;MACnD,IAAM,QAAQ,GAAG,WAAW,CAAC,QAAQ,IAAI,QAAQ;MAEjD,QAAQ,QAAQ;QACf,KAAK,KAAK;QACV,KAAK,QAAQ;QACb,KAAK,MAAM;QACX,KAAK,OAAO;UACX;QACD;UACC,MAAM,IAAI,mBAAW,8BAAA,MAAA,CAA8B,QAAQ,CAAE,CAAC;MAChE;MAGA,IAAI,CAAC,SAAS,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,eAAA,MAAA,CAAY,mBAAY,aAAU;MAG5E,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,eAAA,MAAA,CAAY,QAAQ,CAAE,CAAC;MAEnE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;QAChC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;MAC3C;MAEA,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,EAAE;MACvC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE;MAC/B,IAAI,IAAI,CAAC,WAAW,EAAE;QACrB,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE;MAClC;MAEA,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,UAAU,GAAG,GAAG;MACrC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,GAAG;MACxC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,WAAW,GAAG,GAAG;MACtC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,YAAY,GAAG,GAAG;MAGvC,IAAM,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC;MAC7D,IAAM,aAAa,GAAG,aAAa,CAAC,MAAM;MAC1C,IAAM,YAAY,GAAG,aAAa,CAAC,KAAK;MAExC,QAAQ,QAAQ;QACf,KAAK,KAAK;UACT,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,UAAU,GAAG,aAAa;UAC/C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,gBAAgB;UACrD,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG;UAChC,IAAI,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG;UACxD;QACD,KAAK,QAAQ;UACZ,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,aAAa;UAClD,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,QAAQ;UAC7C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG;UAChC,IAAI,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG;UACxD;QACD,KAAK,MAAM;UACV,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,WAAW,GAAG,YAAY;UAC/C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,aAAa;UAClD,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG;UAChC,IAAI,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG;UACxD;QACD,KAAK,OAAO;UACX,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,YAAY,GAAG,YAAY;UAChD,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,KAAK;UAC1C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG;UAChC,IAAI,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG;UACxD;MACF;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,iBAAiB,CAAC,GAAiB;MAAA,IAAA,MAAA;MAC1C,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;MACrB,IAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MAC1C,IAAI,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,kBAAe;MAC/C,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,QAAQ,EAAE;MACjC,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,QAAQ,EAAE;MAC3B,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,GAAG,CAAC,EAAE;MAE9B,IAAI,CAAC,wBAAwB,CAAC,IAAI,EAAE,GAAG,CAAC;MAExC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,YAAK;QACnC,IAAI,GAAG,CAAC,KAAK,KAAK,WAAW,EAAE;UAC9B,GAAG,CAAC,OAAO,CAAC;YAAE,MAAM,EAAE;UAAI,CAAE,CAAC;QAC9B,CAAC,MAAM;UACN,IAAI,MAAI,CAAC,YAAY,KAAK,GAAG,EAAE;YAC9B,GAAG,CAAC,QAAQ,CAAC;cAAE,MAAM,EAAE;YAAI,CAAE,CAAC;UAC/B,CAAC,MAAM;YACN,GAAG,CAAC,KAAK,EAAE;UACZ;QACD;MACD,CAAC,CAAC;MAEF,GAAG,CAAC,OAAO,CAAC,YAAY,GAAG,IAAI;MAC/B,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC;IACjC;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,wBAAwB,CAAC,IAAiB,EAAE,GAAiB;MACpE,IAAA,YAAA,GAAiC,GAAG,CAAC,OAAO;QAApC,IAAI,GAAA,YAAA,CAAJ,IAAI;QAAE,cAAc,GAAA,YAAA,CAAd,cAAc;MAC5B,IAAI,CAAC,SAAS,GAAG,EAAE;MACnB,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,QAAQ,EAAE;MAE3B,IAAM,YAAY,GAAG,CAAA,cAAc,aAAd,cAAc,uBAAd,cAAc,CAAE,YAAY,KAAI,IAAI;MAEzD,IAAI,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC,CAAC,YAAY,CAAC;MAElE,IAAI,YAAY,EAAE;QACjB,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;QAC5C,MAAM,CAAC,SAAS,MAAA,MAAA,CAAM,mBAAY,uBAAoB;QACtD,IAAI,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;UAC5B,IAAM,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC;UACrC,CAAC,CAAC,SAAS,GAAG,IAAI;UAClB,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC;QACtB,CAAC,MAAM;UACN,IAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;UACzC,GAAG,CAAC,GAAG,GAAG,IAAI;UACd,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,QAAQ,EAAE;UACxB,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC;QACxB;QACA,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;MACzB,CAAC,MAAM;QACN,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,QAAQ,EAAE;MAClC;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,iBAAiB,CAAC,GAAiB,EAAE,KAAkG;MAC7I,IAAM,IAAI,GAAG,GAAG,CAAC,OAAO,CAAC,YAAY;MACrC,IAAI,CAAC,IAAI,EAAE;MAEX,QAAQ,KAAK;QACZ,KAAK,WAAW;UACf,IAAI,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;UAC/C;QACD,KAAK,UAAU;UACd,IAAI,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,eAAY,CAAC;UAClD;QACD,KAAK,cAAc;QACnB,KAAK,aAAa;UACjB,IAAI,CAAC,wBAAwB,CAAC,IAAI,EAAE,GAAG,CAAC;UACxC;QACD,KAAK,aAAa;UACjB,IAAI,IAAI,CAAC,YAAY,CAAC,+BAA+B,EAAE;YACtD,IAAI,CAAC,SAAS,CAAC,GAAG,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC;UAClD;UACA;QACD,KAAK,eAAe;UACnB,IAAI,CAAC,SAAS,CAAC,MAAM,IAAA,MAAA,CAAI,mBAAY,iBAAc,CAAC;UACpD;MACF;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,iBAAiB,CAAC,GAAiB;MAC1C,IAAI,CAAC,mBAAmB,EAAE;MAE1B,IAAI,CAAC,oBAAoB,GAAG,UAAC,CAAgB,EAAI;QAChD,IAAI,CAAC,CAAC,GAAG,KAAK,KAAK,EAAE;UACpB,CAAC,CAAC,cAAc,EAAE;UAClB,IAAM,iBAAiB,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,gBAAgB,CAAc,oFAAoF,CAAC,CAAC,CAAC,MAAM,CAAC,UAAC,EAAE;YAAA,OAAK,CAAC,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,YAAY,CAAC;UAAA,EAAC;UAE1O,IAAI,iBAAiB,CAAC,MAAM,KAAK,CAAC,EAAE;UAEpC,IAAM,YAAY,GAAG,iBAAiB,CAAC,OAAO,CAAC,QAAQ,CAAC,aAA4B,CAAC;UACrF,IAAI,SAAS,GAAG,CAAC,CAAC,QAAQ,GAAG,YAAY,GAAG,CAAC,GAAG,YAAY,GAAG,CAAC;UAEhE,IAAI,SAAS,IAAI,iBAAiB,CAAC,MAAM,EAAE;YAC1C,SAAS,GAAG,CAAC;UACd;UACA,IAAI,SAAS,GAAG,CAAC,EAAE;YAClB,SAAS,GAAG,iBAAiB,CAAC,MAAM,GAAG,CAAC;UACzC;UACA,iBAAiB,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE;QACrC;MACD,CAAC;MACD,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,oBAAoB,CAAC;IAChE;EAAC;IAAA,GAAA;IAAA,KAAA,EAEO,SAAA,mBAAmB,CAAA;MAC1B,IAAI,IAAI,CAAC,oBAAoB,EAAE;QAC9B,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,oBAAoB,CAAC;QAClE,IAAI,CAAC,oBAAoB,GAAG,IAAI;MACjC;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAMO,SAAA,aAAa,CAAC,QAAgB;MACrC,IAAM,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC;MAChC,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,IAAI,EAAE;MAC5B,IAAM,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;MAClC,IAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;MAChC,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;MACpC,OAAO;QAAE,IAAI,EAAJ,IAAI;QAAE,GAAG,EAAH,GAAG;QAAE,KAAK,EAAL,KAAK;QAAE,GAAG,EAAH;MAAG,CAAE;IACjC;EAAC;IAAA,GAAA;IAAA,KAAA;MAAA,IAAA,qBAAA,OAAA,kBAAA,aAAA,YAAA,YAAA,IAAA,CAKM,SAAA,SAAA;QAAA,IAAA,qBAAA;QAAA,IAAA,SAAA,EAAA,UAAA,EAAA,MAAA,EAAA,GAAA,EAAA,OAAA,EAAA,YAAA,EAAA,CAAA,EAAA,SAAA,EAAA,UAAA,EAAA,YAAA,EAAA,SAAA,EAAA,GAAA,EAAA,aAAA,EAAA,KAAA,EAAA,UAAA,EAAA,eAAA,EAAA,CAAA,EAAA,qBAAA,EAAA,WAAA,EAAA,YAAA,EAAA,WAAA;QAAA,OAAA,YAAA,YAAA,IAAA,WAAA,SAAA;UAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;YAAA;cAAA,MACF,CAAC,IAAI,CAAC,YAAY,CAAC,oBAAoB,IAAI,CAAC,IAAI,CAAC,WAAW;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAAA,OAAA,SAAA,CAAA,MAAA;YAAA;cAE1D,SAAS,IAAA,qBAAA,GAAG,IAAI,CAAC,YAAY,CAAC,uBAAuB,cAAA,qBAAA,cAAA,qBAAA,GAAI,CAAC;cAAA,MAC5D,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,SAAS;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAAA,UAAA,GAAA,0BAAA,CAEf,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;cAAA;gBAAvC,KAAA,UAAA,CAAA,CAAA,MAAA,MAAA,GAAA,UAAA,CAAA,CAAA,IAAA,IAAA,GAAyC;kBAA9B,GAAG,GAAA,MAAA,CAAA,KAAA;kBACb,IAAI,GAAG,CAAC,mBAAmB,KAAK,MAAM,IAAI,GAAG,CAAC,KAAK,KAAK,WAAW,EAAE;oBACpE,GAAG,CAAC,YAAY,EAAE;kBACnB;gBACD;cAAC,SAAA,GAAA;gBAAA,UAAA,CAAA,CAAA,CAAA,GAAA;cAAA;gBAAA,UAAA,CAAA,CAAA;cAAA;cAAA,OAAA,SAAA,CAAA,MAAA;YAAA;cAKI,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC;gBAAA,OAAK,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,IAAI,GAAG,EAAE,EAAE,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,IAAI,GAAG,EAAE,EAAE,CAAC;cAAA,EAAC;cAE3I,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,qBAAqB,EAAE;cAEpD,CAAC,GAAG,CAAC;YAAA;cAAA,MAAE,CAAC,GAAG,OAAO,CAAC,MAAM;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAC3B,SAAS,GAAG,OAAO,CAAC,CAAC,CAAC;cAAA,MAGxB,CAAC,SAAS,CAAC,OAAO,CAAC,aAAa,IAAK,SAAS,CAAC,KAAK,KAAK,QAAQ,IAAI,SAAS,CAAC,KAAK,KAAK,WAAY,IAAI,SAAS,KAAK,IAAI,CAAC,YAAY;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAC3I,SAAS,CAAC,YAAY,EAAE;cAAC,OAAA,SAAA,CAAA,MAAA;YAAA;cAIpB,UAAU,GAAG,SAAS,CAAC,EAAE,CAAC,qBAAqB,EAAE;cAAA,MAEnD,UAAU,CAAC,KAAK,IAAI,CAAC,IAAI,UAAU,CAAC,MAAM,IAAI,CAAC;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAClD,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC;cAAC,OAAA,SAAA,CAAA,MAAA;YAAA;cAKxB,YAAY,GAAG,CACpB;gBAAE,CAAC,EAAE,UAAU,CAAC,IAAI,GAAG,CAAC;gBAAE,CAAC,EAAE,UAAU,CAAC,GAAG,GAAG;cAAC,CAAE,EACjD;gBAAE,CAAC,EAAE,UAAU,CAAC,KAAK,GAAG,CAAC;gBAAE,CAAC,EAAE,UAAU,CAAC,GAAG,GAAG;cAAC,CAAE,EAClD;gBAAE,CAAC,EAAE,UAAU,CAAC,KAAK,GAAG,CAAC;gBAAE,CAAC,EAAE,UAAU,CAAC,MAAM,GAAG;cAAC,CAAE,EACrD;gBAAE,CAAC,EAAE,UAAU,CAAC,IAAI,GAAG,CAAC;gBAAE,CAAC,EAAE,UAAU,CAAC,MAAM,GAAG;cAAC,CAAE,EACpD;gBAAE,CAAC,EAAE,UAAU,CAAC,IAAI,GAAG,UAAU,CAAC,KAAK,GAAG,GAAG;gBAAE,CAAC,EAAE,UAAU,CAAC,GAAG,GAAG,UAAU,CAAC,MAAM,GAAG;cAAG,CAAE,CAC5F;cAEG,SAAS,GAAG,KAAK;cAAA,GAAA,MAAA,aAAA,GACD,YAAY;YAAA;cAAA,MAAA,GAAA,GAAA,aAAA,CAAA,MAAA;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAArB,KAAK,GAAA,aAAA,CAAA,GAAA;cAET,UAAU,GAAG,KAAK,CAAC,CAAC,IAAI,YAAY,CAAC,IAAI,IAAI,KAAK,CAAC,CAAC,GAAG,YAAY,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,IAAI,YAAY,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,YAAY,CAAC,MAAM;cAAA,IAC1I,UAAU;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAAA,OAAA,SAAA,CAAA,MAAA;YAAA;cAKX,eAAe,GAAG,KAAK;cAElB,CAAC,GAAG,CAAC,GAAG,CAAC;YAAA;cAAA,MAAE,CAAC,GAAG,OAAO,CAAC,MAAM;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAC/B,WAAW,GAAG,OAAO,CAAC,CAAC,CAAC;cAAA,MAE1B,WAAW,CAAC,KAAK,KAAK,QAAQ,IAAI,EAAA,qBAAA,GAAC,WAAW,CAAC,UAAU,EAAE,cAAA,qBAAA,cAAA,qBAAA,GAAI,CAAC,IAAI,GAAG;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAAA,OAAA,SAAA,CAAA,MAAA;YAAA;cAIrE,YAAY,GAAG,WAAW,CAAC,EAAE,CAAC,qBAAqB,EAAE;cAAA,MAEvD,KAAK,CAAC,CAAC,IAAI,YAAY,CAAC,IAAI,IAAI,KAAK,CAAC,CAAC,GAAG,YAAY,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,IAAI,YAAY,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,YAAY,CAAC,MAAM;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cAC/H,eAAe,GAAG,IAAI;cAAC,OAAA,SAAA,CAAA,MAAA;YAAA;cAVe,CAAC,EAAE;cAAA,SAAA,CAAA,IAAA;cAAA;YAAA;cAAA,IAgBtC,eAAe;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cACnB,SAAS,GAAG,IAAI;cAAC,OAAA,SAAA,CAAA,MAAA;YAAA;cAAA,GAAA;cAAA,SAAA,CAAA,IAAA;cAAA;YAAA;cAAA,KAMf,SAAS;gBAAA,SAAA,CAAA,IAAA;gBAAA;cAAA;cACN,WAAW,GAAG,SAAS,CAAC,OAAO,CAAC,yBAAyB,IAAI,IAAI,CAAC,YAAY,CAAC,yBAAyB,IAAI,MAAM;cACxH,IAAI,WAAW,KAAK,MAAM,EAAE;gBAC3B,SAAS,CAAC,YAAY,EAAE;cACzB;cAAC,SAAA,CAAA,IAAA;cAAA;YAAA;cAAA,SAAA,CAAA,IAAA;cAAA,OAEK,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC;YAAA;cAjEA,CAAC,EAAE;cAAA,SAAA,CAAA,IAAA;cAAA;YAAA;YAAA;cAAA,OAAA,SAAA,CAAA,IAAA;UAAA;QAAA,GAAA,QAAA;MAAA,CAoEvC;MAAA,SAvFY,oBAAoB,CAAA;QAAA,OAAA,qBAAA,CAAA,KAAA,OAAA,SAAA;MAAA;MAAA,OAApB,oBAAoB;IAAA;EAAA;IAAA,GAAA;IAAA,KAAA,EA4FzB,SAAA,2BAA2B,CAAA;MAAA,IAAA,MAAA;MAClC,IAAI,IAAI,CAAC,sBAAsB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;MAGpD,IAAI,CAAC,mBAAmB,GAAG,MAAM,CAAC,UAAU,CAAC,0BAA0B,CAAC;MACxE,IAAI,CAAC,oBAAoB,GAAG,UAAC,CAAsB,EAAI;QAEtD,IAAI,CAAC,CAAC,OAAO,EAAE;UACd,MAAI,CAAC,qBAAqB,EAAE;UAC5B,MAAI,CAAC,QAAQ,CAAC,eAAe,CAAC;QAC/B,CAAC,MAAM;UAEN,MAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC;QACjF;MACD,CAAC;MACD,IAAI,CAAC,mBAAmB,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,oBAAoB,CAAC;MAG9E,IAAM,UAAU,GAAG,QAAQ,CAAC,eAAe;MAC3C,IAAM,MAAM,GAAG;QAAE,UAAU,EAAE,IAAI;QAAE,eAAe,EAAE,CAAC,eAAe;MAAC,CAAE;MACvE,IAAM,QAAQ,GAAG,SAAX,QAAQ,CAAI,aAA+B,EAAI;QAAA,IAAA,qBAAA;QAEpD,IAAI,GAAA,qBAAA,GAAC,MAAI,CAAC,mBAAmB,cAAA,qBAAA,eAAxB,qBAAA,CAA0B,OAAO,GAAE;UAAA,IAAA,UAAA,GAAA,0BAAA,CAChB,aAAa;YAAA,MAAA;UAAA;YAApC,KAAA,UAAA,CAAA,CAAA,MAAA,MAAA,GAAA,UAAA,CAAA,CAAA,IAAA,IAAA,GAAsC;cAAA,IAA3B,QAAQ,GAAA,MAAA,CAAA,KAAA;cAClB,IAAI,QAAQ,CAAC,IAAI,KAAK,YAAY,IAAI,QAAQ,CAAC,aAAa,KAAK,eAAe,EAAE;gBACjF,IAAM,UAAU,GAAI,QAAQ,CAAC,MAAsB,CAAC,YAAY,CAAC,eAAe,CAAC;gBACjF,MAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC;cACrC;YACD;UAAC,SAAA,GAAA;YAAA,UAAA,CAAA,CAAA,CAAA,GAAA;UAAA;YAAA,UAAA,CAAA,CAAA;UAAA;QACF;MACD,CAAC;MACD,IAAI,CAAC,sBAAsB,GAAG,IAAI,gBAAgB,CAAC,QAAQ,CAAC;MAC5D,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC,UAAU,EAAE,MAAM,CAAC;MAIvD,IAAI,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE;QACrC,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC;MAC/B,CAAC,MAAM;QAEN,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC;MACnE;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAKO,SAAA,0BAA0B,CAAA;MACjC,IAAI,IAAI,CAAC,sBAAsB,EAAE;QAChC,IAAI,CAAC,sBAAsB,CAAC,UAAU,EAAE;QACxC,IAAI,CAAC,sBAAsB,GAAG,IAAI;MACnC;MACA,IAAI,IAAI,CAAC,mBAAmB,IAAI,IAAI,CAAC,oBAAoB,EAAE;QAC1D,IAAI,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,oBAAoB,CAAC;MAClF;MACA,IAAI,CAAC,qBAAqB,EAAE;IAC7B;EAAC;IAAA,GAAA;IAAA,KAAA,EAMO,SAAA,mBAAmB,CAAC,UAAyB;MACpD,IAAI,CAAC,qBAAqB,EAAE;MAE5B,IAAI,UAAU,KAAK,MAAM,EAAE;QAC1B,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;MACtB,CAAC,MAAM,IAAI,UAAU,KAAK,MAAM,EAAE;QACjC,IAAI,CAAC,sBAAsB,EAAE;MAC9B,CAAC,MAAM;QAEN,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;MACzB;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAKO,SAAA,sBAAsB,CAAA;MAAA,IAAA,MAAA;MAC7B,IAAI,IAAI,CAAC,0BAA0B,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE;MAE3D,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,UAAU,CAAC,8BAA8B,CAAC;MAE3E,IAAI,CAAC,0BAA0B,GAAG,UAAC,CAAsB,EAAI;QAC5D,MAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,GAAG,MAAM,GAAG,SAAS,CAAC;MAC9C,CAAC;MAED,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,0BAA0B,CAAC;MAGnF,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC,OAAO,GAAG,MAAM,GAAG,SAAS,CAAC;IACpE;EAAC;IAAA,GAAA;IAAA,KAAA,EAKO,SAAA,qBAAqB,CAAA;MAC5B,IAAI,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,0BAA0B,EAAE;QAC/D,IAAI,CAAC,kBAAkB,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,0BAA0B,CAAC;MACvF;MACA,IAAI,CAAC,kBAAkB,GAAG,IAAI;MAC9B,IAAI,CAAC,0BAA0B,GAAG,IAAI;IACvC;EAAC;AAAA,EAptCyC,qBAA+B;AAAA,IAAA,gBAAA,aAArD,aAAc,gBAGN,IAAI,GAAG,EAAwB;;;;;;;;;;ACd5D,IAAA,OAAA,GAAA,OAAA;AACA,IAAA,MAAA,GAAA,OAAA;AAEA,IAAA,eAAA,GAAA,sBAAA,CAAA,OAAA;AACA,IAAA,MAAA,GAAA,sBAAA,CAAA,OAAA;AACA,IAAA,QAAA,GAAA,OAAA;AAAwC,IAAA,SAAA;AAExC,IAAM,OAAO,GAAI,EAAA,SAAA,GAAA,QAAQ,cAAA,SAAA,gBAAA,SAAA,GAAR,SAAA,CAAU,aAAmC,cAAA,SAAA,uBAA7C,SAAA,CAA+C,GAAG,KAAI,EAAE;AAEzE,IAAM,YAAY,GAAwB;EACzC,oBAAoB,EAAE,QAAQ;EAC9B,WAAW,EAAE,OAAO;EACpB,gBAAgB,EAAE,IAAI;EACtB,kBAAkB,EAAE,IAAI;EACxB,mBAAmB,EAAE,IAAI;EACzB,oBAAoB,EAAE,IAAI;EAC1B,+BAA+B,EAAE,IAAI;EACrC,uBAAuB,EAAE,CAAC;EAC1B,mBAAmB,EAAE,IAAI,GAAG,EAAE;EAC9B,OAAO,EAAE;IACR,QAAQ,EAAE;GACV;EACD,wBAAwB,EAAE,IAAI;EAC9B,eAAe,EAAE;CACjB;AAGD,IAAM,OAAO,GAAG,IAAI,0BAAa,CAAC,YAAY,CAAC;AAG/C,IAAM,GAAG,GAAc;EAOtB,IAAI,EAAE,SAAN,IAAI,CAAA,EAA8C;IAAA,IAA3C,OAAA,GAAA,SAAA,CAAA,MAAA,QAAA,SAAA,QAAA,SAAA,GAAA,SAAA,MAA+B,EAAE;IACvC,GAAG,CAAC,eAAe,CAAC,OAAO,CAAC;IAC5B,OAAO,CAAC,IAAI,EAAE;EACf,CAAC;EAKD,YAAY,EAAE,SAAd,YAAY,CAAA,EAA2C;IAAA,IAAxC,OAAA,GAAA,SAAA,CAAA,MAAA,QAAA,SAAA,QAAA,SAAA,GAAA,SAAA,MAAyB,EAAE;IACzC,OAAO,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC;EACrC,CAAC;EAED,EAAE,WAAF,EAAE,CAAiC,SAAY,EAAE,QAA2B,EAAE,OAAyB;IACtG,OAAO,CAAC,EAAE,CAAC,SAAS,EAAE,QAAQ,EAAE,OAAO,CAAC;EACzC,CAAC;EAED,GAAG,WAAH,GAAG,CAAiC,SAAY,EAAE,QAA2B;IAC5E,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,QAAQ,CAAC;EACjC,CAAC;EAED,IAAI,WAAJ,IAAI,CAAiC,SAAY,EAAwC;IAAA,SAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAAnC,IAAmC,OAAA,KAAA,CAAA,IAAA,OAAA,IAAA,WAAA,IAAA,MAAA,IAAA,GAAA,IAAA,EAAA,IAAA;MAAnC,IAAmC,CAAA,IAAA,QAAA,SAAA,CAAA,IAAA;IAAA;IACxF,OAAO,OAAO,CAAC,IAAI,CAAA,KAAA,CAAZ,OAAO,GAAM,SAAS,EAAA,MAAA,CAAK,IAAI,EAAC;EACxC,CAAC;EAKD,WAAW,EAAE,SAAb,WAAW,CAAG,OAAqB,EAAa;IAC/C,OAAO,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC;EAC9B,CAAC;EAKD,gBAAgB,EAAE,SAAlB,gBAAgB,CAAG,OAAqB,EAA0B;IACjE,OAAO,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC;EACnC,CAAC;EAKD,SAAS,EAAE,SAAX,SAAS,CAAG,EAAU,EAAyB;IAC9C,OAAO,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC;EAC7B,CAAC;EAKD,oBAAoB,EAAE,SAAtB,oBAAoB,CAAG,OAAoB,EAAyB;IACnE,OAAO,OAAO,CAAC,oBAAoB,CAAC,OAAO,CAAC;EAC7C,CAAC;EAKD,eAAe,EAAE,SAAjB,eAAe,CAAA,EAAuB;IACrC,OAAO,OAAO,CAAC,eAAe,EAAE;EACjC,CAAC;EAKD,iBAAiB,WAAjB,iBAAiB,CAAC,GAAY,EAAE,KAAkG;IACjI,OAAO,CAAC,iBAAiB,CAAC,GAAmB,EAAE,KAAK,CAAC;EACtD,CAAC;EAKD,gBAAgB,EAAE,SAAlB,gBAAgB,CAAG,OAAsB,EAAU;IAClD,iBAAK,CAAC,SAAS,CAAC,qBAAa,EAAE,OAAO,CAAC;EACxC,CAAC;EAKD,eAAe,EAAE,SAAjB,eAAe,CAAG,OAA4B,EAAU;IAEvD,IAAI,OAAO,CAAC,aAAa,IAAI,OAAO,CAAC,SAAS,EAAE;MAC/C,OAAO,CAAC,IAAI,CAAC,+DAA+D,CAAC;MAC7E,OAAO,OAAO,CAAC,SAAS;IACzB;IACA,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,OAAO,CAAC;IACpC,OAAO,CAAC,iBAAiB,CAAC,YAAY,CAAC;EACxC,CAAC;EAKD,aAAa,EAAE,SAAf,aAAa,CAAG,KAAY,EAAU;IACrC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC;EAC7B,CAAC;EAKD,mBAAmB,EAAE,SAArB,mBAAmB,CAAA,EAAO;IACzB,OAAO,OAAO,CAAC,mBAAmB,EAAE;EACrC,CAAC;EAKD,QAAQ,EAAE,SAAV,QAAQ,CAAG,KAAqB,EAAU;IACzC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC;EACxB,CAAC;EAKD,QAAQ,EAAE,SAAV,QAAQ,CAAA,EAAqB;IAC5B,OAAO,OAAO,CAAC,QAAQ,EAAE;EAC1B,CAAC;EAKD,IAAI,OAAO,CAAA;IACV,OAAO,oBAAW;EACnB,CAAC;EAKD,oBAAoB,EAAE,qBAAc;EAIpC,yBAAyB,EAAE;CAC3B;AAGD,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;EAClC,MAAM,CAAC,MAAM,GAAG,GAAG;AACpB;AAAC,IAAA,QAAA,GAAA,OAAA,cAGc,GAAG;;;;;;;;;;;;;ICxKG,eAAe,GAAA,OAAA;EAGnC,SAAA,gBAAA;IAAA,IAAA,gBAAA,mBAAA,eAAA;IACC,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,EAAE;EACxB;EAAC,WAAA,aAAA,aAAA,eAAA;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,EAAE,CAA2B,SAAY,EAAE,QAAqB,EAAE,OAAyB;MAAA,IAAA,KAAA;MACjG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;QAChC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC;MAC/B;MAEA,IAAI,OAAO,GAA8B,QAAQ;MACjD,IAAI,OAAO,aAAP,OAAO,eAAP,OAAO,CAAE,IAAI,EAAE;QAClB,OAAO,GAAI,SAAX,OAAO,CAAA,EAAyC;UAC/C,KAAI,CAAC,GAAG,CAAC,SAAS,EAAE,QAAQ,CAAC;UAC7B,QAAQ,CAAA,KAAA,SAAA,SAAQ,CAAC;QAClB,CAAiB;MAClB;MAEA,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,SAAS,CAAE,CAAC,IAAI,CAAC;QAChC,OAAO,EAAE,OAAO;QAChB,QAAQ,EAAE;OACV,CAAC;IACH;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,GAAG,CAA2B,SAAY,EAAE,QAAqB;MACvE,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC;MAC3C,IAAI,QAAQ,EAAE;QACb,IAAM,KAAK,GAAG,QAAQ,CAAC,SAAS,CAAC,UAAC,CAAC;UAAA,OAAK,CAAC,CAAC,QAAQ,KAAK,QAAQ;QAAA,EAAC;QAChE,IAAI,KAAK,GAAG,CAAC,CAAC,EAAE;UACf,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;QAC1B;MACD;IACD;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAA,IAAI,CAA2B,SAAY,EAAkC;MAAA,SAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAA7B,IAA6B,OAAA,KAAA,CAAA,IAAA,OAAA,IAAA,WAAA,IAAA,MAAA,IAAA,GAAA,IAAA,EAAA,IAAA;QAA7B,IAA6B,CAAA,IAAA,QAAA,SAAA,CAAA,IAAA;MAAA;MACnF,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC;MAC3C,IAAI,QAAQ,EAAE;QACb,IAAM,OAAO,GAA8B,EAAE;QAC7C,IAAA,mBAAA,aAAI,QAAQ,EAAE,OAAO,CAAC,UAAC,UAAU,EAAI;UACpC,IAAI;YACH,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAA,KAAA,CAAlB,UAAU,EAAY,IAAI,CAAC,CAAC;UAC1C,CAAC,CAAC,OAAO,CAAC,EAAE;YACX,OAAO,CAAC,KAAK,iCAAA,MAAA,CAAgC,MAAM,CAAC,SAAS,CAAC,UAAM,CAAC,CAAC;UACvE;QACD,CAAC,CAAC;QACF,OAAO,OAAO;MACf;IACD;EAAC;AAAA;;;;;;;;;;;;;;;;;;;;ICzDmB,KAAK,GAAA,OAAA;EAAA,SAAA,MAAA;IAAA,IAAA,gBAAA,mBAAA,KAAA;EAAA;EAAA,WAAA,aAAA,aAAA,KAAA;IAAA,GAAA;IAAA,KAAA,EAMlB,SAAO,UAAU,CAAA,EAAuB;MAAA,IAAtB,MAAA,GAAA,SAAA,CAAA,MAAA,QAAA,SAAA,QAAA,SAAA,GAAA,SAAA,MAAiB,KAAK;MAC9C,UAAA,MAAA,CAAU,MAAM,OAAA,MAAA,CAAI,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;IAC/D;EAAC;IAAA,GAAA;IAAA,KAAA,EAEM,SAAO,QAAQ,CAAI,KAAQ,EAA4C;MAAA,IAAA,KAAA;MAAA,IAA1C,IAAA,GAAA,SAAA,CAAA,MAAA,QAAA,SAAA,QAAA,SAAA,GAAA,SAAA,MAA6B,IAAI,OAAO,EAAE;MAC7E,IAAI,KAAK,KAAK,IAAI,IAAI,IAAA,QAAA,aAAO,KAAK,MAAK,QAAQ,EAAE,OAAO,KAAK;MAE7D,IAAI,KAAK,YAAY,IAAI,EAAE,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAM;MAEhE,IAAI,KAAK,YAAY,GAAG,EAAE;QACzB,IAAM,SAAS,GAAG,IAAI,GAAG,EAAE;QAC3B,KAAK,CAAC,OAAO,CAAC,UAAC,CAAC,EAAE,CAAC,EAAI;UACtB,SAAS,CAAC,GAAG,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,IAAI,CAAC,EAAE,KAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;QAC9D,CAAC,CAAC;QACF,OAAO,SAAc;MACtB;MAEA,IAAI,KAAK,YAAY,GAAG,EAAE;QACzB,IAAM,SAAS,GAAG,IAAI,GAAG,EAAE;QAC3B,KAAK,CAAC,OAAO,CAAC,UAAC,CAAC,EAAI;UACnB,SAAS,CAAC,GAAG,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;QACtC,CAAC,CAAC;QACF,OAAO,SAAc;MACtB;MAEA,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;QACzB,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,OAAO,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC;QAC3C,IAAM,OAAO,GAAU,EAAE;QACzB,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC;QAAC,IAAA,SAAA,GAAA,0BAAA,CACN,KAAK;UAAA,KAAA;QAAA;UAAxB,KAAA,SAAA,CAAA,CAAA,MAAA,KAAA,GAAA,SAAA,CAAA,CAAA,IAAA,IAAA,GAA0B;YAAA,IAAf,IAAI,GAAA,KAAA,CAAA,KAAA;YACd,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;UACxC;QAAC,SAAA,GAAA;UAAA,SAAA,CAAA,CAAA,CAAA,GAAA;QAAA;UAAA,SAAA,CAAA,CAAA;QAAA;QACD,OAAO,OAAY;MACpB;MAEA,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,OAAO,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC;MAC3C,IAAM,SAAS,GAA2B,EAAE;MAC5C,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,SAAS,CAAC;MAC1B,KAAK,IAAM,GAAG,IAAI,KAAK,EAAE;QACxB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,EAAE;UACrD,SAAS,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAE,KAAa,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC;QAC1D;MACD;MACA,OAAO,SAAc;IACtB;EAAC;IAAA,GAAA;IAAA,KAAA,EAKM,SAAO,SAAS,CAAqC,MAAS,EAAE,MAAS;MAC/E,IAAM,MAAM,GAAA,aAAA,KAAQ,MAAM,CAAW;MAErC,KAAK,IAAM,GAAG,IAAI,MAAM,EAAE;QACzB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;UACtD,IAAM,WAAW,GAAG,MAAM,CAAC,GAAG,CAAC;UAC/B,IAAM,WAAW,GAAI,MAAc,CAAC,GAAG,CAAC;UAExC,IAAI,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;YAE9B,MAAc,CAAC,GAAG,CAAC,GAAG,WAAW;UACnC,CAAC,MAAM,IAAI,WAAW,YAAY,MAAM,IAAI,OAAO,WAAW,KAAK,UAAU,IAAI,WAAW,YAAY,MAAM,EAAE;YAC9G,MAAc,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,WAAW,CAAC;UAChE,CAAC,MAAM;YACL,MAAc,CAAC,GAAG,CAAC,GAAG,WAAW;UACnC;QACD;MACD;MAEA,OAAO,MAAM;IACd;EAAC;IAAA,GAAA;IAAA,KAAA,EAOM,SAAO,gBAAgB,CAAmB,GAAkB;MAClE,IAAI,CAAC,GAAG,EAAE,OAAO,KAAK;MACtB,KAAK,IAAM,CAAC,IAAI,GAAG,EAAE,OAAO,IAAI;MAChC,OAAO,KAAK;IACb;EAAC;IAAA,GAAA;IAAA,KAAA,EAOM,SAAO,YAAY,CAAC,GAAW;MACrC,IAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;MAC1C,IAAI,CAAC,WAAW,GAAG,GAAG;MACtB,OAAO,IAAI,CAAC,SAAS;IACtB;EAAC;IAAA,GAAA;IAAA,KAAA,EAMM,SAAO,WAAW,CAAC,MAAc;MACvC,OAAO,MAAM,CAAC,OAAO,CAAC,wBAAwB,EAAE,MAAM,CAAC;IACxD;EAAC;IAAA,GAAA;IAAA,KAAA,EAQM,SAAO,QAAQ,CAAC,IAA8B,EAAE,KAAa;MACnE,IAAI,SAAS,GAAkB,IAAI;MACnC,IAAI,QAAQ,GAAiB,IAAI;MAEjC,OAAO,YAAwB;QAAA,SAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAAX,IAAW,OAAA,KAAA,CAAA,IAAA,GAAA,IAAA,MAAA,IAAA,GAAA,IAAA,EAAA,IAAA;UAAX,IAAW,CAAA,IAAA,IAAA,SAAA,CAAA,IAAA;QAAA;QAC9B,QAAQ,GAAG,IAAI;QACf,IAAI,SAAS,KAAK,IAAI,EAAE;UACvB,SAAS,GAAG,MAAM,CAAC,UAAU,CAAC,YAAK;YAClC,IAAI,QAAQ,EAAE;cACb,IAAI,CAAA,KAAA,aAAA,mBAAA,aAAI,QAAQ,EAAC;YAClB;YACA,SAAS,GAAG,IAAI;UACjB,CAAC,EAAE,KAAK,CAAC;QACV;MACD,CAAC;IACF;EAAC;AAAA;;;;;;;;;AChIF,IAAM,SAAS,+uwCA2tCd;AAAC,IAAA,QAAA,GAAA,OAAA,cAEa,SAAS;;;;;;;;;AC1tCjB,IAAM,SAAS,GAAA,OAAA,CAAA,SAAA,GAAU;EAC/B,IAAI,EAAE,MAAM;EACZ,SAAS,EAAE;IAEV,wBAAwB,EAAE,SAAS;IACnC,gBAAgB,EAAE,SAAS;IAC3B,oBAAoB,EAAE,MAAM;IAC5B,gCAAgC,EAAE,iBAAiB;IACnD,iCAAiC,EAAE,iBAAiB;IACpD,iCAAiC,EAAE,iBAAiB;IAGpD,0BAA0B,EAAE,SAAS;IACrC,8BAA8B,EAAE,SAAS;IACzC,qCAAqC,EAAE,MAAM;IAG7C,wBAAwB,EAAE,SAAS;IACnC,8BAA8B,EAAE,SAAS;IAGzC,qBAAqB,EAAE,SAAS;IAChC,yBAAyB,EAAE,MAAM;IACjC,6BAA6B,EAAE,SAAS;IACxC,iCAAiC,EAAE,SAAS;IAG5C,oBAAoB,EAAE,SAAS;IAC/B,2BAA2B,EAAE,SAAS;IACtC,wBAAwB,EAAE,SAAS;IACnC,wBAAwB,EAAE,SAAS;IACnC,oCAAoC,EAAE,SAAS;IAC/C,2CAA2C,EAAE,SAAS;IAGtD,mCAAmC,EAAE,SAAS;IAC9C,6CAA6C,EAAE,MAAM;IAGrD,wBAAwB,EAAE,uBAAuB;IACjD,4BAA4B,EAAE,MAAM;IACpC,6BAA6B,EAAE,SAAS;IAGxC,gCAAgC,EAAE;;CAEnC;;;;;;;;;AC9CM,IAAM,YAAY,GAAA,OAAA,CAAA,YAAA,GAAU;EAClC,IAAI,EAAE,SAAS;EACf,SAAS,EAAE;IAEV,wBAAwB,EAAE,MAAM;IAChC,gBAAgB,EAAE,SAAS;IAC3B,oBAAoB,EAAE,SAAS;IAC/B,gCAAgC,EAAE,kBAAkB;IACpD,iCAAiC,EAAE,iBAAiB;IACpD,iCAAiC,EAAE,kBAAkB;IAGrD,0BAA0B,EAAE,SAAS;IACrC,iCAAiC,EAAE,SAAS;IAC5C,8BAA8B,EAAE,MAAM;IACtC,qCAAqC,EAAE,MAAM;IAG7C,wBAAwB,EAAE,SAAS;IACnC,8BAA8B,EAAE,SAAS;IACzC,oCAAoC,EAAE,SAAS;IAC/C,uCAAuC,EAAE,MAAM;IAG/C,qBAAqB,EAAE,MAAM;IAC7B,yBAAyB,EAAE,MAAM;IACjC,6BAA6B,EAAE,MAAM;IACrC,gCAAgC,EAAE,SAAS;IAC3C,mCAAmC,EAAE,MAAM;IAC3C,iCAAiC,EAAE,MAAM;IAGzC,oBAAoB,EAAE,SAAS;IAC/B,2BAA2B,EAAE,SAAS;IACtC,wBAAwB,EAAE,SAAS;IACnC,wBAAwB,EAAE,SAAS;IACnC,oCAAoC,EAAE,MAAM;IAC5C,2CAA2C,EAAE,MAAM;IAGnD,iCAAiC,EAAE,QAAQ;IAC3C,wCAAwC,EAAE,QAAQ;IAGlD,mCAAmC,EAAE,SAAS;IAC9C,6CAA6C,EAAE,MAAM;IAGrD,wBAAwB,EAAE,0BAA0B;IACpD,4BAA4B,EAAE,SAAS;IACvC,6BAA6B,EAAE,SAAS;IACxC,oCAAoC,EAAE,SAAS;IAC/C,uCAAuC,EAAE,MAAM;IAG/C,uBAAuB,EAAE,0BAA0B;IACnD,0BAA0B,EAAE,sCAAsC;IAGlE,gCAAgC,EAAE;;CAEnC;;;;;;;;;AC1DM,IAAM,iBAAiB,GAAA,OAAA,CAAA,iBAAA,GAAU;EACvC,IAAI,EAAE,eAAe;EACrB,SAAS,EAAE;IAEV,wBAAwB,EAAE,MAAM;IAChC,gBAAgB,EAAE,MAAM;IACxB,oBAAoB,EAAE,MAAM;IAC5B,gCAAgC,EAAE,aAAa;IAC/C,iCAAiC,EAAE,aAAa;IAChD,iCAAiC,EAAE,aAAa;IAGhD,0BAA0B,EAAE,MAAM;IAClC,iCAAiC,EAAE,SAAS;IAC5C,8BAA8B,EAAE,MAAM;IACtC,qCAAqC,EAAE,MAAM;IAG7C,wBAAwB,EAAE,MAAM;IAChC,8BAA8B,EAAE,MAAM;IACtC,oCAAoC,EAAE,SAAS;IAC/C,uCAAuC,EAAE,MAAM;IAG/C,qBAAqB,EAAE,MAAM;IAC7B,yBAAyB,EAAE,MAAM;IACjC,6BAA6B,EAAE,MAAM;IACrC,gCAAgC,EAAE,SAAS;IAC3C,mCAAmC,EAAE,MAAM;IAG3C,oBAAoB,EAAE,MAAM;IAC5B,2BAA2B,EAAE,MAAM;IACnC,wBAAwB,EAAE,MAAM;IAGhC,wBAAwB,EAAE,oBAAoB;IAC9C,4BAA4B,EAAE,MAAM;IACpC,6BAA6B,EAAE,MAAM;IACrC,oCAAoC,EAAE,SAAS;IAC/C,uCAAuC,EAAE;;CAE1C;;;;;;;;;AC/CM,IAAM,WAAW,GAAA,OAAA,CAAA,WAAA,GAAG,UAAU",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()",
    "function _OverloadYield(e, d) {\n  this.v = e, this.k = d;\n}\nmodule.exports = _OverloadYield, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nmodule.exports = _arrayWithHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return arrayLikeToArray(r);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nmodule.exports = _asyncToGenerator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var isNativeReflectConstruct = require(\"./isNativeReflectConstruct.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _construct(t, e, r) {\n  if (isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments);\n  var o = [null];\n  o.push.apply(o, e);\n  var p = new (t.bind.apply(t, o))();\n  return r && setPrototypeOf(p, r.prototype), p;\n}\nmodule.exports = _construct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _getPrototypeOf(t) {\n  return module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _getPrototypeOf(t);\n}\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _interopRequireDefault(e) {\n  return e && e.__esModule ? e : {\n    \"default\": e\n  };\n}\nmodule.exports = _interopRequireDefault, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _isNativeFunction(t) {\n  try {\n    return -1 !== Function.toString.call(t).indexOf(\"[native code]\");\n  } catch (n) {\n    return \"function\" == typeof t;\n  }\n}\nmodule.exports = _isNativeFunction, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (module.exports = _isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _isNativeReflectConstruct, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nmodule.exports = _iterableToArrayLimit, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableRest, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var _typeof = require(\"./typeof.js\")[\"default\"];\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var regeneratorDefine = require(\"./regeneratorDefine.js\");\nfunction _regenerator() {\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */\n  var e,\n    t,\n    r = \"function\" == typeof Symbol ? Symbol : {},\n    n = r.iterator || \"@@iterator\",\n    o = r.toStringTag || \"@@toStringTag\";\n  function i(r, n, o, i) {\n    var c = n && n.prototype instanceof Generator ? n : Generator,\n      u = Object.create(c.prototype);\n    return regeneratorDefine(u, \"_invoke\", function (r, n, o) {\n      var i,\n        c,\n        u,\n        f = 0,\n        p = o || [],\n        y = !1,\n        G = {\n          p: 0,\n          n: 0,\n          v: e,\n          a: d,\n          f: d.bind(e, 4),\n          d: function d(t, r) {\n            return i = t, c = 0, u = e, G.n = r, a;\n          }\n        };\n      function d(r, n) {\n        for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) {\n          var o,\n            i = p[t],\n            d = G.p,\n            l = i[2];\n          r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0));\n        }\n        if (o || r > 1) return a;\n        throw y = !0, n;\n      }\n      return function (o, p, l) {\n        if (f > 1) throw TypeError(\"Generator is already running\");\n        for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) {\n          i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u);\n          try {\n            if (f = 2, i) {\n              if (c || (o = \"next\"), t = i[o]) {\n                if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\");\n                if (!t.done) return t;\n                u = t.value, c < 2 && (c = 0);\n              } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1);\n              i = e;\n            } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break;\n          } catch (t) {\n            i = e, c = 1, u = t;\n          } finally {\n            f = 1;\n          }\n        }\n        return {\n          value: t,\n          done: y\n        };\n      };\n    }(r, o, i), !0), u;\n  }\n  var a = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  t = Object.getPrototypeOf;\n  var c = [][n] ? t(t([][n]())) : (regeneratorDefine(t = {}, n, function () {\n      return this;\n    }), t),\n    u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c);\n  function f(e) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, regeneratorDefine(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e;\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, regeneratorDefine(u, \"constructor\", GeneratorFunctionPrototype), regeneratorDefine(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", regeneratorDefine(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), regeneratorDefine(u), regeneratorDefine(u, o, \"Generator\"), regeneratorDefine(u, n, function () {\n    return this;\n  }), regeneratorDefine(u, \"toString\", function () {\n    return \"[object Generator]\";\n  }), (module.exports = _regenerator = function _regenerator() {\n    return {\n      w: i,\n      m: f\n    };\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _regenerator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var regeneratorAsyncGen = require(\"./regeneratorAsyncGen.js\");\nfunction _regeneratorAsync(n, e, r, t, o) {\n  var a = regeneratorAsyncGen(n, e, r, t, o);\n  return a.next().then(function (n) {\n    return n.done ? n.value : a.next();\n  });\n}\nmodule.exports = _regeneratorAsync, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var regenerator = require(\"./regenerator.js\");\nvar regeneratorAsyncIterator = require(\"./regeneratorAsyncIterator.js\");\nfunction _regeneratorAsyncGen(r, e, t, o, n) {\n  return new regeneratorAsyncIterator(regenerator().w(r, e, t, o), n || Promise);\n}\nmodule.exports = _regeneratorAsyncGen, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var OverloadYield = require(\"./OverloadYield.js\");\nvar regeneratorDefine = require(\"./regeneratorDefine.js\");\nfunction AsyncIterator(t, e) {\n  function n(r, o, i, f) {\n    try {\n      var c = t[r](o),\n        u = c.value;\n      return u instanceof OverloadYield ? e.resolve(u.v).then(function (t) {\n        n(\"next\", t, i, f);\n      }, function (t) {\n        n(\"throw\", t, i, f);\n      }) : e.resolve(u).then(function (t) {\n        c.value = t, i(c);\n      }, function (t) {\n        return n(\"throw\", t, i, f);\n      });\n    } catch (t) {\n      f(t);\n    }\n  }\n  var r;\n  this.next || (regeneratorDefine(AsyncIterator.prototype), regeneratorDefine(AsyncIterator.prototype, \"function\" == typeof Symbol && Symbol.asyncIterator || \"@asyncIterator\", function () {\n    return this;\n  })), regeneratorDefine(this, \"_invoke\", function (t, o, i) {\n    function f() {\n      return new e(function (e, r) {\n        n(t, i, e, r);\n      });\n    }\n    return r = r ? r.then(f, f) : f();\n  }, !0);\n}\nmodule.exports = AsyncIterator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _regeneratorDefine(e, r, n, t) {\n  var i = Object.defineProperty;\n  try {\n    i({}, \"\", {});\n  } catch (e) {\n    i = 0;\n  }\n  module.exports = _regeneratorDefine = function regeneratorDefine(e, r, n, t) {\n    if (r) i ? i(e, r, {\n      value: n,\n      enumerable: !t,\n      configurable: !t,\n      writable: !t\n    }) : e[r] = n;else {\n      var o = function o(r, n) {\n        _regeneratorDefine(e, r, function (e) {\n          return this._invoke(r, n, e);\n        });\n      };\n      o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2);\n    }\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _regeneratorDefine(e, r, n, t);\n}\nmodule.exports = _regeneratorDefine, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _regeneratorKeys(e) {\n  var n = Object(e),\n    r = [];\n  for (var t in n) r.unshift(t);\n  return function e() {\n    for (; r.length;) if ((t = r.pop()) in n) return e.value = t, e.done = !1, e;\n    return e.done = !0, e;\n  };\n}\nmodule.exports = _regeneratorKeys, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var OverloadYield = require(\"./OverloadYield.js\");\nvar regenerator = require(\"./regenerator.js\");\nvar regeneratorAsync = require(\"./regeneratorAsync.js\");\nvar regeneratorAsyncGen = require(\"./regeneratorAsyncGen.js\");\nvar regeneratorAsyncIterator = require(\"./regeneratorAsyncIterator.js\");\nvar regeneratorKeys = require(\"./regeneratorKeys.js\");\nvar regeneratorValues = require(\"./regeneratorValues.js\");\nfunction _regeneratorRuntime() {\n  \"use strict\";\n\n  var r = regenerator(),\n    e = r.m(_regeneratorRuntime),\n    t = (Object.getPrototypeOf ? Object.getPrototypeOf(e) : e.__proto__).constructor;\n  function n(r) {\n    var e = \"function\" == typeof r && r.constructor;\n    return !!e && (e === t || \"GeneratorFunction\" === (e.displayName || e.name));\n  }\n  var o = {\n    \"throw\": 1,\n    \"return\": 2,\n    \"break\": 3,\n    \"continue\": 3\n  };\n  function a(r) {\n    var e, t;\n    return function (n) {\n      e || (e = {\n        stop: function stop() {\n          return t(n.a, 2);\n        },\n        \"catch\": function _catch() {\n          return n.v;\n        },\n        abrupt: function abrupt(r, e) {\n          return t(n.a, o[r], e);\n        },\n        delegateYield: function delegateYield(r, o, a) {\n          return e.resultName = o, t(n.d, regeneratorValues(r), a);\n        },\n        finish: function finish(r) {\n          return t(n.f, r);\n        }\n      }, t = function t(r, _t, o) {\n        n.p = e.prev, n.n = e.next;\n        try {\n          return r(_t, o);\n        } finally {\n          e.next = n.n;\n        }\n      }), e.resultName && (e[e.resultName] = n.v, e.resultName = void 0), e.sent = n.v, e.next = n.n;\n      try {\n        return r.call(this, e);\n      } finally {\n        n.p = e.prev, n.n = e.next;\n      }\n    };\n  }\n  return (module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return {\n      wrap: function wrap(e, t, n, o) {\n        return r.w(a(e), t, n, o && o.reverse());\n      },\n      isGeneratorFunction: n,\n      mark: r.m,\n      awrap: function awrap(r, e) {\n        return new OverloadYield(r, e);\n      },\n      AsyncIterator: regeneratorAsyncIterator,\n      async: function async(r, e, t, o, u) {\n        return (n(e) ? regeneratorAsyncGen : regeneratorAsync)(a(r), e, t, o, u);\n      },\n      keys: regeneratorKeys,\n      values: regeneratorValues\n    };\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorValues(e) {\n  if (null != e) {\n    var t = e[\"function\" == typeof Symbol && Symbol.iterator || \"@@iterator\"],\n      r = 0;\n    if (t) return t.call(e);\n    if (\"function\" == typeof e.next) return e;\n    if (!isNaN(e.length)) return {\n      next: function next() {\n        return e && r >= e.length && (e = void 0), {\n          value: e && e[r++],\n          done: !e\n        };\n      }\n    };\n  }\n  throw new TypeError(_typeof(e) + \" is not iterable\");\n}\nmodule.exports = _regeneratorValues, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _setPrototypeOf(t, e) {\n  return module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _setPrototypeOf(t, e);\n}\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var arrayWithHoles = require(\"./arrayWithHoles.js\");\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableRest = require(\"./nonIterableRest.js\");\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nmodule.exports = _slicedToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(r) {\n  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "var getPrototypeOf = require(\"./getPrototypeOf.js\");\nvar setPrototypeOf = require(\"./setPrototypeOf.js\");\nvar isNativeFunction = require(\"./isNativeFunction.js\");\nvar construct = require(\"./construct.js\");\nfunction _wrapNativeSuper(t) {\n  var r = \"function\" == typeof Map ? new Map() : void 0;\n  return module.exports = _wrapNativeSuper = function _wrapNativeSuper(t) {\n    if (null === t || !isNativeFunction(t)) return t;\n    if (\"function\" != typeof t) throw new TypeError(\"Super expression must either be null or a function\");\n    if (void 0 !== r) {\n      if (r.has(t)) return r.get(t);\n      r.set(t, Wrapper);\n    }\n    function Wrapper() {\n      return construct(t, arguments, getPrototypeOf(this).constructor);\n    }\n    return Wrapper.prototype = Object.create(t.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    }), setPrototypeOf(Wrapper, t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _wrapNativeSuper(t);\n}\nmodule.exports = _wrapNativeSuper, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;",
    "// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n",
    "import { WindowOptions } from \"./types\";\r\n\r\n// Partial<WindowOptions>ではなく、全てのキーを定義して型安全にする\r\nexport const defaultConfig: Required<WindowOptions> = {\r\n\tid: null,\r\n\tifExists: \"focus\",\r\n\ttitle: \"New Window\",\r\n\ticon: null,\r\n\tx: \"auto\",\r\n\ty: \"auto\",\r\n\twidth: 500,\r\n\theight: 400,\r\n\tminWidth: 200,\r\n\tminHeight: 150,\r\n\tvirtualizable: true,\r\n\tanimationOrigin: null,\r\n\twindowOptions: {\r\n\t\tresizableX: true,\r\n\t\tresizableY: true,\r\n\t\tmovable: true,\r\n\t\tclosable: true,\r\n\t\tminimizable: true,\r\n\t\tmaximizable: true,\r\n\t\tmaximizableOnDblClick: true,\r\n\t\tfocus: true,\r\n\t\talwaysOnTop: false,\r\n\t\tuseGhostWindow: false,\r\n\t\topacity: 1.0,\r\n\t\tmodal: false,\r\n\t},\r\n\tcontent: {\r\n\t\thtml: \"\",\r\n\t\tiframe: {\r\n\t\t\tsrc: \"\",\r\n\t\t\tsrcdoc: \"\",\r\n\t\t\tallow: \"\",\r\n\t\t\treferrerPolicy: \"\",\r\n\t\t\tloading: \"lazy\",\r\n\t\t\tsandbox: \"\",\r\n\t\t\tloadWinLet: false,\r\n\t\t},\r\n\t\ttemplate: \"\",\r\n\t},\r\n\tsplitView: {\r\n\t\tdirection: \"horizontal\",\r\n\t\tpanes: [],\r\n\t},\r\n\tstatusBar: {\r\n\t\tenabled: false,\r\n\t\ttext: \"\",\r\n\t\tallowHTML: false,\r\n\t},\r\n\tsearch: {\r\n\t\tenabled: false,\r\n\t\tcaseSensitive: false,\r\n\t\tshowCaseSensitiveButton: true,\r\n\t\tshowRegexButton: true,\r\n\t\tshowWholeWordButton: true,\r\n\t\ttargetSelector: \"\",\r\n\t},\r\n\tmenu: [],\r\n\tmenuStyle: \"default\",\r\n\ttabs: [],\r\n\ttabStyle: \"default\",\r\n\ttabOptions: {\r\n\t\treorderable: false,\r\n\t\tclosable: false,\r\n\t\taddable: false,\r\n\t\tdetachable: false,\r\n\t\tmergeable: false,\r\n\t\tallowIncomingMerge: false,\r\n\t\tonAdd: undefined,\r\n\t\tonMergeAttempt: undefined,\r\n\t},\r\n\ttaskbarOptions: {\r\n\t\tshowIconOnly: true,\r\n\t},\r\n\tcontextMenu: [],\r\n\tcustomControls: [],\r\n\tenableShortcuts: true,\r\n\tcontrolsPosition: \"right\",\r\n\tshowLoadingIndicator: true,\r\n\tlazyLoad: false,\r\n\tdisableMoveEvent: false,\r\n\tdisableResizeEvent: false,\r\n\tvirtualizationStrategy: null,\r\n\tvirtualizationRestoreMode: \"auto\",\r\n\tshowVirtualizationRefreshButton: true,\r\n\tonOpen: () => {},\r\n\tonClose: () => {},\r\n\tonFocus: () => {},\r\n\tonBlur: () => {},\r\n\tonResize: () => {},\r\n\tonMove: () => {},\r\n\tonReload: () => {},\r\n\tonBeforeClose: () => {},\r\n\tonMoveStart: () => {},\r\n\tonMoveEnd: () => {},\r\n\tonResizeStart: () => {},\r\n\tonResizeEnd: () => {},\r\n\r\n\t_isPopup: false,\r\n\t_parent: null,\r\n\t_taskbarItem: null,\r\n};\r\n",
    "interface ErrorConstructor {\n\tcaptureStackTrace?(targetObject: object, constructorOpt?: Function): void;\n}\n\n/**\n * すべてのカスタムエラーの基底クラス\n */\nexport class WinLetBaseError extends Error {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t\tthis.name = this.constructor.name;\n\n\t\tconst BuiltInError: ErrorConstructor = Error as ErrorConstructor;\n\t\tif (BuiltInError.captureStackTrace) {\n\t\t\tBuiltInError.captureStackTrace(this, this.constructor);\n\t\t}\n\t}\n}\n\n/**\n * 単純なメッセージのみのエラー\n */\nexport class SimpleError extends WinLetBaseError {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t}\n}\n\nexport class WinLetError extends SimpleError {}\n",
    "export const LIBRARY_NAME = \"winlet\";\r\n\r\nexport type WindowState = \"normal\" | \"minimized\" | \"maximized\";\r\n/**\r\n * ウィンドウの仮想化レベル\r\n * - `none`: 仮想化されていない状態\r\n * - `frozen`: ウィンドウのコンテンツは保持されるが、インタラクションは停止\r\n * - `suspended`: ウィンドウのコンテンツはDOMから非表示にされ、描画負荷を削減\r\n * - `unloaded`: ウィンドウのコンテンツはメモリから解放され、リソースを最大限制御\r\n */\r\nexport type VirtualizationLevel = \"none\" | \"frozen\" | \"suspended\" | \"unloaded\";\r\n\r\n/**\r\n * アニメーションの基点\r\n * - string: DOMセレクタ\r\n * - HTMLElement: DOM要素\r\n * - MouseEvent: マウスイベント\r\n * - object: 座標 { x: number; y: number }\r\n */\r\nexport type AnimationOrigin = string | HTMLElement | MouseEvent | { x: number; y: number };\r\n\r\n/**\r\n * アニメーションのオプション\r\n */\r\nexport interface AnimationOptions {\r\n\torigin?: AnimationOrigin;\r\n}\r\n\r\nexport interface WindowContentOptions {\r\n\t/**\r\n\t * 直接埋め込むHTML\r\n\t */\r\n\thtml?: string;\r\n\t/**\r\n\t * iframe設定\r\n\t */\r\n\tiframe?: {\r\n\t\tsrc?: HTMLIFrameElement[\"src\"];\r\n\t\tsrcdoc?: HTMLIFrameElement[\"srcdoc\"];\r\n\t\tallow?: HTMLIFrameElement[\"allow\"];\r\n\t\treferrerPolicy?: HTMLIFrameElement[\"referrerPolicy\"];\r\n\t\tloading?: HTMLIFrameElement[\"loading\"];\r\n\t\tsandbox?: string[] | string;\r\n\t\t/**\r\n\t\t * srcdocで生成されるiframe内にWinLetライブラリ自身を読み込むかどうか。\r\n\t\t * trueにする場合、GlobalConfigOptionsでlibraryPathを指定する必要があります。\r\n\t\t */\r\n\t\tloadWinLet?: boolean;\r\n\t};\r\n\t/**\r\n\t * HTMLテンプレートのselector\r\n\t */\r\n\ttemplate?: string;\r\n}\r\n\r\n/**\r\n * 分割ビューのペイン定義\r\n */\r\nexport interface SplitViewPane {\r\n\tid: string;\r\n\tcontent: WindowContentOptions;\r\n\tsize?: string; // \"50%\", \"200px\" など\r\n\tminSize?: string;\r\n\tresizable?: boolean;\r\n}\r\n\r\n/**\r\n * 分割ビューのレイアウト定義\r\n */\r\nexport interface SplitViewOptions {\r\n\tdirection: \"horizontal\" | \"vertical\";\r\n\tpanes: SplitViewPane[];\r\n}\r\n\r\n/**\r\n * ステータスバーのオプション\r\n */\r\nexport interface StatusBarOptions {\r\n\t/**\r\n\t * ステータスバーを表示するかどうか\r\n\t * @default false\r\n\t */\r\n\tenabled?: boolean;\r\n\t/**\r\n\t * 初期テキスト\r\n\t */\r\n\ttext?: string;\r\n\t/**\r\n\t * HTMLを許可するか\r\n\t * @default false\r\n\t */\r\n\tallowHTML?: boolean;\r\n}\r\n\r\n/**\r\n * ウィンドウ内検索機能のオプション\r\n */\r\nexport interface SearchOptions {\r\n\t/**\r\n\t * 検索UIを有効にするか\r\n\t * @default true\r\n\t */\r\n\tenabled?: boolean;\r\n\t/**\r\n\t * 検索時に大文字小文字を区別するか\r\n\t * @default false\r\n\t */\r\n\tcaseSensitive?: boolean;\r\n\t/**\r\n\t * 「大文字/小文字の区別」ボタンを表示するか\r\n\t * @default true\r\n\t */\r\n\tshowCaseSensitiveButton?: boolean;\r\n\t/**\r\n\t * 「正規表現」ボタンを表示するか\r\n\t * @default true\r\n\t */\r\n\tshowRegexButton?: boolean;\r\n\t/**\r\n\t * 「単語単位」ボタンを表示するか\r\n\t * @default true\r\n\t */\r\n\tshowWholeWordButton?: boolean;\r\n\t/**\r\n\t * 検索対象のセレクタ\r\n\t * 指定しない場合はウィンドウのコンテンツ全体\r\n\t */\r\n\ttargetSelector?: string;\r\n}\r\n\r\nexport interface ListenerOptions {\r\n\tonce?: boolean;\r\n}\r\n\r\nexport interface WindowEventMap {\r\n\topen: (win: IWindow) => void;\r\n\tclose: (win: IWindow) => void;\r\n\t\"before-close\": (win: IWindow) => boolean | void;\r\n\tfocus: (win: IWindow) => void;\r\n\tblur: (win: IWindow) => void;\r\n\t\"move-start\": (win: IWindow) => void;\r\n\t\"move-end\": (win: IWindow) => void;\r\n\tmove: (win: IWindow) => void;\r\n\t\"resize-start\": (win: IWindow) => void;\r\n\t\"resize-end\": (win: IWindow) => void;\r\n\tresize: (win: IWindow) => void;\r\n\treload: (win: IWindow) => boolean | void;\r\n\t[key: string]: (...args: any[]) => any;\r\n}\r\n\r\nexport interface GlobalEventMap {\r\n\t\"window-created\": (win: IWindow) => void;\r\n\t\"window-destroyed\": (win: IWindow) => void;\r\n\t[key: string]: (...args: any[]) => any;\r\n}\r\n\r\n// IWindowインターフェースを先に定義することで循環参照を回避\r\nexport interface IWindow {\r\n\treadonly id: string;\r\n\toptions: Required<WindowOptions>;\r\n\tel: HTMLElement;\r\n\tstate: WindowState;\r\n\r\n\ton<K extends keyof WindowEventMap>(eventName: K, listener: WindowEventMap[K], options?: ListenerOptions): void;\r\n\toff<K extends keyof WindowEventMap>(eventName: K, listener: WindowEventMap[K]): void;\r\n\temit<K extends keyof WindowEventMap>(eventName: K, ...args: Parameters<WindowEventMap[K]>): ReturnType<WindowEventMap[K]>[] | undefined;\r\n\r\n\t// --- Public API ---\r\n\t/**\r\n\t * ウィンドウを閉じます。\r\n\t */\r\n\tclose(): void;\r\n\t/**\r\n\t * ウィンドウを最小化します。\r\n\t * @param options - アニメーションのオプション\r\n\t */\r\n\tminimize(options?: AnimationOptions): void;\r\n\t/**\r\n\t * ウィンドウを最大化/元に戻します。\r\n\t */\r\n\ttoggleMaximize(): void;\r\n\t/**\r\n\t * ウィンドウを最大化します。\r\n\t */\r\n\tmaximize(): void;\r\n\t/**\r\n\t * ウィンドウを元に戻します。\r\n\t * @param options - アニメーションのオプション\r\n\t */\r\n\trestore(options?: AnimationOptions): void;\r\n\t/**\r\n\t * ウィンドウをフォーカスします。\r\n\t */\r\n\tfocus(): void;\r\n\t/**\r\n\t * ウィンドウからフォーカスを外します。\r\n\t */\r\n\tblur(): void;\r\n\t/**\r\n\t * 注意を引くためにウィンドウを揺らします。\r\n\t */\r\n\tshake(): void;\r\n\t/**\r\n\t * ウィンドウの内容をキャプチャして、画像データとして取得します。\r\n\t * @returns PNG形式のデータURLを含むPromise\r\n\t * @see https://github.com/niklasvh/html2canvas\r\n\t */\r\n\tcapture(): Promise<string>;\r\n\t/**\r\n\t * ウィンドウのコンテンツを印刷します。\r\n\t */\r\n\tprint(): void;\r\n\tgetTitle(): string;\r\n\tsetTitle(title: string): void;\r\n\tsetIcon(icon: string | null): void;\r\n\tgetPosition(): { x: number; y: number };\r\n\tsetPosition(x: number | \"center\" | \"left\" | \"right\" | \"auto\", y: number | \"center\" | \"top\" | \"bottom\" | \"auto\"): void;\r\n\tgetSize(): { width: number; height: number };\r\n\tsetSize(width: number | string, height: number | string): void;\r\n\t/**\r\n\t * ウィンドウの不透明度を設定します。\r\n\t * @param opacity 0.0 (透明) から 1.0 (不透明) の間の値\r\n\t */\r\n\tsetOpacity(opacity: number): void;\r\n\t/**\r\n\t * ウィンドウをリロードします。\r\n\t */\r\n\treload(): void;\r\n\r\n\t/**\r\n\t * ウィンドウのコンテンツ要素（またはiframe要素）を取得します。\r\n\t * @returns コンテンツを内包するHTMLElement、またはiframeウィンドウの場合はHTMLIFrameElement\r\n\t */\r\n\tgetContent(): HTMLElement | HTMLIFrameElement;\r\n\r\n\t/**\r\n\t * ステータスバーのテキストを更新します。\r\n\t * @param text - 表示するテキストまたはHTML\r\n\t */\r\n\tsetStatusBarText(text: string): void;\r\n\r\n\t/**\r\n\t * ウィンドウ内検索UIを開きます。\r\n\t */\r\n\topenSearch(): void;\r\n\r\n\t/**\r\n\t * ウィンドウ内検索UIを閉じます。\r\n\t */\r\n\tcloseSearch(): void;\r\n\r\n\t/**\r\n\t * このウィンドウの内部に新しいウィンドウを作成します。\r\n\t * @param options - 新しいウィンドウのオプション\r\n\t * @returns 作成されたIWindowインスタンス\r\n\t */\r\n\tcreateWindow(options?: WindowOptions): IWindow;\r\n\r\n\t/**\r\n\t * このウィンドウの内部に新しいポップアップを作成します。\r\n\t * @param options - 新しいポップアップのオプション\r\n\t * @returns 作成されたIWindowインスタンス\r\n\t */\r\n\tcreatePopup(options: PopupOptions): IWindow;\r\n\t/**\r\n\t * このウィンドウの内部に新しいポップアップを作成します。\r\n\t * @param options - 新しいポップアップのオプション\r\n\t * @returns Promiseオブジェクト\r\n\t */\r\n\tcreateAsyncPopup(options: PopupOptions): Promise<PopupResult>;\r\n\r\n\t/**\r\n\t * ウィンドウのオプションを動的に変更します。\r\n\t *\r\n\t * (初期化時に使用されるオプションは変更されず、警告なども出力されません。)\r\n\t *\r\n\t * @param options - 変更したいオプション\r\n\t */\r\n\tsetOptions(options: Partial<WindowOptions>): void;\r\n}\r\n\r\nexport interface MenuItem {\r\n\tname?: string;\r\n\taction?: (win: IWindow) => void;\r\n\titems?: MenuItem[];\r\n\tseparator?: boolean;\r\n\tshortcut?: string;\r\n}\r\n\r\nexport interface TabItem {\r\n\ttitle: string;\r\n\tcontent: WindowContentOptions;\r\n}\r\n\r\nexport interface ContextMenuItem {\r\n\tname?: string;\r\n\taction?: (win: IWindow) => void;\r\n\tseparator?: boolean;\r\n}\r\n\r\nexport interface CustomControlButton {\r\n\t/**\r\n\t * ボタンを識別するための一意の名前\r\n\t */\r\n\tname: string;\r\n\t/**\r\n\t * ボタンのHTMLコンテンツ (例: '<i class=\"fa fa-question\"></i>')\r\n\t */\r\n\thtml: string;\r\n\t/**\r\n\t * ボタンのツールチップテキスト\r\n\t */\r\n\ttitle?: string;\r\n\t/**\r\n\t * ボタンクリック時のアクション\r\n\t */\r\n\taction: (win: IWindow) => void;\r\n}\r\n\r\nexport interface WindowOptions {\r\n\t/**\r\n\t * ウィンドウのID\r\n\t */\r\n\tid?: string | null;\r\n\t/**\r\n\t * 既に同名のウィンドウが存在する場合の動作\r\n\t *\r\n\t * focus (デフォルト): 既存のウィンドウを復元し、フォーカスします。\r\n\t * prevent: 新しいウィンドウを作成せず、処理を中断します。\r\n\t * create: IDの重複を無視して、常に新しいウィンドウを作成します。\r\n\t */\r\n\tifExists?: \"focus\" | \"prevent\" | \"create\";\r\n\t/**\r\n\t * ウィンドウのタイトル\r\n\t */\r\n\ttitle?: string;\r\n\t/**\r\n\t * ウィンドウのアイコン\r\n\t *\r\n\t * url / font-awesomeのクラス名の指定可能\r\n\t */\r\n\ticon?: string | null;\r\n\t/**\r\n\t * ウィンドウのX座標\r\n\t */\r\n\tx?: number | \"center\" | \"left\" | \"right\" | \"auto\";\r\n\t/**\r\n\t * ウィンドウのY座標\r\n\t */\r\n\ty?: number | \"center\" | \"top\" | \"bottom\" | \"auto\";\r\n\t/**\r\n\t * ウィンドウのサイズX\r\n\t */\r\n\twidth?: number;\r\n\t/**\r\n\t * ウィンドウのサイズY\r\n\t */\r\n\theight?: number;\r\n\t/**\r\n\t * ウィンドウの最小サイズX\r\n\t */\r\n\tminWidth?: number;\r\n\t/**\r\n\t * ウィンドウの最小サイズY\r\n\t */\r\n\tminHeight?: number;\r\n\t/**\r\n\t * ウィンドウが仮想化の対象となるかどうか。\r\n\t * `enableVirtualization` がtrueの場合にのみ有効です。\r\n\t * @default true\r\n\t */\r\n\tvirtualizable?: boolean;\r\n\t/**\r\n\t * 拡大・縮小アニメーションの基点を指定します。\r\n\t * - セレクタ文字列 (e.g., '#my-button')\r\n\t * - HTMLElement\r\n\t * - MouseEvent\r\n\t * - 座標オブジェクト {x: number, y: number}\r\n\t */\r\n\tanimationOrigin?: AnimationOrigin | null;\r\n\t/**\r\n\t * ウィンドウのオプション\r\n\t */\r\n\twindowOptions?: {\r\n\t\t/**\r\n\t\t * 水平方向のリサイズ\r\n\t\t */\r\n\t\tresizableX?: boolean;\r\n\t\t/**\r\n\t\t * 垂直方向のリサイズ\r\n\t\t */\r\n\t\tresizableY?: boolean;\r\n\t\t/**\r\n\t\t * ウィンドウの移動\r\n\t\t */\r\n\t\tmovable?: boolean;\r\n\t\t/**\r\n\t\t * ウィンドウを閉じるボタンの表示\r\n\t\t */\r\n\t\tclosable?: boolean;\r\n\t\t/**\r\n\t\t * ウィンドウを最小化するボタンの表示\r\n\t\t */\r\n\t\tminimizable?: boolean;\r\n\t\t/**\r\n\t\t * ウィンドウを最大化するボタンの表示\r\n\t\t */\r\n\t\tmaximizable?: boolean;\r\n\t\t/**\r\n\t\t * タイトルバーのダブルクリックで最大化\r\n\t\t */\r\n\t\tmaximizableOnDblClick?: boolean;\r\n\t\t/**\r\n\t\t * ウィンドウを常に最前面に表示するかどうか\r\n\t\t */\r\n\t\talwaysOnTop?: boolean;\r\n\t\t/**\r\n\t\t * ドラッグ・リサイズ時にゴーストウィンドウ（輪郭）を表示するか\r\n\t\t */\r\n\t\tuseGhostWindow?: boolean;\r\n\t\t/**\r\n\t\t * 作成時にウィンドウにフォーカスを当てるか\r\n\t\t */\r\n\t\tfocus?: boolean;\r\n\t\t/**\r\n\t\t * ウィンドウの不透明度 (0.0 - 1.0)\r\n\t\t */\r\n\t\topacity?: number;\r\n\t\t/**\r\n\t\t * ウィンドウをモーダルとして扱うか\r\n\t\t * trueの場合、このウィンドウ以外は操作できなくなります。\r\n\t\t */\r\n\t\tmodal?: boolean;\r\n\t};\r\n\t/**\r\n\t * ウィンドウのコンテンツ\r\n\t */\r\n\tcontent?: WindowContentOptions;\r\n\t/**\r\n\t * 分割ビューの定義。\r\n\t * `content`オプションと同時に指定された場合、こちらが優先されます。\r\n\t */\r\n\tsplitView?: SplitViewOptions;\r\n\t/**\r\n\t * ステータスバーのオプション\r\n\t */\r\n\tstatusBar?: StatusBarOptions;\r\n\t/**\r\n\t * ウィンドウ内検索のオプション\r\n\t */\r\n\tsearch?: SearchOptions;\r\n\t/**\r\n\t * メニュー\r\n\t */\r\n\tmenu?: MenuItem[];\r\n\t/**\r\n\t * メニューの表示形式\r\n\t * - default: 通常のメニューバー\r\n\t * - merged: タイトルバーに統合\r\n\t */\r\n\tmenuStyle?: \"default\" | \"merged\";\r\n\t/**\r\n\t * タブ\r\n\t */\r\n\ttabs?: TabItem[];\r\n\t/**\r\n\t * タブの表示形式\r\n\t * - default: 通常のタブバー\r\n\t * - merged: タイトルバーに統合されたChrome風タブ\r\n\t */\r\n\ttabStyle?: \"default\" | \"merged\";\r\n\ttabOptions?: {\r\n\t\t/**\r\n\t\t * タブの入れ替え\r\n\t\t */\r\n\t\treorderable?: boolean;\r\n\t\t/**\r\n\t\t * タブを閉じるボタン\r\n\t\t */\r\n\t\tclosable?: boolean;\r\n\t\t/**\r\n\t\t * タブ追加ボタン\r\n\t\t */\r\n\t\taddable?: boolean;\r\n\t\t/**\r\n\t\t * タブをドラッグして新しいウィンドウとして分離できるようにするか\r\n\t\t */\r\n\t\tdetachable?: boolean;\r\n\t\t/**\r\n\t\t * タブを別の既存のウィンドウにマージすることができます。\r\n\t\t */\r\n\t\tmergeable?: boolean;\r\n\t\t/**\r\n\t\t * このウィンドウが他のウィンドウからマージされたタブを受け入れることができます。\r\n\t\t */\r\n\t\tallowIncomingMerge?: boolean;\r\n\t\t/**\r\n\t\t * 追加ボタン押下時の処理\r\n\t\t */\r\n\t\tonAdd?: (win: IWindow) => TabItem;\r\n\t\t/**\r\n\t\t * マージが許可されているかどうかを動的に決定するコールバック関数。\r\n\t\t * @param sourceWindow タブの元ウィンドウ\r\n\t\t * @param targetWindow ドロップされたタブのウィンドウ\r\n\t\t * @returns true:マージ許可 false:マージ禁止\r\n\t\t */\r\n\t\tonMergeAttempt?: (sourceWindow: IWindow, targetWindow: IWindow) => boolean;\r\n\t};\r\n\t/**\r\n\t * タスクバーアイテムの表示設定\r\n\t */\r\n\ttaskbarOptions?: {\r\n\t\t/**\r\n\t\t * trueにすると、タスクバーにタイトルではなくアイコンを表示します。\r\n\t\t * アイコンが設定されている必要があります。\r\n\t\t */\r\n\t\tshowIconOnly?: boolean;\r\n\t};\r\n\t/**\r\n\t * 右クリックメニュー\r\n\t */\r\n\tcontextMenu?: ContextMenuItem[];\r\n\t/**\r\n\t * タイトルバーに追加するカスタムコントロールボタン\r\n\t */\r\n\tcustomControls?: CustomControlButton[];\r\n\t/**\r\n\t * ショートカットキーを有効化\r\n\t */\r\n\tenableShortcuts?: boolean;\r\n\t/**\r\n\t * コントロールの位置\r\n\t */\r\n\tcontrolsPosition?: \"left\" | \"right\";\r\n\t/**\r\n\t * iframeや非同期コンテンツの読み込み中にローディングインジケーターを表示するか\r\n\t */\r\n\tshowLoadingIndicator?: boolean;\r\n\t/**\r\n\t * コンテンツの読み込みを初回フォーカス時まで遅延させるか\r\n\t * @default false\r\n\t */\r\n\tlazyLoad?: boolean;\r\n\t/**\r\n\t * moveイベントの発火を無効にするか\r\n\t * @default false\r\n\t */\r\n\tdisableMoveEvent?: boolean;\r\n\t/**\r\n\t * resizeイベントの発火を無効にするか\r\n\t * @default false\r\n\t */\r\n\tdisableResizeEvent?: boolean;\r\n\t/**\r\n\t * このウィンドウに適用する仮想化戦略\r\n\t * 'standard': DOMを非表示/解放 (デフォルト)\r\n\t * 'canvas': コンテンツをCanvasに描き出してDOMを解放\r\n\t */\r\n\tvirtualizationStrategy?: \"standard\" | \"canvas\" | null;\r\n\t/**\r\n\t * 仮想化からの復帰モード\r\n\t * 'auto': ウィンドウが可視になった際に自動で復帰 (デフォルト)\r\n\t * 'manual': ユーザーのアクション（クリック、フォーカス、更新ボタン）で復帰\r\n\t */\r\n\tvirtualizationRestoreMode?: \"auto\" | \"manual\";\r\n\t/**\r\n\t * 手動復帰モードの際に更新ボタンを表示するか\r\n\t * @default true\r\n\t */\r\n\tshowVirtualizationRefreshButton?: boolean;\r\n\t/**\r\n\t * ウィンドウオープン時\r\n\t */\r\n\tonOpen?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウクローズ時\r\n\t */\r\n\tonClose?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウが閉じる前に呼び出され、falseを返すとクローズをキャンセルします。\r\n\t */\r\n\tonBeforeClose?: (win: IWindow) => boolean | void;\r\n\t/**\r\n\t * ウィンドウフォーカス時\r\n\t */\r\n\tonFocus?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウブラー時\r\n\t */\r\n\tonBlur?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウリサイズ時\r\n\t */\r\n\tonResize?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウの移動開始時\r\n\t */\r\n\tonMoveStart?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウの移動終了時\r\n\t */\r\n\tonMoveEnd?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウのリサイズ開始時\r\n\t */\r\n\tonResizeStart?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウのリサイズ終了時\r\n\t */\r\n\tonResizeEnd?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウ移動時\r\n\t */\r\n\tonMove?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウリロード時\r\n\t *\r\n\t * デフォルトのリロード動作（iframeの再読み込みやhtmlの再描画）をキャンセルする場合は `false` を返します。\r\n\t */\r\n\tonReload?: (win: IWindow) => boolean | void;\r\n\r\n\t// 内部利用フラグ\r\n\t_isPopup?: boolean;\r\n\t/**\r\n\t * 親ウィンドウのインスタンス (内部利用)\r\n\t */\r\n\t_parent?: IWindow | null;\r\n\t/**\r\n\t * タスクバーのアイテム要素 (内部利用)\r\n\t */\r\n\t_taskbarItem?: HTMLElement | null;\r\n}\r\n\r\n// --- Popup ---\r\nexport const TIMEOUT_RESULT = Symbol(\"timeout\");\r\nexport const CLOSE_BUTTON_RESULT = Symbol(\"close\");\r\n\r\nexport type PopupResult = string | number | symbol | null;\r\n\r\nexport interface PopupButton {\r\n\ttext: string;\r\n\tvalue: PopupResult;\r\n}\r\n\r\nexport type PopupButtonPreset = \"Ok\" | \"OkCancel\" | \"Yes\" | \"YesNo\" | \"YesNoCancel\" | \"Retry\" | \"RetryCancel\" | \"AbortRetryIgnore\";\r\n\r\nexport interface PopupOptions {\r\n\tmessage: string;\r\n\ttitle?: string;\r\n\ticon?: string | null;\r\n\tbuttons?: PopupButton[] | PopupButtonPreset;\r\n\ttimeout?: number;\r\n\tautoWidth?: boolean;\r\n\tfocus?: boolean;\r\n\talwaysOnTop?: boolean;\r\n\tmodal?: boolean;\r\n\r\n\t/**\r\n\t * ウィンドウクローズ時\r\n\t */\r\n\tonClose?: (result: PopupResult) => void;\r\n\t/**\r\n\t * ウィンドウフォーカス時\r\n\t */\r\n\tonFocus?: (win: IWindow) => void;\r\n\t/**\r\n\t * ウィンドウブラー時\r\n\t */\r\n\tonBlur?: (win: IWindow) => void;\r\n}\r\n\r\nexport interface TaskbarOptions {\r\n\t/**\r\n\t * タスクバーの表示位置\r\n\t * @default 'bottom'\r\n\t */\r\n\tposition?: \"top\" | \"bottom\" | \"left\" | \"right\";\r\n}\r\n\r\nexport interface GlobalConfigOptions {\r\n\twindowSwitchShortcut?: string | null; // 例: \"Ctrl+`\"\r\n\t/**\r\n\t * ウィンドウマネージャを内包する親要素。\r\n\t * セレクタ文字列またはHTMLElementを指定します。\r\n\t * 未指定の場合はbody直下に配置されます。\r\n\t */\r\n\tcontainer?: string | HTMLElement;\r\n\t/**\r\n\t * `srcdoc` iframeでWinLetを自己読込する場合のライブラリのパス。\r\n\t */\r\n\tlibraryPath?: string;\r\n\t/**\r\n\t * ウィンドウ操作時のアニメーションを有効にするか\r\n\t * @default true\r\n\t */\r\n\tenableAnimations?: boolean;\r\n\t/**\r\n\t * 最小化・復元時にタスクバーのアイコンからアニメーションさせるか\r\n\t * @default true\r\n\t */\r\n\tanimateFromTaskbar?: boolean;\r\n\t/**\r\n\t * タスクバーを表示するか\r\n\t * @default false\r\n\t */\r\n\tenableTaskbar?: boolean;\r\n\t/**\r\n\t * タスクバーの設定\r\n\t */\r\n\ttaskbar?: TaskbarOptions;\r\n\t/**\r\n\t * モーダルウィンドウのフォーカストラップを有効にするか\r\n\t * @default true\r\n\t */\r\n\tenableFocusTrapping?: boolean;\r\n\t/**\r\n\t * ウィンドウ仮想化を有効にするか。\r\n\t * 大量のウィンドウを扱う際のパフォーマンスを向上させます。\r\n\t * @default true\r\n\t */\r\n\tenableVirtualization?: boolean;\r\n\t/**\r\n\t * 仮想化されたウィンドウをタスクバーで視覚的に示すか\r\n\t * @default true\r\n\t */\r\n\tindicateVirtualizationInTaskbar?: boolean;\r\n\t/**\r\n\t * グローバルな仮想化戦略\r\n\t * 'standard': DOMを非表示/解放 (デフォルト)\r\n\t * 'canvas': コンテンツをCanvasに描き出してDOMを解放\r\n\t */\r\n\tvirtualizationStrategy?: \"standard\" | \"canvas\";\r\n\t/**\r\n\t * グローバルな仮想化からの復帰モード\r\n\t * 'auto': ウィンドウが可視になった際に自動で復帰 (デフォルト)\r\n\t * 'manual': ユーザーのアクション（クリック、フォーカス、更新ボタン）で復帰\r\n\t */\r\n\tvirtualizationRestoreMode?: \"auto\" | \"manual\";\r\n\t/**\r\n\t * 仮想化がアクティブになる最小ウィンドウ数。\r\n\t * この数を超えると、非表示のウィンドウの仮想化が開始されます。\r\n\t * @default 5\r\n\t */\r\n\tvirtualizationThreshold?: number;\r\n\t/**\r\n\t * 最小化されたウィンドウを仮想化するまでの遅延時間（ミリ秒）。\r\n\t * `enableVirtualization` がtrueの場合にのみ有効です。\r\n\t * @default 10000\r\n\t */\r\n\tvirtualizationDelay?: number;\r\n\t/**\r\n\t * イベントのスロットリング設定 (ミリ秒)\r\n\t */\r\n\teventThrottling?: {\r\n\t\tmoveDelay?: number;\r\n\t\tresizeDelay?: number;\r\n\t};\r\n\t/**\r\n\t * 初期テーマ\r\n\t * 'dark'などの登録済みテーマ名、またはThemeオブジェクトを指定\r\n\t * @default 'default'\r\n\t */\r\n\ttheme?: string | Theme;\r\n\t/**\r\n\t * Bootstrapのカラースキームを自動検出し、テーマを同期させるか\r\n\t * @default true\r\n\t */\r\n\tautoDetectBootstrapTheme?: boolean;\r\n\t/**\r\n\t * デバッグモードを有効にするか。\r\n\t * ウィンドウにID、座標、状態などのデバッグ情報をオーバーレイ表示します。\r\n\t * @default false\r\n\t */\r\n\tenableDebugMode?: boolean;\r\n}\r\n\r\n/**\r\n * テーマの定義\r\n */\r\nexport interface Theme {\r\n\tname: string;\r\n\tvariables: Record<string, string>;\r\n}\r\n\r\n// WinLetの公開APIの型\r\nexport interface WinLetApi {\r\n\tinit: (options?: GlobalConfigOptions) => void;\r\n\ton<K extends keyof GlobalEventMap>(eventName: K, listener: GlobalEventMap[K], options?: ListenerOptions): void;\r\n\toff<K extends keyof GlobalEventMap>(eventName: K, listener: GlobalEventMap[K]): void;\r\n\temit<K extends keyof GlobalEventMap>(eventName: K, ...args: Parameters<GlobalEventMap[K]>): ReturnType<GlobalEventMap[K]>[] | undefined;\r\n\t/**\r\n\t * ウィンドウを作成します。\r\n\t * @param options - 新しいウィンドウのオプション\r\n\t * @returns 作成されたIWindowインスタンス\r\n\t */\r\n\tcreateWindow: (options?: WindowOptions) => IWindow;\r\n\t/**\r\n\t * ポップアップウィンドウを作成します。\r\n\t * @param options - 新しいポップアップのオプション\r\n\t * @returns 作成されたIWindowインスタンス\r\n\t */\r\n\tcreatePopup: (options: PopupOptions) => IWindow;\r\n\t/**\r\n\t * ポップアップウィンドウを作成します。\r\n\t * @param options - 新しいポップアップのオプション\r\n\t * @returns Promiseオブジェクト\r\n\t */\r\n\tcreateAsyncPopup(options: PopupOptions): Promise<PopupResult>;\r\n\t/**\r\n\t * 指定されたIDのウィンドウインスタンスを取得します。\r\n\t * @param id - 取得するウィンドウのID\r\n\t */\r\n\tgetWindow: (id: string) => IWindow | undefined;\r\n\t/**\r\n\t * 指定されたDOM要素を内包するウィンドウインスタンスを取得します。\r\n\t * 入れ子ウィンドウの場合、最も内側にある子ウィンドウを返します。\r\n\t * @param element - 検索の起点となるDOM要素\r\n\t * @returns 発見されたIWindowインスタンス、またはundefined\r\n\t */\r\n\tgetWindowFromElement: (element: HTMLElement) => IWindow | undefined;\r\n\t/**\r\n\t * 現在アクティブなウィンドウを取得します。\r\n\t */\r\n\tgetActiveWindow: () => IWindow | null;\r\n\t/**\r\n\t * タスクバーのアイテムを更新します。\r\n\t * @param win - 更新するウィンドウ\r\n\t * @param state - 更新する状態\r\n\t */\r\n\tupdateTaskbarItem: (win: IWindow, state: \"minimized\" | \"restored\" | \"titleChanged\" | \"iconChanged\" | \"virtualized\" | \"unvirtualized\") => void;\r\n\t/**\r\n\t * ウィンドウのデフォルトの設定を変更します。\r\n\t * @param options - 新しいウィンドウのオプション\r\n\t */\r\n\tsetDefaultConfig: (options: WindowOptions) => void;\r\n\t/**\r\n\t * グローバル設定を変更します。\r\n\t * @param options - 新しいウィンドウのオプション\r\n\t */\r\n\tsetGlobalConfig: (options: GlobalConfigOptions) => void;\r\n\t/**\r\n\t * 表示テーマを登録します。\r\n\t * @param theme - 登録するテーマ\r\n\t */\r\n\tregisterTheme: (theme: Theme) => void;\r\n\t/**\r\n\t * 登録済みのテーマ名の配列を取得します。\r\n\t * @returns 登録済みのテーマ名の配列\r\n\t */\r\n\tgetRegisteredThemes: () => string[];\r\n\t/**\r\n\t * 表示テーマを変更します。\r\n\t * @param theme - 登録済みのテーマ名（'default', 'dark'など）またはThemeオブジェクト\r\n\t */\r\n\tsetTheme: (theme: string | Theme) => void;\r\n\t/**\r\n\t * 現在の表示テーマを取得します。\r\n\t * @returns 現在の表示テーマ\r\n\t */\r\n\tgetTheme: () => Theme | null;\r\n\t/**\r\n\t * WinLetのバージョンを取得します。\r\n\t */\r\n\tget version(): string;\r\n\tPOPUP_TIMEOUT_RESULT: typeof TIMEOUT_RESULT;\r\n\tPOPUP_CLOSE_BUTTON_RESULT: typeof CLOSE_BUTTON_RESULT;\r\n}\r\n\r\n// グローバルスコープのWindowにWinLetプロパティを追加\r\ndeclare global {\r\n\tinterface Window {\r\n\t\tWinLet: WinLetApi;\r\n\r\n\t\t// 外部ライブラリを追加\r\n\t\thtml2canvas?: (element: HTMLElement, options?: any) => Promise<HTMLCanvasElement>;\r\n\t}\r\n}\r\n",
    "import { defaultConfig } from \"../const/config\";\r\nimport { WinLetError } from \"../const/errors\";\r\nimport { AnimationOptions, AnimationOrigin, CLOSE_BUTTON_RESULT, IWindow, LIBRARY_NAME, MenuItem, PopupOptions, PopupResult, SplitViewOptions, TabItem, VirtualizationLevel, WindowContentOptions, WindowEventMap, WindowOptions, WindowState } from \"../const/types\";\r\nimport WinLetBaseClass from \"../libs/baseclass\";\r\nimport Utils from \"../libs/utils\";\r\nimport WindowManager from \"./window_manager\";\r\n\r\nexport default class WinLetWindow extends WinLetBaseClass<WindowEventMap> implements IWindow {\r\n\tpublic readonly id: string;\r\n\tpublic options: Required<WindowOptions>;\r\n\tpublic el: HTMLElement;\r\n\tpublic state: WindowState = \"normal\";\r\n\r\n\tprivate manager: WindowManager;\r\n\tprivate lastState = { x: 0, y: 0, width: 0, height: 0 };\r\n\tprivate focused: boolean = false;\r\n\tprivate readonly DRAG_THRESHOLD = 5;\r\n\r\n\tprivate titleBarEl: HTMLElement;\r\n\tprivate iconEl: HTMLElement;\r\n\tprivate titleEl: HTMLElement;\r\n\tprivate mainContentEl: HTMLElement;\r\n\tprivate contentEl: HTMLElement;\r\n\tprivate loaderEl: HTMLElement;\r\n\tprivate tabs: { tabEl: HTMLElement; contentEl: HTMLElement }[] = [];\r\n\tprivate addTabBtn: HTMLElement | null = null;\r\n\tprivate isMenuOpen = false;\r\n\tprivate boundGlobalClickHandler: ((event: MouseEvent) => void) | null = null;\r\n\r\n\tprivate statusBarEl: HTMLElement | null = null;\r\n\tprivate searchBarEl: HTMLElement | null = null;\r\n\tprivate searchResults: HTMLElement[] = [];\r\n\tprivate currentSearchIndex = -1;\r\n\r\n\t// 検索オプションのライブ状態\r\n\tprivate searchOptionsState = {\r\n\t\tcaseSensitive: false,\r\n\t\tregex: false,\r\n\t\twholeWord: false,\r\n\t};\r\n\r\n\t// モバイル対応\r\n\tprivate readonly MOBILE_CONTEXT_MENU_TIMEOUT = 700;\r\n\tprivate contextMenuTimer: number | null = null;\r\n\r\n\t// Popup用\r\n\tpublic popupCloseCallback: ((result: PopupResult) => void) | null = null;\r\n\r\n\tprivate childManager: WindowManager | null = null;\r\n\tprivate parentWindow: IWindow | null;\r\n\r\n\tprivate debugOverlayEl: HTMLElement | null = null;\r\n\tprivate isContentLoaded = false;\r\n\tprivate throttledEmitMove: (() => void) | null = null;\r\n\tprivate throttledEmitResize: (() => void) | null = null;\r\n\tprivate canvasSnapshot: string | null = null;\r\n\tprivate canvasOverlayEl: HTMLElement | null = null;\r\n\tpublic virtualizationLevel: VirtualizationLevel = \"none\";\r\n\tprivate minimizeVirtualizeTimer: number | null = null;\r\n\tprivate readonly virtualizationHierarchy: readonly VirtualizationLevel[] = [\"none\", \"frozen\", \"suspended\", \"unloaded\"];\r\n\r\n\tconstructor(options: WindowOptions, manager: WindowManager) {\r\n\t\tsuper();\r\n\t\tthis.id = options.id || Utils.generateId(`${LIBRARY_NAME}-window`);\r\n\t\tif (options.id) {\r\n\t\t\tconst existingEl = document.getElementById(options.id);\r\n\t\t\tif (existingEl && existingEl.classList.contains(`${LIBRARY_NAME}-window`)) {\r\n\t\t\t\tthrow new WinLetError(`WinLet: Window with ID \"${options.id}\" already exists. New window will not be created.`);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.manager = manager;\r\n\t\tthis.options = Utils.deepMerge(Utils.deepCopy(defaultConfig), options) as Required<WindowOptions>;\r\n\t\tthis.parentWindow = options._parent || null;\r\n\r\n\t\t// 検索オプションの初期状態を設定\r\n\t\tthis.searchOptionsState.caseSensitive = !!this.options.search.caseSensitive;\r\n\r\n\t\t// イベントスロットリングのセットアップ\r\n\t\tconst throttlingOptions = this.manager.getGlobalConfig().eventThrottling;\r\n\t\tif (!this.options.disableMoveEvent) {\r\n\t\t\tconst delay = throttlingOptions?.moveDelay;\r\n\t\t\tconst emitMove = () => this.emit(\"move\", this);\r\n\t\t\tthis.throttledEmitMove = delay && delay > 0 ? Utils.throttle(emitMove, delay) : emitMove;\r\n\t\t}\r\n\t\tif (!this.options.disableResizeEvent) {\r\n\t\t\tconst delay = throttlingOptions?.resizeDelay;\r\n\t\t\tconst emitResize = () => this.emit(\"resize\", this);\r\n\t\t\tthis.throttledEmitResize = delay && delay > 0 ? Utils.throttle(emitResize, delay) : emitResize;\r\n\t\t}\r\n\r\n\t\tthis.el = this.createDOM();\r\n\r\n\t\t// _isPopupによってクラスを追加\r\n\t\tif (this.options._isPopup) {\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-popup-window`);\r\n\t\t}\r\n\t\t// tabStyleとmenuStyleによってクラスを追加\r\n\t\tif (this.options.tabStyle === \"merged\") {\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-tab-style-merged`);\r\n\t\t}\r\n\t\tif (this.options.menuStyle === \"merged\") {\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-menu-style-merged`);\r\n\t\t}\r\n\t\t// 最前面/モーダル指定によりクラスを追加\r\n\t\tif (this.options.windowOptions.alwaysOnTop) {\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-always-on-top`);\r\n\t\t}\r\n\t\tif (this.options.windowOptions.modal) {\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-modal`);\r\n\t\t\tthis.el.setAttribute(\"aria-modal\", \"true\");\r\n\t\t}\r\n\r\n\t\tthis.titleBarEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title-bar`)!;\r\n\t\tthis.iconEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-icon`)!;\r\n\t\tthis.titleEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-title`)!;\r\n\t\tthis.mainContentEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-main-content`)!;\r\n\t\tthis.contentEl = this.mainContentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-content`)!;\r\n\t\tthis.loaderEl = this.mainContentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-loader-overlay`)!;\r\n\t\tthis.canvasOverlayEl = this.mainContentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-canvas-overlay`)!;\r\n\t\tthis.debugOverlayEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-debug-overlay`);\r\n\t\tthis.statusBarEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-statusbar`);\r\n\r\n\t\tthis.applyOptions();\r\n\t\tthis.setupEventListeners();\r\n\t\tthis.updateDebugOverlay();\r\n\r\n\t\t// Register onXX handlers\r\n\t\tif (this.options.onOpen) this.on(\"open\", this.options.onOpen);\r\n\t\tif (this.options.onClose) this.on(\"close\", this.options.onClose);\r\n\t\tif (this.options.onBeforeClose) this.on(\"before-close\", this.options.onBeforeClose);\r\n\t\tif (this.options.onFocus) this.on(\"focus\", this.options.onFocus);\r\n\t\tif (this.options.onBlur) this.on(\"blur\", this.options.onBlur);\r\n\t\tif (this.options.onMove) this.on(\"move\", this.options.onMove);\r\n\t\tif (this.options.onMoveStart) this.on(\"move-start\", this.options.onMoveStart);\r\n\t\tif (this.options.onMoveEnd) this.on(\"move-end\", this.options.onMoveEnd);\r\n\t\tif (this.options.onResize) this.on(\"resize\", this.options.onResize);\r\n\t\tif (this.options.onResizeStart) this.on(\"resize-start\", this.options.onResizeStart);\r\n\t\tif (this.options.onResizeEnd) this.on(\"resize-end\", this.options.onResizeEnd);\r\n\t\tif (this.options.onReload) this.on(\"reload\", this.options.onReload);\r\n\r\n\t\tthis.emit(\"open\", this);\r\n\t}\r\n\r\n\tprivate _calculateTransformOrigin(origin?: AnimationOrigin | null): string {\r\n\t\tlet originX = 0;\r\n\t\tlet originY = 0;\r\n\r\n\t\tconst winRect = this.el.getBoundingClientRect();\r\n\r\n\t\t// No origin, default to taskbar item if available and enabled\r\n\t\tif (!origin && this.manager.getGlobalConfig().animateFromTaskbar && this.options._taskbarItem) {\r\n\t\t\torigin = this.options._taskbarItem;\r\n\t\t}\r\n\r\n\t\tif (origin instanceof HTMLElement) {\r\n\t\t\tconst rect = origin.getBoundingClientRect();\r\n\t\t\toriginX = rect.left + rect.width / 2;\r\n\t\t\toriginY = rect.top + rect.height / 2;\r\n\t\t} else if (typeof origin === \"string\") {\r\n\t\t\tconst el = document.querySelector(origin);\r\n\t\t\tif (el) {\r\n\t\t\t\tconst rect = el.getBoundingClientRect();\r\n\t\t\t\toriginX = rect.left + rect.width / 2;\r\n\t\t\t\toriginY = rect.top + rect.height / 2;\r\n\t\t\t}\r\n\t\t} else if (origin instanceof MouseEvent) {\r\n\t\t\toriginX = origin.clientX;\r\n\t\t\toriginY = origin.clientY;\r\n\t\t} else if (origin && typeof origin === \"object\" && \"x\" in origin && \"y\" in origin) {\r\n\t\t\toriginX = origin.x;\r\n\t\t\toriginY = origin.y;\r\n\t\t} else {\r\n\t\t\t// Default to window center if no valid origin is provided\r\n\t\t\treturn `50% 50%`;\r\n\t\t}\r\n\r\n\t\t// ウィンドウの左上からの相対座標を計算\r\n\t\tconst relativeX = originX - winRect.left;\r\n\t\tconst relativeY = originY - winRect.top;\r\n\r\n\t\treturn `${relativeX}px ${relativeY}px`;\r\n\t}\r\n\r\n\tprivate createDOM(): HTMLElement {\r\n\t\tconst windowEl = document.createElement(\"div\");\r\n\t\twindowEl.className = `${LIBRARY_NAME}-window`;\r\n\t\twindowEl.id = this.id;\r\n\r\n\t\t// ARIA属性\r\n\t\twindowEl.setAttribute(\"role\", \"application\");\r\n\t\twindowEl.setAttribute(\"aria-labelledby\", `${this.id}-title`);\r\n\t\tif (this.state === \"minimized\") {\r\n\t\t\twindowEl.setAttribute(\"inert\", \"\");\r\n\t\t\twindowEl.setAttribute(\"aria-hidden\", \"true\");\r\n\t\t}\r\n\r\n\t\tconst handles: string[] = [];\r\n\t\tif (this.options.windowOptions.resizableY) {\r\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-n\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-s\"></div>`);\r\n\t\t}\r\n\t\tif (this.options.windowOptions.resizableX) {\r\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-w\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-e\"></div>`);\r\n\t\t}\r\n\t\tif (this.options.windowOptions.resizableX && this.options.windowOptions.resizableY) {\r\n\t\t\thandles.push(`<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-nw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-ne\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-sw\"></div>`, `<div class=\"${LIBRARY_NAME}-resize-handle ${LIBRARY_NAME}-se\"></div>`);\r\n\t\t}\r\n\t\tconst resizableHandlesHTML = handles.join(\"\");\r\n\r\n\t\tconst hasMenu = this.options.menu.length > 0;\r\n\t\tconst hasTabs = this.options.tabs.length > 0;\r\n\t\tconst isMergedMenu = this.options.menuStyle === \"merged\" && hasMenu;\r\n\t\tconst isMergedTabs = this.options.tabStyle === \"merged\" && hasTabs;\r\n\r\n\t\tconst customControlsHTML = (this.options.customControls ?? []).map((c) => `<button class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-custom-control-btn\" data-name=\"${c.name}\" title=\"${c.title || \"\"}\" aria-label=\"${c.title || c.name}\">${c.html}</button>`).join(\"\");\r\n\r\n\t\tconst refreshBtnHTML = `<button class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-refresh-btn\" title=\"Refresh Content\" aria-label=\"Refresh Content\"><i class=\"fas fa-sync-alt\"></i></button>`;\r\n\t\tconst controlsHTML = `\r\n            <div class=\"${LIBRARY_NAME}-controls\">\r\n\t\t\t\t${customControlsHTML}\r\n\t\t\t\t${refreshBtnHTML}\r\n                ${this.options.windowOptions.minimizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-minimize-btn\" type=\"button\" value=\"\\uff3f\" title=\"Minimize\" aria-label=\"Minimize\"/>` : \"\"}\r\n                ${this.options.windowOptions.maximizable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-maximize-btn\" type=\"button\" value=\"\\u25a1\" title=\"Maximize\" aria-label=\"Maximize\"/>` : \"\"}\r\n                ${this.options.windowOptions.closable ? `<input class=\"${LIBRARY_NAME}-control-btn ${LIBRARY_NAME}-close-btn\" type=\"button\" value=\"\\u2573\" title=\"Close\" aria-label=\"Close\"/>` : \"\"}\r\n            </div>`;\r\n\r\n\t\tconst titleBarContentHTML = `\r\n            <div class=\"${LIBRARY_NAME}-icon\"></div>\r\n            ${isMergedMenu ? `<div class=\"${LIBRARY_NAME}-menu-bar\"></div>` : \"\"}\r\n            <div id=\"${this.id}-title\" class=\"${LIBRARY_NAME}-title\"></div>\r\n            ${isMergedTabs ? `<div class=\"${LIBRARY_NAME}-tab-bar\"></div>` : \"\"}\r\n            ${controlsHTML}\r\n        `;\r\n\r\n\t\tconst loaderHTML = `\r\n            <div class=\"${LIBRARY_NAME}-loader-overlay\" style=\"display: none;\">\r\n                <div class=\"${LIBRARY_NAME}-loader-spinner\"></div>\r\n            </div>\r\n        `;\r\n\r\n\t\tconst statusBarHTML = this.options.statusBar.enabled ? `<div class=\"${LIBRARY_NAME}-statusbar\"></div>` : \"\";\r\n\t\tconst debugHTML = `<div class=\"${LIBRARY_NAME}-debug-overlay\"></div>`;\r\n\t\tconst canvasOverlayHTML = `<div class=\"${LIBRARY_NAME}-canvas-overlay\"></div>`;\r\n\r\n\t\twindowEl.innerHTML = `\r\n\t\t\t${debugHTML}\r\n            <div class=\"${LIBRARY_NAME}-title-bar ${LIBRARY_NAME}-us-none\">\r\n                ${titleBarContentHTML}\r\n            </div>\r\n            <div class=\"${LIBRARY_NAME}-main-content\">\r\n                ${!isMergedMenu && hasMenu ? `<div class=\"${LIBRARY_NAME}-menu-bar\" role=\"menubar\"></div>` : \"\"}\r\n                ${!isMergedTabs && hasTabs ? `<div class=\"${LIBRARY_NAME}-tab-bar\" role=\"tablist\"></div>` : \"\"}\r\n                <div class=\"${LIBRARY_NAME}-content\"></div>\r\n\t\t\t\t${loaderHTML}\r\n\t\t\t\t${canvasOverlayHTML}\r\n            </div>\r\n\t\t\t${statusBarHTML}\r\n            ${resizableHandlesHTML}\r\n        `;\r\n\t\treturn windowEl;\r\n\t}\r\n\r\n\tprivate _renderInitialContent(): void {\r\n\t\tif (this.isContentLoaded) return;\r\n\r\n\t\t// 分割ビューが定義されていれば、そちらを優先\r\n\t\tif (this.options.splitView && this.options.splitView.panes.length > 0) {\r\n\t\t\tthis.createSplitView(this.contentEl, this.options.splitView);\r\n\t\t} else if (this.options.tabs.length > 0) {\r\n\t\t\tthis.createTabs();\r\n\t\t} else {\r\n\t\t\tthis.renderContent(this.contentEl, this.options.content);\r\n\t\t}\r\n\t\tthis.isContentLoaded = true;\r\n\t}\r\n\r\n\tprivate applyOptions(): void {\r\n\t\tthis.setTitle(this.options.title);\r\n\t\tthis.setIcon(this.options.icon);\r\n\t\tthis.setSize(this.options.width, this.options.height);\r\n\t\tthis.el.style.minWidth = `${this.options.minWidth}px`;\r\n\t\tthis.el.style.minHeight = `${this.options.minHeight}px`;\r\n\r\n\t\tif (this.options.controlsPosition === \"left\") {\r\n\t\t\tthis.titleBarEl.classList.add(`${LIBRARY_NAME}-controls-left`);\r\n\t\t}\r\n\r\n\t\tif (!this.options.lazyLoad) {\r\n\t\t\tthis._renderInitialContent();\r\n\t\t} else {\r\n\t\t\tthis.showLoader();\r\n\t\t}\r\n\r\n\t\tif (this.options.menu.length > 0) {\r\n\t\t\tthis.createMenu();\r\n\t\t}\r\n\t\tif (this.statusBarEl) {\r\n\t\t\tthis.setStatusBarText(this.options.statusBar.text || \"\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate showLoader(): void {\r\n\t\tif (this.options.showLoadingIndicator) {\r\n\t\t\tthis.loaderEl.style.display = \"flex\";\r\n\t\t}\r\n\t}\r\n\r\n\tprivate hideLoader(): void {\r\n\t\tthis.loaderEl.style.display = \"none\";\r\n\t}\r\n\r\n\tprivate renderContent(container: HTMLElement, content: WindowContentOptions): void {\r\n\t\tcontainer.innerHTML = \"\";\r\n\t\tthis.hideLoader();\r\n\r\n\t\tif (this.virtualizationLevel === \"unloaded\") {\r\n\t\t\treturn; // 仮想化された場合、コンテンツをレンダリングしない\r\n\t\t}\r\n\r\n\t\tif (content.template) {\r\n\t\t\tconst template = document.querySelector<HTMLTemplateElement>(content.template);\r\n\t\t\tif (template?.tagName === \"TEMPLATE\") {\r\n\t\t\t\tcontainer.appendChild(template.content.cloneNode(true));\r\n\t\t\t} else {\r\n\t\t\t\tcontainer.innerHTML = \"Error: Template not found or invalid.\";\r\n\t\t\t\tconsole.warn(\"WinLet Warning: Template not found or invalid.\");\r\n\t\t\t}\r\n\t\t} else if (content.html) {\r\n\t\t\tcontainer.innerHTML = content.html;\r\n\t\t} else if (Utils.isNonEmptyObject(content.iframe) && (content.iframe.src || content.iframe.srcdoc)) {\r\n\t\t\tthis.showLoader();\r\n\t\t\tconst iframe = document.createElement(\"iframe\");\r\n\t\t\tconst iframeConfig = content.iframe;\r\n\t\t\tif (iframeConfig.src) {\r\n\t\t\t\tiframe.src = iframeConfig.src;\r\n\t\t\t}\r\n\t\t\tif (iframeConfig.srcdoc) {\r\n\t\t\t\tlet finalSrcDoc = iframeConfig.srcdoc;\r\n\t\t\t\tif (iframeConfig.loadWinLet) {\r\n\t\t\t\t\tconst globalConfig = this.manager.getGlobalConfig();\r\n\t\t\t\t\tif (globalConfig.libraryPath) {\r\n\t\t\t\t\t\tconst scriptTag = `<script src=\"${globalConfig.libraryPath}\"><\\/script>`;\r\n\t\t\t\t\t\tconst initScript = `<script>document.addEventListener('DOMContentLoaded', () => window.WinLet.init({ container: document.body }));<\\/script>`;\r\n\t\t\t\t\t\tfinalSrcDoc = `<!DOCTYPE html><html><head><meta charset=\"UTF-8\">${scriptTag}${initScript}</head><body>${iframeConfig.srcdoc}</body></html>`;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.warn(\"WinLet Warning: `loadWinLet` is true, but `libraryPath` is not set in global config.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tiframe.srcdoc = finalSrcDoc;\r\n\t\t\t}\r\n\t\t\tif (iframeConfig.allow) {\r\n\t\t\t\tiframe.allow = iframeConfig.allow;\r\n\t\t\t}\r\n\t\t\tif (iframeConfig.referrerPolicy) {\r\n\t\t\t\tiframe.referrerPolicy = iframeConfig.referrerPolicy;\r\n\t\t\t}\r\n\t\t\tif (iframeConfig.loading) {\r\n\t\t\t\tiframe.loading = iframeConfig.loading;\r\n\t\t\t}\r\n\t\t\tif (iframeConfig.sandbox) {\r\n\t\t\t\tif (!Array.isArray(iframeConfig.sandbox)) {\r\n\t\t\t\t\tiframeConfig.sandbox = [iframeConfig.sandbox];\r\n\t\t\t\t}\r\n\t\t\t\tif (iframeConfig.sandbox.length > 0) {\r\n\t\t\t\t\tiframe.setAttribute(\"sandbox\", iframeConfig.sandbox.join(\" \"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tiframe.addEventListener(\"load\", () => this.hideLoader());\r\n\t\t\tiframe.addEventListener(\"error\", () => this.hideLoader());\r\n\t\t\tcontainer.appendChild(iframe);\r\n\t\t} else {\r\n\t\t\tcontainer.innerHTML = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tprivate closeAllMenus(): void {\r\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-menu-item > .${LIBRARY_NAME}-menu-dropdown`).forEach((dd) => {\r\n\t\t\tdd.style.display = \"none\";\r\n\t\t});\r\n\t\tthis.isMenuOpen = false;\r\n\t}\r\n\r\n\tprivate createMenu(): void {\r\n\t\tconst menuBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-menu-bar`)!;\r\n\t\tmenuBar.innerHTML = \"\";\r\n\r\n\t\tthis.options.menu.forEach((menuItemData) => {\r\n\t\t\tconst menuItemEl = document.createElement(\"div\");\r\n\t\t\tmenuItemEl.className = `${LIBRARY_NAME}-menu-item ${LIBRARY_NAME}-us-none`;\r\n\t\t\tmenuItemEl.textContent = menuItemData.name ?? \"\";\r\n\t\t\tmenuItemEl.setAttribute(\"role\", \"menu\");\r\n\r\n\t\t\tif (menuItemData.items) {\r\n\t\t\t\tconst dropdownEl = this.createDropdownMenu(menuItemData.items);\r\n\r\n\t\t\t\tmenuItemEl.addEventListener(\r\n\t\t\t\t\t\"click\",\r\n\t\t\t\t\t(e) => {\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\tconst isVisible = dropdownEl.style.display === \"block\";\r\n\t\t\t\t\t\tthis.closeAllMenus();\r\n\t\t\t\t\t\tif (!isVisible) {\r\n\t\t\t\t\t\t\tdropdownEl.style.display = \"block\";\r\n\t\t\t\t\t\t\tthis.isMenuOpen = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ passive: false }\r\n\t\t\t\t);\r\n\r\n\t\t\t\tmenuItemEl.addEventListener(\r\n\t\t\t\t\t\"mouseenter\",\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tif (this.isMenuOpen) {\r\n\t\t\t\t\t\t\tthis.closeAllMenus();\r\n\t\t\t\t\t\t\tdropdownEl.style.display = \"block\";\r\n\t\t\t\t\t\t\tthis.isMenuOpen = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ passive: true }\r\n\t\t\t\t);\r\n\r\n\t\t\t\tmenuItemEl.appendChild(dropdownEl);\r\n\t\t\t}\r\n\t\t\tmenuBar.appendChild(menuItemEl);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate createDropdownMenu(items: MenuItem[]): HTMLUListElement {\r\n\t\tconst dropdownEl = document.createElement(\"ul\");\r\n\t\tdropdownEl.className = `${LIBRARY_NAME}-menu-dropdown`;\r\n\r\n\t\titems.forEach((itemData) => {\r\n\t\t\tconst itemEl = document.createElement(\"li\");\r\n\t\t\tif (itemData.separator) {\r\n\t\t\t\titemEl.className = `${LIBRARY_NAME}-separator`;\r\n\t\t\t} else {\r\n\t\t\t\tlet text = itemData.name ?? \"\";\r\n\t\t\t\ttext = `<span>${text}</span>`;\r\n\t\t\t\tif (this.options.enableShortcuts && itemData.shortcut) {\r\n\t\t\t\t\ttext += `<span class=\"${LIBRARY_NAME}-shortcut-text\">(${itemData.shortcut})</span>`;\r\n\t\t\t\t}\r\n\t\t\t\titemEl.innerHTML = `<div class=\"${LIBRARY_NAME}-menu-dropdown-item\" role=\"menuitem\">${text}</div>`;\r\n\t\t\t\titemEl.addEventListener(\r\n\t\t\t\t\t\"click\",\r\n\t\t\t\t\t(e) => {\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\tthis.closeAllMenus();\r\n\t\t\t\t\t\titemData.action?.(this);\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ passive: false }\r\n\t\t\t\t);\r\n\t\t\t\tif (itemData.items) {\r\n\t\t\t\t\titemEl.classList.add(`${LIBRARY_NAME}-has-submenu`); // スタイル付けのためのクラス\r\n\t\t\t\t\tconst subMenuEl = this.createDropdownMenu(itemData.items);\r\n\t\t\t\t\titemEl.appendChild(subMenuEl);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdropdownEl.appendChild(itemEl);\r\n\t\t});\r\n\t\treturn dropdownEl;\r\n\t}\r\n\r\n\tprivate createTabs(): void {\r\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\r\n\t\ttabBar.innerHTML = \"\";\r\n\t\tthis.tabs = [];\r\n\t\tconst tabOpts = this.options.tabOptions ?? {};\r\n\r\n\t\tthis.options.tabs.forEach((tabData, index) => {\r\n\t\t\tthis.createTabElement(tabData, index);\r\n\t\t});\r\n\r\n\t\tif (tabOpts.addable) {\r\n\t\t\tthis.addTabBtn = document.createElement(\"div\");\r\n\t\t\tthis.addTabBtn.className = `${LIBRARY_NAME}-tab-add-btn`;\r\n\t\t\tthis.addTabBtn.textContent = \"+\";\r\n\t\t\tthis.addTabBtn.addEventListener(\r\n\t\t\t\t\"click\",\r\n\t\t\t\t(e) => {\r\n\t\t\t\t\tconst newTabItem = tabOpts.onAdd?.(this);\r\n\t\t\t\t\tif (newTabItem) {\r\n\t\t\t\t\t\tthis.addTab(newTabItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{ passive: true }\r\n\t\t\t);\r\n\t\t\ttabBar.appendChild(this.addTabBtn);\r\n\t\t}\r\n\t\t// タブの並び替えと統合のためのドロップゾーンを設定\r\n\t\tthis.setupTabBarDropZone();\r\n\r\n\t\tif (this.tabs.length > 0) this.activateTab(0);\r\n\t}\r\n\r\n\tprivate setupTabBarDropZone(): void {\r\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\r\n\t\tif (!tabBar || !this.options.tabOptions.reorderable) return;\r\n\r\n\t\ttabBar.addEventListener(\r\n\t\t\t\"dragover\",\r\n\t\t\t(e) => {\r\n\t\t\t\tif (e.dataTransfer?.types.includes(\"application/winlet-tab\")) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tif (e.dataTransfer) e.dataTransfer.dropEffect = \"move\";\r\n\t\t\t\t\ttabBar.classList.add(`${LIBRARY_NAME}-drag-over`);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\t\ttabBar.addEventListener(\r\n\t\t\t\"dragleave\",\r\n\t\t\t() => {\r\n\t\t\t\ttabBar.classList.remove(`${LIBRARY_NAME}-drag-over`);\r\n\t\t\t},\r\n\t\t\t{ passive: true }\r\n\t\t);\r\n\t\ttabBar.addEventListener(\r\n\t\t\t\"drop\",\r\n\t\t\t(e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\ttabBar.classList.remove(`${LIBRARY_NAME}-drag-over`);\r\n\r\n\t\t\t\tconst tabDataJSON = e.dataTransfer?.getData(\"application/winlet-tab\");\r\n\t\t\t\tconst sourceWindowId = e.dataTransfer?.getData(\"application/winlet-source-window-id\");\r\n\t\t\t\tconst sourceTabId = e.dataTransfer?.getData(\"text/plain\");\r\n\t\t\t\tif (!tabDataJSON || !sourceWindowId || !sourceTabId) return;\r\n\r\n\t\t\t\tconst draggingEl = this.manager.container?.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.${LIBRARY_NAME}-dragging`);\r\n\r\n\t\t\t\t// 自分自身のウィンドウ内での並び替え\r\n\t\t\t\tif (sourceWindowId === this.id) {\r\n\t\t\t\t\tif (draggingEl) {\r\n\t\t\t\t\t\t// ドロップされた位置に挿入\r\n\t\t\t\t\t\tthis.updateTabOrderFromDOM();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 外部ウィンドウからのタブ統合\r\n\t\t\t\tconst sourceWindow = this.manager.getWindow(sourceWindowId);\r\n\t\t\t\tif (sourceWindow) {\r\n\t\t\t\t\tconst sourceOpts = sourceWindow.options.tabOptions;\r\n\t\t\t\t\tconst targetOpts = this.options.tabOptions;\r\n\r\n\t\t\t\t\tconst isMergeable = sourceOpts.mergeable ?? sourceOpts.detachable; // ソースをマージできるかどうかを確認\r\n\t\t\t\t\tconst allowsIncoming = targetOpts.allowIncomingMerge ?? true; // ターゲットが受け入れるかどうかを確認\r\n\t\t\t\t\tconst customFilterPassed = !targetOpts.onMergeAttempt || targetOpts.onMergeAttempt(sourceWindow, this);\r\n\r\n\t\t\t\t\tif (!isMergeable || !allowsIncoming || !customFilterPassed) {\r\n\t\t\t\t\t\treturn; // 条件が満たされていない場合は、マージを中止\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst tabData: TabItem = JSON.parse(tabDataJSON);\r\n\t\t\t\t\tthis.addTab(tabData, true);\r\n\r\n\t\t\t\t\tsourceWindow.closeTab(parseInt(sourceTabId, 10));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\t}\r\n\r\n\tprivate createTabElement(tabData: TabItem, index: number): void {\r\n\t\tconst tabBar = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab-bar`)!;\r\n\t\tconst tabOpts = this.options.tabOptions ?? {};\r\n\r\n\t\tconst tabEl = document.createElement(\"div\");\r\n\t\ttabEl.className = `${LIBRARY_NAME}-tab`;\r\n\t\ttabEl.setAttribute(\"role\", \"tab\");\r\n\t\ttabEl.dataset.tabId = index.toString(); // IDを紐付け\r\n\r\n\t\tconst titleEl = document.createElement(\"span\");\r\n\t\ttitleEl.textContent = tabData.title;\r\n\t\ttabEl.appendChild(titleEl);\r\n\r\n\t\t// +ボタンが存在すればその前に、なければ末尾に追加\r\n\t\ttabBar.insertBefore(tabEl, this.addTabBtn);\r\n\r\n\t\tif (tabOpts.closable) {\r\n\t\t\tconst closeBtn = document.createElement(\"span\");\r\n\t\t\tcloseBtn.className = `${LIBRARY_NAME}-tab-close-btn`;\r\n\t\t\tcloseBtn.innerHTML = \"&times;\";\r\n\t\t\tcloseBtn.addEventListener(\r\n\t\t\t\t\"click\",\r\n\t\t\t\t(e) => {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t// クロージャのindexに依存せず、クリックされた時点の最新のインデックスを探す\r\n\t\t\t\t\tconst indexToClose = this.tabs.findIndex((t) => t.tabEl === tabEl);\r\n\t\t\t\t\tif (indexToClose !== -1) {\r\n\t\t\t\t\t\tthis.closeTab(indexToClose);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{ passive: false }\r\n\t\t\t);\r\n\t\t\ttabEl.appendChild(closeBtn);\r\n\t\t}\r\n\r\n\t\t// タブコンテント生成ロジック\r\n\t\tconst tabContentEl = document.createElement(\"div\");\r\n\t\ttabContentEl.className = `${LIBRARY_NAME}-tab-content`;\r\n\t\ttabContentEl.setAttribute(\"role\", \"tabpanel\");\r\n\t\tthis.contentEl.appendChild(tabContentEl);\r\n\t\tthis.renderContent(tabContentEl, tabData.content);\r\n\r\n\t\ttabEl.addEventListener(\r\n\t\t\t\"click\",\r\n\t\t\t(e) => {\r\n\t\t\t\tthis.activateTab(+tabEl.dataset.tabId!);\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\t\tthis.tabs.splice(index, 0, { tabEl, contentEl: tabContentEl }); // 指定位置に挿入\r\n\r\n\t\tif (tabOpts.reorderable) {\r\n\t\t\tthis.makeTabReorderable(tabEl);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate makeTabReorderable(tabEl: HTMLElement) {\r\n\t\ttabEl.draggable = true;\r\n\t\ttabEl.addEventListener(\r\n\t\t\t\"dragstart\",\r\n\t\t\t(e) => {\r\n\t\t\t\te.dataTransfer!.setData(\"text/plain\", tabEl.dataset.tabId!);\r\n\t\t\t\ttabEl.classList.add(`${LIBRARY_NAME}-dragging`);\r\n\r\n\t\t\t\t// 分離機能が有効な場合、追加情報をセット\r\n\t\t\t\tif (this.options.tabOptions.detachable) {\r\n\t\t\t\t\tconst tabIndex = parseInt(tabEl.dataset.tabId!, 10);\r\n\t\t\t\t\tif (!isNaN(tabIndex) && this.options.tabs[tabIndex]) {\r\n\t\t\t\t\t\tconst tabData = this.options.tabs[tabIndex];\r\n\t\t\t\t\t\te.dataTransfer!.setData(\"application/winlet-tab\", JSON.stringify(tabData));\r\n\t\t\t\t\t\te.dataTransfer!.setData(\"application/winlet-source-window-id\", this.id);\r\n\r\n\t\t\t\t\t\tthis.manager.onTabDragStart(this.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: true }\r\n\t\t);\r\n\t\ttabEl.addEventListener(\r\n\t\t\t\"dragend\",\r\n\t\t\t() => {\r\n\t\t\t\ttabEl.classList.remove(`${LIBRARY_NAME}-dragging`);\r\n\t\t\t\tthis.manager.onTabDragEnd();\r\n\t\t\t},\r\n\t\t\t{ passive: true }\r\n\t\t);\r\n\r\n\t\ttabEl.addEventListener(\r\n\t\t\t\"dragover\",\r\n\t\t\t(e) => {\r\n\t\t\t\tif (this.manager.draggingTabInfo?.sourceWindowId !== this.id) {\r\n\t\t\t\t\treturn; //タブが別のウィンドウからである場合、何もしない\r\n\t\t\t\t}\r\n\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tconst draggingEl = document.querySelector<HTMLElement>(`.${LIBRARY_NAME}-tab.${LIBRARY_NAME}-dragging`);\r\n\t\t\t\tif (draggingEl && draggingEl !== tabEl) {\r\n\t\t\t\t\tconst rect = tabEl.getBoundingClientRect();\r\n\t\t\t\t\t// カーソルの位置によって挿入位置を左右に決める\r\n\t\t\t\t\tconst isAfter = e.clientX > rect.left + rect.width / 2;\r\n\t\t\t\t\tconst parent = tabEl.parentNode!;\r\n\t\t\t\t\tif (isAfter) {\r\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl.nextSibling);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tparent.insertBefore(draggingEl, tabEl);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\r\n\t\ttabEl.addEventListener(\r\n\t\t\t\"drop\",\r\n\t\t\t(e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\t}\r\n\r\n\t// タブを閉じるロジック\r\n\tpublic closeTab(index: number) {\r\n\t\t// アクティブなタブが閉じられるかチェック\r\n\t\tconst wasActive = this.tabs[index]?.tabEl.classList.contains(`${LIBRARY_NAME}-active`);\r\n\r\n\t\t// DOMから要素を削除\r\n\t\tthis.tabs[index].tabEl.remove();\r\n\t\tthis.tabs[index].contentEl.remove();\r\n\t\t// 配列から削除\r\n\t\tthis.tabs.splice(index, 1);\r\n\t\tthis.options.tabs.splice(index, 1);\r\n\r\n\t\t// IDの再割り当て\r\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\r\n\r\n\t\t// アクティブなタブを再設定\r\n\t\tif (this.tabs.length > 0) {\r\n\t\t\tif (wasActive) {\r\n\t\t\t\tconst newActiveIndex = Math.max(0, index - 1);\r\n\t\t\t\tthis.activateTab(newActiveIndex);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// タブが0になったらウィンドウを閉じる\r\n\t\t\tthis.close();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * タブをアクティブにします。\r\n\t * @param index - アクティブにするタブのインデックス\r\n\t */\r\n\tpublic activateTab(index: number): void {\r\n\t\tif (index < 0 || index >= this.tabs.length) return;\r\n\r\n\t\tthis.tabs.forEach((tab, i) => {\r\n\t\t\tconst isActive = i === index;\r\n\t\t\ttab.tabEl.classList.toggle(`${LIBRARY_NAME}-active`, isActive);\r\n\t\t\ttab.tabEl.setAttribute(\"aria-selected\", String(isActive));\r\n\t\t\ttab.contentEl.classList.toggle(`${LIBRARY_NAME}-active`, isActive);\r\n\t\t});\r\n\r\n\t\t// 検索バーが開いていれば、再検索を実行\r\n\t\tif (this.searchBarEl) {\r\n\t\t\tthis._performSearch();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addTab(tabItem: TabItem, setActive: boolean = true): void {\r\n\t\tthis.options.tabs.push(tabItem);\r\n\t\tconst newIndex = this.options.tabs.length - 1;\r\n\t\tthis.createTabElement(tabItem, newIndex);\r\n\t\tif (setActive) {\r\n\t\t\tthis.activateTab(newIndex);\r\n\t\t\t// タブが追加されアクティブになったウィンドウにフォーカスを当てる\r\n\t\t\tthis.focus();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getTabs(): { tabEl: HTMLElement; contentEl: HTMLElement }[] {\r\n\t\treturn this.tabs;\r\n\t}\r\n\r\n\tprivate updateTabOrderFromDOM(): void {\r\n\t\tconst tabElements = Array.from(this.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-tab-bar > .${LIBRARY_NAME}-tab`));\r\n\r\n\t\tconst newTabs: typeof this.tabs = [];\r\n\t\tconst newOptionsTabs: TabItem[] = [];\r\n\r\n\t\tconst oldTabs = [...this.tabs];\r\n\t\tconst oldOptionsTabs = [...this.options.tabs];\r\n\r\n\t\ttabElements.forEach((tabEl) => {\r\n\t\t\t// dataset.tabIdはもはや信頼できない可能性があるため、DOM要素で直接比較する\r\n\t\t\tconst oldIndex = oldTabs.findIndex((t) => t.tabEl === tabEl);\r\n\t\t\tif (oldIndex !== -1) {\r\n\t\t\t\tnewTabs.push(oldTabs[oldIndex]);\r\n\t\t\t\tnewOptionsTabs.push(oldOptionsTabs[oldIndex]);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.tabs = newTabs;\r\n\t\tthis.options.tabs = newOptionsTabs;\r\n\r\n\t\t// 新しい順序でdataset.tabIdを再設定\r\n\t\tthis.tabs.forEach((tab, i) => (tab.tabEl.dataset.tabId = i.toString()));\r\n\t}\r\n\r\n\tprivate createSplitView(container: HTMLElement, options: SplitViewOptions) {\r\n\t\tcontainer.innerHTML = \"\"; // コンテナをクリア\r\n\t\tconst splitViewEl = document.createElement(\"div\");\r\n\t\tsplitViewEl.className = `${LIBRARY_NAME}-split-view ${LIBRARY_NAME}-split-view-${options.direction}`;\r\n\t\tcontainer.appendChild(splitViewEl);\r\n\r\n\t\toptions.panes.forEach((paneOptions, index) => {\r\n\t\t\tconst paneEl = document.createElement(\"div\");\r\n\t\t\tpaneEl.className = `${LIBRARY_NAME}-split-pane`;\r\n\t\t\tpaneEl.id = paneOptions.id;\r\n\r\n\t\t\tif (paneOptions.size) {\r\n\t\t\t\tpaneEl.style.flex = `0 0 ${paneOptions.size}`;\r\n\t\t\t} else {\r\n\t\t\t\tpaneEl.style.flex = \"1 1 0\";\r\n\t\t\t}\r\n\t\t\tif (paneOptions.minSize) {\r\n\t\t\t\tif (options.direction === \"horizontal\") {\r\n\t\t\t\t\tpaneEl.style.minWidth = paneOptions.minSize;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpaneEl.style.minHeight = paneOptions.minSize;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// コンテンツを描画\r\n\t\t\tthis.renderContent(paneEl, paneOptions.content);\r\n\t\t\tsplitViewEl.appendChild(paneEl);\r\n\r\n\t\t\t// 最後以外のペインの後ろにリサイザーを追加\r\n\t\t\tif (index < options.panes.length - 1) {\r\n\t\t\t\tconst resizerEl = document.createElement(\"div\");\r\n\t\t\t\tresizerEl.className = `${LIBRARY_NAME}-split-resizer`;\r\n\t\t\t\tif (paneOptions.resizable !== false) {\r\n\t\t\t\t\tthis.makePaneResizable(resizerEl, paneEl, options.direction);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresizerEl.style.pointerEvents = \"none\";\r\n\t\t\t\t}\r\n\t\t\t\tsplitViewEl.appendChild(resizerEl);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate makePaneResizable(resizer: HTMLElement, prevPane: HTMLElement, direction: \"horizontal\" | \"vertical\") {\r\n\t\tresizer.addEventListener(\r\n\t\t\t\"pointerdown\",\r\n\t\t\t(e: PointerEvent) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tconst startX = e.clientX;\r\n\t\t\t\tconst startY = e.clientY;\r\n\t\t\t\tconst startWidth = prevPane.offsetWidth;\r\n\t\t\t\tconst startHeight = prevPane.offsetHeight;\r\n\r\n\t\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\r\n\t\t\t\t\tif (direction === \"horizontal\") {\r\n\t\t\t\t\t\tconst newWidth = startWidth + (moveE.clientX - startX);\r\n\t\t\t\t\t\tprevPane.style.flexBasis = `${newWidth}px`;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst newHeight = startHeight + (moveE.clientY - startY);\r\n\t\t\t\t\t\tprevPane.style.flexBasis = `${newHeight}px`;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tconst onPointerUp = () => {\r\n\t\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\r\n\t\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerUp);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove, { passive: true });\r\n\t\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp, { passive: true });\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\t}\r\n\r\n\tprivate setupEventListeners(): void {\r\n\t\tthis.el.addEventListener(\"click\", () => this.focus(), true);\r\n\r\n\t\t// iframeなどにフォーカスが移った際にウィンドウ自体をアクティブにする\r\n\t\tthis.el.addEventListener(\"focusin\", () => this.focus(), { passive: true });\r\n\r\n\t\t// グローバルクリックリスナーを追加して、外側をクリックするときにメニューを閉じる\r\n\t\tthis.boundGlobalClickHandler = () => {\r\n\t\t\tif (this.isMenuOpen) {\r\n\t\t\t\tthis.closeAllMenus();\r\n\t\t\t}\r\n\t\t};\r\n\t\tdocument.addEventListener(\"click\", this.boundGlobalClickHandler, { passive: true });\r\n\r\n\t\tconst controlsEl = this.el.querySelector<HTMLElement>(`.${LIBRARY_NAME}-controls`);\r\n\t\tcontrolsEl?.addEventListener(\r\n\t\t\t\"click\",\r\n\t\t\t(e) => {\r\n\t\t\t\tconst target = e.target as HTMLElement;\r\n\t\t\t\tconst button = target.closest<HTMLElement>(`.${LIBRARY_NAME}-control-btn`);\r\n\t\t\t\tif (!button) return;\r\n\r\n\t\t\t\t// 標準ボタン\r\n\t\t\t\tif (button.classList.contains(`${LIBRARY_NAME}-close-btn`)) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tif (this.options._isPopup) {\r\n\t\t\t\t\t\tthis.popupCloseCallback?.(CLOSE_BUTTON_RESULT);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.close();\r\n\t\t\t\t} else if (button.classList.contains(`${LIBRARY_NAME}-maximize-btn`)) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tthis.toggleMaximize();\r\n\t\t\t\t} else if (button.classList.contains(`${LIBRARY_NAME}-minimize-btn`)) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tthis.minimize();\r\n\t\t\t\t} else if (button.classList.contains(`${LIBRARY_NAME}-refresh-btn`)) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tthis.unvirtualize();\r\n\t\t\t\t}\r\n\t\t\t\t// カスタムボタン\r\n\t\t\t\telse if (button.classList.contains(`${LIBRARY_NAME}-custom-control-btn`)) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tconst name = button.dataset.name;\r\n\t\t\t\t\tconst control = this.options.customControls.find((c) => c.name === name);\r\n\t\t\t\t\tcontrol?.action(this);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\r\n\t\tif (this.options.windowOptions.movable) this.makeMovable();\r\n\t\tif (this.options.windowOptions.resizableX || this.options.windowOptions.resizableY) this.makeResizable();\r\n\t\tif (this.options.contextMenu.length > 0) {\r\n\t\t\t// PC用: 右クリック\r\n\t\t\tthis.titleBarEl.addEventListener(\r\n\t\t\t\t\"contextmenu\",\r\n\t\t\t\t(e) => {\r\n\t\t\t\t\tconst target = e.target as HTMLElement;\r\n\t\t\t\t\t// 操作UI（コントロールボタン、メニュー、タブ）の上では発火しないようにする\r\n\t\t\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab`)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\r\n\t\t\t\t},\r\n\t\t\t\t{ passive: false }\r\n\t\t\t);\r\n\t\t\t// モバイル用: 長押し\r\n\t\t\tthis.titleBarEl.addEventListener(\r\n\t\t\t\t\"pointerdown\",\r\n\t\t\t\t(e) => {\r\n\t\t\t\t\tif (e.pointerType !== \"touch\") return;\r\n\t\t\t\t\tthis.contextMenuTimer = window.setTimeout(() => {\r\n\t\t\t\t\t\tthis.contextMenuTimer = null;\r\n\t\t\t\t\t\tthis.manager.showContextMenu(e.clientX, e.clientY, this.options.contextMenu, this);\r\n\t\t\t\t\t}, this.MOBILE_CONTEXT_MENU_TIMEOUT);\r\n\t\t\t\t},\r\n\t\t\t\t{ passive: true }\r\n\t\t\t);\r\n\t\t\tconst clearContextMenuTimer = () => {\r\n\t\t\t\tif (this.contextMenuTimer) {\r\n\t\t\t\t\tclearTimeout(this.contextMenuTimer);\r\n\t\t\t\t\tthis.contextMenuTimer = null;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.titleBarEl.addEventListener(\"pointermove\", clearContextMenuTimer, { passive: true });\r\n\t\t\tthis.titleBarEl.addEventListener(\"pointerup\", clearContextMenuTimer, { passive: true });\r\n\t\t\tthis.titleBarEl.addEventListener(\"pointercancel\", clearContextMenuTimer, { passive: true });\r\n\t\t}\r\n\r\n\t\t// 検索ショートカット (Ctrl+F)\r\n\t\tdocument.addEventListener(\r\n\t\t\t\"keydown\",\r\n\t\t\t(e) => {\r\n\t\t\t\tif (!this.focused) return;\r\n\t\t\t\tif (this.options.search.enabled && e.ctrlKey && e.key === \"f\") {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tthis.openSearch();\r\n\t\t\t\t}\r\n\t\t\t\tif (e.key === \"Escape\" && this.searchBarEl) {\r\n\t\t\t\t\tthis.closeSearch();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\t}\r\n\r\n\tprivate makeMovable(): void {\r\n\t\tconst onPointerDown = (e: PointerEvent) => {\r\n\t\t\tconst target = e.target as HTMLElement;\r\n\t\t\t// 操作UI要素の上なら移動させない\r\n\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-resize-handle, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab, .${LIBRARY_NAME}-tab-add-btn`)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// メインボタン（マウスの左ボタン、タッチ）でのみ移動\r\n\t\t\tif (e.button !== 0) return;\r\n\r\n\t\t\te.preventDefault();\r\n\t\t\tthis.focus();\r\n\r\n\t\t\tconst { clientX: startX, clientY: startY } = e;\r\n\t\t\tlet isDragging = false;\r\n\r\n\t\t\t// ドラッグ開始時のウィンドウ座標。isDraggingがtrueになったときに設定される。\r\n\t\t\tlet initialLeft: number;\r\n\t\t\tlet initialTop: number;\r\n\r\n\t\t\t// --- ゴーストウィンドウ処理 ---\r\n\t\t\tlet ghostEl: HTMLElement | null = null;\r\n\t\t\tif (this.options.windowOptions.useGhostWindow) {\r\n\t\t\t\tghostEl = document.createElement(\"div\");\r\n\t\t\t\tghostEl.className = `${LIBRARY_NAME}-ghost-window`;\r\n\t\t\t\tthis.manager.container?.appendChild(ghostEl);\r\n\t\t\t\tghostEl.style.left = `${this.el.offsetLeft}px`;\r\n\t\t\t\tghostEl.style.top = `${this.el.offsetTop}px`;\r\n\t\t\t\tghostEl.style.width = `${this.el.offsetWidth}px`;\r\n\t\t\t\tghostEl.style.height = `${this.el.offsetHeight}px`;\r\n\t\t\t}\r\n\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-dragging`);\r\n\r\n\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\r\n\t\t\t\tif (!this.el?.isConnected) return;\r\n\t\t\t\tif (!isDragging) {\r\n\t\t\t\t\tconst deltaX = Math.abs(moveE.clientX - startX);\r\n\t\t\t\t\tconst deltaY = Math.abs(moveE.clientY - startY);\r\n\r\n\t\t\t\t\t// 閾値を超えたらドラッグモードを開始\r\n\t\t\t\t\tif (deltaX > this.DRAG_THRESHOLD || deltaY > this.DRAG_THRESHOLD) {\r\n\t\t\t\t\t\tisDragging = true;\r\n\t\t\t\t\t\tthis.el.setPointerCapture(e.pointerId);\r\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\r\n\r\n\t\t\t\t\t\tthis.emit(\"move-start\", this);\r\n\r\n\t\t\t\t\t\t// 最大化状態からのドラッグ開始の場合、ウィンドウを復元\r\n\t\t\t\t\t\tif (this.state === \"maximized\") {\r\n\t\t\t\t\t\t\tconst restoredWidth = this.lastState.width;\r\n\t\t\t\t\t\t\tconst clickRatio = e.clientX / this.el.offsetWidth;\r\n\t\t\t\t\t\t\tconst titleBarRect = this.titleBarEl.getBoundingClientRect();\r\n\t\t\t\t\t\t\tconst offsetY = e.clientY - titleBarRect.top;\r\n\t\t\t\t\t\t\tconst posX = e.clientX - restoredWidth * clickRatio;\r\n\t\t\t\t\t\t\tconst posY = e.clientY - offsetY;\r\n\r\n\t\t\t\t\t\t\tthis.restore();\r\n\t\t\t\t\t\t\tthis.setPosition(posX, posY);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// ドラッグ開始時点の座標を記録\r\n\t\t\t\t\t\tinitialLeft = this.el.offsetLeft;\r\n\t\t\t\t\t\tinitialTop = this.el.offsetTop;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 閾値に達していなければ何もしない\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// ドラッグ中の移動処理\r\n\t\t\t\tconst newLeft = initialLeft + moveE.clientX - startX;\r\n\t\t\t\tconst newTop = initialTop + moveE.clientY - startY;\r\n\t\t\t\tif (ghostEl) {\r\n\t\t\t\t\tghostEl.style.left = `${newLeft}px`;\r\n\t\t\t\t\tghostEl.style.top = `${newTop}px`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setPosition(newLeft, newTop);\r\n\t\t\t\t}\r\n\t\t\t\tthis.throttledEmitMove?.();\r\n\t\t\t};\r\n\r\n\t\t\tconst onPointerUp = () => {\r\n\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\r\n\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerUp);\r\n\r\n\t\t\t\tif (ghostEl) {\r\n\t\t\t\t\tthis.setPosition(ghostEl.offsetLeft, ghostEl.offsetTop);\r\n\t\t\t\t\tghostEl.remove();\r\n\t\t\t\t}\r\n\t\t\t\t// ドラッグが発生した場合のみ後処理とコールバック呼び出し\r\n\t\t\t\tif (isDragging) {\r\n\t\t\t\t\tthis.el.releasePointerCapture(e.pointerId);\r\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\r\n\t\t\t\t\tthis.emit(\"move-end\", this);\r\n\t\t\t\t\t(async () => await this.manager.updateVirtualization())();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-dragging`);\r\n\t\t\t};\r\n\r\n\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove, { passive: true });\r\n\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp, { passive: true });\r\n\t\t};\r\n\r\n\t\tthis.titleBarEl.addEventListener(\"pointerdown\", onPointerDown, { passive: false });\r\n\r\n\t\tif (this.options.windowOptions.maximizable) {\r\n\t\t\tthis.titleBarEl.addEventListener(\"dblclick\", (e: MouseEvent) => {\r\n\t\t\t\tif (this.options.windowOptions.maximizableOnDblClick) {\r\n\t\t\t\t\tconst target = e.target as HTMLElement;\r\n\t\t\t\t\t// 操作UI（コントロールボタン、メニュー、タブ）の上では発火しないようにする\r\n\t\t\t\t\tif (target.closest(`.${LIBRARY_NAME}-control-btn, .${LIBRARY_NAME}-menu-item, .${LIBRARY_NAME}-tab`)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.toggleMaximize();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate makeResizable(): void {\r\n\t\tthis.el.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-resize-handle`).forEach((handle) => {\r\n\t\t\thandle.addEventListener(\r\n\t\t\t\t\"pointerdown\",\r\n\t\t\t\t(e: PointerEvent) => {\r\n\t\t\t\t\tif (e.button !== 0 || !handle?.isConnected) return;\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tthis.focus();\r\n\t\t\t\t\tthis.contentEl.style.pointerEvents = \"none\";\r\n\t\t\t\t\thandle.setPointerCapture(e.pointerId);\r\n\r\n\t\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-resizing`);\r\n\t\t\t\t\tthis.emit(\"resize-start\", this);\r\n\r\n\t\t\t\t\t// --- ゴーストウィンドウ処理 ---\r\n\t\t\t\t\tlet ghostEl: HTMLElement | null = null;\r\n\t\t\t\t\tif (this.options.windowOptions.useGhostWindow) {\r\n\t\t\t\t\t\tghostEl = document.createElement(\"div\");\r\n\t\t\t\t\t\tghostEl.className = `${LIBRARY_NAME}-ghost-window`;\r\n\t\t\t\t\t\tthis.manager.container?.appendChild(ghostEl);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst direction = handle.className.replace(`${LIBRARY_NAME}-resize-handle `, \"\");\r\n\t\t\t\t\tconst { clientX: startX, clientY: startY } = e;\r\n\t\t\t\t\tconst { offsetWidth: startWidth, offsetHeight: startHeight, offsetLeft: startLeft, offsetTop: startTop } = this.el;\r\n\t\t\t\t\tconst { minWidth, minHeight } = this.options;\r\n\r\n\t\t\t\t\tconst onPointerMove = (moveE: PointerEvent) => {\r\n\t\t\t\t\t\tlet newWidth = startWidth,\r\n\t\t\t\t\t\t\tnewHeight = startHeight,\r\n\t\t\t\t\t\t\tnewLeft = startLeft,\r\n\t\t\t\t\t\t\tnewTop = startTop;\r\n\t\t\t\t\t\tconst deltaX = moveE.clientX - startX;\r\n\t\t\t\t\t\tconst deltaY = moveE.clientY - startY;\r\n\r\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-e`)) newWidth = Math.max(minWidth, startWidth + deltaX);\r\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-w`)) {\r\n\t\t\t\t\t\t\tnewWidth = Math.max(minWidth, startWidth - deltaX);\r\n\t\t\t\t\t\t\tnewLeft = startLeft + deltaX;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-s`)) newHeight = Math.max(minHeight, startHeight + deltaY);\r\n\t\t\t\t\t\tif (direction.includes(`${LIBRARY_NAME}-n`)) {\r\n\t\t\t\t\t\t\tnewHeight = Math.max(minHeight, startHeight - deltaY);\r\n\t\t\t\t\t\t\tnewTop = startTop + deltaY;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (ghostEl) {\r\n\t\t\t\t\t\t\tghostEl.style.left = `${newLeft}px`;\r\n\t\t\t\t\t\t\tghostEl.style.top = `${newTop}px`;\r\n\t\t\t\t\t\t\tghostEl.style.width = `${newWidth}px`;\r\n\t\t\t\t\t\t\tghostEl.style.height = `${newHeight}px`;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.setSize(newWidth, newHeight);\r\n\t\t\t\t\t\t\tthis.setPosition(newLeft, newTop);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.throttledEmitResize?.();\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconst onPointerUp = () => {\r\n\t\t\t\t\t\thandle.releasePointerCapture(e.pointerId);\r\n\t\t\t\t\t\tthis.contentEl.style.pointerEvents = \"auto\";\r\n\r\n\t\t\t\t\t\tif (ghostEl) {\r\n\t\t\t\t\t\t\tthis.setSize(ghostEl.offsetWidth, ghostEl.offsetHeight);\r\n\t\t\t\t\t\t\tthis.setPosition(ghostEl.offsetLeft, ghostEl.offsetTop);\r\n\t\t\t\t\t\t\tghostEl.remove();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdocument.removeEventListener(\"pointermove\", onPointerMove);\r\n\t\t\t\t\t\tdocument.removeEventListener(\"pointerup\", onPointerUp);\r\n\t\t\t\t\t\tthis.emit(\"resize-end\", this);\r\n\t\t\t\t\t\tthis.updateDebugOverlay();\r\n\t\t\t\t\t\t(async () => await this.manager.updateVirtualization())();\r\n\r\n\t\t\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-resizing`);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tdocument.addEventListener(\"pointermove\", onPointerMove, { passive: true });\r\n\t\t\t\t\tdocument.addEventListener(\"pointerup\", onPointerUp, { passive: true });\r\n\t\t\t\t},\r\n\t\t\t\t{ passive: false }\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic isFontAwesome(classStr: string): boolean {\r\n\t\tconst classes = classStr.trim().split(/\\s+/);\r\n\t\tconst hasPrefix = classes.some((c) => /^fa[bslr]?$/.test(c));\r\n\t\tconst hasIcon = classes.some((c) => /^fa-[a-z0-9-]+$/.test(c));\r\n\t\treturn hasPrefix && hasIcon;\r\n\t}\r\n\r\n\tpublic updateDebugOverlay(): void {\r\n\t\tif (this.debugOverlayEl) {\r\n\t\t\tconst pos = this.getPosition();\r\n\t\t\tconst size = this.getSize();\r\n\t\t\tthis.debugOverlayEl.textContent = `ID:    ${this.id}\r\nState: ${this.state}\r\nPos:   x:${Math.round(pos.x)}, y:${Math.round(pos.y)}\r\nSize:  w:${Math.round(size.width)}, h:${Math.round(size.height)}\r\nFocus: ${this.focused}\r\nz-idx: ${this.el.style.zIndex}\r\nVirt:  ${this.virtualizationLevel}`.trim();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ウィンドウ内に不安全なコンテンツがあるか判定する\r\n\t */\r\n\tpublic getUnsafeContentLevel(): VirtualizationLevel {\r\n\t\tif (this.mainContentEl.querySelector(\"iframe, frame, video, audio, applet, embed, object\")) {\r\n\t\t\treturn \"frozen\";\r\n\t\t}\r\n\t\tif (this.mainContentEl.querySelector(\"img, input, textarea, select, canvas, [contentEditable=true]\")) {\r\n\t\t\treturn \"suspended\";\r\n\t\t}\r\n\t\treturn \"unloaded\";\r\n\t}\r\n\r\n\t/**\r\n\t * ウィンドウを指定されたレベルまで仮想化する\r\n\t * @param level - 仮想化の目標レベル\r\n\t */\r\n\tpublic async virtualize(level: \"none\" | \"frozen\" | \"suspended\" | \"unloaded\" | \"auto\"): Promise<void> {\r\n\t\tif (level === \"auto\") {\r\n\t\t\tlevel = this.getUnsafeContentLevel();\r\n\t\t}\r\n\t\tif (level === \"none\") {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst currentIndex = this.virtualizationHierarchy.indexOf(this.virtualizationLevel);\r\n\t\tconst targetIndex = this.virtualizationHierarchy.indexOf(level);\r\n\r\n\t\tif (targetIndex <= currentIndex) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.cleanupVirtualizationStyles();\r\n\r\n\t\t// Add lock class to disable controls during any virtualization\r\n\t\tthis.el.classList.add(`${LIBRARY_NAME}-virtualization-lock`);\r\n\r\n\t\tconst restoreMode = this.options.virtualizationRestoreMode || this.manager.getGlobalConfig().virtualizationRestoreMode || \"auto\";\r\n\t\tif (restoreMode === \"manual\" && this.options.showVirtualizationRefreshButton) {\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-virtualized-manual`);\r\n\t\t}\r\n\r\n\t\tconst strategy = this.options.virtualizationStrategy || this.manager.getGlobalConfig().virtualizationStrategy;\r\n\r\n\t\tif (strategy === \"canvas\" && level === \"unloaded\") {\r\n\t\t\tthis.showLoader();\r\n\t\t\ttry {\r\n\t\t\t\tthis.canvasSnapshot = await this.capture();\r\n\t\t\t\tif (this.canvasOverlayEl && this.canvasSnapshot) {\r\n\t\t\t\t\tconst img = document.createElement(\"img\");\r\n\t\t\t\t\timg.src = this.canvasSnapshot;\r\n\t\t\t\t\tthis.canvasOverlayEl.innerHTML = \"\";\r\n\t\t\t\t\tthis.canvasOverlayEl.appendChild(img);\r\n\t\t\t\t\tthis.canvasOverlayEl.style.display = \"block\";\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"WinLet: Canvas virtualization failed, falling back to standard.\", e);\r\n\t\t\t\tthis.canvasSnapshot = null; // Ensure fallback works\r\n\t\t\t} finally {\r\n\t\t\t\tthis.hideLoader();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.virtualizationLevel = level;\r\n\r\n\t\tif (currentIndex === 0 && targetIndex > 0) {\r\n\t\t\tthis.manager.updateTaskbarItem(this, \"virtualized\");\r\n\t\t}\r\n\r\n\t\tswitch (level) {\r\n\t\t\tcase \"frozen\":\r\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-frozen`);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"suspended\":\r\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-suspended`);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"unloaded\":\r\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-virtualized`);\r\n\t\t\t\tif (this.tabs.length > 0) {\r\n\t\t\t\t\tthis.tabs.forEach((tab) => {\r\n\t\t\t\t\t\ttab.contentEl.innerHTML = \"\";\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.contentEl.innerHTML = \"\";\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tthis.updateDebugOverlay();\r\n\t}\r\n\t/**\r\n\t * ウィンドウの仮想化を解除する\r\n\t */\r\n\tpublic unvirtualize(): void {\r\n\t\tif (this.virtualizationLevel === \"none\") return;\r\n\r\n\t\tthis.el.classList.remove(`${LIBRARY_NAME}-virtualization-lock`, `${LIBRARY_NAME}-is-virtualized-manual`);\r\n\r\n\t\tif (this.canvasSnapshot && this.canvasOverlayEl) {\r\n\t\t\tthis.canvasOverlayEl.style.display = \"none\";\r\n\t\t\tthis.canvasOverlayEl.innerHTML = \"\";\r\n\t\t\tthis.canvasSnapshot = null;\r\n\t\t}\r\n\r\n\t\tthis.manager.updateTaskbarItem(this, \"unvirtualized\");\r\n\r\n\t\tconst previousLevel = this.virtualizationLevel;\r\n\t\tthis.virtualizationLevel = \"none\";\r\n\t\tthis.cleanupVirtualizationStyles();\r\n\r\n\t\tif (previousLevel === \"unloaded\") {\r\n\t\t\tthis.showLoader();\r\n\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\tthis.isContentLoaded = false; // Allow re-rendering\r\n\t\t\t\tthis._renderInitialContent();\r\n\t\t\t\tthis.hideLoader();\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.updateDebugOverlay();\r\n\t}\r\n\r\n\t/**\r\n\t * 仮想化に関連するスタイルと属性をリセットします。\r\n\t */\r\n\tprivate cleanupVirtualizationStyles(): void {\r\n\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-frozen`, `${LIBRARY_NAME}-is-suspended`, `${LIBRARY_NAME}-is-virtualized`);\r\n\t\tthis.contentEl.style.display = \"\";\r\n\t}\r\n\r\n\t// --- Public API ---\r\n\r\n\tpublic close(): void {\r\n\t\t// onBeforeCloseでfalseが返された場合は処理を中断\r\n\t\tconst results = this.emit(\"before-close\", this);\r\n\t\tif (results?.includes(false)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Clean up global event listeners\r\n\t\tif (this.boundGlobalClickHandler) {\r\n\t\t\tdocument.removeEventListener(\"click\", this.boundGlobalClickHandler);\r\n\t\t}\r\n\t\tthis.emit(\"close\", this);\r\n\t\tthis.manager.destroyWindow(this.id);\r\n\t}\r\n\r\n\tpublic minimize(options?: AnimationOptions): void {\r\n\t\tif (this.virtualizationLevel !== \"none\") {\r\n\t\t\tthis.unvirtualize();\r\n\t\t}\r\n\t\tif (this.state === \"minimized\") return;\r\n\r\n\t\tif (this.state !== \"normal\") {\r\n\t\t\tthis.restore();\r\n\t\t}\r\n\r\n\t\tconst doMinimize = () => {\r\n\t\t\tthis.state = \"minimized\";\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-minimized`);\r\n\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-minimizing`);\r\n\t\t\tthis.el.setAttribute(\"aria-hidden\", \"true\");\r\n\t\t\tthis.manager.updateTaskbarItem(this, \"minimized\");\r\n\t\t\tthis.blur();\r\n\r\n\t\t\t// 最小化時の仮想化タイマーを開始\r\n\t\t\tconst globalConfig = this.manager.getGlobalConfig();\r\n\t\t\tif (globalConfig.enableVirtualization && this.options.virtualizable) {\r\n\t\t\t\tif (this.minimizeVirtualizeTimer) {\r\n\t\t\t\t\tclearTimeout(this.minimizeVirtualizeTimer);\r\n\t\t\t\t}\r\n\t\t\t\tthis.minimizeVirtualizeTimer = window.setTimeout(() => {\r\n\t\t\t\t\tthis.virtualize(\"auto\");\r\n\t\t\t\t}, globalConfig.virtualizationDelay ?? 5000);\r\n\t\t\t}\r\n\t\t\tthis.updateDebugOverlay();\r\n\t\t\tthis.manager.updateVirtualization();\r\n\t\t};\r\n\r\n\t\tthis.el.setAttribute(\"inert\", \"\");\r\n\t\tif (this.manager.getGlobalConfig().enableAnimations) {\r\n\t\t\tconst originPriority = [options?.origin, this.options.animationOrigin, this.manager.getGlobalConfig().animateFromTaskbar ? this.options._taskbarItem : null];\r\n\t\t\tconst origin = originPriority.find((o) => o != null);\r\n\t\t\tthis.el.style.transformOrigin = this._calculateTransformOrigin(origin);\r\n\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-minimizing`);\r\n\t\t\tthis.el.addEventListener(\"transitionend\", doMinimize, { once: true });\r\n\t\t} else {\r\n\t\t\tdoMinimize();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic toggleMaximize(): void {\r\n\t\tthis.state === \"maximized\" ? this.restore() : this.maximize();\r\n\t}\r\n\r\n\tpublic maximize(): void {\r\n\t\tif (this.virtualizationLevel !== \"none\") {\r\n\t\t\tthis.unvirtualize();\r\n\t\t}\r\n\t\tif (this.state !== \"maximized\") {\r\n\t\t\tif (this.state !== \"normal\") this.restore();\r\n\t\t\tthis.lastState = { x: this.el.offsetLeft, y: this.el.offsetTop, width: this.el.offsetWidth, height: this.el.offsetHeight };\r\n\t\t\tthis.state = \"maximized\";\r\n\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-maximized`);\r\n\r\n\t\t\tconst doMaximize = () => {\r\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-maximizing`);\r\n\t\t\t\tthis.setPosition(0, 0);\r\n\t\t\t\tthis.setSize(\"100%\", \"100%\");\r\n\t\t\t\tthis.updateDebugOverlay();\r\n\t\t\t};\r\n\r\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations) {\r\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-maximizing`);\r\n\t\t\t\t// アニメーションのために先にサイズと位置を設定\r\n\t\t\t\tthis.el.style.top = \"0px\";\r\n\t\t\t\tthis.el.style.left = \"0px\";\r\n\t\t\t\tthis.el.style.width = \"100%\";\r\n\t\t\t\tthis.el.style.height = \"100%\";\r\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doMaximize, { once: true, passive: true });\r\n\t\t\t} else {\r\n\t\t\t\tdoMaximize();\r\n\t\t\t}\r\n\r\n\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\r\n\t\t\tif (maxBtn) {\r\n\t\t\t\tmaxBtn.title = \"Restore\";\r\n\t\t\t\tmaxBtn.value = \"\\u274f\";\r\n\t\t\t\tmaxBtn.setAttribute(\"aria-label\", \"Restore\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic restore(options?: AnimationOptions): void {\r\n\t\t// 仮想化解除タイマーをクリア\r\n\t\tif (this.minimizeVirtualizeTimer) {\r\n\t\t\tclearTimeout(this.minimizeVirtualizeTimer);\r\n\t\t\tthis.minimizeVirtualizeTimer = null;\r\n\t\t}\r\n\t\t// もし仮想化されていたら、解除する\r\n\t\tif (this.virtualizationLevel !== \"none\") {\r\n\t\t\tthis.unvirtualize();\r\n\t\t}\r\n\r\n\t\tif (this.state === \"minimized\") {\r\n\t\t\tconst doRestore = () => {\r\n\t\t\t\tthis.state = \"normal\";\r\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-is-restoring-from-minimized`);\r\n\t\t\t\t// アニメーション後に不要なスタイルをクリーンアップ\r\n\t\t\t\tthis.el.style.transformOrigin = \"\";\r\n\t\t\t\tthis.updateDebugOverlay();\r\n\t\t\t\tthis.manager.updateVirtualization();\r\n\t\t\t};\r\n\r\n\t\t\tthis.el.removeAttribute(\"aria-hidden\");\r\n\t\t\tthis.el.removeAttribute(\"inert\");\r\n\t\t\tthis.el.style.transition = \"\"; // Use CSS transition for transform/opacity\r\n\r\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations) {\r\n\t\t\t\tconst originPriority = [options?.origin, this.options.animationOrigin, this.manager.getGlobalConfig().animateFromTaskbar ? this.options._taskbarItem : null];\r\n\t\t\t\tconst origin = originPriority.find((o) => o != null);\r\n\t\t\t\tthis.el.style.transformOrigin = this._calculateTransformOrigin(origin);\r\n\r\n\t\t\t\t// `minimized`クラスを削除して表示状態にし、アニメーションを開始\r\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-minimized`);\r\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-restoring-from-minimized`);\r\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doRestore, { once: true });\r\n\t\t\t} else {\r\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-minimized`);\r\n\t\t\t\tdoRestore();\r\n\t\t\t}\r\n\r\n\t\t\tthis.manager.updateTaskbarItem(this, \"restored\");\r\n\t\t\tthis.focus();\r\n\t\t} else if (this.state === \"maximized\") {\r\n\t\t\tconst doRestore = () => {\r\n\t\t\t\tthis.state = \"normal\";\r\n\t\t\t\tthis.el.classList.remove(`${LIBRARY_NAME}-maximized`, `${LIBRARY_NAME}-is-restoring`);\r\n\t\t\t\tthis.el.style.transition = \"\"; // Reset transition\r\n\t\t\t\tconst maxBtn = this.el.querySelector<HTMLButtonElement>(`.${LIBRARY_NAME}-maximize-btn`);\r\n\t\t\t\tif (maxBtn) {\r\n\t\t\t\t\tmaxBtn.title = \"Maximize\";\r\n\t\t\t\t\tmaxBtn.value = \"\\u25a1\";\r\n\t\t\t\t\tmaxBtn.setAttribute(\"aria-label\", \"Maximize\");\r\n\t\t\t\t}\r\n\t\t\t\tthis.updateDebugOverlay();\r\n\t\t\t};\r\n\r\n\t\t\tif (this.manager.getGlobalConfig().enableAnimations) {\r\n\t\t\t\tthis.el.style.transition = \"top 0.25s ease-in-out, left 0.25s ease-in-out, width 0.25s ease-in-out, height 0.25s ease-in-out\";\r\n\t\t\t\tthis.el.classList.add(`${LIBRARY_NAME}-is-restoring`);\r\n\t\t\t\tthis.setSize(this.lastState.width, this.lastState.height);\r\n\t\t\t\tthis.setPosition(this.lastState.x, this.lastState.y);\r\n\t\t\t\tthis.el.addEventListener(\"transitionend\", doRestore, { once: true });\r\n\t\t\t} else {\r\n\t\t\t\tthis.setSize(this.lastState.width, this.lastState.height);\r\n\t\t\t\tthis.setPosition(this.lastState.x, this.lastState.y);\r\n\t\t\t\tdoRestore();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.updateDebugOverlay();\r\n\t\t(async () => await this.manager.updateVirtualization())();\r\n\t}\r\n\r\n\tpublic focus(): void {\r\n\t\tif (this.focused) return;\r\n\r\n\t\tconst restoreMode = this.options.virtualizationRestoreMode || this.manager.getGlobalConfig().virtualizationRestoreMode || \"auto\";\r\n\t\tif (this.virtualizationLevel !== \"none\" && restoreMode === \"manual\") {\r\n\t\t\tthis.unvirtualize();\r\n\t\t}\r\n\r\n\t\tif (this.options.lazyLoad && !this.isContentLoaded) {\r\n\t\t\tthis._renderInitialContent();\r\n\t\t}\r\n\r\n\t\t// 階層を遡ってすべての親ウィンドウをフォーカスする\r\n\t\tif (this.parentWindow) {\r\n\t\t\tthis.parentWindow.focus();\r\n\t\t}\r\n\r\n\t\tthis.manager.focusWindow(this);\r\n\t\tthis.focused = true;\r\n\t\tthis.el.classList.add(`${LIBRARY_NAME}-active`);\r\n\t\tthis.updateDebugOverlay();\r\n\t\tthis.emit(\"focus\", this);\r\n\t}\r\n\r\n\tpublic blur(): void {\r\n\t\tif (!this.focused) return;\r\n\t\tthis.focused = false;\r\n\t\tthis.el.classList.remove(`${LIBRARY_NAME}-active`);\r\n\t\tthis.updateDebugOverlay();\r\n\t\tthis.emit(\"blur\", this);\r\n\t}\r\n\r\n\tpublic shake(): void {\r\n\t\tconst className = `${LIBRARY_NAME}-is-shaking`;\r\n\t\tif (this.el.classList.contains(className)) {\r\n\t\t\treturn; // Already shaking\r\n\t\t}\r\n\t\tthis.el.classList.add(className);\r\n\t\tthis.el.addEventListener(\r\n\t\t\t\"animationend\",\r\n\t\t\t() => {\r\n\t\t\t\tthis.el.classList.remove(className);\r\n\t\t\t},\r\n\t\t\t{ once: true, passive: true }\r\n\t\t);\r\n\t}\r\n\r\n\tpublic reload(): void {\r\n\t\t// onReloadがfalseを返した場合、デフォルトのリロード処理を中断\r\n\t\tconst results = this.emit(\"reload\", this);\r\n\t\tif (results?.includes(false)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst reloadContent = (container: HTMLElement, content: WindowContentOptions) => {\r\n\t\t\tif (Utils.isNonEmptyObject(content.iframe) && (content.iframe.src || content.iframe.srcdoc)) {\r\n\t\t\t\tconst iframe = container.querySelector(\"iframe\");\r\n\t\t\t\t// srcがあり、srcdocがない場合はiframeのreloadを試みる\r\n\t\t\t\tif (iframe && iframe.src && !content.iframe.srcdoc) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// クロスオリジンフレームへのアクセスはエラーになる可能性がある\r\n\t\t\t\t\t\tiframe.contentWindow?.location.reload();\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t// 失敗した場合はiframe要素を再生成する\r\n\t\t\t\t\t\tconsole.warn(\"WinLet: Cross-origin iframe could not be reloaded directly. Recreating iframe element.\", e);\r\n\t\t\t\t\t\tthis.renderContent(container, content);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// srcdocの場合やiframeが見つからない場合は要素を再生成\r\n\t\t\t\t\tthis.renderContent(container, content);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// htmlまたはtemplateの場合は常に再描画\r\n\t\t\t\tthis.renderContent(container, content);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (this.options.tabs.length > 0) {\r\n\t\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(`${LIBRARY_NAME}-active`));\r\n\t\t\tif (activeTabIndex > -1) {\r\n\t\t\t\tconst activeTab = this.tabs[activeTabIndex];\r\n\t\t\t\tconst tabContentOptions = this.options.tabs[activeTabIndex].content;\r\n\t\t\t\treloadContent(activeTab.contentEl, tabContentOptions);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treloadContent(this.contentEl, this.options.content);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getContent(): HTMLElement | HTMLIFrameElement {\r\n\t\tlet contentContainer: HTMLElement;\r\n\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(`${LIBRARY_NAME}-active`));\r\n\r\n\t\tif (activeTabIndex > -1) {\r\n\t\t\t// If there's an active tab, use its content element\r\n\t\t\tcontentContainer = this.tabs[activeTabIndex].contentEl;\r\n\t\t} else {\r\n\t\t\t// Otherwise, use the main content element\r\n\t\t\tcontentContainer = this.contentEl;\r\n\t\t}\r\n\r\n\t\tconst iframe = contentContainer.querySelector(\"iframe\");\r\n\t\treturn iframe || contentContainer;\r\n\t}\r\n\r\n\t/**\r\n\t * 子ウィンドウマネージャを初期化または取得します。\r\n\t */\r\n\tprivate getChildManager(): WindowManager {\r\n\t\tif (!this.childManager) {\r\n\t\t\t// WindowManagerのコンストラクタとGlobalConfigの整合性を取る必要がある\r\n\t\t\t// ここでは簡易的に空のconfigで生成\r\n\t\t\tconst childConfig = {};\r\n\t\t\tthis.childManager = new WindowManager(childConfig);\r\n\r\n\t\t\t// 子マネージャのコンテナとして、このウィンドウのcontentElを指定\r\n\t\t\tthis.childManager.applyGlobalConfig({ container: this.contentEl });\r\n\t\t\tthis.childManager.init();\r\n\t\t}\r\n\t\treturn this.childManager;\r\n\t}\r\n\r\n\t/**\r\n\t * ステータスバーのテキストを更新します。\r\n\t */\r\n\tpublic setStatusBarText(text: string): void {\r\n\t\tif (this.statusBarEl) {\r\n\t\t\tif (this.options.statusBar.allowHTML) {\r\n\t\t\t\tthis.statusBarEl.innerHTML = text;\r\n\t\t\t} else {\r\n\t\t\t\tthis.statusBarEl.textContent = text;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ウィンドウ内検索UIを開きます。\r\n\t */\r\n\tpublic openSearch(): void {\r\n\t\tif (this.searchBarEl) {\r\n\t\t\tconst input = this.searchBarEl.querySelector<HTMLInputElement>(`.${LIBRARY_NAME}-search-input`);\r\n\t\t\tinput?.focus();\r\n\t\t\tinput?.select();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.searchBarEl = document.createElement(\"div\");\r\n\t\tthis.searchBarEl.className = `${LIBRARY_NAME}-search-bar`;\r\n\r\n\t\tconst s = this.options.search;\r\n\t\tconst caseBtn = s.showCaseSensitiveButton ? `<button class=\"${LIBRARY_NAME}-search-btn\" data-action=\"case-sensitive\" title=\"Case Sensitive\">Aa</button>` : \"\";\r\n\t\tconst regexBtn = s.showRegexButton ? `<button class=\"${LIBRARY_NAME}-search-btn\" data-action=\"regex\" title=\"Use Regular Expression\">.*</button>` : \"\";\r\n\t\tconst wordBtn = s.showWholeWordButton ? `<button class=\"${LIBRARY_NAME}-search-btn\" data-action=\"whole-word\" title=\"Match Whole Word\">ab</button>` : \"\";\r\n\r\n\t\tthis.searchBarEl.innerHTML = `\r\n\t\t\t<input type=\"text\" class=\"${LIBRARY_NAME}-search-input\" placeholder=\"Search...\">\r\n\t\t\t<span class=\"${LIBRARY_NAME}-search-results\">0/0</span>\r\n\t\t\t${caseBtn}\r\n\t\t\t${regexBtn}\r\n\t\t\t${wordBtn}\r\n\t\t\t<button class=\"${LIBRARY_NAME}-search-btn\" data-action=\"prev\" title=\"Previous Match\">&uarr;</button>\r\n\t\t\t<button class=\"${LIBRARY_NAME}-search-btn\" data-action=\"next\" title=\"Next Match\">&darr;</button>\r\n\t\t\t<button class=\"${LIBRARY_NAME}-search-btn\" data-action=\"close\" title=\"Close\">&times;</button>\r\n\t\t`;\r\n\r\n\t\tthis.contentEl.insertBefore(this.searchBarEl, this.contentEl.firstChild);\r\n\r\n\t\t// ボタンのアクティブ状態を反映\r\n\t\tthis.updateSearchButtonState();\r\n\r\n\t\tconst input = this.searchBarEl.querySelector<HTMLInputElement>(`.${LIBRARY_NAME}-search-input`)!;\r\n\t\tinput.focus();\r\n\r\n\t\tinput.addEventListener(\"input\", () => this._performSearch(), { passive: true });\r\n\t\tinput.addEventListener(\r\n\t\t\t\"keydown\",\r\n\t\t\t(e) => {\r\n\t\t\t\tif (e.key === \"Enter\") {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tif (e.shiftKey) {\r\n\t\t\t\t\t\tthis.navigateSearch(\"prev\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.navigateSearch(\"next\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\r\n\t\tthis.searchBarEl.addEventListener(\r\n\t\t\t\"click\",\r\n\t\t\t(e) => {\r\n\t\t\t\tconst target = e.target as HTMLElement;\r\n\t\t\t\tconst button = target.closest<HTMLElement>(\"[data-action]\");\r\n\t\t\t\tif (!button) return;\r\n\t\t\t\tconst action = button.dataset.action;\r\n\r\n\t\t\t\tswitch (action) {\r\n\t\t\t\t\tcase \"close\":\r\n\t\t\t\t\t\tthis.closeSearch();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"prev\":\r\n\t\t\t\t\t\tthis.navigateSearch(\"prev\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"next\":\r\n\t\t\t\t\t\tthis.navigateSearch(\"next\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"case-sensitive\":\r\n\t\t\t\t\t\tthis.searchOptionsState.caseSensitive = !this.searchOptionsState.caseSensitive;\r\n\t\t\t\t\t\tthis.updateSearchButtonState(button, this.searchOptionsState.caseSensitive);\r\n\t\t\t\t\t\tthis._performSearch();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"regex\":\r\n\t\t\t\t\t\tthis.searchOptionsState.regex = !this.searchOptionsState.regex;\r\n\t\t\t\t\t\tthis.updateSearchButtonState(button, this.searchOptionsState.regex);\r\n\t\t\t\t\t\tthis._performSearch();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"whole-word\":\r\n\t\t\t\t\t\tthis.searchOptionsState.wholeWord = !this.searchOptionsState.wholeWord;\r\n\t\t\t\t\t\tthis.updateSearchButtonState(button, this.searchOptionsState.wholeWord);\r\n\t\t\t\t\t\tthis._performSearch();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: true }\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * ウィンドウ内検索UIを閉じます。\r\n\t */\r\n\tpublic closeSearch(): void {\r\n\t\tif (this.searchBarEl) {\r\n\t\t\tthis.clearSearchHighlights();\r\n\t\t\tthis.searchBarEl.remove();\r\n\t\t\tthis.searchBarEl = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate navigateSearch(direction: \"next\" | \"prev\"): void {\r\n\t\tif (this.searchResults.length === 0) return;\r\n\r\n\t\tif (direction === \"next\") {\r\n\t\t\tthis.currentSearchIndex = (this.currentSearchIndex + 1) % this.searchResults.length;\r\n\t\t} else {\r\n\t\t\tthis.currentSearchIndex = (this.currentSearchIndex - 1 + this.searchResults.length) % this.searchResults.length;\r\n\t\t}\r\n\t\tthis.updateSearchResults(this.currentSearchIndex + 1, this.searchResults.length);\r\n\t\tthis.highlightCurrentResult();\r\n\t}\r\n\r\n\tprivate highlightCurrentResult(): void {\r\n\t\tthis.searchResults.forEach((el, index) => {\r\n\t\t\tel.classList.toggle(`${LIBRARY_NAME}-search-highlight-active`, index === this.currentSearchIndex);\r\n\t\t});\r\n\t\tif (this.currentSearchIndex > -1) {\r\n\t\t\tthis.searchResults[this.currentSearchIndex].scrollIntoView({\r\n\t\t\t\tbehavior: \"instant\",\r\n\t\t\t\tblock: \"nearest\",\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate clearSearchHighlights(): void {\r\n\t\t// 検索対象は動的に変わるため、ハイライト解除はウィンドウ全体を対象に行う\r\n\t\tconst allContentAreas = this.el.querySelectorAll(`.${LIBRARY_NAME}-content, .${LIBRARY_NAME}-split-pane`);\r\n\t\tallContentAreas.forEach((area) => {\r\n\t\t\tconst highlights = area.querySelectorAll<HTMLElement>(`.${LIBRARY_NAME}-search-highlight`);\r\n\t\t\thighlights.forEach((el) => {\r\n\t\t\t\tconst parent = el.parentNode;\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\tparent.replaceChild(document.createTextNode(el.textContent || \"\"), el);\r\n\t\t\t\t\tparent.normalize(); // 隣接するテキストノードを結合\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.searchResults = [];\r\n\t\tthis.currentSearchIndex = -1;\r\n\t}\r\n\r\n\tprivate updateSearchResults(current: number, total: number): void {\r\n\t\tif (this.searchBarEl) {\r\n\t\t\tconst resultsEl = this.searchBarEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-search-results`)!;\r\n\t\t\tresultsEl.textContent = `${total > 0 ? current : 0}/${total}`;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _performSearch(): void {\r\n\t\tif (!this.searchBarEl) return;\r\n\t\tthis.clearSearchHighlights();\r\n\r\n\t\tconst input = this.searchBarEl.querySelector<HTMLInputElement>(`.${LIBRARY_NAME}-search-input`)!;\r\n\t\tlet query = input.value;\r\n\r\n\t\tif (query.length < 1) {\r\n\t\t\tthis.updateSearchResults(0, 0);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet searchRoot: Element | null = this.contentEl;\r\n\t\tconst activeTabIndex = this.tabs.findIndex((tab) => tab.tabEl.classList.contains(`${LIBRARY_NAME}-active`));\r\n\t\tif (this.options.tabs.length > 0 && activeTabIndex !== -1 && this.tabs[activeTabIndex]) {\r\n\t\t\tsearchRoot = this.tabs[activeTabIndex].contentEl;\r\n\t\t}\r\n\t\tif (!searchRoot) return;\r\n\r\n\t\tconst contentArea = this.options.search.targetSelector ? searchRoot.querySelector(this.options.search.targetSelector) : searchRoot;\r\n\t\tif (!contentArea) return;\r\n\r\n\t\tif (!this.searchOptionsState.regex) {\r\n\t\t\tquery = Utils.escapeRegex(query);\r\n\t\t}\r\n\t\tif (this.searchOptionsState.wholeWord) {\r\n\t\t\tquery = `\\\\b${query}\\\\b`;\r\n\t\t}\r\n\r\n\t\tlet regex: RegExp;\r\n\t\ttry {\r\n\t\t\tregex = new RegExp(query, this.searchOptionsState.caseSensitive ? \"g\" : \"gi\");\r\n\t\t\tinput.style.borderColor = \"\";\r\n\t\t} catch (e) {\r\n\t\t\t// 不正な正規表現の場合は何もしない\r\n\t\t\tinput.style.borderColor = \"red\";\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst newHighlights: HTMLElement[] = [];\r\n\t\tconst nodesToModify: { node: Text; matches: RegExpMatchArray }[] = [];\r\n\r\n\t\tconst walker = document.createTreeWalker(contentArea, NodeFilter.SHOW_TEXT, (node) => {\r\n\t\t\t// スクリプトやスタイル、既存のハイライトの中は検索しない\r\n\t\t\treturn node.parentElement?.tagName === \"SCRIPT\" || node.parentElement?.tagName === \"STYLE\" || node.parentElement?.classList.contains(`${LIBRARY_NAME}-search-highlight`) ? NodeFilter.FILTER_REJECT : NodeFilter.FILTER_ACCEPT;\r\n\t\t});\r\n\r\n\t\tlet currentNode: Node | null;\r\n\t\twhile ((currentNode = walker.nextNode())) {\r\n\t\t\tconst textNode = currentNode as Text;\r\n\t\t\t// 空のテキストノードは無視\r\n\t\t\tif (!textNode.textContent?.trim()) continue;\r\n\t\t\tconst matches = textNode.textContent.match(regex);\r\n\t\t\tif (matches) {\r\n\t\t\t\tnodesToModify.push({ node: textNode, matches });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// DOMの変更処理\r\n\t\tfor (const { node, matches } of nodesToModify) {\r\n\t\t\tconst parent = node.parentNode;\r\n\t\t\tif (!parent) continue;\r\n\r\n\t\t\tconst parts = node.textContent!.split(regex);\r\n\r\n\t\t\tparts.forEach((part, i) => {\r\n\t\t\t\tif (part) {\r\n\t\t\t\t\tparent.insertBefore(document.createTextNode(part), node);\r\n\t\t\t\t}\r\n\t\t\t\tif (i < matches.length) {\r\n\t\t\t\t\tconst highlight = document.createElement(\"span\");\r\n\t\t\t\t\thighlight.className = `${LIBRARY_NAME}-search-highlight`;\r\n\t\t\t\t\thighlight.textContent = matches[i];\r\n\t\t\t\t\tparent.insertBefore(highlight, node);\r\n\t\t\t\t\tnewHighlights.push(highlight);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tparent.removeChild(node);\r\n\t\t}\r\n\r\n\t\tthis.searchResults = newHighlights;\r\n\t\tthis.currentSearchIndex = this.searchResults.length > 0 ? 0 : -1;\r\n\t\tthis.updateSearchResults(this.currentSearchIndex + 1, this.searchResults.length);\r\n\t\tthis.highlightCurrentResult();\r\n\t}\r\n\r\n\tprivate updateSearchButtonState(button?: HTMLElement, isActive?: boolean): void {\r\n\t\tif (!this.searchBarEl) return;\r\n\t\tif (button && typeof isActive === \"boolean\") {\r\n\t\t\tbutton.classList.toggle(`${LIBRARY_NAME}-search-btn-active`, isActive);\r\n\t\t} else {\r\n\t\t\t// 初期化用\r\n\t\t\tconst s = this.searchOptionsState;\r\n\t\t\tconst caseBtn = this.searchBarEl.querySelector(`[data-action=\"case-sensitive\"]`);\r\n\t\t\tconst regexBtn = this.searchBarEl.querySelector(`[data-action=\"regex\"]`);\r\n\t\t\tconst wordBtn = this.searchBarEl.querySelector(`[data-action=\"whole-word\"]`);\r\n\t\t\tcaseBtn?.classList.toggle(`${LIBRARY_NAME}-search-btn-active`, s.caseSensitive);\r\n\t\t\tregexBtn?.classList.toggle(`${LIBRARY_NAME}-search-btn-active`, s.regex);\r\n\t\t\twordBtn?.classList.toggle(`${LIBRARY_NAME}-search-btn-active`, s.wholeWord);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * このウィンドウ内に新しいウィンドウを作成します。\r\n\t */\r\n\tpublic createWindow(options: WindowOptions = {}): IWindow {\r\n\t\t// iframeコンテンツの場合は、直接DOM操作する代わりにpostMessageを使用\r\n\t\tconst iframe = this.contentEl.querySelector(\"iframe\");\r\n\t\tif (iframe && iframe.contentWindow) {\r\n\t\t\tconst message = {\r\n\t\t\t\ttype: \"winlet:createWindow\",\r\n\t\t\t\toptions: options,\r\n\t\t\t};\r\n\t\t\t// iframeのオリジンを尊重\r\n\t\t\tiframe.contentWindow.postMessage(message, \"*\");\r\n\t\t\t// postMessageでは直接インスタンスを返せないため、暫定的にnullを返すか、Promiseベースの設計にする必要がある\r\n\t\t\t// ここでは未対応とし、コンソールに警告を出す\r\n\t\t\tconsole.warn(\"WinLet: Window creation inside an iframe is asynchronous and does not return an instance directly.\");\r\n\t\t\t// ダミーのインスタンスを返すか、APIの戻り値をvoidにするなどの検討が必要\r\n\t\t\treturn null as any; // 暫定\r\n\t\t}\r\n\r\n\t\t// 通常のHTMLコンテンツの場合\r\n\t\tconst manager = this.getChildManager();\r\n\t\t// 新しいウィンドウに自身を親として設定\r\n\t\toptions._parent = this;\r\n\t\treturn manager.createWindow(options);\r\n\t}\r\n\r\n\t/**\r\n\t * このウィンドウ内に新しいポップアップを作成します。\r\n\t */\r\n\tpublic createPopup(options: PopupOptions): IWindow {\r\n\t\tconst manager = this.getChildManager();\r\n\t\t// ポップアップにも自身を親として設定\r\n\t\tconst winOptions: WindowOptions = { _parent: this };\r\n\t\treturn manager.popup(Object.assign(options, winOptions));\r\n\t}\r\n\r\n\tpublic createAsyncPopup(options: PopupOptions): Promise<PopupResult> {\r\n\t\tconst manager = this.getChildManager();\r\n\t\tconst popupOptionsWithParent = { ...options, _parent: this };\r\n\t\treturn manager.popupAsync(popupOptionsWithParent);\r\n\t}\r\n\r\n\tpublic async capture(): Promise<string> {\r\n\t\t// HTML2Canvasがロードされているかどうかを確認します（例：CDN経由）\r\n\t\tif (typeof window.html2canvas !== \"function\") {\r\n\t\t\tconst e = new WinLetError(\"The capture() feature requires the 'html2canvas' library. Please include it from a CDN to use this feature. https://html2canvas.hertzen.com/\");\r\n\t\t\tconsole.warn(e);\r\n\t\t\treturn Promise.reject(e);\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst canvas = await window.html2canvas(this.el, {\r\n\t\t\t\tallowTaint: true,\r\n\t\t\t\tuseCORS: true,\r\n\t\t\t\tlogging: false,\r\n\t\t\t\tonclone: (clonedDoc: Document) => {\r\n\t\t\t\t\t// 一時的なUI要素のキャプチャを避けるため\r\n\t\t\t\t\tclonedDoc.querySelector(`#${this.id}`)?.classList.remove(`${LIBRARY_NAME}-is-resizing`, `${LIBRARY_NAME}-is-dragging`);\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\treturn canvas.toDataURL(\"image/png\");\r\n\t\t} catch (error: any) {\r\n\t\t\tconst e = new WinLetError(`html2canvas failed to capture the window. Error: ${error.message}`);\r\n\t\t\te.stack += \"\\n\\n--- Caused by ---\\n\" + error.stack;\r\n\t\t\tconsole.error(e);\r\n\t\t\treturn Promise.reject(e);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic print(): void {\r\n\t\tconst contentSource = this.getContent();\r\n\r\n\t\t// コンテンツがiframeの場合は、直接印刷\r\n\t\tif (contentSource.tagName === \"IFRAME\") {\r\n\t\t\tconst iframe = contentSource as HTMLIFrameElement;\r\n\t\t\ttry {\r\n\t\t\t\t// 印刷する前にiframeが完全にロードされていることを確認\r\n\t\t\t\tif (document.readyState === \"complete\") {\r\n\t\t\t\t\tiframe.contentWindow?.print();\r\n\t\t\t\t} else {\r\n\t\t\t\t\twindow.addEventListener(\"load\", () => {\r\n\t\t\t\t\t\tiframe.contentWindow?.print();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"WinLet: Could not print iframe content, possibly due to cross-origin restrictions.\", e);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst size = this.getSize();\r\n\r\n\t\t// HTMLコンテンツの場合、印刷する一時的なiframeを作成します。\r\n\t\tconst printFrame = document.createElement(\"iframe\");\r\n\t\tprintFrame.style.position = \"absolute\";\r\n\t\tprintFrame.style.opacity = \"0.01\";\r\n\t\tprintFrame.style.border = \"0\";\r\n\t\tprintFrame.style.top = \"0\";\r\n\t\tprintFrame.style.left = \"0\";\r\n\t\tprintFrame.style.width = size.width + \"px\";\r\n\t\tprintFrame.style.height = size.height + \"px\";\r\n\t\tprintFrame.style.zIndex = \"1\";\r\n\t\tprintFrame.style.transform = \"scale(0.5)\";\r\n\t\tprintFrame.style.pointerEvents = \"none\";\r\n\t\tprintFrame.setAttribute(\"inert\", \"\");\r\n\t\tdocument.body.appendChild(printFrame);\r\n\r\n\t\tconst frameDoc = printFrame.contentWindow?.document;\r\n\t\tif (!frameDoc) {\r\n\t\t\tconsole.error(\"WinLet: Could not create a document for printing.\");\r\n\t\t\tdocument.body.removeChild(printFrame);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tframeDoc.open();\r\n\t\tframeDoc.write(\"<!DOCTYPE html><html><head>\");\r\n\t\tframeDoc.write(`<title>${this.getTitle()}</title>`);\r\n\r\n\t\t// メインドキュメントから印刷iframeにスタイルをコピーします\r\n\t\tconst styles = document.querySelectorAll('style, link[rel=\"stylesheet\"]');\r\n\t\tstyles.forEach((style) => {\r\n\t\t\tframeDoc.write(style.outerHTML);\r\n\t\t});\r\n\r\n\t\tframeDoc.write(\"</head><body>\");\r\n\t\tframeDoc.write(contentSource.innerHTML);\r\n\t\tframeDoc.write(\"</body></html>\");\r\n\t\tframeDoc.close();\r\n\r\n\t\tconst doPrint = async () => {\r\n\t\t\tawait new Promise((resolve) => setTimeout(resolve, 300));\r\n\t\t\ttry {\r\n\t\t\t\tprintFrame.contentWindow?.focus();\r\n\t\t\t\tprintFrame.contentWindow?.print();\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"WinLet: Printing failed.\", e);\r\n\t\t\t} finally {\r\n\t\t\t\t// 印刷ダイアログが閉じられた後にiframeが削除されます（またはキャンセルされます）\r\n\t\t\t\t// タイムアウトを使用すると、印刷ダイアログが適切に開くことができます\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tdocument.body.removeChild(printFrame);\r\n\t\t\t\t}, 500);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (printFrame.contentWindow?.document.readyState === \"complete\") {\r\n\t\t\tdoPrint();\r\n\t\t} else {\r\n\t\t\tprintFrame.contentWindow?.addEventListener(\"load\", doPrint);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getTitle(): string {\r\n\t\treturn this.options.title;\r\n\t}\r\n\r\n\tpublic setTitle(title: string): void {\r\n\t\tthis.options.title = title;\r\n\t\tthis.titleEl.textContent = Utils.sanitizeHTML(title);\r\n\t\tthis.titleEl.setAttribute(\"aria-label\", Utils.sanitizeHTML(title));\r\n\t\tthis.manager.updateTaskbarItem(this, \"titleChanged\");\r\n\t}\r\n\r\n\tpublic setIcon(icon: string | null): void {\r\n\t\tthis.options.icon = icon;\r\n\t\tthis.iconEl.innerHTML = \"\";\r\n\t\tif (!icon) {\r\n\t\t\tthis.manager.updateTaskbarItem(this, \"iconChanged\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this.isFontAwesome(icon)) {\r\n\t\t\tconst i = document.createElement(\"i\");\r\n\t\t\ti.className = icon;\r\n\t\t\tthis.iconEl.appendChild(i);\r\n\t\t} else {\r\n\t\t\tconst img = document.createElement(\"img\");\r\n\t\t\timg.src = icon;\r\n\t\t\timg.alt = \"window icon\";\r\n\t\t\tthis.iconEl.appendChild(img);\r\n\t\t}\r\n\t\tthis.manager.updateTaskbarItem(this, \"iconChanged\");\r\n\t}\r\n\r\n\tpublic getPosition(): { x: number; y: number } {\r\n\t\tif (this.state === \"maximized\") {\r\n\t\t\treturn { x: this.lastState.x, y: this.lastState.y };\r\n\t\t}\r\n\t\treturn { x: this.el.offsetLeft, y: this.el.offsetTop };\r\n\t}\r\n\r\n\tpublic setPosition(x: number | \"center\" | \"left\" | \"right\", y: number | \"center\" | \"top\" | \"bottom\"): void {\r\n\t\t// containerが存在しない（初期化前）場合は処理を中断\r\n\t\tif (!this.manager.container) {\r\n\t\t\tconsole.warn(\"WinLet Warning: setPosition called before manager is initialized.\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst parentRect = this.manager.container.getBoundingClientRect();\r\n\t\tconst winWidth = this.el.offsetWidth;\r\n\t\tconst winHeight = this.el.offsetHeight;\r\n\r\n\t\tlet finalX: number;\r\n\t\tlet finalY: number;\r\n\r\n\t\t// X座標の計算\r\n\t\tswitch (x) {\r\n\t\t\tcase \"left\":\r\n\t\t\t\tfinalX = 0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"center\":\r\n\t\t\t\tfinalX = (parentRect.width - winWidth) / 2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"right\":\r\n\t\t\t\tfinalX = parentRect.width - winWidth;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tfinalX = x as number;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t// Y座標の計算\r\n\t\tswitch (y) {\r\n\t\t\tcase \"top\":\r\n\t\t\t\tfinalY = 0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"center\":\r\n\t\t\t\tfinalY = (parentRect.height - winHeight) / 2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"bottom\":\r\n\t\t\t\tfinalY = parentRect.height - winHeight;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tfinalY = y as number;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t// 画面外にはみ出さないようにする既存のロジックを適用\r\n\t\tthis.el.style.left = `${Math.min(Math.max(150 - winWidth, finalX), parentRect.width - 150)}px`;\r\n\t\tthis.el.style.top = `${Math.min(Math.max(0, finalY), parentRect.height - 50)}px`;\r\n\t\tthis.updateDebugOverlay();\r\n\t}\r\n\r\n\tpublic getSize(): { width: number; height: number } {\r\n\t\tif (this.state === \"maximized\") {\r\n\t\t\treturn { width: this.lastState.width, height: this.lastState.height };\r\n\t\t}\r\n\t\treturn { width: this.el.offsetWidth, height: this.el.offsetHeight };\r\n\t}\r\n\r\n\tpublic setSize(width: number | string, height: number | string): void {\r\n\t\tthis.el.style.width = typeof width === \"number\" ? `${width}px` : width;\r\n\t\tthis.el.style.height = typeof height === \"number\" ? `${height}px` : height;\r\n\t\tthis.updateDebugOverlay();\r\n\t}\r\n\r\n\tpublic setOpacity(opacity: number): void {\r\n\t\tconst clampedOpacity = Math.max(0, Math.min(1, opacity));\r\n\t\tthis.options.windowOptions.opacity = clampedOpacity;\r\n\t\tthis.el.style.opacity = clampedOpacity.toString();\r\n\t}\r\n\r\n\tpublic getOpacity(): number {\r\n\t\treturn this.options.windowOptions.opacity!;\r\n\t}\r\n\r\n\tpublic setOptions(options: Partial<WindowOptions>): void {\r\n\t\t// ifExists\r\n\t\tif (typeof options.ifExists === \"boolean\") {\r\n\t\t\tthis.options.ifExists = options.ifExists;\r\n\t\t}\r\n\t\t// タイトル\r\n\t\tif (typeof options.title === \"string\") {\r\n\t\t\tthis.setTitle(options.title);\r\n\t\t}\r\n\t\t// アイコン\r\n\t\tif (typeof options.icon === \"string\" || options.icon === null) {\r\n\t\t\tthis.setIcon(options.icon);\r\n\t\t}\r\n\t\t// 位置\r\n\t\tlet x: number | \"center\" | \"left\" | \"right\" | null = null;\r\n\t\tif (typeof options.x === \"number\" || options.x === \"center\" || options.x === \"left\" || options.x === \"right\") {\r\n\t\t\tx = options.x;\r\n\t\t}\r\n\t\tlet y: number | \"center\" | \"top\" | \"bottom\" | null = null;\r\n\t\tif (typeof options.y === \"number\" || options.y === \"center\" || options.y === \"top\" || options.y === \"bottom\") {\r\n\t\t\ty = options.y;\r\n\t\t}\r\n\t\tif (x !== null || y !== null) {\r\n\t\t\tif (x === null) {\r\n\t\t\t\tx = this.getPosition().x;\r\n\t\t\t}\r\n\t\t\tif (y === null) {\r\n\t\t\t\ty = this.getPosition().y;\r\n\t\t\t}\r\n\t\t\tthis.setPosition(x, y);\r\n\t\t}\r\n\t\t// サイズ\r\n\t\tlet width: number | string | null = null;\r\n\t\tif (typeof options.width === \"number\" || typeof options.width === \"string\") {\r\n\t\t\twidth = options.width;\r\n\t\t}\r\n\t\tlet height: number | string | null = null;\r\n\t\tif (typeof options.height === \"number\" || typeof options.height === \"string\") {\r\n\t\t\theight = options.height;\r\n\t\t}\r\n\t\tif (width !== null || height !== null) {\r\n\t\t\tif (width === null) {\r\n\t\t\t\twidth = this.getSize().width;\r\n\t\t\t}\r\n\t\t\tif (height === null) {\r\n\t\t\t\theight = this.getSize().height;\r\n\t\t\t}\r\n\t\t\tthis.setSize(width, height);\r\n\t\t}\r\n\r\n\t\tconst windowOptions = options.windowOptions || {};\r\n\r\n\t\t// 不透明度\r\n\t\tif (typeof windowOptions.opacity === \"number\") {\r\n\t\t\tthis.setOpacity(windowOptions.opacity);\r\n\t\t}\r\n\t\t// 常に手前に表示\r\n\t\tif (typeof windowOptions.alwaysOnTop === \"boolean\") {\r\n\t\t\tthis.options.windowOptions.alwaysOnTop = windowOptions.alwaysOnTop;\r\n\t\t\tthis.el.classList.toggle(`${LIBRARY_NAME}-always-on-top`, windowOptions.alwaysOnTop);\r\n\t\t\t// z-indexを再評価するためにフォーカスする\r\n\t\t\tthis.focus();\r\n\t\t}\r\n\t\t// ゴーストウィンドウ\r\n\t\tif (typeof windowOptions.useGhostWindow === \"boolean\") {\r\n\t\t\tthis.options.windowOptions.useGhostWindow = windowOptions.useGhostWindow;\r\n\t\t}\r\n\t}\r\n}\r\n",
    "// src/WindowManager.ts\r\n\r\nimport { defaultConfig } from \"../const/config\";\r\nimport { WinLetError } from \"../const/errors\";\r\nimport { ContextMenuItem, GlobalConfigOptions, GlobalEventMap, IWindow, LIBRARY_NAME, MenuItem, PopupButton, PopupButtonPreset, PopupOptions, PopupResult, TabItem, Theme, TIMEOUT_RESULT, WindowOptions } from \"../const/types\";\r\nimport WinLetBaseClass from \"../libs/baseclass\";\r\nimport Utils from \"../libs/utils\";\r\nimport styleData from \"../style/styles\";\r\nimport { darkTheme } from \"../style/themes/dark\";\r\nimport { defaultTheme } from \"../style/themes/default\";\r\nimport { highContrastTheme } from \"../style/themes/high-contrast\";\r\nimport WinLetWindow from \"./window\";\r\n\r\nexport default class WindowManager extends WinLetBaseClass<GlobalEventMap> {\r\n\tpublic container: HTMLElement | null = null;\r\n\tprivate workspaceEl: HTMLElement | null = null;\r\n\tprivate static allWindows = new Map<string, WinLetWindow>();\r\n\tprivate windows = new Map<string, WinLetWindow>();\r\n\t// z-indexを通常と最前面で分離\r\n\tprivate zIndexCounter = 1000;\r\n\tprivate zIndexCounterOnTop = 50000;\r\n\tprivate activeWindow: WinLetWindow | null = null;\r\n\tprivate contextMenuEl: HTMLElement | null = null;\r\n\tprivate _isInitialized = false;\r\n\r\n\tprivate globalConfig: GlobalConfigOptions;\r\n\r\n\tprivate lastAutoPosition: { x: number; y: number } | null = null;\r\n\tprivate lastPopupPosition: { x: number; y: number } | null = null;\r\n\tprivate readonly CASCADE_OFFSET = 30;\r\n\r\n\tpublic draggingTabInfo: { sourceWindowId: string } | null = null;\r\n\r\n\tprivate taskbarEl: HTMLElement | null = null;\r\n\tprivate themes = new Map<string, Theme>();\r\n\tprivate activeTheme: Theme | null = null;\r\n\tprivate boundTabPressHandler: ((e: KeyboardEvent) => void) | null = null;\r\n\r\n\tprivate bootstrapThemeObserver: MutationObserver | null = null;\r\n\tprivate prefersDarkMatcher: MediaQueryList | null = null;\r\n\tprivate prefersColorSchemeListener: ((e: MediaQueryListEvent) => void) | null = null;\r\n\r\n\tprivate highContrastMatcher: MediaQueryList | null = null;\r\n\tprivate highContrastListener: ((e: MediaQueryListEvent) => void) | null = null;\r\n\r\n\tconstructor(initialConfig: GlobalConfigOptions) {\r\n\t\tsuper();\r\n\t\tthis.globalConfig = initialConfig;\r\n\t\tthis.registerTheme(defaultTheme);\r\n\t\tthis.registerTheme(darkTheme);\r\n\t\tthis.registerTheme(highContrastTheme);\r\n\t}\r\n\r\n\t/**\r\n\t * ライブラリが初期化済みかどうかを取得します。\r\n\t */\r\n\tpublic get isInitialized(): boolean {\r\n\t\treturn this._isInitialized;\r\n\t}\r\n\r\n\tpublic applyGlobalConfig(options: GlobalConfigOptions) {\r\n\t\tObject.assign(this.globalConfig, options);\r\n\t\t// アニメーション設定をコンテナクラスに反映\r\n\t\tif (this.container) {\r\n\t\t\tthis.container.classList.toggle(`${LIBRARY_NAME}-animations-disabled`, !this.globalConfig.enableAnimations);\r\n\t\t\tthis.container.classList.toggle(`${LIBRARY_NAME}-debug-mode-enabled`, !!this.globalConfig.enableDebugMode);\r\n\r\n\t\t\t// タスクバーの有効・無効切り替えとレイアウト更新\r\n\t\t\tif (this.globalConfig.enableTaskbar) {\r\n\t\t\t\tif (!this.taskbarEl) {\r\n\t\t\t\t\t// タスクバーがなければ作成\r\n\t\t\t\t\tthis.createTaskbar();\r\n\t\t\t\t}\r\n\t\t\t\tthis.updateTaskbarLayout();\r\n\t\t\t} else if (this.taskbarEl) {\r\n\t\t\t\t// 無効化された場合\r\n\t\t\t\tthis.taskbarEl.remove();\r\n\t\t\t\tthis.taskbarEl = null;\r\n\t\t\t\t// flex-directionをリセット\r\n\t\t\t\tthis.container.style.flexDirection = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Bootstrapテーマ監視の開始/停止\r\n\t\tif (this.globalConfig.autoDetectBootstrapTheme) {\r\n\t\t\tthis.startBootstrapThemeObserver();\r\n\t\t} else {\r\n\t\t\tthis.stopBootstrapThemeObserver();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getGlobalConfig(): GlobalConfigOptions {\r\n\t\treturn this.globalConfig;\r\n\t}\r\n\r\n\tpublic init(): void {\r\n\t\tif (this._isInitialized) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet parentEl: HTMLElement | null = null;\r\n\t\tif (typeof this.globalConfig.container === \"string\") {\r\n\t\t\tparentEl = document.querySelector<HTMLElement>(this.globalConfig.container);\r\n\t\t\tif (!parentEl) {\r\n\t\t\t\tthrow new WinLetError(`WinLet: The specified container \"${this.globalConfig.container}\" was not found.`);\r\n\t\t\t}\r\n\t\t} else if (this.globalConfig.container instanceof HTMLElement) {\r\n\t\t\tparentEl = this.globalConfig.container;\r\n\t\t}\r\n\r\n\t\t// 親が指定されていない場合は、デフォルトでbodyに設定\r\n\t\tif (!parentEl) {\r\n\t\t\tif (!document.body) {\r\n\t\t\t\tthrow new WinLetError(\"Cannot initialize before document.body is ready. Please call WinLet.init() after DOMContentLoaded.\");\r\n\t\t\t}\r\n\t\t\tparentEl = document.body;\r\n\t\t}\r\n\r\n\t\tif (!document.getElementById(`${LIBRARY_NAME}-styles`)) {\r\n\t\t\tconst styleTag = document.createElement(\"style\");\r\n\t\t\tstyleTag.id = `${LIBRARY_NAME}-styles`;\r\n\t\t\tstyleTag.innerHTML = this.getStyleData();\r\n\t\t\tdocument.head.appendChild(styleTag);\r\n\t\t}\r\n\t\tlet containerEl = parentEl.querySelector<HTMLElement>(`.${LIBRARY_NAME}-container`);\r\n\t\tif (!containerEl) {\r\n\t\t\tcontainerEl = document.createElement(\"div\");\r\n\t\t\tcontainerEl.className = `${LIBRARY_NAME}-container`;\r\n\t\t\tparentEl.appendChild(containerEl);\r\n\t\t}\r\n\t\tthis.container = containerEl;\r\n\r\n\t\tthis.workspaceEl = document.createElement(\"div\");\r\n\t\tthis.workspaceEl.className = `${LIBRARY_NAME}-workspace`;\r\n\t\tthis.container.appendChild(this.workspaceEl);\r\n\r\n\t\t// 初期設定を適用\r\n\t\tthis.applyGlobalConfig(this.globalConfig);\r\n\r\n\t\tif (parentEl !== document.body) {\r\n\t\t\tthis.container.classList.add(`${LIBRARY_NAME}-is-nested`);\r\n\r\n\t\t\t// 親がポジショニングコンテキストとして機能できることを確認\r\n\t\t\tconst computedStyle = window.getComputedStyle(parentEl);\r\n\t\t\tif (computedStyle.position === \"static\") {\r\n\t\t\t\tparentEl.style.position = \"relative\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.globalConfig.enableTaskbar) {\r\n\t\t\tif (!this.taskbarEl) {\r\n\t\t\t\t// タスクバーがなければ作成\r\n\t\t\t\tthis.createTaskbar();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.globalConfig.theme) {\r\n\t\t\tthis.setTheme(this.globalConfig.theme);\r\n\t\t} else {\r\n\t\t\tthis.setTheme(\"default\");\r\n\t\t}\r\n\r\n\t\t(async () => await this.updateVirtualization())();\r\n\r\n\t\twindow.addEventListener(\"blur\", () =>\r\n\t\t\t// 次のイベントサイクルでアクティブな要素を取得\r\n\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\tconst activeEl = document.activeElement;\r\n\t\t\t\t// フォーカスがiframeに移った場合\r\n\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\r\n\t\t\t\t\t// そのiframeがWinLetのウィンドウ内にあるか探索\r\n\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\r\n\t\t\t\t\tif (winEl) {\r\n\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\r\n\t\t\t\t\t\t// 対象のウィンドウが存在し、まだアクティブでなければフォーカスする\r\n\t\t\t\t\t\tif (win && this.activeWindow !== win) {\r\n\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t\tdocument.addEventListener(\r\n\t\t\t\"pointerdown\",\r\n\t\t\t() =>\r\n\t\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\t\tconst activeEl = document.activeElement;\r\n\t\t\t\t\tif (activeEl?.tagName === \"IFRAME\") {\r\n\t\t\t\t\t\tconst winEl = (activeEl as HTMLElement).closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\r\n\t\t\t\t\t\tif (winEl) {\r\n\t\t\t\t\t\t\tconst win = this.windows.get(winEl.id);\r\n\t\t\t\t\t\t\tif (win && this.activeWindow !== win) {\r\n\t\t\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\ttrue\r\n\t\t);\r\n\r\n\t\t// ウィンドウ外クリックでblurさせる処理を追加\r\n\t\tdocument.addEventListener(\"pointerdown\", (e: PointerEvent) => {\r\n\t\t\tif (!(e.target instanceof HTMLElement)) return;\r\n\r\n\t\t\tconst clickedContextMenu = e.target.closest(`.${LIBRARY_NAME}-context-menu`);\r\n\r\n\t\t\t// コンテキストメニュー以外の場所がクリックされた場合、メニューを閉じる\r\n\t\t\tif (!clickedContextMenu) {\r\n\t\t\t\tthis.hideContextMenu();\r\n\t\t\t}\r\n\r\n\t\t\t// アクティブなウィンドウがない、またはモーダルウィンドウの場合は何もしない\r\n\t\t\tif (!this.activeWindow || this.activeWindow.options.windowOptions.modal) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// クリックされた場所がウィンドウまたはタスクバーの内側かどうかを判定\r\n\t\t\tconst clickedWindow = e.target.closest(`.${LIBRARY_NAME}-window`);\r\n\t\t\tconst clickedTaskbar = e.target.closest(`.${LIBRARY_NAME}-taskbar`);\r\n\r\n\t\t\t// ウィンドウ、コンテキストメニュー、タスクバーの外側がクリックされた場合\r\n\t\t\tif (!clickedWindow && !clickedContextMenu && !clickedTaskbar) {\r\n\t\t\t\t// アクティブなウィンドウのフォーカスを外す\r\n\t\t\t\tconst active = this.activeWindow;\r\n\t\t\t\tthis.activeWindow = null;\r\n\t\t\t\tactive.blur();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\twindow.addEventListener(\"message\", (event) => {\r\n\t\t\t// メッセージの形式を検証\r\n\t\t\tif (event.data && event.data.type === \"winlet:createWindow\" && typeof event.data.options === \"object\") {\r\n\t\t\t\t// メッセージの送信元が管理下のiframeか検証（セキュリティ対策）\r\n\t\t\t\tlet isSourceValid = false;\r\n\t\t\t\tlet sourceWindow: WinLetWindow | null = null;\r\n\t\t\t\tfor (const win of this.windows.values()) {\r\n\t\t\t\t\tconst iframe = win.el.querySelector(\"iframe\");\r\n\t\t\t\t\tif (iframe && iframe.contentWindow === event.source) {\r\n\t\t\t\t\t\tisSourceValid = true;\r\n\t\t\t\t\t\t// メッセージの送信元ウィンドウを特定\r\n\t\t\t\t\t\tsourceWindow = win;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (isSourceValid) {\r\n\t\t\t\t\t// 送信元ウィンドウ(sourceWindow)が存在すれば、それは親ウィンドウであり、\r\n\t\t\t\t\t// その中に新しいウィンドウを作成する。\r\n\t\t\t\t\tif (sourceWindow) {\r\n\t\t\t\t\t\t// iframeの親ウィンドウのcreateWindowを呼び出す\r\n\t\t\t\t\t\tsourceWindow.createWindow(event.data.options);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 通常のトップレベルでのウィンドウ作成\r\n\t\t\t\t\t\tthis.createWindow(event.data.options);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn(\"WinLet: Untrusted source attempted to create a window.\", event.origin);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._isInitialized = true;\r\n\t\tthis.setupShortcutListeners();\r\n\r\n\t\t// タブ分離機能のためのグローバルなD&Dリスナー\r\n\t\tthis.workspaceEl!.addEventListener(\"dragover\", (e) => {\r\n\t\t\tif (e.dataTransfer?.types.includes(\"application/winlet-tab\")) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.workspaceEl!.addEventListener(\"drop\", (e) => {\r\n\t\t\t// ドロップ先がウィンドウやタブバーの中なら何もしない\r\n\t\t\tconst targetEl = e.target as HTMLElement;\r\n\t\t\tif (targetEl.closest(`.${LIBRARY_NAME}-window`)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst tabDataJSON = e.dataTransfer?.getData(\"application/winlet-tab\");\r\n\t\t\tconst sourceWindowId = e.dataTransfer?.getData(\"application/winlet-source-window-id\");\r\n\t\t\tconst sourceTabId = e.dataTransfer?.getData(\"text/plain\");\r\n\r\n\t\t\tif (tabDataJSON && sourceWindowId && sourceTabId) {\r\n\t\t\t\tconst sourceWindow = this.windows.get(sourceWindowId);\r\n\t\t\t\tif (!sourceWindow || !sourceWindow.options.tabOptions.detachable) return;\r\n\r\n\t\t\t\tconst tabData: TabItem = JSON.parse(tabDataJSON);\r\n\t\t\t\tconst newTab: TabItem = {\r\n\t\t\t\t\ttitle: tabData.title,\r\n\t\t\t\t\tcontent: tabData.content,\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Create a clean copy of the source options, removing non-serializable parts.\r\n\t\t\t\tconst cleanSourceOptions: Partial<WindowOptions> = Utils.deepCopy(sourceWindow.options);\r\n\t\t\t\tdelete cleanSourceOptions.id; // New window should get a new ID\r\n\t\t\t\tdelete cleanSourceOptions.animationOrigin; // This is often a non-serializable DOM element or event\r\n\t\t\t\tdelete cleanSourceOptions.content; // Will be replaced by the new tab content\r\n\t\t\t\tdelete cleanSourceOptions.tabs; // Will be replaced by the new tab\r\n\t\t\t\tdelete cleanSourceOptions.splitView; // A detached tab shouldn't inherit a split view\r\n\r\n\t\t\t\tconst mergedWindowOptions = Utils.deepMerge(cleanSourceOptions, {\r\n\t\t\t\t\ttabs: [newTab],\r\n\t\t\t\t\tx: e.clientX,\r\n\t\t\t\t\ty: e.clientY,\r\n\t\t\t\t\twidth: sourceWindow.getSize().width,\r\n\t\t\t\t\theight: sourceWindow.getSize().height,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// 新しいウィンドウを作成\r\n\t\t\t\tthis.createWindow(mergedWindowOptions);\r\n\r\n\t\t\t\t// 元のウィンドウからタブを削除\r\n\t\t\t\tsourceWindow.closeTab(parseInt(sourceTabId, 10));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// ショートカットキーのリスナーを統合\r\n\tprivate setupShortcutListeners() {\r\n\t\tdocument.addEventListener(\r\n\t\t\t\"keydown\",\r\n\t\t\t(e) => {\r\n\t\t\t\t// --- 1. グローバルショートカット (ウィンドウ切り替え) ---\r\n\t\t\t\tif (this.globalConfig.windowSwitchShortcut) {\r\n\t\t\t\t\tconst shortcut = this.parseShortcut(this.globalConfig.windowSwitchShortcut);\r\n\r\n\t\t\t\t\tif (e.key.toLowerCase() === shortcut.key.toLowerCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tconst windows = Array.from(this.windows.values());\r\n\r\n\t\t\t\t\t\tconst currentIndex = this.activeWindow ? windows.findIndex((w) => w === this.activeWindow) : -1;\r\n\t\t\t\t\t\tconst nextIndex = (currentIndex + 1) % windows.length;\r\n\r\n\t\t\t\t\t\tconst win = windows[nextIndex];\r\n\t\t\t\t\t\tif (win.state === \"minimized\") {\r\n\t\t\t\t\t\t\twin.restore();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twin.focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// --- 2. ウィンドウ固有のショートカット ---\r\n\t\t\t\tconst targetWindow = this.activeWindow;\r\n\r\n\t\t\t\t// ターゲットウィンドウがなければ何もしない\r\n\t\t\t\tif (!targetWindow || !targetWindow.options.enableShortcuts) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// --- 3. タブ切り替えショートカット (Ctrl+Shift+[1-9]) ---\r\n\t\t\t\tif (e.ctrlKey && e.shiftKey && (targetWindow.options.tabs?.length ?? 0) > 0) {\r\n\t\t\t\t\t// Shiftキーの影響を受けない e.code で判定する\r\n\t\t\t\t\tif (e.code.startsWith(\"Digit\")) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\t\t\tconst keyNum = parseInt(e.code.replace(\"Digit\", \"\"), 10);\r\n\r\n\t\t\t\t\t\tconst tabs = targetWindow.getTabs();\r\n\t\t\t\t\t\tconst numTabs = tabs.length;\r\n\t\t\t\t\t\tlet tabIndex = -1;\r\n\r\n\t\t\t\t\t\tif (keyNum >= 1 && keyNum <= 8) {\r\n\t\t\t\t\t\t\ttabIndex = keyNum - 1;\r\n\t\t\t\t\t\t} else if (keyNum === 9) {\r\n\t\t\t\t\t\t\ttabIndex = numTabs - 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (tabIndex >= 0 && tabIndex < numTabs) {\r\n\t\t\t\t\t\t\ttargetWindow.activateTab(tabIndex);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn; // 他のショートカットと重複しないようにreturn\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// --- 4. ショートカットキーを検索して実行 ---\r\n\t\t\t\tconst findAndExecShortcut = (menuItems: MenuItem[]) => {\r\n\t\t\t\t\tfor (const item of menuItems) {\r\n\t\t\t\t\t\tif (item.shortcut) {\r\n\t\t\t\t\t\t\tconst shortcut = this.parseShortcut(item.shortcut);\r\n\t\t\t\t\t\t\tif (e.key.toUpperCase() === shortcut.key.toUpperCase() && e.ctrlKey === shortcut.ctrl && e.altKey === shortcut.alt && e.shiftKey === shortcut.shift) {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\titem.action?.(targetWindow!);\r\n\t\t\t\t\t\t\t\treturn true; // 実行したら探索終了\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (item.items && findAndExecShortcut(item.items)) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t};\r\n\r\n\t\t\t\tfindAndExecShortcut(targetWindow.options.menu);\r\n\t\t\t},\r\n\t\t\t{ passive: false }\r\n\t\t);\r\n\t}\r\n\r\n\t// 未初期化の場合に自動でinitを呼び出すヘルパー\r\n\tprivate ensureInitialized(): void {\r\n\t\tif (!this._isInitialized) {\r\n\t\t\tthis.init();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * スタイルシートを取得\r\n\t */\r\n\tprivate getStyleData() {\r\n\t\treturn this.replaceStringVariable(styleData);\r\n\t}\r\n\r\n\t/**\r\n\t * 変数置換\r\n\t */\r\n\tprivate replaceStringVariable(str: string) {\r\n\t\treturn str.replace(/\\$\\[(\\w+)\\]/g, (a, p) => {\r\n\t\t\tswitch (p) {\r\n\t\t\t\tcase \"prefix\":\r\n\t\t\t\t\treturn LIBRARY_NAME;\r\n\t\t\t}\r\n\t\t\treturn p;\r\n\t\t});\r\n\t}\r\n\r\n\tpublic createWindow(options: WindowOptions): WinLetWindow {\r\n\t\tthis.ensureInitialized();\r\n\r\n\t\tconst ifExists = options.ifExists ?? \"focus\";\r\n\r\n\t\tif (options.id && ifExists !== \"create\") {\r\n\t\t\tconst existingWindow = this.getWindow(options.id);\r\n\t\t\tif (existingWindow) {\r\n\t\t\t\tif (ifExists === \"prevent\") {\r\n\t\t\t\t\treturn existingWindow; // 何もせず既存インスタンスを返す\r\n\t\t\t\t}\r\n\t\t\t\tif (ifExists === \"focus\") {\r\n\t\t\t\t\tif (existingWindow.state === \"minimized\") {\r\n\t\t\t\t\t\texistingWindow.restore();\r\n\t\t\t\t\t}\r\n\t\t\t\t\texistingWindow.focus();\r\n\t\t\t\t\treturn existingWindow; // フォーカスして既存インスタンスを返す\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst creationOptions: Required<WindowOptions> = Utils.deepMerge(Utils.deepCopy(defaultConfig), options);\r\n\t\tif (creationOptions.x === \"auto\" || creationOptions.y === \"auto\") {\r\n\t\t\tconst winWidth = creationOptions.width;\r\n\t\t\tconst winHeight = creationOptions.height;\r\n\t\t\tconst containerRect = this.workspaceEl!.getBoundingClientRect();\r\n\t\t\tconst centerPos = {\r\n\t\t\t\tx: (containerRect.width - winWidth) / 2,\r\n\t\t\t\ty: (containerRect.height - winHeight) / 2,\r\n\t\t\t};\r\n\r\n\t\t\t// カスケードを中央からリセットすべきか判断\r\n\t\t\tlet resetCascade = true;\r\n\t\t\tif (this.lastAutoPosition) {\r\n\t\t\t\tlet lastPosWindowFound = false;\r\n\t\t\t\tfor (const win of this.windows.values()) {\r\n\t\t\t\t\tif (win.state === \"normal\" && !win.options._isPopup) {\r\n\t\t\t\t\t\tconst pos = win.getPosition();\r\n\t\t\t\t\t\t// 前回のカスケード位置にウィンドウが存在するかチェック\r\n\t\t\t\t\t\tif (Math.abs(pos.x - this.lastAutoPosition.x) < 5 && Math.abs(pos.y - this.lastAutoPosition.y) < 5) {\r\n\t\t\t\t\t\t\tlastPosWindowFound = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (lastPosWindowFound) {\r\n\t\t\t\t\tresetCascade = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet nextPos: { x: number; y: number };\r\n\r\n\t\t\tif (resetCascade) {\r\n\t\t\t\tnextPos = centerPos;\r\n\t\t\t} else {\r\n\t\t\t\tnextPos = {\r\n\t\t\t\t\tx: this.lastAutoPosition!.x + this.CASCADE_OFFSET,\r\n\t\t\t\t\ty: this.lastAutoPosition!.y + this.CASCADE_OFFSET,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\t// 画面外にはみ出す場合は中央に戻す\r\n\t\t\tif (nextPos.x + winWidth > containerRect.width || nextPos.y + winHeight > containerRect.height) {\r\n\t\t\t\tnextPos = centerPos;\r\n\t\t\t}\r\n\r\n\t\t\t// 計算結果をオプションに反映\r\n\t\t\tcreationOptions.x = nextPos.x;\r\n\t\t\tcreationOptions.y = nextPos.y;\r\n\r\n\t\t\t// ポップアップでない場合のみ、次回のカスケード位置を保存\r\n\t\t\tif (!creationOptions._isPopup) {\r\n\t\t\t\tthis.lastAutoPosition = { x: nextPos.x, y: nextPos.y };\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst win = new WinLetWindow(creationOptions, this);\r\n\t\tthis.windows.set(win.id, win);\r\n\t\tWindowManager.allWindows.set(win.id, win);\r\n\t\tthis.workspaceEl!.appendChild(win.el);\r\n\r\n\t\tthis.emit(\"window-created\", win);\r\n\r\n\t\tif (this.taskbarEl) {\r\n\t\t\tthis.createTaskbarItem(win);\r\n\t\t}\r\n\r\n\t\twin.setPosition(creationOptions.x, creationOptions.y);\r\n\t\tif (creationOptions.windowOptions.focus) {\r\n\t\t\tthis.focusWindow(win);\r\n\t\t\twin.focus();\r\n\t\t} else {\r\n\t\t\twin.el.style.zIndex = `${(win.options.windowOptions.alwaysOnTop ? this.zIndexCounterOnTop : this.zIndexCounter) - 1}`;\r\n\t\t\tthis.updateVirtualization();\r\n\t\t\twin.updateDebugOverlay();\r\n\t\t}\r\n\t\treturn win;\r\n\t}\r\n\r\n\tpublic popup(options: PopupOptions): WinLetWindow {\r\n\t\tthis.ensureInitialized();\r\n\t\tlet buttons: PopupButton[];\r\n\t\tconst buttonPresets: { [key in PopupButtonPreset]: PopupButton[] } = {\r\n\t\t\tOk: [{ text: \"OK\", value: 1 }],\r\n\t\t\tOkCancel: [\r\n\t\t\t\t{ text: \"OK\", value: 1 },\r\n\t\t\t\t{ text: \"Cancel\", value: 2 },\r\n\t\t\t],\r\n\t\t\tYes: [{ text: \"Yes\", value: 6 }],\r\n\t\t\tYesNo: [\r\n\t\t\t\t{ text: \"Yes\", value: 6 },\r\n\t\t\t\t{ text: \"No\", value: 7 },\r\n\t\t\t],\r\n\t\t\tYesNoCancel: [\r\n\t\t\t\t{ text: \"Yes\", value: 6 },\r\n\t\t\t\t{ text: \"No\", value: 7 },\r\n\t\t\t\t{ text: \"Cancel\", value: 2 },\r\n\t\t\t],\r\n\t\t\tRetry: [{ text: \"Retry\", value: 4 }],\r\n\t\t\tRetryCancel: [\r\n\t\t\t\t{ text: \"Retry\", value: 4 },\r\n\t\t\t\t{ text: \"Cancel\", value: 2 },\r\n\t\t\t],\r\n\t\t\tAbortRetryIgnore: [\r\n\t\t\t\t{ text: \"Abort\", value: 3 },\r\n\t\t\t\t{ text: \"Retry\", value: 4 },\r\n\t\t\t\t{ text: \"Ignore\", value: 5 },\r\n\t\t\t],\r\n\t\t};\r\n\t\tif (Array.isArray(options.buttons)) {\r\n\t\t\tbuttons = options.buttons;\r\n\t\t} else {\r\n\t\t\tbuttons = buttonPresets[options.buttons || \"Ok\"] || buttonPresets.Ok;\r\n\t\t}\r\n\r\n\t\tlet timeoutId: number | null = null;\r\n\t\tconst closeCallback = (result: PopupResult) => {\r\n\t\t\tif (timeoutId) clearTimeout(timeoutId);\r\n\t\t\ttimeoutId = null;\r\n\t\t\ttry {\r\n\t\t\t\toptions.onClose?.(result);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst messageHTML = `<div class=\"${LIBRARY_NAME}-popup-message\">${Utils.sanitizeHTML(options.message)}</div>`;\r\n\t\tconst buttonsHTML = buttons.map((btn, index) => `<input class=\"${LIBRARY_NAME}-popup-button\" data-index=\"${index}\" type=\"button\" value=\"${Utils.sanitizeHTML(btn.text)}\" role=\"button\"/>`).join(\"\");\r\n\t\tconst contentHTML = `${messageHTML}<div class=\"${LIBRARY_NAME}-popup-buttons\" role=\"spinbutton\">${buttonsHTML}</div>`;\r\n\r\n\t\tconst winOptions: WindowOptions = {\r\n\t\t\tid: Utils.generateId(`${LIBRARY_NAME}-popup`),\r\n\t\t\ttitle: options.title || \"\",\r\n\t\t\ticon: options.icon,\r\n\t\t\tvirtualizable: false,\r\n\t\t\twindowOptions: {\r\n\t\t\t\tresizableX: false,\r\n\t\t\t\tresizableY: false,\r\n\t\t\t\tmovable: true,\r\n\t\t\t\tclosable: true,\r\n\t\t\t\tminimizable: false,\r\n\t\t\t\tmaximizable: false,\r\n\t\t\t\tmaximizableOnDblClick: false,\r\n\t\t\t\tmodal: options.modal ?? true,\r\n\t\t\t\talwaysOnTop: options.alwaysOnTop ?? false,\r\n\t\t\t\tfocus: options.focus ?? true,\r\n\t\t\t},\r\n\t\t\tenableShortcuts: false,\r\n\t\t\tcontent: { html: contentHTML },\r\n\t\t\t_isPopup: true,\r\n\t\t};\r\n\t\tif (options.onFocus) winOptions.onFocus = options.onFocus;\r\n\t\tif (options.onBlur) winOptions.onBlur = options.onBlur;\r\n\r\n\t\tif (options.autoWidth) {\r\n\t\t\tconst temp = document.createElement(\"span\");\r\n\t\t\ttemp.style.visibility = \"hidden\";\r\n\t\t\ttemp.style.position = \"absolute\";\r\n\t\t\ttemp.style.whiteSpace = \"pre\";\r\n\t\t\ttemp.className = `${LIBRARY_NAME}-popup-message`;\r\n\t\t\ttemp.innerHTML = Utils.sanitizeHTML(options.message);\r\n\t\t\tthis.workspaceEl?.appendChild(temp);\r\n\t\t\twinOptions.width = temp.offsetWidth + 80; // メッセージ幅 + パディング\r\n\t\t\tthis.workspaceEl?.removeChild(temp);\r\n\t\t} else {\r\n\t\t\twinOptions.width = 300;\r\n\t\t}\r\n\t\twinOptions.height = 150;\r\n\r\n\t\tconst winWidth = winOptions.width!;\r\n\t\tconst winHeight = winOptions.height!;\r\n\t\tconst containerRect = this.workspaceEl!.getBoundingClientRect();\r\n\t\tconst centerPos = {\r\n\t\t\tx: (containerRect.width - winWidth) / 2,\r\n\t\t\ty: (containerRect.height - winHeight) / 2,\r\n\t\t};\r\n\r\n\t\tlet resetCascade = true;\r\n\t\tif (this.lastPopupPosition) {\r\n\t\t\tlet lastPosWindowFound = false;\r\n\t\t\tfor (const win of this.windows.values()) {\r\n\t\t\t\tif (win.options._isPopup && win.state === \"normal\") {\r\n\t\t\t\t\tconst pos = win.getPosition();\r\n\t\t\t\t\tif (Math.abs(pos.x - this.lastPopupPosition.x) < 5 && Math.abs(pos.y - this.lastPopupPosition.y) < 5) {\r\n\t\t\t\t\t\tlastPosWindowFound = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (lastPosWindowFound) {\r\n\t\t\t\tresetCascade = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet nextPos: { x: number; y: number };\r\n\t\tif (resetCascade) {\r\n\t\t\tnextPos = centerPos;\r\n\t\t} else {\r\n\t\t\tnextPos = {\r\n\t\t\t\tx: this.lastPopupPosition!.x + this.CASCADE_OFFSET,\r\n\t\t\t\ty: this.lastPopupPosition!.y + this.CASCADE_OFFSET,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (nextPos.x + winWidth > containerRect.width || nextPos.y + winHeight > containerRect.height) {\r\n\t\t\tnextPos = centerPos;\r\n\t\t}\r\n\r\n\t\twinOptions.x = nextPos.x;\r\n\t\twinOptions.y = nextPos.y;\r\n\r\n\t\tconst win = this.createWindow(winOptions);\r\n\t\tthis.lastPopupPosition = nextPos; // Save the position for the next popup\r\n\t\twin.popupCloseCallback = closeCallback;\r\n\r\n\t\twin.el.querySelectorAll<HTMLButtonElement>(`.${LIBRARY_NAME}-popup-button`).forEach((button) => {\r\n\t\t\tbutton.addEventListener(\"click\", () => {\r\n\t\t\t\tconst index = parseInt(button.dataset.index!, 10);\r\n\t\t\t\tconst result = buttons[index].value;\r\n\t\t\t\tcloseCallback(result);\r\n\t\t\t\twin.close();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tif (options.timeout && options.timeout > 0) {\r\n\t\t\ttimeoutId = window.setTimeout(() => {\r\n\t\t\t\tif (this.windows.has(win.id)) {\r\n\t\t\t\t\tcloseCallback(TIMEOUT_RESULT);\r\n\t\t\t\t\twin.close();\r\n\t\t\t\t}\r\n\t\t\t}, options.timeout);\r\n\t\t}\r\n\t\treturn win;\r\n\t}\r\n\r\n\tpublic popupAsync(options: PopupOptions): Promise<PopupResult> {\r\n\t\tconst opt = Utils.deepCopy(options);\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tconst tmpOnClose = opt.onClose;\r\n\t\t\topt.onClose = (result) => {\r\n\t\t\t\ttmpOnClose?.(result);\r\n\t\t\t\tresolve(result);\r\n\t\t\t};\r\n\t\t\tthis.popup(opt);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic destroyWindow(id: string): void {\r\n\t\tthis.ensureInitialized();\r\n\t\tconst win = this.windows.get(id);\r\n\t\tif (win) {\r\n\t\t\tif (win.options._taskbarItem) {\r\n\t\t\t\twin.options._taskbarItem.remove();\r\n\t\t\t}\r\n\t\t\tif (win.options.windowOptions.modal) {\r\n\t\t\t\tthis.deactivateFocusTrap();\r\n\t\t\t}\r\n\r\n\t\t\tthis.emit(\"window-destroyed\", win);\r\n\t\t\twin.el.remove();\r\n\t\t\tthis.windows.delete(id);\r\n\t\t\tWindowManager.allWindows.delete(id);\r\n\t\t\tif (this.activeWindow === win) {\r\n\t\t\t\tthis.activeWindow = null;\r\n\t\t\t\tconst nextWin = Array.from(this.windows.values()).pop();\r\n\t\t\t\tif (nextWin) this.focusWindow(nextWin);\r\n\t\t\t}\r\n\t\t\t// ウィンドウ破棄後に仮想化状態を更新\r\n\t\t\t(async () => await this.updateVirtualization())();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic focusWindow(win: WinLetWindow): void {\r\n\t\tthis.ensureInitialized();\r\n\t\tif (this.activeWindow === win && !win.options.windowOptions.modal) return;\r\n\r\n\t\t// 自身が管理する他のウィンドウをぼかす\r\n\t\tthis.activeWindow?.blur();\r\n\r\n\t\t// モーダルかつフォーカストラップ有効ならトラップ開始\r\n\t\tif (win.options.windowOptions.modal && this.globalConfig.enableFocusTrapping) {\r\n\t\t\tthis.activateFocusTrap(win);\r\n\t\t} else {\r\n\t\t\t// そうでなければ既存のトラップは解除\r\n\t\t\tthis.deactivateFocusTrap();\r\n\t\t}\r\n\r\n\t\tthis.activeWindow = win;\r\n\t\twin.el.style.zIndex = `${win.options.windowOptions.alwaysOnTop ? ++this.zIndexCounterOnTop : ++this.zIndexCounter}`;\r\n\r\n\t\tthis.windows.forEach((w) => w.options._taskbarItem?.classList.remove(`${LIBRARY_NAME}-active`));\r\n\t\twin.options._taskbarItem?.classList.add(`${LIBRARY_NAME}-active`);\r\n\t\t// ウィンドウのフォーカス、移動、リサイズ時に仮想化状態を即時更新\r\n\t\t(async () => await this.updateVirtualization())();\r\n\r\n\t\t// focus()はWindowクラス側で呼ばれるので不要\r\n\t}\r\n\r\n\tpublic getWindow(id: string): WinLetWindow | undefined {\r\n\t\tthis.ensureInitialized();\r\n\t\treturn this.windows.get(id);\r\n\t}\r\n\r\n\tpublic getWindowFromElement(element: HTMLElement): WinLetWindow | undefined {\r\n\t\tthis.ensureInitialized();\r\n\t\tconst winEl = element.closest<HTMLElement>(`.${LIBRARY_NAME}-window`);\r\n\t\tif (winEl?.id) {\r\n\t\t\treturn WindowManager.allWindows.get(winEl.id);\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic getActiveWindow(): WinLetWindow | null {\r\n\t\tthis.ensureInitialized();\r\n\t\treturn this.activeWindow;\r\n\t}\r\n\r\n\tpublic onTabDragStart(sourceWindowId: string): void {\r\n\t\tthis.workspaceEl?.classList.add(`${LIBRARY_NAME}-is-tab-dragging`);\r\n\t\tthis.draggingTabInfo = { sourceWindowId };\r\n\t}\r\n\r\n\tpublic onTabDragEnd(): void {\r\n\t\tthis.workspaceEl?.classList.remove(`${LIBRARY_NAME}-is-tab-dragging`);\r\n\t\tthis.draggingTabInfo = null;\r\n\t}\r\n\r\n\tpublic showContextMenu(x: number, y: number, menuItems: ContextMenuItem[], contextWindow: IWindow): void {\r\n\t\tthis.ensureInitialized();\r\n\t\tthis.hideContextMenu();\r\n\r\n\t\tthis.contextMenuEl = document.createElement(\"ul\");\r\n\t\tthis.contextMenuEl.className = `${LIBRARY_NAME}-context-menu`;\r\n\r\n\t\tmenuItems.forEach((itemData) => {\r\n\t\t\tconst itemEl = document.createElement(\"li\");\r\n\t\t\tif (itemData.separator) {\r\n\t\t\t\titemEl.className = `${LIBRARY_NAME}-separator`;\r\n\t\t\t} else {\r\n\t\t\t\titemEl.textContent = itemData.name ?? \"\";\r\n\t\t\t\titemEl.addEventListener(\"click\", (e) => {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\titemData.action?.(contextWindow);\r\n\t\t\t\t\tthis.hideContextMenu();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.contextMenuEl!.appendChild(itemEl);\r\n\t\t});\r\n\r\n\t\tthis.workspaceEl!.appendChild(this.contextMenuEl);\r\n\r\n\t\tconst { offsetWidth: menuWidth, offsetHeight: menuHeight } = this.contextMenuEl;\r\n\t\tconst { innerWidth: screenWidth, innerHeight: screenHeight } = window;\r\n\r\n\t\tthis.contextMenuEl.style.left = x + menuWidth > screenWidth ? `${screenWidth - menuWidth}px` : `${x}px`;\r\n\t\tthis.contextMenuEl.style.top = y + menuHeight > screenHeight ? `${screenHeight - menuHeight}px` : `${y}px`;\r\n\t}\r\n\r\n\tpublic hideContextMenu(): void {\r\n\t\tthis.contextMenuEl?.remove();\r\n\t\tthis.contextMenuEl = null;\r\n\t}\r\n\r\n\tpublic registerTheme(theme: Theme): void {\r\n\t\tthis.themes.set(theme.name, theme);\r\n\t}\r\n\r\n\tpublic getRegisteredThemes(): string[] {\r\n\t\treturn Array.from(this.themes.keys());\r\n\t}\r\n\r\n\tpublic setTheme(theme: string | Theme): void {\r\n\t\tconst themeObj = typeof theme === \"string\" ? this.themes.get(theme.toLowerCase()) : theme;\r\n\t\tif (!themeObj) {\r\n\t\t\tconsole.warn(`WinLet: Theme \"${theme}\" not found.`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!this.container) {\r\n\t\t\tconsole.warn(\"WinLet: Container not found.\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this.activeTheme) {\r\n\t\t\tfor (const [key, value] of Object.entries(this.activeTheme.variables)) {\r\n\t\t\t\tif (!(key in themeObj.variables)) {\r\n\t\t\t\t\tthis.container.style.removeProperty(this.replaceStringVariable(key));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.activeTheme = themeObj;\r\n\t\tfor (const [key, value] of Object.entries(themeObj.variables)) {\r\n\t\t\tthis.container.style.setProperty(this.replaceStringVariable(key), this.replaceStringVariable(value));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getTheme(): Theme | null {\r\n\t\treturn this.activeTheme;\r\n\t}\r\n\r\n\tprivate createTaskbar(): void {\r\n\t\tif (!this.container) return;\r\n\t\tthis.taskbarEl = document.createElement(\"div\");\r\n\t\tthis.taskbarEl.className = `${LIBRARY_NAME}-taskbar ${LIBRARY_NAME}-us-none`;\r\n\t\tthis.updateTaskbarLayout();\r\n\t\tthis.container.appendChild(this.taskbarEl);\r\n\t}\r\n\r\n\tprivate updateTaskbarLayout(): void {\r\n\t\tif (!this.taskbarEl || !this.container) return;\r\n\r\n\t\tconst taskbarOpts = this.globalConfig.taskbar || {};\r\n\t\tconst position = taskbarOpts.position || \"bottom\";\r\n\r\n\t\tswitch (position) {\r\n\t\t\tcase \"top\":\r\n\t\t\tcase \"bottom\":\r\n\t\t\tcase \"left\":\r\n\t\t\tcase \"right\":\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new WinLetError(`Invalid taskbar position: ${position}`);\r\n\t\t}\r\n\r\n\t\t// クラスを一度リセット\r\n\t\tthis.taskbarEl.className = `${LIBRARY_NAME}-taskbar ${LIBRARY_NAME}-us-none`;\r\n\r\n\t\t// 位置クラスを追加\r\n\t\tthis.taskbarEl.classList.add(`${LIBRARY_NAME}-taskbar-${position}`);\r\n\r\n\t\tif (!this.taskbarEl.isConnected) {\r\n\t\t\tthis.container.appendChild(this.taskbarEl);\r\n\t\t}\r\n\r\n\t\tthis.container.style.flexDirection = \"\";\r\n\t\tthis.taskbarEl.style.order = \"\";\r\n\t\tif (this.workspaceEl) {\r\n\t\t\tthis.workspaceEl.style.order = \"\";\r\n\t\t}\r\n\r\n\t\tthis.container.style.paddingTop = \"0\";\r\n\t\tthis.container.style.paddingBottom = \"0\";\r\n\t\tthis.container.style.paddingLeft = \"0\";\r\n\t\tthis.container.style.paddingRight = \"0\";\r\n\r\n\t\t// getComputedStyleで実際のタスクバーサイズを取得\r\n\t\tconst computedStyle = window.getComputedStyle(this.taskbarEl);\r\n\t\tconst taskbarHeight = computedStyle.height;\r\n\t\tconst taskbarWidth = computedStyle.width;\r\n\r\n\t\tswitch (position) {\r\n\t\t\tcase \"top\":\r\n\t\t\t\tthis.container.style.paddingTop = taskbarHeight;\r\n\t\t\t\tthis.container.style.flexDirection = \"column-reverse\";\r\n\t\t\t\tthis.taskbarEl.style.order = \"1\";\r\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"2\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"bottom\":\r\n\t\t\t\tthis.container.style.paddingBottom = taskbarHeight;\r\n\t\t\t\tthis.container.style.flexDirection = \"column\";\r\n\t\t\t\tthis.taskbarEl.style.order = \"2\";\r\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"1\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"left\":\r\n\t\t\t\tthis.container.style.paddingLeft = taskbarWidth;\r\n\t\t\t\tthis.container.style.flexDirection = \"row-reverse\";\r\n\t\t\t\tthis.taskbarEl.style.order = \"1\";\r\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"2\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"right\":\r\n\t\t\t\tthis.container.style.paddingRight = taskbarWidth;\r\n\t\t\t\tthis.container.style.flexDirection = \"row\";\r\n\t\t\t\tthis.taskbarEl.style.order = \"2\";\r\n\t\t\t\tif (this.workspaceEl) this.workspaceEl.style.order = \"1\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate createTaskbarItem(win: WinLetWindow): void {\r\n\t\tif (!this.taskbarEl) return;\r\n\t\tconst item = document.createElement(\"div\");\r\n\t\titem.className = `${LIBRARY_NAME}-taskbar-item`;\r\n\t\titem.textContent = win.getTitle();\r\n\t\titem.title = win.getTitle();\r\n\t\titem.dataset.windowId = win.id;\r\n\r\n\t\tthis.updateTaskbarItemContent(item, win);\r\n\r\n\t\titem.addEventListener(\"click\", () => {\r\n\t\t\tif (win.state === \"minimized\") {\r\n\t\t\t\twin.restore({ origin: item });\r\n\t\t\t} else {\r\n\t\t\t\tif (this.activeWindow === win) {\r\n\t\t\t\t\twin.minimize({ origin: item });\r\n\t\t\t\t} else {\r\n\t\t\t\t\twin.focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\twin.options._taskbarItem = item;\r\n\t\tthis.taskbarEl.appendChild(item);\r\n\t}\r\n\r\n\tprivate updateTaskbarItemContent(item: HTMLElement, win: WinLetWindow) {\r\n\t\tconst { icon, taskbarOptions } = win.options;\r\n\t\titem.innerHTML = \"\"; // Clear existing content\r\n\t\titem.title = win.getTitle(); // Always set tooltip\r\n\r\n\t\tconst showIconOnly = taskbarOptions?.showIconOnly && icon;\r\n\r\n\t\titem.classList.toggle(`${LIBRARY_NAME}-icon-only`, !!showIconOnly);\r\n\r\n\t\tif (showIconOnly) {\r\n\t\t\tconst iconEl = document.createElement(\"div\");\r\n\t\t\ticonEl.className = `${LIBRARY_NAME}-taskbar-item-icon`;\r\n\t\t\tif (win.isFontAwesome(icon)) {\r\n\t\t\t\tconst i = document.createElement(\"i\");\r\n\t\t\t\ti.className = icon;\r\n\t\t\t\ticonEl.appendChild(i);\r\n\t\t\t} else {\r\n\t\t\t\tconst img = document.createElement(\"img\");\r\n\t\t\t\timg.src = icon;\r\n\t\t\t\timg.alt = win.getTitle();\r\n\t\t\t\ticonEl.appendChild(img);\r\n\t\t\t}\r\n\t\t\titem.appendChild(iconEl);\r\n\t\t} else {\r\n\t\t\titem.textContent = win.getTitle();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic updateTaskbarItem(win: WinLetWindow, state: \"minimized\" | \"restored\" | \"titleChanged\" | \"iconChanged\" | \"virtualized\" | \"unvirtualized\"): void {\r\n\t\tconst item = win.options._taskbarItem;\r\n\t\tif (!item) return;\r\n\r\n\t\tswitch (state) {\r\n\t\t\tcase \"minimized\":\r\n\t\t\t\titem.classList.add(`${LIBRARY_NAME}-minimized`);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"restored\":\r\n\t\t\t\titem.classList.remove(`${LIBRARY_NAME}-minimized`);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"titleChanged\":\r\n\t\t\tcase \"iconChanged\":\r\n\t\t\t\tthis.updateTaskbarItemContent(item, win);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"virtualized\":\r\n\t\t\t\tif (this.globalConfig.indicateVirtualizationInTaskbar) {\r\n\t\t\t\t\titem.classList.add(`${LIBRARY_NAME}-virtualized`);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"unvirtualized\":\r\n\t\t\t\titem.classList.remove(`${LIBRARY_NAME}-virtualized`);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate activateFocusTrap(win: WinLetWindow): void {\r\n\t\tthis.deactivateFocusTrap(); // 念のため既存のリスナーを解除\r\n\r\n\t\tthis.boundTabPressHandler = (e: KeyboardEvent) => {\r\n\t\t\tif (e.key === \"Tab\") {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tconst focusableElements = Array.from(win.el.querySelectorAll<HTMLElement>('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex=\"-1\"])')).filter((el) => !el.hasAttribute(\"disabled\") && !el.closest(\".minimized\"));\r\n\r\n\t\t\t\tif (focusableElements.length === 0) return;\r\n\r\n\t\t\t\tconst currentIndex = focusableElements.indexOf(document.activeElement as HTMLElement);\r\n\t\t\t\tlet nextIndex = e.shiftKey ? currentIndex - 1 : currentIndex + 1;\r\n\r\n\t\t\t\tif (nextIndex >= focusableElements.length) {\r\n\t\t\t\t\tnextIndex = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (nextIndex < 0) {\r\n\t\t\t\t\tnextIndex = focusableElements.length - 1;\r\n\t\t\t\t}\r\n\t\t\t\tfocusableElements[nextIndex].focus();\r\n\t\t\t}\r\n\t\t};\r\n\t\tdocument.addEventListener(\"keydown\", this.boundTabPressHandler);\r\n\t}\r\n\r\n\tprivate deactivateFocusTrap(): void {\r\n\t\tif (this.boundTabPressHandler) {\r\n\t\t\tdocument.removeEventListener(\"keydown\", this.boundTabPressHandler);\r\n\t\t\tthis.boundTabPressHandler = null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ショートカット文字列を解析し、修飾キーと主キーのオブジェクトを返す\r\n\t * @param shortcut - \"Ctrl+Shift+K\"のような文字列\r\n\t */\r\n\tprivate parseShortcut(shortcut: string): { ctrl: boolean; alt: boolean; shift: boolean; key: string } {\r\n\t\tconst keys = shortcut.split(\"+\");\r\n\t\tconst key = keys.pop() || \"\"; // 主キーを配列から取り出す\r\n\t\tconst ctrl = keys.includes(\"Ctrl\");\r\n\t\tconst alt = keys.includes(\"Alt\");\r\n\t\tconst shift = keys.includes(\"Shift\");\r\n\t\treturn { ctrl, alt, shift, key };\r\n\t}\r\n\r\n\t/**\r\n\t * 全てのウィンドウの可視性をチェックし、必要に応じて仮想化/復元を行う\r\n\t */\r\n\tpublic async updateVirtualization(): Promise<void> {\r\n\t\tif (!this.globalConfig.enableVirtualization || !this.workspaceEl) return;\r\n\r\n\t\tconst threshold = this.globalConfig.virtualizationThreshold ?? 5;\r\n\t\tif (this.windows.size <= threshold) {\r\n\t\t\t// しきい値以下の場合は、すべてのウィンドウが仮想化されていないことを確認\r\n\t\t\tfor (const win of this.windows.values()) {\r\n\t\t\t\tif (win.virtualizationLevel !== \"none\" && win.state !== \"minimized\") {\r\n\t\t\t\t\twin.unvirtualize();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn; // さらに処理を停止\r\n\t\t}\r\n\r\n\t\t// z-indexでソートし、奥のウィンドウから手前のウィンドウの順で並べる\r\n\t\tconst windows = Array.from(this.windows.values()).sort((a, b) => parseInt(a.el.style.zIndex || \"0\", 10) - parseInt(b.el.style.zIndex || \"0\", 10));\r\n\r\n\t\tconst viewportRect = this.workspaceEl.getBoundingClientRect();\r\n\r\n\t\tfor (let i = 0; i < windows.length; i++) {\r\n\t\t\tconst targetWin = windows[i];\r\n\r\n\t\t\t// 1. 仮想化対象外のウィンドウ、またはアクティブなウィンドウは常に非仮想化\r\n\t\t\tif (!targetWin.options.virtualizable || (targetWin.state !== \"normal\" && targetWin.state !== \"minimized\") || targetWin === this.activeWindow) {\r\n\t\t\t\ttargetWin.unvirtualize();\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst targetRect = targetWin.el.getBoundingClientRect();\r\n\t\t\t// 面積が非常に小さいウィンドウは非表示として扱う\r\n\t\t\tif (targetRect.width <= 1 || targetRect.height <= 1) {\r\n\t\t\t\ttargetWin.virtualize(\"auto\");\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// 2. 5つのサンプルポイント（四隅と中央）を定義\r\n\t\t\tconst samplePoints = [\r\n\t\t\t\t{ x: targetRect.left + 1, y: targetRect.top + 1 }, // Top-left\r\n\t\t\t\t{ x: targetRect.right - 1, y: targetRect.top + 1 }, // Top-right\r\n\t\t\t\t{ x: targetRect.right - 1, y: targetRect.bottom - 1 }, // Bottom-right\r\n\t\t\t\t{ x: targetRect.left + 1, y: targetRect.bottom - 1 }, // Bottom-left\r\n\t\t\t\t{ x: targetRect.left + targetRect.width * 0.5, y: targetRect.top + targetRect.height * 0.5 }, // Center\r\n\t\t\t];\r\n\r\n\t\t\tlet isVisible = false;\r\n\t\t\tfor (const point of samplePoints) {\r\n\t\t\t\t// ポイントがビューポート（ワークスペース）の外側なら、このポイントは不可視\r\n\t\t\t\tconst inViewport = point.x >= viewportRect.left && point.x < viewportRect.right && point.y >= viewportRect.top && point.y < viewportRect.bottom;\r\n\t\t\t\tif (!inViewport) {\r\n\t\t\t\t\tcontinue; // 次のサンプルポイントをチェック\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// ポイントが他のウィンドウに隠されているかチェック\r\n\t\t\t\tlet pointIsOccluded = false;\r\n\t\t\t\t// targetWinより手前にあるウィンドウ(occluderWin)をすべてチェック\r\n\t\t\t\tfor (let j = i + 1; j < windows.length; j++) {\r\n\t\t\t\t\tconst occluderWin = windows[j];\r\n\t\t\t\t\t// 隠す能力のないウィンドウ（最小化、透明など）はスキップ\r\n\t\t\t\t\tif (occluderWin.state !== \"normal\" || (occluderWin.getOpacity() ?? 1) < 0.9) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst occluderRect = occluderWin.el.getBoundingClientRect();\r\n\t\t\t\t\t// ポイントがoccluderWinの矩形内にあるかチェック\r\n\t\t\t\t\tif (point.x >= occluderRect.left && point.x < occluderRect.right && point.y >= occluderRect.top && point.y < occluderRect.bottom) {\r\n\t\t\t\t\t\tpointIsOccluded = true;\r\n\t\t\t\t\t\tbreak; // １つのウィンドウでも隠していれば、このポイントのチェックは終了\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// このポイントがビューポート内にあり、かつどのウィンドウにも隠されていなければ、可視と判断\r\n\t\t\t\tif (!pointIsOccluded) {\r\n\t\t\t\t\tisVisible = true;\r\n\t\t\t\t\tbreak; // １つでも可視ポイントがあれば、ウィンドウ全体のチェックは終了\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// 3. 最終的な可視性に基づいて仮想化状態を更新\r\n\t\t\tif (isVisible) {\r\n\t\t\t\tconst restoreMode = targetWin.options.virtualizationRestoreMode || this.globalConfig.virtualizationRestoreMode || \"auto\";\r\n\t\t\t\tif (restoreMode === \"auto\") {\r\n\t\t\t\t\ttargetWin.unvirtualize();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tawait targetWin.virtualize(\"auto\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Bootstrapのテーマ属性の変更を監視するMutationObserverを開始します。\r\n\t */\r\n\tprivate startBootstrapThemeObserver(): void {\r\n\t\tif (this.bootstrapThemeObserver || !this.container) return;\r\n\r\n\t\t// --- ハイコントラストのリスナー設定 ---\r\n\t\tthis.highContrastMatcher = window.matchMedia(\"(prefers-contrast: more)\");\r\n\t\tthis.highContrastListener = (e: MediaQueryListEvent) => {\r\n\t\t\t// ハイコントラストがONになったら、high-contrastテーマを強制適用\r\n\t\t\tif (e.matches) {\r\n\t\t\t\tthis.stopAutoThemeListener();\r\n\t\t\t\tthis.setTheme(\"high-contrast\");\r\n\t\t\t} else {\r\n\t\t\t\t// OFFになったら、Bootstrapのテーマ設定を再評価\r\n\t\t\t\tthis.applyBootstrapTheme(document.documentElement.getAttribute(\"data-bs-theme\"));\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.highContrastMatcher.addEventListener(\"change\", this.highContrastListener);\r\n\r\n\t\t// --- Bootstrapテーマのリスナー設定 ---\r\n\t\tconst targetNode = document.documentElement;\r\n\t\tconst config = { attributes: true, attributeFilter: [\"data-bs-theme\"] };\r\n\t\tconst callback = (mutationsList: MutationRecord[]) => {\r\n\t\t\t// ハイコントラストが有効でなければ、テーマ変更を処理\r\n\t\t\tif (!this.highContrastMatcher?.matches) {\r\n\t\t\t\tfor (const mutation of mutationsList) {\r\n\t\t\t\t\tif (mutation.type === \"attributes\" && mutation.attributeName === \"data-bs-theme\") {\r\n\t\t\t\t\t\tconst themeValue = (mutation.target as HTMLElement).getAttribute(\"data-bs-theme\");\r\n\t\t\t\t\t\tthis.applyBootstrapTheme(themeValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.bootstrapThemeObserver = new MutationObserver(callback);\r\n\t\tthis.bootstrapThemeObserver.observe(targetNode, config);\r\n\r\n\t\t// --- 初期チェック ---\r\n\t\t// 優先度1: ハイコントラストモード\r\n\t\tif (this.highContrastMatcher.matches) {\r\n\t\t\tthis.setTheme(\"high-contrast\");\r\n\t\t} else {\r\n\t\t\t// 優先度2: Bootstrapテーマ\r\n\t\t\tthis.applyBootstrapTheme(targetNode.getAttribute(\"data-bs-theme\"));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Bootstrapのテーマ属性の監視を停止します。\r\n\t */\r\n\tprivate stopBootstrapThemeObserver(): void {\r\n\t\tif (this.bootstrapThemeObserver) {\r\n\t\t\tthis.bootstrapThemeObserver.disconnect();\r\n\t\t\tthis.bootstrapThemeObserver = null;\r\n\t\t}\r\n\t\tif (this.highContrastMatcher && this.highContrastListener) {\r\n\t\t\tthis.highContrastMatcher.removeEventListener(\"change\", this.highContrastListener);\r\n\t\t}\r\n\t\tthis.stopAutoThemeListener(); // OSのリスナーも停止\r\n\t}\r\n\r\n\t/**\r\n\t * 適用されたBootstrapのテーマに応じてWinLetのテーマを設定します。\r\n\t * @param themeValue - data-bs-theme属性の値 ('dark', 'light', 'auto', or null)\r\n\t */\r\n\tprivate applyBootstrapTheme(themeValue: string | null): void {\r\n\t\tthis.stopAutoThemeListener(); // 競合を避けるため、まずOSのリスナーを停止\r\n\r\n\t\tif (themeValue === \"dark\") {\r\n\t\t\tthis.setTheme(\"dark\");\r\n\t\t} else if (themeValue === \"auto\") {\r\n\t\t\tthis.startAutoThemeListener();\r\n\t\t} else {\r\n\t\t\t// 'light' または属性が存在しない場合\r\n\t\t\tthis.setTheme(\"default\");\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * OSのカラースキーム変更の監視を開始します。\r\n\t */\r\n\tprivate startAutoThemeListener(): void {\r\n\t\tif (this.prefersColorSchemeListener || !window.matchMedia) return;\r\n\r\n\t\tthis.prefersDarkMatcher = window.matchMedia(\"(prefers-color-scheme: dark)\");\r\n\r\n\t\tthis.prefersColorSchemeListener = (e: MediaQueryListEvent) => {\r\n\t\t\tthis.setTheme(e.matches ? \"dark\" : \"default\");\r\n\t\t};\r\n\r\n\t\tthis.prefersDarkMatcher.addEventListener(\"change\", this.prefersColorSchemeListener);\r\n\r\n\t\t// 現在のOS設定に基づいて初期テーマを適用\r\n\t\tthis.setTheme(this.prefersDarkMatcher.matches ? \"dark\" : \"default\");\r\n\t}\r\n\r\n\t/**\r\n\t * OSのカラースキーム変更の監視を停止します。\r\n\t */\r\n\tprivate stopAutoThemeListener(): void {\r\n\t\tif (this.prefersDarkMatcher && this.prefersColorSchemeListener) {\r\n\t\t\tthis.prefersDarkMatcher.removeEventListener(\"change\", this.prefersColorSchemeListener);\r\n\t\t}\r\n\t\tthis.prefersDarkMatcher = null;\r\n\t\tthis.prefersColorSchemeListener = null;\r\n\t}\r\n}\r\n",
    "// src/index.ts\r\n\r\nimport { defaultConfig } from \"./const/config\";\r\nimport { CLOSE_BUTTON_RESULT, GlobalConfigOptions, GlobalEventMap, IWindow, ListenerOptions, PopupOptions, PopupResult, Theme, TIMEOUT_RESULT, WindowOptions, WinLetApi } from \"./const/types\";\r\nimport WinLetWindow from \"./function/window\";\r\nimport WindowManager from \"./function/window_manager\";\r\nimport Utils from \"./libs/utils\";\r\nimport { LIB_VERSION } from \"./version\";\r\n\r\nconst selfUrl = (document?.currentScript as HTMLScriptElement)?.src || \"\";\r\n\r\nconst globalConfig: GlobalConfigOptions = {\r\n\twindowSwitchShortcut: \"Ctrl+`\", // デフォルトショートカット（バッククォート）\r\n\tlibraryPath: selfUrl,\r\n\tenableAnimations: true,\r\n\tanimateFromTaskbar: true,\r\n\tenableFocusTrapping: true,\r\n\tenableVirtualization: true,\r\n\tindicateVirtualizationInTaskbar: true,\r\n\tvirtualizationThreshold: 5,\r\n\tvirtualizationDelay: 1000 * 10,\r\n\ttaskbar: {\r\n\t\tposition: \"bottom\",\r\n\t},\r\n\tautoDetectBootstrapTheme: true,\r\n\tenableDebugMode: false,\r\n};\r\n\r\n// シングルトンインスタンス\r\nconst manager = new WindowManager(globalConfig);\r\n\r\n// 公開するAPI\r\nconst api: WinLetApi = {\r\n\t/**\r\n\t * ライブラリを初期化します。DOMの準備ができた後に呼び出してください。\r\n\t * (例: document.addEventListener('DOMContentLoaded', WinLet.init);)\r\n\t *\r\n\t * @param options - グローバル設定。コンテナ要素などを指定できます。\r\n\t */\r\n\tinit: (options: GlobalConfigOptions = {}): void => {\r\n\t\tapi.setGlobalConfig(options);\r\n\t\tmanager.init();\r\n\t},\r\n\r\n\t/**\r\n\t * 新しいウィンドウを作成\r\n\t */\r\n\tcreateWindow: (options: WindowOptions = {}): IWindow => {\r\n\t\treturn manager.createWindow(options);\r\n\t},\r\n\r\n\ton<K extends keyof GlobalEventMap>(eventName: K, listener: GlobalEventMap[K], options?: ListenerOptions): void {\r\n\t\tmanager.on(eventName, listener, options);\r\n\t},\r\n\r\n\toff<K extends keyof GlobalEventMap>(eventName: K, listener: GlobalEventMap[K]): void {\r\n\t\tmanager.off(eventName, listener);\r\n\t},\r\n\r\n\temit<K extends keyof GlobalEventMap>(eventName: K, ...args: Parameters<GlobalEventMap[K]>): ReturnType<GlobalEventMap[K]>[] | undefined {\r\n\t\treturn manager.emit(eventName, ...args);\r\n\t},\r\n\r\n\t/**\r\n\t * 新しいポップアップウィンドウを作成\r\n\t */\r\n\tcreatePopup: (options: PopupOptions): IWindow => {\r\n\t\treturn manager.popup(options);\r\n\t},\r\n\r\n\t/**\r\n\t * 新しいポップアップウィンドウを作成\r\n\t */\r\n\tcreateAsyncPopup: (options: PopupOptions): Promise<PopupResult> => {\r\n\t\treturn manager.popupAsync(options);\r\n\t},\r\n\r\n\t/**\r\n\t * ウィンドウを取得\r\n\t */\r\n\tgetWindow: (id: string): IWindow | undefined => {\r\n\t\treturn manager.getWindow(id);\r\n\t},\r\n\r\n\t/**\r\n\t * 指定されたDOM要素を内包するウィンドウインスタンスを取得します。\r\n\t */\r\n\tgetWindowFromElement: (element: HTMLElement): IWindow | undefined => {\r\n\t\treturn manager.getWindowFromElement(element);\r\n\t},\r\n\r\n\t/**\r\n\t * アクティブなウィンドウを取得\r\n\t */\r\n\tgetActiveWindow: (): IWindow | null => {\r\n\t\treturn manager.getActiveWindow();\r\n\t},\r\n\r\n\t/**\r\n\t * タスクバーのアイテムを更新\r\n\t */\r\n\tupdateTaskbarItem(win: IWindow, state: \"minimized\" | \"restored\" | \"titleChanged\" | \"iconChanged\" | \"virtualized\" | \"unvirtualized\"): void {\r\n\t\tmanager.updateTaskbarItem(win as WinLetWindow, state);\r\n\t},\r\n\r\n\t/**\r\n\t * デフォルトのウィンドウ設定を変更\r\n\t */\r\n\tsetDefaultConfig: (options: WindowOptions): void => {\r\n\t\tUtils.deepMerge(defaultConfig, options);\r\n\t},\r\n\r\n\t/**\r\n\t * グローバル設定を変更\r\n\t */\r\n\tsetGlobalConfig: (options: GlobalConfigOptions): void => {\r\n\t\t// 初期化後にコンテナを変更しようとした場合は警告を出す\r\n\t\tif (manager.isInitialized && options.container) {\r\n\t\t\tconsole.warn(\"WinLet: The container cannot be changed after initialization.\");\r\n\t\t\tdelete options.container;\r\n\t\t}\r\n\t\tObject.assign(globalConfig, options);\r\n\t\tmanager.applyGlobalConfig(globalConfig);\r\n\t},\r\n\r\n\t/**\r\n\t * 表示テーマを登録します。\r\n\t */\r\n\tregisterTheme: (theme: Theme): void => {\r\n\t\tmanager.registerTheme(theme);\r\n\t},\r\n\r\n\t/**\r\n\t * 登録済みのテーマ名の配列を取得します。\r\n\t */\r\n\tgetRegisteredThemes: () => {\r\n\t\treturn manager.getRegisteredThemes();\r\n\t},\r\n\r\n\t/**\r\n\t * 表示テーマを変更します。\r\n\t */\r\n\tsetTheme: (theme: string | Theme): void => {\r\n\t\tmanager.setTheme(theme);\r\n\t},\r\n\r\n\t/**\r\n\t * 現在の表示テーマを取得します。\r\n\t */\r\n\tgetTheme: (): Theme | null => {\r\n\t\treturn manager.getTheme();\r\n\t},\r\n\r\n\t/**\r\n\t * ライブラリのバージョンを取得\r\n\t */\r\n\tget version() {\r\n\t\treturn LIB_VERSION;\r\n\t},\r\n\r\n\t/**\r\n\t * ポップアップウィンドウのタイムアウト結果\r\n\t */\r\n\tPOPUP_TIMEOUT_RESULT: TIMEOUT_RESULT,\r\n\t/**\r\n\t * ポップアップウィンドウの閉じるボタンの結果\r\n\t */\r\n\tPOPUP_CLOSE_BUTTON_RESULT: CLOSE_BUTTON_RESULT,\r\n};\r\n\r\n// グローバルスコープにAPIをアタッチ\r\nif (typeof window !== \"undefined\") {\r\n\twindow.WinLet = api;\r\n}\r\n\r\n// モジュールとしてエクスポートも可能\r\nexport default api;\r\n",
    "import { ListenerOptions } from \"../const/types\";\r\n\r\ntype EventHandler<T extends (...args: any[]) => any> = T;\r\ninterface EventHandlerObject<T extends (...args: any[]) => any> {\r\n\thandler: EventHandler<T>;\r\n\toriginal: T;\r\n}\r\n\r\nexport default class WinLetBaseClass<EventMap extends Record<string, (...args: any[]) => any>> {\r\n\tprivate events: Map<keyof EventMap, EventHandlerObject<EventMap[keyof EventMap]>[]>;\r\n\r\n\tconstructor() {\r\n\t\tthis.events = new Map();\r\n\t}\r\n\r\n\tpublic on<K extends keyof EventMap>(eventName: K, listener: EventMap[K], options?: ListenerOptions): void {\r\n\t\tif (!this.events.has(eventName)) {\r\n\t\t\tthis.events.set(eventName, []);\r\n\t\t}\r\n\r\n\t\tlet handler: EventHandler<EventMap[K]> = listener;\r\n\t\tif (options?.once) {\r\n\t\t\thandler = ((...args: Parameters<EventMap[K]>) => {\r\n\t\t\t\tthis.off(eventName, listener);\r\n\t\t\t\tlistener(...args);\r\n\t\t\t}) as EventMap[K];\r\n\t\t}\r\n\r\n\t\tthis.events.get(eventName)!.push({\r\n\t\t\thandler: handler,\r\n\t\t\toriginal: listener,\r\n\t\t});\r\n\t}\r\n\r\n\tpublic off<K extends keyof EventMap>(eventName: K, listener: EventMap[K]): void {\r\n\t\tconst handlers = this.events.get(eventName);\r\n\t\tif (handlers) {\r\n\t\t\tconst index = handlers.findIndex((h) => h.original === listener);\r\n\t\t\tif (index > -1) {\r\n\t\t\t\thandlers.splice(index, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic emit<K extends keyof EventMap>(eventName: K, ...args: Parameters<EventMap[K]>): ReturnType<EventMap[K]>[] | undefined {\r\n\t\tconst handlers = this.events.get(eventName);\r\n\t\tif (handlers) {\r\n\t\t\tconst results: ReturnType<EventMap[K]>[] = [];\r\n\t\t\t[...handlers].forEach((handlerObj) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tresults.push(handlerObj.handler(...args));\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.error(`Error in event handler for \"${String(eventName)}\":`, e);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn results;\r\n\t\t}\r\n\t}\r\n}\r\n",
    "export default class Utils {\r\n\t/**\r\n\t * ユニークなIDを生成します。\r\n\t * @param prefix - IDのプレフィックス\r\n\t * @returns 生成されたID\r\n\t */\r\n\tpublic static generateId(prefix: string = \"win\"): string {\r\n\t\treturn `${prefix}-${Math.random().toString(36).substring(2, 9)}`;\r\n\t}\r\n\r\n\tpublic static deepCopy<T>(value: T, seen: WeakMap<object, any> = new WeakMap()): T {\r\n\t\tif (value === null || typeof value !== \"object\") return value;\r\n\r\n\t\tif (value instanceof Date) return new Date(value.getTime()) as T;\r\n\r\n\t\tif (value instanceof Map) {\r\n\t\t\tconst copiedMap = new Map();\r\n\t\t\tvalue.forEach((v, k) => {\r\n\t\t\t\tcopiedMap.set(this.deepCopy(k, seen), this.deepCopy(v, seen));\r\n\t\t\t});\r\n\t\t\treturn copiedMap as T;\r\n\t\t}\r\n\r\n\t\tif (value instanceof Set) {\r\n\t\t\tconst copiedSet = new Set();\r\n\t\t\tvalue.forEach((v) => {\r\n\t\t\t\tcopiedSet.add(this.deepCopy(v, seen));\r\n\t\t\t});\r\n\t\t\treturn copiedSet as T;\r\n\t\t}\r\n\r\n\t\tif (Array.isArray(value)) {\r\n\t\t\tif (seen.has(value)) return seen.get(value);\r\n\t\t\tconst arrCopy: any[] = [];\r\n\t\t\tseen.set(value, arrCopy);\r\n\t\t\tfor (const item of value) {\r\n\t\t\t\tarrCopy.push(this.deepCopy(item, seen));\r\n\t\t\t}\r\n\t\t\treturn arrCopy as T;\r\n\t\t}\r\n\r\n\t\tif (seen.has(value)) return seen.get(value);\r\n\t\tconst copiedObj: { [key: string]: any } = {};\r\n\t\tseen.set(value, copiedObj);\r\n\t\tfor (const key in value) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(value, key)) {\r\n\t\t\t\tcopiedObj[key] = this.deepCopy((value as any)[key], seen);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn copiedObj as T;\r\n\t}\r\n\r\n\t/**\r\n\t * オブジェクトをディープマージします。\r\n\t */\r\n\tpublic static deepMerge<T extends object, U extends object>(target: T, source: U): T & U {\r\n\t\tconst output = { ...target } as T & U;\r\n\r\n\t\tfor (const key in source) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(source, key)) {\r\n\t\t\t\tconst sourceValue = source[key];\r\n\t\t\t\tconst targetValue = (target as any)[key];\r\n\r\n\t\t\t\tif (Array.isArray(sourceValue)) {\r\n\t\t\t\t\t// ソースの値が配列の場合は、そのまま上書きする\r\n\t\t\t\t\t(output as any)[key] = sourceValue;\r\n\t\t\t\t} else if (sourceValue instanceof Object && typeof sourceValue !== \"function\" && targetValue instanceof Object) {\r\n\t\t\t\t\t(output as any)[key] = this.deepMerge(targetValue, sourceValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t(output as any)[key] = sourceValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\t}\r\n\r\n\t/**\r\n\t * オブジェクトが空でないかとどうかを判定します。\r\n\t * @param obj - 判定するオブジェクト\r\n\t * @returns オブジェクトが空である場合はfalse、そうでない場合はtrue\r\n\t */\r\n\tpublic static isNonEmptyObject<T extends object>(obj: T | undefined): obj is T & Record<string | symbol, unknown> {\r\n\t\tif (!obj) return false;\r\n\t\tfor (const _ in obj) return true;\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * HTML文字列をサニタイズします。\r\n\t * @param str - サニタイズする文字列\r\n\t * @returns サニタイズされたHTML文字列\r\n\t */\r\n\tpublic static sanitizeHTML(str: string): string {\r\n\t\tconst temp = document.createElement(\"div\");\r\n\t\ttemp.textContent = str;\r\n\t\treturn temp.innerHTML;\r\n\t}\r\n\r\n\t/**\r\n\t * 正規表現をエスケープします。\r\n\t * @param string - エスケープする文字列\r\n\t */\r\n\tpublic static escapeRegex(string: string): string {\r\n\t\treturn string.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, \"\\\\$&\");\r\n\t}\r\n\r\n\t/**\r\n\t * 関数をスロットリングします。指定された時間内に複数回呼び出されても、最後の呼び出しから一定時間後に一度だけ実行します。\r\n\t * @param func - スロットリングする関数\r\n\t * @param delay - 遅延時間 (ミリ秒)\r\n\t * @returns スロットリングされた関数\r\n\t */\r\n\tpublic static throttle(func: (...args: any[]) => void, delay: number): (...args: any[]) => void {\r\n\t\tlet timeoutId: number | null = null;\r\n\t\tlet lastArgs: any[] | null = null;\r\n\r\n\t\treturn function (...args: any[]) {\r\n\t\t\tlastArgs = args;\r\n\t\t\tif (timeoutId === null) {\r\n\t\t\t\ttimeoutId = window.setTimeout(() => {\r\n\t\t\t\t\tif (lastArgs) {\r\n\t\t\t\t\t\tfunc(...lastArgs);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttimeoutId = null;\r\n\t\t\t\t}, delay);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n}\r\n",
    "const styleData: string = `\r\n/* ========================================================================\r\n    1. 基本設定・変数\r\n   ======================================================================== */\r\n:root {\r\n    /* 基本色・シャドウ */\r\n    --$[prefix]-text-color: #000;\r\n    --$[prefix]-bg: #f0f0f0;\r\n    --$[prefix]-border: #a0a0a0;\r\n    --$[prefix]-shadow-color-light: rgba(0,0,0,0.15);\r\n    --$[prefix]-shadow-color-strong: rgba(0,0,0,0.3);\r\n    --$[prefix]-shadow-color-active: rgba(0,0,0,0.45);\r\n\r\n    /* タイトルバー */\r\n    --$[prefix]-title-bar-height: 32px;\r\n    --$[prefix]-title-bar-bg: #e0e0e0;\r\n    --$[prefix]-title-bar-active-bg: #0078d7;\r\n    --$[prefix]-title-text-color: #000;\r\n    --$[prefix]-title-text-active-color: #fff;\r\n\r\n    /* コントロールボタン */\r\n    --$[prefix]-control-bg: #d0d0d0;\r\n    --$[prefix]-control-hover-bg: #e5e5e5;\r\n    --$[prefix]-control-close-hover-bg: #e81123;\r\n    --$[prefix]-control-close-hover-color: #fff;\r\n\r\n    /* メニュー */\r\n    --$[prefix]-menu-bg: #fff;\r\n    --$[prefix]-menu-border: #ccc;\r\n    --$[prefix]-menu-item-color: #000;\r\n    --$[prefix]-menu-item-hover-bg: #0078d7;\r\n    --$[prefix]-menu-item-hover-color: #fff;\r\n    --$[prefix]-shortcut-text-color: #666;\r\n\r\n    /* タブ */\r\n    --$[prefix]-tab-bg: #dcdcdc;\r\n    --$[prefix]-tab-active-bg: #f0f0f0;\r\n    --$[prefix]-tab-border: #b0b0b0;\r\n    --$[prefix]-tab-bar-bg: #e1e1e1;\r\n    --$[prefix]-tab-close-btn-hover-bg: #ccc;\r\n    --$[prefix]-tab-active-close-btn-hover-bg: #ddd;\r\n\r\n    /* 検索ハイライト */\r\n    --$[prefix]-search-highlight-bg: yellow;\r\n    --$[prefix]-search-highlight-active-bg: orange;\r\n\r\n    /* ポップアップボタン */\r\n    --$[prefix]-popup-button-hover-bg: #e9e9e9;\r\n    --$[prefix]-popup-button-hover-border-color: #bbb;\r\n\r\n    /* リサイズハンドル */\r\n    --$[prefix]-resize-handle-size: 8px;\r\n    --$[prefix]-resize-handle-offset: -4px;\r\n\r\n    /* タスクバー */\r\n    --$[prefix]-taskbar-bg: rgba(240, 240, 240, 0.9);\r\n    --$[prefix]-taskbar-border: #a0a0a0;\r\n    --$[prefix]-taskbar-item-bg: #d0d0d0;\r\n    --$[prefix]-taskbar-item-active-bg: #0078d7;\r\n    --$[prefix]-taskbar-item-active-color: #fff;\r\n    --$[prefix]-taskbar-height: 40px;\r\n    --$[prefix]-taskbar-width: 40px;\r\n\r\n    /* ローディングインジケーター */\r\n    --$[prefix]-loader-bg: rgba(255, 255, 255, 0.7);\r\n    --$[prefix]-loader-color: var(--$[prefix]-title-bar-active-bg);\r\n\r\n    /* その他 */\r\n    --$[prefix]-scrollbar-thumb-bg: rgba(100, 100, 100, 0.5);\r\n}\r\n\r\n/* ========================================================================\r\n    2. ユーティリティクラス\r\n   ========================================================================= */\r\n/**\r\n * テキスト選択を無効化\r\n */\r\n.$[prefix]-us-none {\r\n    user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n}\r\n/**\r\n * テキスト選択を有効化\r\n */\r\n.$[prefix]-us-auto {\r\n    user-select: auto;\r\n    -webkit-user-select: auto;\r\n    -ms-user-select: auto;\r\n}\r\n\r\n/* ========================================================================\r\n    3. コンテナ\r\n   ========================================================================= */\r\n/**\r\n * 全てのウィンドウを内包する最上位コンテナ\r\n */\r\n.$[prefix]-container {\r\n    position: fixed;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    box-sizing: border-box;\r\n    pointer-events: none;\r\n    overflow: hidden;\r\n    z-index: 999;\r\n    display: flex;\r\n    pointer-events: none;\r\n}\r\n.$[prefix]-container > * {\r\n    pointer-events: all; /* 子要素(workspace, taskbar)のイベントは有効化 */\r\n}\r\n/**\r\n * 特定の要素内にネストされた場合のコンテナ\r\n */\r\n.$[prefix]-container.$[prefix]-is-nested {\r\n    position: absolute;\r\n}\r\n\r\n.$[prefix]-workspace {\r\n    position: relative;\r\n    flex-grow: 1; /* 残りのスペースをすべて占有 */\r\n    overflow: hidden; /* ウィンドウがはみ出さないように */\r\n    min-width: 0; /* flexアイテムの縮小問題を回避 */\r\n    min-height: 0; /* flexアイテムの縮小問題を回避 */\r\n    pointer-events: none;\r\n}\r\n/**\r\n * タブのドラッグ中にポインターイベントを有効化し、ドロップを受け付ける\r\n */\r\n.$[prefix]-workspace.$[prefix]-is-tab-dragging {\r\n    pointer-events: auto;\r\n}\r\n\r\n/* ========================================================================\r\n    4. 仮想化技術\r\n   ======================================================================== */\r\n/**\r\n * 仮想化(アンロード)されたウィンドウ\r\n */\r\n.$[prefix]-window.$[prefix]-is-virtualized > .$[prefix]-main-content {\r\n    display: none;\r\n}\r\n.$[prefix]-window.$[prefix]-is-virtualized::after {\r\n    content: \"Unloaded\";\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    color: var(--$[prefix]-border);\r\n    font-size: 1.5em;\r\n    font-weight: bold;\r\n    pointer-events: none;\r\n}\r\n\r\n/**\r\n * 中断されたウィンドウ\r\n */\r\n.$[prefix]-window.$[prefix]-is-suspended > .$[prefix]-main-content {\r\n    display: none;\r\n}\r\n.$[prefix]-window.$[prefix]-is-suspended::after {\r\n    content: \"Suspended\";\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    color: var(--$[prefix]-border);\r\n    font-size: 1.5em;\r\n    font-weight: bold;\r\n    pointer-events: none;\r\n    z-index: 15;\r\n}\r\n\r\n/**\r\n * フリーズされたウィンドウ\r\n */\r\n.$[prefix]-window.$[prefix]-is-frozen > .$[prefix]-main-content {\r\n    pointer-events: none; /* コンテンツの操作を無効化 */\r\n}\r\n.$[prefix]-window.$[prefix]-is-frozen > .$[prefix]-main-content iframe {\r\n    visibility: hidden;\r\n}\r\n.$[prefix]-window.$[prefix]-is-frozen::after {\r\n    content: \"Frozen\";\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    color: var(--$[prefix]-border);\r\n    background: rgba(128, 128, 128, 0.1);\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-size: 1.5em;\r\n    font-weight: bold;\r\n    pointer-events: none;\r\n    z-index: 15; /* ローダーより手前 */\r\n}\r\n\r\n/**\r\n * 仮想化時の操作制限\r\n */\r\n.$[prefix]-window.$[prefix]-virtualization-lock .$[prefix]-menu-bar,\r\n.$[prefix]-window.$[prefix]-virtualization-lock .$[prefix]-tab-bar,\r\n.$[prefix]-window.$[prefix]-virtualization-lock .$[prefix]-custom-control-btn {\r\n    pointer-events: none;\r\n    opacity: 0.5;\r\n}\r\n/* ========================================================================\r\n    5. ウィンドウ\r\n   ======================================================================== */\r\n/* --- ウィンドウ基本スタイル --- */\r\n.$[prefix]-window {\r\n    position: absolute;\r\n    display: flex;\r\n    flex-direction: column;\r\n    min-width: 200px;\r\n    min-height: 150px;\r\n    border: 1px solid var(--$[prefix]-border);\r\n    background-color: var(--$[prefix]-bg);\r\n    box-shadow: 0 5px 15px var(--$[prefix]-shadow-color-strong);\r\n    box-sizing: border-box;\r\n    border-radius: 5px;\r\n    overflow: hidden;\r\n    pointer-events: all;\r\n    transition: opacity 0.25s, transform 0.25s;\r\n    touch-action: none;\r\n}\r\n\r\n/* --- ウィンドウ状態別スタイル --- */\r\n/**\r\n * 最小化中のウィンドウ\r\n */\r\n.$[prefix]-window.$[prefix]-is-minimizing {\r\n    transform: scale(0);\r\n    opacity: 0;\r\n    pointer-events: none;\r\n}\r\n\r\n/**\r\n * 最小化完了状態のウィンドウ\r\n */\r\n.$[prefix]-window.$[prefix]-minimized {\r\n    /* アニメーションの最終状態を維持 */\r\n    transform: scale(0);\r\n    opacity: 0;\r\n    /* 表示と操作を無効化 */\r\n    display: none;\r\n    pointer-events: none;\r\n}\r\n/**\r\n * 最大化されたウィンドウ\r\n */\r\n.$[prefix]-window.$[prefix]-maximized {\r\n    border-radius: 0;\r\n}\r\n/**\r\n * 最大化状態ではリサイズハンドルを非表示\r\n */\r\n.$[prefix]-window.$[prefix]-maximized > .$[prefix]-resize-handle {\r\n    display: none;\r\n}\r\n/**\r\n * 復元中のアニメーション（現在は状態を示すマーカーとしてのみ利用）\r\n */\r\n.$[prefix]-window.$[prefix]-is-restoring {\r\n    /* The transition is now handled by the base .winlet-window class */\r\n}\r\n\r\n/**\r\n * ドラッグ中・リサイズ中のトランジションを短縮し、操作性を向上\r\n */\r\n.$[prefix]-window.$[prefix]-is-dragging,\r\n.$[prefix]-window.$[prefix]-is-resizing {\r\n    transition: opacity 0.1s, transform 0.1s;\r\n}\r\n\r\n/**\r\n * アクティブ（フォーカスされている）ウィンドウ\r\n */\r\n.$[prefix]-window.$[prefix]-active {\r\n    box-shadow: 0 8px 25px var(--$[prefix]-shadow-color-active); /* アクティブ時のシャドウ */\r\n}\r\n/**\r\n * アクティブ（フォーカスされている）ウィンドウのタイトルバー\r\n */\r\n.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar {\r\n    background-color: var(--$[prefix]-title-bar-active-bg);\r\n    color: var(--$[prefix]-title-text-active-color);\r\n}\r\n.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar .$[prefix]-title {\r\n    color: var(--$[prefix]-title-text-active-color);\r\n}\r\n\r\n/* --- ウィンドウ特殊スタイル --- */\r\n/**\r\n * 「常に手前に表示」が有効なウィンドウ\r\n */\r\n.$[prefix]-window.$[prefix]-always-on-top .$[prefix]-title-bar {\r\n    background-image: repeating-linear-gradient(\r\n        -45deg,\r\n        transparent,\r\n        transparent 4px,\r\n        rgba(255, 255, 255, 0.05) 4px,\r\n        rgba(255, 255, 255, 0.05) 8px\r\n    );\r\n}\r\n\r\n/**\r\n * ウィンドウシェイクアニメーション\r\n */\r\n@keyframes $[prefix]-shake {\r\n    10%, 90% { transform: translate3d(-1px, 0, 0); }\r\n    20%, 80% { transform: translate3d(2px, 0, 0); }\r\n    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }\r\n    40%, 60% { transform: translate3d(4px, 0, 0); }\r\n}\r\n.$[prefix]-window.$[prefix]-is-shaking {\r\n    animation: $[prefix]-shake 0.82s cubic-bezier(.36,.07,.19,.97) both;\r\n}\r\n\r\n/* ========================================================================\r\n    6. ゴーストウィンドウ\r\n   ======================================================================== */\r\n/**\r\n * ドラッグ・リサイズ時に表示される輪郭\r\n */\r\n.$[prefix]-ghost-window {\r\n    position: absolute;\r\n    box-sizing: border-box;\r\n    border: 2px dashed var(--$[prefix]-title-bar-active-bg);\r\n    background-color: rgba(0, 120, 215, 0.1);\r\n    z-index: 99999;\r\n    pointer-events: none;\r\n}\r\n\r\n/* ========================================================================\r\n    7. タイトルバー\r\n   ======================================================================== */\r\n/* --- タイトルバー基本スタイル --- */\r\n.$[prefix]-title-bar {\r\n    display: flex;\r\n    align-items: center;\r\n    height: var(--$[prefix]-title-bar-height);\r\n    background-color: var(--$[prefix]-title-bar-bg);\r\n    color: var(--$[prefix]-title-text-color);\r\n    cursor: move;\r\n    flex-shrink: 0;\r\n    touch-action: none;\r\n}\r\n/**\r\n * コントロールが左側にある場合のタイトルバー\r\n */\r\n.$[prefix]-title-bar.$[prefix]-controls-left {\r\n    flex-direction: row-reverse;\r\n}\r\n\r\n/* --- アイコン・タイトル --- */\r\n.$[prefix]-icon {\r\n    min-width: calc(var(--$[prefix]-title-bar-height) * 0.75);\r\n    height: calc(var(--$[prefix]-title-bar-height) * 0.75);\r\n    margin: 0 4px;\r\n    pointer-events: none;\r\n    flex-shrink: 0;\r\n}\r\n\r\n.$[prefix]-icon:empty {\r\n    display: none;\r\n}\r\n\r\n.$[prefix]-icon i {\r\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\r\n    line-height: calc(var(--$[prefix]-title-bar-height) * 0.75);\r\n    text-align: center;\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.$[prefix]-icon img {\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.$[prefix]-title {\r\n    flex-grow: 1;\r\n    padding: 0 8px;\r\n    font-family: sans-serif;\r\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.44);\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    pointer-events: none;\r\n}\r\n\r\n.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-title {\r\n    text-align: right;\r\n}\r\n\r\n/* --- コントロールボタン --- */\r\n.$[prefix]-controls {\r\n    display: flex;\r\n    height: 100%;\r\n    margin-left: auto;\r\n    flex-shrink: 0;\r\n}\r\n\r\n.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-controls {\r\n    margin-left: 0;\r\n    margin-right: auto;\r\n    flex-direction: row-reverse;\r\n}\r\n\r\n.$[prefix]-control-btn {\r\n    display: inline-flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    width: calc(var(--$[prefix]-title-bar-height) * 1.3);\r\n    height: 100%;\r\n    border: none;\r\n    border-radius: 0;\r\n    box-sizing: border-box;\r\n    background-color: transparent;\r\n    font-size: calc(var(--$[prefix]-title-bar-height) * 0.5);\r\n    cursor: pointer;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n    font-family: sans-serif;\r\n    transition: background-color 0.2s;\r\n    touch-action: auto;\r\n    padding: 0;\r\n    margin: 0;\r\n    color: inherit;\r\n}\r\n\r\n.$[prefix]-custom-control-btn > * {\r\n    pointer-events: none;\r\n}\r\n\r\n.$[prefix]-control-btn:hover {\r\n    background-color: var(--$[prefix]-control-hover-bg);\r\n}\r\n\r\n.$[prefix]-control-btn.$[prefix]-close-btn:hover {\r\n    background-color: var(--$[prefix]-control-close-hover-bg);\r\n    color: var(--$[prefix]-control-close-hover-color);\r\n}\r\n\r\n.$[prefix]-refresh-btn {\r\n    display: none;\r\n}\r\n\r\n.$[prefix]-window.$[prefix]-is-virtualized-manual .$[prefix]-refresh-btn {\r\n    display: inline-flex;\r\n}\r\n\r\n/* ========================================================================\r\n    8. メインコンテンツエリア\r\n   ======================================================================== */\r\n.$[prefix]-main-content {\r\n    all: initial;\r\n    position: relative;\r\n    display:flex;\r\n    color: var(--$[prefix]-text-color);\r\n    flex-direction:column;\r\n    flex-grow:1;\r\n    overflow:hidden;\r\n}\r\n\r\n.$[prefix]-content {\r\n    display: flex;\r\n    flex-direction: column;\r\n    flex-grow: 1;\r\n    position: relative;\r\n    overflow: auto;\r\n    touch-action: auto;\r\n}\r\n\r\n.$[prefix]-content iframe {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    border: none;\r\n}\r\n\r\n/* --- ローディングインジケーター --- */\r\n.$[prefix]-loader-overlay {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: var(--$[prefix]-loader-bg);\r\n    display: none;\r\n    justify-content: center;\r\n    align-items: center;\r\n    z-index: 20;\r\n}\r\n@keyframes $[prefix]-spinner-rotation {\r\n    0% { transform: rotate(0deg); }\r\n    100% { transform: rotate(360deg); }\r\n}\r\n.$[prefix]-loader-spinner {\r\n    width: 48px;\r\n    height: 48px;\r\n    border-radius: 50%;\r\n    border: 5px solid #fff;\r\n    border-bottom-color: var(--$[prefix]-loader-color);\r\n    animation: $[prefix]-spinner-rotation 1s linear infinite;\r\n}\r\n\r\n.$[prefix]-canvas-overlay {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    display: none;\r\n    z-index: 10;\r\n}\r\n.$[prefix]-canvas-overlay img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: contain;\r\n}\r\n\r\n/* ========================================================================\r\n    9. メニューバー\r\n   ======================================================================== */\r\n.$[prefix]-menu-bar {\r\n    color: var(--$[prefix]-menu-item-color);\r\n    display: flex;\r\n    background-color: var(--$[prefix]-bg);\r\n    padding: 2px;\r\n    flex-shrink: 0;\r\n    border-bottom: 1px solid var(--$[prefix]-border);\r\n    touch-action: auto;\r\n}\r\n\r\n.$[prefix]-menu-item {\r\n    font-family: sans-serif;\r\n    font-size: clamp(0px , calc(var(--winlet-title-bar-height) * 0.6), 14px);\r\n    padding: 4px 8px;\r\n    cursor: default;\r\n    position: relative;\r\n}\r\n\r\n.$[prefix]-menu-item:hover {\r\n    background-color: var(--$[prefix]-menu-item-hover-bg);\r\n    color: var(--$[prefix]-menu-item-hover-color);\r\n}\r\n\r\n/* --- ドロップダウンメニュー --- */\r\n.$[prefix]-menu-dropdown {\r\n    color: var(--$[prefix]-menu-item-color);\r\n    display: none;\r\n    position: absolute;\r\n    top: 100%;\r\n    left: 0;\r\n    background-color: var(--$[prefix]-menu-bg);\r\n    border: 1px solid var(--$[prefix]-menu-border);\r\n    box-shadow: 0 2px 8px var(--$[prefix]-shadow-color-light);\r\n    list-style: none;\r\n    margin: 0;\r\n    padding: 4px 0;\r\n    min-width: 150px;\r\n    z-index: 10;\r\n    touch-action: auto;\r\n}\r\n\r\n.$[prefix]-menu-dropdown li {\r\n    padding: 0 20px;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n}\r\n\r\n.$[prefix]-menu-dropdown li:hover {\r\n    background-color: var(--$[prefix]-menu-item-hover-bg);\r\n    color: var(--$[prefix]-menu-item-hover-color);\r\n}\r\n\r\n.$[prefix]-menu-dropdown li.$[prefix]-separator {\r\n    height: 1px;\r\n    background-color: var(--$[prefix]-menu-border);\r\n    margin: 4px 0;\r\n    padding: 0;\r\n}\r\n\r\n.$[prefix]-menu-dropdown-item {\r\n    display: flex;\r\n    line-height: 1.6em;\r\n    flex-wrap: nowrap;\r\n    justify-content: space-between;\r\n    width: 100%;\r\n    white-space: nowrap;\r\n}\r\n\r\n/* --- サブメニュー --- */\r\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu {\r\n    position: relative;\r\n}\r\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu::after {\r\n    content: '▶';\r\n    position: absolute;\r\n    top: 50%;\r\n    right: 10px;\r\n    margin-top: calc(var(--winlet-title-bar-height) * -0.5);\r\n    font-size: 0.8em;\r\n    color: inherit;\r\n}\r\n/**\r\n * ネストされたサブメニューの表示位置\r\n */\r\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu > .$[prefix]-menu-dropdown {\r\n    top: -5px; /* liのpaddingを考慮 */\r\n    left: 100%;\r\n}\r\n/**\r\n * サブメニューはホバーで開く\r\n */\r\n.$[prefix]-menu-dropdown li.$[prefix]-has-submenu:hover > .$[prefix]-menu-dropdown {\r\n    display: block;\r\n}\r\n\r\n/* --- ショートカットテキスト --- */\r\n.$[prefix]-shortcut-text {\r\n    color: var(--$[prefix]-shortcut-text-color);\r\n    margin-left: 1em;\r\n}\r\n.$[prefix]-menu-dropdown li:hover .$[prefix]-shortcut-text {\r\n    color: inherit;\r\n}\r\n\r\n/* --- タブ --- */\r\n.$[prefix]-tab-bar {\r\n    color: var(--$[prefix]-menu-item-color);\r\n    overflow-x: auto;\r\n    overflow-y: hidden;\r\n    -ms-overflow-style: -ms-autohiding-scrollbar;\r\n    scrollbar-width: thin;\r\n    display: flex;\r\n    background-color: var(--$[prefix]-tab-bar-bg);\r\n    flex-shrink: 0;\r\n    align-items: flex-end;\r\n    touch-action: auto;\r\n}\r\n\r\n.$[prefix]-tab-bar::-webkit-scrollbar{\r\n    width: 6px;\r\n    height: 6px;\r\n}\r\n\r\n.$[prefix]-tab-bar::-webkit-scrollbar-thumb {\r\n    background-color: var(--$[prefix]-scrollbar-thumb-bg);\r\n    border-radius: 3px;\r\n}\r\n\r\n.$[prefix]-tab-bar::-webkit-scrollbar-track {\r\n    background-color: transparent;\r\n}\r\n\r\n/* --- タブ --- */\r\n.$[prefix]-tab {\r\n    white-space: nowrap;\r\n    padding: 8px 16px;\r\n    font-family: sans-serif;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n    border-right: 1px solid var(--$[prefix]-tab-border);\r\n    background-color: var(--$[prefix]-tab-bg);\r\n}\r\n\r\n.$[prefix]-tab.$[prefix]-active {\r\n    background-color: var(--$[prefix]-tab-active-bg);\r\n    border-bottom: 2px solid var(--$[prefix]-title-bar-active-bg);\r\n}\r\n\r\n.$[prefix]-tab.$[prefix]-active .$[prefix]-tab-close-btn:hover {\r\n    background-color: var(--$[prefix]-tab-active-close-btn-hover-bg);\r\n}\r\n\r\n/**\r\n * ドラッグ中のタブのスタイル\r\n */\r\n.$[prefix]-tab.$[prefix]-dragging {\r\n    opacity: 0.5;\r\n}\r\n\r\n/* --- タブ関連ボタン --- */\r\n/**\r\n * タブの閉じるボタン\r\n */\r\n.$[prefix]-tab-close-btn {\r\n    margin-left: 8px;\r\n    padding: 0 4px;\r\n    border-radius: 50%;\r\n    cursor: pointer;\r\n    font-weight: bold;\r\n    font-size: 14px;\r\n    line-height: 1;\r\n}\r\n.$[prefix]-tab-close-btn:hover {\r\n    background-color: var(--$[prefix]-tab-close-btn-hover-bg);\r\n}\r\n\r\n/**\r\n * タブ追加ボタン\r\n */\r\n.$[prefix]-tab-add-btn {\r\n    padding: 8px;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n    border-bottom: 1px solid var(--$[prefix]-tab-border);\r\n}\r\n.$[prefix]-tab-add-btn:hover {\r\n    background-color: var(--$[prefix]-title-bar-bg);\r\n}\r\n\r\n/* --- タブコンテンツ --- */\r\n.$[prefix]-tab-content {\r\n    display: none;\r\n}\r\n\r\n.$[prefix]-tab-content.$[prefix]-active {\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n/* ========================================================================\r\n    10. 分割ビュー (Split View)\r\n   ======================================================================== */\r\n.$[prefix]-split-view {\r\n    display: flex;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n}\r\n.$[prefix]-split-view-horizontal {\r\n    flex-direction: row;\r\n}\r\n.$[prefix]-split-view-vertical {\r\n    flex-direction: column;\r\n}\r\n.$[prefix]-split-pane {\r\n    position: relative;\r\n    overflow: auto;\r\n}\r\n.$[prefix]-split-resizer {\r\n    background-color: var(--$[prefix]-border);\r\n    flex-shrink: 0;\r\n    z-index: 1;\r\n    transition: background-color 0.2s;\r\n}\r\n.$[prefix]-split-resizer:hover {\r\n    background-color: var(--$[prefix]-title-bar-active-bg);\r\n}\r\n.$[prefix]-split-view-horizontal > .$[prefix]-split-resizer {\r\n    width: 4px;\r\n    cursor: col-resize;\r\n}\r\n.$[prefix]-split-view-vertical > .$[prefix]-split-resizer {\r\n    height: 4px;\r\n    cursor: row-resize;\r\n}\r\n\r\n/* ========================================================================\r\n    11. ステータスバー (Status Bar)\r\n   ======================================================================== */\r\n.$[prefix]-statusbar {\r\n    flex-shrink: 0;\r\n    height: 24px;\r\n    line-height: 24px;\r\n    padding: 0 8px;\r\n    background-color: var(--$[prefix]-title-bar-bg);\r\n    border-top: 1px solid var(--$[prefix]-border);\r\n    font-size: 12px;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    user-select: none;\r\n}\r\n\r\n/* ========================================================================\r\n    12. ウィンドウ内検索 (In-window Search)\r\n   ======================================================================== */\r\n.$[prefix]-search-bar {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    background-color: var(--$[prefix]-bg);\r\n    border: 1px solid var(--$[prefix]-border);\r\n    box-shadow: var(--$[prefix]-shadow-color-light) -2px 2px 5px;\r\n    padding: 4px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n    border-radius: 3px;\r\n    z-index: 80;\r\n}\r\n.$[prefix]-search-input {\r\n    border: 1px solid var(--$[prefix]-border);\r\n    padding: 2px 4px;\r\n    width: 150px;\r\n}\r\n.$[prefix]-search-results {\r\n    font-size: 12px;\r\n    padding: 0 4px;\r\n}\r\n.$[prefix]-search-btn {\r\n    border: 1px solid var(--$[prefix]-border);\r\n    background-color: var(--$[prefix]-bg);\r\n    cursor: pointer;\r\n    padding: 2px 4px;\r\n    font-size: 12px;\r\n    min-width: 22px;\r\n}\r\n.$[prefix]-search-btn:hover {\r\n    background-color: var(--$[prefix]-popup-button-hover-bg);\r\n}\r\n.$[prefix]-search-btn-active {\r\n    background-color: var(--$[prefix]-title-bar-active-bg);\r\n    color: var(--$[prefix]-title-bar-active-color);\r\n}\r\n.$[prefix]-search-highlight {\r\n    background-color: var(--$[prefix]-search-highlight-bg);\r\n    color: black;\r\n}\r\n.$[prefix]-search-highlight-active {\r\n    background-color: var(--$[prefix]-search-highlight-active-bg);\r\n}\r\n\r\n/* ========================================================================\r\n    13. リサイズハンドル\r\n   ======================================================================== */\r\n.$[prefix]-resize-handle {\r\n    position: absolute;\r\n    z-index: 5;\r\n    touch-action: none;\r\n}\r\n\r\n.$[prefix]-resize-handle.$[prefix]-n { top: var(--$[prefix]-resize-handle-offset); left: 0; right: 0; height: var(--$[prefix]-resize-handle-size); cursor: n-resize; }\r\n.$[prefix]-resize-handle.$[prefix]-s { bottom: var(--$[prefix]-resize-handle-offset); left: 0; right: 0; height: var(--$[prefix]-resize-handle-size); cursor: s-resize; }\r\n.$[prefix]-resize-handle.$[prefix]-w { top: 0; bottom: 0; left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); cursor: w-resize; }\r\n.$[prefix]-resize-handle.$[prefix]-e { top: 0; bottom: 0; right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); cursor: e-resize; }\r\n.$[prefix]-resize-handle.$[prefix]-nw { top: var(--$[prefix]-resize-handle-offset); left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: nw-resize; }\r\n.$[prefix]-resize-handle.$[prefix]-ne { top: var(--$[prefix]-resize-handle-offset); right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: ne-resize; }\r\n.$[prefix]-resize-handle.$[prefix]-sw { bottom: var(--$[prefix]-resize-handle-offset); left: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: sw-resize; }\r\n.$[prefix]-resize-handle.$[prefix]-se { bottom: var(--$[prefix]-resize-handle-offset); right: var(--$[prefix]-resize-handle-offset); width: var(--$[prefix]-resize-handle-size); height: var(--$[prefix]-resize-handle-size); cursor: se-resize; }\r\n\r\n/* ========================================================================\r\n    14. コンテキストメニュー\r\n   ======================================================================== */\r\n.$[prefix]-context-menu {\r\n    color: var(--$[prefix]-menu-item-color);\r\n    pointer-events: all;\r\n    position: fixed;\r\n    z-index: 10000;\r\n    background-color: var(--$[prefix]-menu-bg);\r\n    border: 1px solid var(--$[prefix]-menu-border);\r\n    box-shadow: 0 2px 8px var(--$[prefix]-shadow-color-light);\r\n    list-style: none;\r\n    margin: 0;\r\n    padding: 4px 0;\r\n    min-width: 160px;\r\n}\r\n.$[prefix]-context-menu li {\r\n    padding: 6px 24px;\r\n    font-family: sans-serif;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n}\r\n.$[prefix]-context-menu li:hover {\r\n    background-color: var(--$[prefix]-menu-item-hover-bg);\r\n    color: var(--$[prefix]-menu-item-hover-color);\r\n}\r\n.$[prefix]-context-menu li.$[prefix]-separator {\r\n    height: 1px;\r\n    background-color: var(--$[prefix]-menu-border);\r\n    margin: 4px 0;\r\n    padding: 0;\r\n}\r\n\r\n/* ========================================================================\r\n    15. ポップアップ\r\n   ======================================================================== */\r\n.$[prefix]-popup-window .$[prefix]-content {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    padding: 20px;\r\n    box-sizing: border-box;\r\n}\r\n.$[prefix]-popup-message {\r\n    font-family: sans-serif;\r\n    font-size: 14px;\r\n    line-height: 1.5;\r\n    flex-grow: 1;\r\n    word-wrap: break-word;\r\n}\r\n.$[prefix]-popup-buttons {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: 10px;\r\n    margin-top: 20px;\r\n    flex-shrink: 0;\r\n    touch-action: auto;\r\n}\r\n.$[prefix]-popup-button {\r\n    color: var(--$[prefix]-menu-item-color);\r\n    min-width: 80px;\r\n    padding: 8px 12px;\r\n    margin: 0;\r\n    border: 1px solid var(--$[prefix]-menu-border);\r\n    border-radius: 3px;\r\n    background-color: var(--$[prefix]-bg);\r\n    cursor: pointer;\r\n    font-size: 14px;\r\n    box-shadow: 0 1px 1px var(--$[prefix]-shadow-color-light);\r\n}\r\n.$[prefix]-popup-button:hover {\r\n    border-color: var(--$[prefix]-popup-button-hover-border-color);\r\n    background-color: var(--$[prefix]-popup-button-hover-bg);\r\n}\r\n.$[prefix]-popup-button:active {\r\n    background-color: var(--$[prefix]-tab-bg);\r\n}\r\n\r\n/* ========================================================================\r\n    16. 統合スタイル (Merged Styles)\r\n   ======================================================================== */\r\n/* --- メニュー/タブ統合時の基本タイトルバー --- */\r\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-title-bar,\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-title-bar {\r\n    height: auto;\r\n    align-items: flex-end;\r\n    padding: 0;\r\n}\r\n\r\n/* --- メニュー統合スタイル --- */\r\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-icon {\r\n    margin-block: auto;\r\n}\r\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-title {\r\n    flex-grow: 1;\r\n    margin-block: auto;\r\n}\r\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-menu-bar {\r\n    border-bottom: none;\r\n    background: transparent;\r\n    padding: 0 6px;\r\n    align-self: center;\r\n}\r\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-menu-item {\r\n    line-height: var(--$[prefix]-title-bar-height);\r\n    padding-top: 0;\r\n    padding-bottom: 0;\r\n}\r\n/* アクティブウィンドウの統合メニューの文字色 */\r\n.$[prefix]-window.$[prefix]-menu-style-merged.$[prefix]-active:not(.$[prefix]-tab-style-merged) .$[prefix]-menu-item {\r\n    color: var(--winlet-menu-item-hover-color);\r\n}\r\n.$[prefix]-window.$[prefix]-menu-style-merged.$[prefix]-active:not(.$[prefix]-tab-style-merged) .$[prefix]-menu-item:hover {\r\n    background-color: var(--$[prefix]-title-bar-bg);\r\n    color: var(--$[prefix]-menu-item-color);\r\n}\r\n\r\n/* --- タブ統合スタイル (Chrome風) --- */\r\n.$[prefix]-window.$[prefix]-tab-style-merged.$[prefix]-window.$[prefix]-active .$[prefix]-title-bar {\r\n    background-color: var(--$[prefix]-title-bar-bg);\r\n}\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-title {\r\n    display: none;\r\n}\r\n\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar {\r\n    background-color: transparent;\r\n    flex-grow: 1;\r\n    flex-shrink: 1;\r\n    min-width: 0;\r\n    align-items: flex-end;\r\n    height: calc(var(--$[prefix]-title-bar-height) + 4px);\r\n    margin: 0;\r\n    order: 1; /* controlsより前に配置 */\r\n    -ms-overflow-style: none;\r\n    scrollbar-width: none;\r\n}\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-bar::-webkit-scrollbar{\r\n    display: none;\r\n}\r\n.$[prefix]-window.$[prefix]-title-bar.$[prefix]-controls-left .$[prefix]-tab-bar {\r\n    order: -1;\r\n}\r\n\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab {\r\n    border: 1px solid var(--$[prefix]-border);\r\n    border-bottom: none;\r\n    border-radius: 6px 6px 0 0;\r\n    margin-top: 4px;\r\n    margin-left: -1px;\r\n    position: relative;\r\n    bottom: -1px;\r\n}\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab.$[prefix]-active {\r\n    background-color: var(--$[prefix]-bg);\r\n    border-color: var(--$[prefix]-border);\r\n    border-bottom: 1px solid var(--$[prefix]-bg);\r\n    z-index: 2;\r\n}\r\n\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-tab-add-btn {\r\n    border: none;\r\n    align-self: center;\r\n}\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-main-content {\r\n    border-top: none;\r\n}\r\n\r\n/* --- 統合時のコントロールボタン --- */\r\n.$[prefix]-window.$[prefix]-tab-style-merged .$[prefix]-controls,\r\n.$[prefix]-window.$[prefix]-menu-style-merged .$[prefix]-controls {\r\n    align-self: flex-start;\r\n    order: 2;\r\n}\r\n\r\n/* ========================================================================\r\n    17. タスクバー\r\n   ======================================================================== */\r\n.$[prefix]-taskbar {\r\n    position: absolute;\r\n    background-color: var(--$[prefix]-taskbar-bg);\r\n    box-sizing: border-box;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 0 5px;\r\n    z-index: 50000;\r\n    flex-shrink: 0;\r\n    display: flex;\r\n    gap: 5px;\r\n    overflow: auto;\r\n    scrollbar-width: none;\r\n    -ms-overflow-style: none;\r\n    backdrop-filter: blur(5px);\r\n    pointer-events: all;\r\n}\r\n.$[prefix]-taskbar::-webkit-scrollbar{\r\n    display: none;\r\n}\r\n\r\n/* --- 位置 --- */\r\n.$[prefix]-taskbar.$[prefix]-taskbar-bottom {\r\n    bottom: 0;\r\n    left: 0;\r\n    border-top: 1px solid var(--$[prefix]-taskbar-border);\r\n}\r\n.$[prefix]-taskbar.$[prefix]-taskbar-top {\r\n    top: 0;\r\n    left: 0;\r\n    border-bottom: 1px solid var(--$[prefix]-taskbar-border);\r\n}\r\n.$[prefix]-taskbar.$[prefix]-taskbar-left {\r\n    top: 0;\r\n    left: 0;\r\n    border-right: 1px solid var(--$[prefix]-taskbar-border);\r\n}\r\n.$[prefix]-taskbar.$[prefix]-taskbar-right {\r\n    top: 0;\r\n    right: 0;\r\n    border-left: 1px solid var(--$[prefix]-taskbar-border);\r\n}\r\n\r\n.$[prefix]-taskbar.$[prefix]-taskbar-bottom,\r\n.$[prefix]-taskbar.$[prefix]-taskbar-top {\r\n    --$[prefix]-taskbar-icon-size: var(--$[prefix]-taskbar-height);\r\n    width: 100%;\r\n    height: var(--$[prefix]-taskbar-height);\r\n    flex-direction: row;\r\n}\r\n.$[prefix]-taskbar.$[prefix]-taskbar-left,\r\n.$[prefix]-taskbar.$[prefix]-taskbar-right {\r\n    --$[prefix]-taskbar-icon-size: var(--$[prefix]-taskbar-width);\r\n    width: var(--$[prefix]-taskbar-width);\r\n    height: 100%;\r\n    flex-direction: column;\r\n}\r\n\r\n\r\n.$[prefix]-taskbar-item {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: auto;\r\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\r\n    padding: 0 10px;\r\n    border-radius: 3px;\r\n    background-color: var(--$[prefix]-taskbar-item-bg);\r\n    cursor: pointer;\r\n    flex-shrink: 0;\r\n    max-width: 150px;\r\n    transition: background-color 0.2s;\r\n    font-family: sans-serif;\r\n    font-size: 14px;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    box-sizing: border-box;\r\n}\r\n/* 縦向きタスクバーのアイテム */\r\n.$[prefix]-taskbar.$[prefix]-taskbar-left .$[prefix]-taskbar-item,\r\n.$[prefix]-taskbar.$[prefix]-taskbar-right .$[prefix]-taskbar-item {\r\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\r\n    height: auto;\r\n    min-height: 40px;\r\n    max-width: none;\r\n    padding: 10px 0;\r\n    writing-mode: vertical-rl;\r\n}\r\n\r\n.$[prefix]-taskbar-item-icon {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n.$[prefix]-taskbar-item-icon img {\r\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\r\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\r\n    object-fit: contain;\r\n}\r\n.$[prefix]-taskbar-item-icon i {\r\n    font-size: calc((var(--winlet-taskbar-icon-size) - 12px) * 0.8);\r\n    line-height: calc(var(--winlet-taskbar-icon-size) - 18px);\r\n    text-align: center;\r\n    object-fit: contain;\r\n}\r\n.$[prefix]-taskbar-item.$[prefix]-icon-only {\r\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\r\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\r\n    padding: 6px;\r\n}\r\n/* 縦向きアイコンモード */\r\n.$[prefix]-taskbar.$[prefix]-taskbar-left .$[prefix]-taskbar-item.$[prefix]-icon-only,\r\n.$[prefix]-taskbar.$[prefix]-taskbar-right .$[prefix]-taskbar-item.$[prefix]-icon-only {\r\n    width: calc(var(--winlet-taskbar-icon-size) - 6px);\r\n    height: calc(var(--winlet-taskbar-icon-size) - 6px);\r\n}\r\n\r\n.$[prefix]-taskbar-item.$[prefix]-active {\r\n    background-color: var(--$[prefix]-taskbar-item-active-bg);\r\n    color: var(--$[prefix]-taskbar-item-active-color);\r\n}\r\n.$[prefix]-taskbar-item.$[prefix]-minimized {\r\n    opacity: 0.7;\r\n}\r\n\r\n/**\r\n * 仮想化されたウィンドウを示すタスクバーアイテム\r\n */\r\n.$[prefix]-taskbar-item.$[prefix]-virtualized {\r\n    filter: grayscale(80%);\r\n    opacity: 0.7;\r\n    font-style: italic;\r\n}\r\n.$[prefix]-taskbar-item.$[prefix]-virtualized .$[prefix]-taskbar-item-icon img {\r\n    width: calc(var(--winlet-taskbar-icon-size) - 9px);\r\n    height: calc(var(--winlet-taskbar-icon-size) - 9px);\r\n}\r\n.$[prefix]-taskbar-item.$[prefix]-virtualized .$[prefix]-taskbar-item-icon i {\r\n    font-size: calc((var(--winlet-taskbar-icon-size) - 18px) * 0.8);\r\n    line-height: calc(var(--winlet-taskbar-icon-size) - 27px);\r\n}\r\n\r\n/* ========================================================================\r\n    18. モバイル・タッチデバイス対応\r\n   ======================================================================== */\r\n@media (pointer: coarse), (max-width: 768px) {\r\n    /* リサイズハンドルとコントロールボタンを大きくして操作しやすくする */\r\n    :root {\r\n        --$[prefix]-resize-handle-size: 16px;\r\n        --$[prefix]-resize-handle-offset: -8px;\r\n    }\r\n    .$[prefix]-control-btn {\r\n        width: calc(var(--$[prefix]-title-bar-height) * 1.5);\r\n    }\r\n}\r\n\r\n/* ========================================================================\r\n    19. ハイコントラストモード対応\r\n   ======================================================================== */\r\n/* high-contrast.tsと合わせる */\r\n@media (prefers-contrast: more) {\r\n    .$[prefix]-window,\r\n    .$[prefix]-window.$[prefix]-active {\r\n        box-shadow: none;\r\n    }\r\n    .$[prefix]-window.$[prefix]-active {\r\n        border: 2px solid var(--$[prefix]-title-bar-active-bg);\r\n    }\r\n}\r\n\r\n/* ========================================================================\r\n    20. アニメーション無効化\r\n   ======================================================================== */\r\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window,\r\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-minimized,\r\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-maximized,\r\n.$[prefix]-container.$[prefix]-animations-disabled .$[prefix]-window.$[prefix]-is-restoring {\r\n    transition: none;\r\n}\r\n\r\n/* ========================================================================\r\n    21. デバッグモード\r\n   ======================================================================== */\r\n.$[prefix]-debug-overlay {\r\n    display: none;\r\n    position: absolute;\r\n    top: calc(var(--$[prefix]-title-bar-height) + 5px);\r\n    left: 5px;\r\n    background: rgba(0,0,0,0.5);\r\n    color: #fff;\r\n    padding: 5px;\r\n    border-radius: 3px;\r\n    font-family: monospace;\r\n    font-size: 12px;\r\n    line-height: 1.4;\r\n    pointer-events: none;\r\n    z-index: 100;\r\n    white-space: pre;\r\n}\r\n\r\n.$[prefix]-container.$[prefix]-debug-mode-enabled .$[prefix]-debug-overlay {\r\n    display: block;\r\n}\r\n`;\r\n\r\nexport default styleData;\r\n",
    "// src/themes/dark.ts\nimport { Theme } from \"../../const/types\";\n\nexport const darkTheme: Theme = {\n\tname: \"dark\",\n\tvariables: {\n\t\t// 基本色・シャドウ\n\t\t\"--$[prefix]-text-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-bg\": \"#2d2d2d\",\n\t\t\"--$[prefix]-border\": \"#555\",\n\t\t\"--$[prefix]-shadow-color-light\": \"rgba(0,0,0,0.3)\",\n\t\t\"--$[prefix]-shadow-color-strong\": \"rgba(0,0,0,0.5)\",\n\t\t\"--$[prefix]-shadow-color-active\": \"rgba(0,0,0,0.7)\",\n\n\t\t// タイトルバー\n\t\t\"--$[prefix]-title-bar-bg\": \"#3c3c3c\",\n\t\t\"--$[prefix]-title-text-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-title-text-active-color\": \"#fff\",\n\n\t\t// コントロールボタン\n\t\t\"--$[prefix]-control-bg\": \"#4a4a4a\",\n\t\t\"--$[prefix]-control-hover-bg\": \"#5a5a5a\",\n\n\t\t// メニュー\n\t\t\"--$[prefix]-menu-bg\": \"#252525\",\n\t\t\"--$[prefix]-menu-border\": \"#444\",\n\t\t\"--$[prefix]-menu-item-color\": \"#e0e0e0\",\n\t\t\"--$[prefix]-shortcut-text-color\": \"#b0b0b0\",\n\n\t\t// タブ\n\t\t\"--$[prefix]-tab-bg\": \"#383838\",\n\t\t\"--$[prefix]-tab-active-bg\": \"#2d2d2d\",\n\t\t\"--$[prefix]-tab-border\": \"#505050\",\n\t\t\"--$[prefix]-tab-bar-bg\": \"#383838\",\n\t\t\"--$[prefix]-tab-close-btn-hover-bg\": \"#5a5a5a\",\n\t\t\"--$[prefix]-tab-active-close-btn-hover-bg\": \"#6a6a6a\",\n\n\t\t// ポップアップボタン\n\t\t\"--$[prefix]-popup-button-hover-bg\": \"#5a5a5a\",\n\t\t\"--$[prefix]-popup-button-hover-border-color\": \"#777\",\n\n\t\t// タスクバー\n\t\t\"--$[prefix]-taskbar-bg\": \"rgba(45, 45, 45, 0.9)\",\n\t\t\"--$[prefix]-taskbar-border\": \"#555\",\n\t\t\"--$[prefix]-taskbar-item-bg\": \"#5a5a5a\",\n\n\t\t// その他\n\t\t\"--$[prefix]-scrollbar-thumb-bg\": \"rgba(180, 180, 180, 0.5)\",\n\t},\n};\n",
    "// src/themes/default.ts\nimport { Theme } from \"../../const/types\";\n\nexport const defaultTheme: Theme = {\n\tname: \"default\",\n\tvariables: {\n\t\t// 基本色・シャドウ\n\t\t\"--$[prefix]-text-color\": \"#000\",\n\t\t\"--$[prefix]-bg\": \"#f0f0f0\",\n\t\t\"--$[prefix]-border\": \"#a0a0a0\",\n\t\t\"--$[prefix]-shadow-color-light\": \"rgba(0,0,0,0.15)\",\n\t\t\"--$[prefix]-shadow-color-strong\": \"rgba(0,0,0,0.3)\",\n\t\t\"--$[prefix]-shadow-color-active\": \"rgba(0,0,0,0.45)\",\n\n\t\t// タイトルバー\n\t\t\"--$[prefix]-title-bar-bg\": \"#e0e0e0\",\n\t\t\"--$[prefix]-title-bar-active-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-title-text-color\": \"#000\",\n\t\t\"--$[prefix]-title-text-active-color\": \"#fff\",\n\n\t\t// コントロールボタン\n\t\t\"--$[prefix]-control-bg\": \"#d0d0d0\",\n\t\t\"--$[prefix]-control-hover-bg\": \"#e5e5e5\",\n\t\t\"--$[prefix]-control-close-hover-bg\": \"#e81123\",\n\t\t\"--$[prefix]-control-close-hover-color\": \"#fff\",\n\n\t\t// メニュー\n\t\t\"--$[prefix]-menu-bg\": \"#fff\",\n\t\t\"--$[prefix]-menu-border\": \"#ccc\",\n\t\t\"--$[prefix]-menu-item-color\": \"#000\",\n\t\t\"--$[prefix]-menu-item-hover-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-menu-item-hover-color\": \"#fff\",\n\t\t\"--$[prefix]-shortcut-text-color\": \"#666\",\n\n\t\t// タブ\n\t\t\"--$[prefix]-tab-bg\": \"#dcdcdc\",\n\t\t\"--$[prefix]-tab-active-bg\": \"#f0f0f0\",\n\t\t\"--$[prefix]-tab-border\": \"#b0b0b0\",\n\t\t\"--$[prefix]-tab-bar-bg\": \"#e1e1e1\",\n\t\t\"--$[prefix]-tab-close-btn-hover-bg\": \"#ccc\",\n\t\t\"--$[prefix]-tab-active-close-btn-hover-bg\": \"#ddd\",\n\n\t\t// 検索ハイライト\n\t\t\"--$[prefix]-search-highlight-bg\": \"yellow\",\n\t\t\"--$[prefix]-search-highlight-active-bg\": \"orange\",\n\n\t\t// ポップアップボタン\n\t\t\"--$[prefix]-popup-button-hover-bg\": \"#e9e9e9\",\n\t\t\"--$[prefix]-popup-button-hover-border-color\": \"#bbb\",\n\n\t\t// タスクバー\n\t\t\"--$[prefix]-taskbar-bg\": \"rgba(240, 240, 240, 0.9)\",\n\t\t\"--$[prefix]-taskbar-border\": \"#a0a0a0\",\n\t\t\"--$[prefix]-taskbar-item-bg\": \"#d0d0d0\",\n\t\t\"--$[prefix]-taskbar-item-active-bg\": \"#0078d7\",\n\t\t\"--$[prefix]-taskbar-item-active-color\": \"#fff\",\n\n\t\t/* ローディングインジケーター */\n\t\t\"--$[prefix]-loader-bg\": \"rgba(255, 255, 255, 0.7)\",\n\t\t\"--$[prefix]-loader-color\": \"var(--$[prefix]-title-bar-active-bg)\",\n\n\t\t// その他\n\t\t\"--$[prefix]-scrollbar-thumb-bg\": \"rgba(100, 100, 100, 0.5)\",\n\t},\n};\n",
    "import { Theme } from \"../../const/types\";\n\n/**\n * 高コントラストテーマ\n * @see https://github.com/hi2ma-bu4/winlet/blob/main/src/style/style.ts (prefers-contrast: more)\n */\nexport const highContrastTheme: Theme = {\n\tname: \"high-contrast\",\n\tvariables: {\n\t\t// 基本色・シャドウ\n\t\t\"--$[prefix]-text-color\": \"#fff\",\n\t\t\"--$[prefix]-bg\": \"#000\",\n\t\t\"--$[prefix]-border\": \"#fff\",\n\t\t\"--$[prefix]-shadow-color-light\": \"transparent\",\n\t\t\"--$[prefix]-shadow-color-strong\": \"transparent\",\n\t\t\"--$[prefix]-shadow-color-active\": \"transparent\",\n\n\t\t// タイトルバー\n\t\t\"--$[prefix]-title-bar-bg\": \"#000\",\n\t\t\"--$[prefix]-title-bar-active-bg\": \"#0000ff\",\n\t\t\"--$[prefix]-title-text-color\": \"#fff\",\n\t\t\"--$[prefix]-title-text-active-color\": \"#000\",\n\n\t\t// コントロールボタン\n\t\t\"--$[prefix]-control-bg\": \"#000\",\n\t\t\"--$[prefix]-control-hover-bg\": \"#444\",\n\t\t\"--$[prefix]-control-close-hover-bg\": \"#ff0000\",\n\t\t\"--$[prefix]-control-close-hover-color\": \"#fff\",\n\n\t\t// メニュー\n\t\t\"--$[prefix]-menu-bg\": \"#000\",\n\t\t\"--$[prefix]-menu-border\": \"#fff\",\n\t\t\"--$[prefix]-menu-item-color\": \"#fff\",\n\t\t\"--$[prefix]-menu-item-hover-bg\": \"#0000ff\",\n\t\t\"--$[prefix]-menu-item-hover-color\": \"#fff\",\n\n\t\t// タブ\n\t\t\"--$[prefix]-tab-bg\": \"#000\",\n\t\t\"--$[prefix]-tab-active-bg\": \"#000\",\n\t\t\"--$[prefix]-tab-border\": \"#fff\",\n\n\t\t// タスクバー\n\t\t\"--$[prefix]-taskbar-bg\": \"rgba(0, 0, 0, 0.9)\",\n\t\t\"--$[prefix]-taskbar-border\": \"#fff\",\n\t\t\"--$[prefix]-taskbar-item-bg\": \"#000\",\n\t\t\"--$[prefix]-taskbar-item-active-bg\": \"#0000ff\",\n\t\t\"--$[prefix]-taskbar-item-active-color\": \"#fff\",\n\t},\n};\n",
    "// このファイルは自動生成されます\nexport const LIB_VERSION = \"v1.0.2.7\";\n"
  ]
}